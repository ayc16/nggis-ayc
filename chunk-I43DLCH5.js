import{a as u}from"./chunk-WXYOVYVR.js";import{Na as v,R as s,T as S,Y as l,_ as m,b as h,c as p,ca as d,ha as w}from"./chunk-VUJUH7MP.js";import"./chunk-JDLVIKS3.js";import"./chunk-YTDHENVR.js";import{e as F,f as y}from"./chunk-EGGOXN6S.js";import{a as A}from"./chunk-LX3TXNPU.js";import"./chunk-YTC2EJDQ.js";import"./chunk-ERH7ZNSC.js";import"./chunk-5HCLBNUR.js";import"./chunk-QBQKFGOZ.js";import"./chunk-XKXYUJUA.js";import"./chunk-F7PIPM6E.js";import"./chunk-FR6Q4MSQ.js";import"./chunk-C6JT6KYF.js";import"./chunk-BCREO4Q5.js";import"./chunk-6FWNINU2.js";import"./chunk-ES7AH7WX.js";import"./chunk-RSDQHAJX.js";import"./chunk-BENVXA3L.js";import"./chunk-UI76XBLJ.js";import"./chunk-UE2YGKE7.js";import"./chunk-BE76S5KT.js";import"./chunk-3RDV3O6N.js";import"./chunk-D2ITYHSM.js";import"./chunk-FIITBHDP.js";import"./chunk-VSVNPPHQ.js";import"./chunk-CTGIUUCS.js";import"./chunk-VWEBO6QK.js";import"./chunk-KAAR5ZJN.js";import"./chunk-W3WDPWBE.js";import"./chunk-WKT5W7KT.js";import"./chunk-MLSR6YE6.js";import"./chunk-JPDAKIWT.js";import"./chunk-VU5W7W6Y.js";import"./chunk-X3IDZTNG.js";import"./chunk-IQJU4QT3.js";import{h as g}from"./chunk-EAH6BNBL.js";function c(n,e,i,t,a,r){return g(this,null,function*(){if(t.length===1){if(l(t[0]))return u(n,t[0],s(t[1],-1));if(d(t[0]))return u(n,t[0].toArray(),s(t[1],-1))}else if(t.length===2){if(l(t[0]))return u(n,t[0],s(t[1],-1));if(d(t[0]))return u(n,t[0].toArray(),s(t[1],-1));if(m(t[0])){let o=yield t[0].load(),f=yield T(y.create(t[1],o.getFieldsIndex(),o.dateFieldsTimeZoneDefaultUTC),r,a);return x(a,yield t[0].calculateStatistic(n,f,s(t[2],1e3),e.abortSignal))}}else if(t.length===3&&m(t[0])){let o=yield t[0].load(),f=yield T(y.create(t[1],o.getFieldsIndex(),o.dateFieldsTimeZoneDefaultUTC),r,a);return x(a,yield t[0].calculateStatistic(n,f,s(t[2],1e3),e.abortSignal))}return u(n,t,-1)})}function x(n,e){return e instanceof F?A.fromReaderAsTimeStampOffset(e.toStorageFormat()):e instanceof Date?A.dateJSAndZoneToArcadeDate(e,v(n)):e}function T(n,e,i){return g(this,null,function*(){let t=n.getVariables();if(t.length>0){let a=[];for(let o=0;o<t.length;o++){let f={name:t[o]};a.push(yield e.evaluateIdentifier(i,f))}let r={};for(let o=0;o<t.length;o++)r[t[o]]=a[o];return n.parameters=r,n}return n})}function q(n){n.mode==="async"&&(n.functions.stdev=function(e,i){return n.standardFunctionAsync(e,i,(t,a,r)=>c("stdev",t,a,r,e,n))},n.functions.variance=function(e,i){return n.standardFunctionAsync(e,i,(t,a,r)=>c("variance",t,a,r,e,n))},n.functions.average=function(e,i){return n.standardFunctionAsync(e,i,(t,a,r)=>c("mean",t,a,r,e,n))},n.functions.mean=function(e,i){return n.standardFunctionAsync(e,i,(t,a,r)=>c("mean",t,a,r,e,n))},n.functions.sum=function(e,i){return n.standardFunctionAsync(e,i,(t,a,r)=>c("sum",t,a,r,e,n))},n.functions.min=function(e,i){return n.standardFunctionAsync(e,i,(t,a,r)=>c("min",t,a,r,e,n))},n.functions.max=function(e,i){return n.standardFunctionAsync(e,i,(t,a,r)=>c("max",t,a,r,e,n))},n.functions.count=function(e,i){return n.standardFunctionAsync(e,i,(t,a,r)=>{if(w(r,1,1,e,i),m(r[0]))return r[0].count(t.abortSignal);if(l(r[0])||S(r[0]))return r[0].length;if(d(r[0]))return r[0].length();throw new p(e,h.InvalidParameter,i)})})}export{q as registerFunctions};
