import{b as Rt}from"./chunk-A2AOHK3A.js";import{a as z}from"./chunk-HPYRFOMM.js";import{a as Ne,d as ze,e as bt,g as Ve}from"./chunk-56SRKZHP.js";import{c as Ue,d as yt,e as vt}from"./chunk-T6T7OU6K.js";import{a as L}from"./chunk-BEEN2Y4A.js";import{a as $}from"./chunk-PEVVMXZX.js";import{a as je,b as le,c as xt}from"./chunk-FSWYUX4A.js";import{a as M,b as x,c as Me,d as Te,e as Ie,f as Oe,k as Ee,l as Ce,n as gt}from"./chunk-PLEVQKLM.js";import{b as dt}from"./chunk-6HNTTYFF.js";import{b as Fe}from"./chunk-LWKMZQFJ.js";import{a as At}from"./chunk-NYOCZ43I.js";import{a as wt,c as St}from"./chunk-IFFYADB3.js";import{a as b}from"./chunk-Z5FRAQHK.js";import{b as N,c as Pe,d as _e,e as Y}from"./chunk-LQWMDYLF.js";import{a as q,b as ce}from"./chunk-BW3UVZYU.js";import{b as ut}from"./chunk-VXJKEPDS.js";import{F as ft,a as pt,g as mt}from"./chunk-R4NNYEN7.js";import{a as ht}from"./chunk-CF52RSJZ.js";import{a as ie}from"./chunk-ALWV3RJ2.js";import{a as Re}from"./chunk-7C6Z24SS.js";import{a as Qe,c as Xe}from"./chunk-4XUOIGFO.js";import{g as ve,i as we,p as lt,s as Se,t as Ae,w as be}from"./chunk-EBWCXIFH.js";import{p as ct}from"./chunk-MRVR6F6G.js";import{c as ae,d as ot,e as nt,l as at,r as ye,s as st,w as it,x as se}from"./chunk-OZF6BMOL.js";import{a as y,c as ne,e as W,f as rt}from"./chunk-GJP6PTKT.js";import{b as Je}from"./chunk-SF6Z2K5H.js";import{a as et}from"./chunk-NDG5FXLR.js";import{a as Ke}from"./chunk-5ODCEDHC.js";import{b as tt,l as S,v as xe}from"./chunk-SA4OMQAD.js";import{H as He,r as Ze}from"./chunk-XPCG2OJX.js";import{L as g,a as ke,d as We}from"./chunk-AUTL5LCV.js";import{S as ge}from"./chunk-KUJG22IX.js";import{a as h}from"./chunk-W3WDPWBE.js";import{j as qe,k,m as Ye,r as de,v as $e}from"./chunk-GISCFF3Z.js";import{r as C,t as j}from"./chunk-HQMV3KQV.js";import{a as oe,b as he,h as T}from"./chunk-EAH6BNBL.js";var Ft="Mesh must be loaded before applying operations",Pt="Provided component is not part of the list of components",Mt="Expected polygon to be a Polygon instance",Z="Expected location to be a Point instance",pe=class extends j{constructor(){super("invalid-input:location",Z)}};function It([e,t,o,r,n,a],s,i,l){Tt??=new Float64Array(24);let c=Tt;return c[0]=e,c[1]=t,c[2]=o,c[3]=e,c[4]=n,c[5]=o,c[6]=r,c[7]=n,c[8]=o,c[9]=r,c[10]=t,c[11]=o,c[12]=e,c[13]=t,c[14]=a,c[15]=e,c[16]=n,c[17]=a,c[18]=r,c[19]=n,c[20]=a,c[21]=r,c[22]=t,c[23]=a,gt({positions:c,transform:s,vertexSpace:i,inSpatialReference:l,outSpatialReference:l,outPositions:c}),Ge(c,l)}var Tt=null;function Be(e){if(e.length===0)return ft;let t=pt([Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,-Number.POSITIVE_INFINITY,-Number.POSITIVE_INFINITY,-Number.POSITIVE_INFINITY]);return mt(t,e),t}function Ge(e,t){let[o,r,n,a,s,i]=Be(e);return new xe({xmin:o,ymin:r,zmin:n,xmax:a,ymax:s,zmax:i,spatialReference:t})}function H(e,t,o,r){if(r!==void 0){We(e(),"option: geographic",{replacement:"Use mesh `vertexSpace` and spatial reference to control how operations are performed instead.",version:"4.30",warnOnce:!0});let n=t.type==="local";if(!N(t)||r===n)return o.isGeographic||o.isWebMercator&&r;e().warnOnce(`Specifying the 'geographic' parameter (${r}) for a Mesh vertex space of type "${t.type}" is not supported. This parameter will be ignored.`)}switch(t.type){case"georeferenced":return o.isGeographic;case"local":return o.isGeographic||o.isWebMercator}}var me=()=>C.getLogger("esri.geometry.support.meshUtils.centerAt");function Ot(e,t,o){if(!e.vertexAttributes?.position)return;let{vertexSpace:r}=e,n=o?.origin??e.anchor,a=H(me,r,n.spatialReference,o?.geographic);N(r)?or(e,t,n):a?nr(e,t,n):ar(e,t,n)}function or(e,t,o){let{vertexSpace:r}=e;if(!N(r))return;let n=Ct,a=Et;if(!b(t,a,e.spatialReference))return void x(me(),t.spatialReference,e.spatialReference,M);if(!b(o,n,e.spatialReference)){let i=e.origin;return n[0]=i.x,n[1]=i.y,n[2]=i.z,void x(me(),o.spatialReference,e.spatialReference,M)}let s=nt(ir,a,n);r.origin=ot(y(),r.origin,s)}function nr(e,t,o){let r=ne(o.x,o.y,o.z??0),n=le(e,new ce({origin:r}));if(!n)return;let a=ne(t.x,t.y,t.z??0),s=le({vertexAttributes:n,spatialReference:e.spatialReference,vertexSpace:new ce({origin:a})},new q);if(!s)return;let{position:i,normal:l,tangent:c}=s;e.vertexAttributes.position=i,e.vertexAttributes.normal=l,e.vertexAttributes.tangent=c,e.vertexAttributesChanged()}function ar(e,t,o){let r=Ct,n=Et;if(b(t,n,e.spatialReference)){if(!b(o,r,e.spatialReference)){let a=e.origin;return r[0]=a.x,r[1]=a.y,r[2]=a.z,void x(me(),o.spatialReference,e.spatialReference,M)}sr(e.vertexAttributes.position,n,r),e.vertexAttributesChanged()}else x(me(),t.spatialReference,e.spatialReference,M)}function sr(e,t,o){if(e)for(let r=0;r<e.length;r+=3)for(let n=0;n<3;n++)e[r+n]+=t[n]-o[n]}var Et=y(),Ct=y(),ir=y();function jt(e,t,o){return T(this,null,function*(){let{source:r}=t,{loadGLTFMesh:n}=yield de(import("./chunk-CFVJ2FYN.js"),o),a=yield lr(r,o);k(o);let s=n(new S({x:0,y:0,z:0,spatialReference:e.spatialReference}),a.url,{resolveFile:cr(a),signal:o?.signal,expectedType:a.type});s.then(()=>a.dispose(),()=>a.dispose());let{vertexAttributes:i,components:l}=yield s;e.vertexAttributes=i,e.components=l})}function cr(e){let t=He(e.url);return o=>{let r=Ze(o,t,t),n=r?r.replace(/^ *\.\//,""):null;return(n?e.files.get(n):null)??o}}function lr(e,t){return T(this,null,function*(){if(Array.isArray(e)){if(!e.length)throw new j("mesh-load-external:missing-assets","There must be at least one file to load");return e[0]instanceof File?mr(e):fr(e,t)}return Nt(e)})}function pr(e,t){return T(this,null,function*(){let{parts:o,assetMimeType:r,assetName:n}=e;if(o.length===1)return new K(o[0].partUrl);let a=yield e.toBlob(t);return k(t),K.fromBlob(a,Ut(n,r))})}function Nt(e){return K.fromBlob(e,Ut(e.name,e.type))}function mr(e){return _t(e.map(t=>({name:t.name,mimeType:t.type,source:Nt(t)})))}function fr(e,t){return T(this,null,function*(){let o=yield $e(e.map(r=>T(this,null,function*(){let n=yield pr(r);return k(t),{name:r.assetName,mimeType:r.assetMimeType,source:n}})));if(Ye(t))throw o.forEach(r=>r.source.dispose()),qe();return _t(o)})}var zt=/^model\/gltf\+json$/,Lt=/^model\/gltf-binary$/,De=/\.gltf$/i,ur=/\.glb$/i;function _t(e){let t=new Map,o,r=null;for(let{name:n,mimeType:a,source:s}of e)r===null&&(zt.test(a)||De.test(n)?(r=s.url,o="gltf"):(Lt.test(a)||ur.test(n))&&(r=s.url,o="glb")),t.set(n,s.url),s.files.forEach((i,l)=>t.set(l,i));if(r==null)throw new j("mesh-load-external:missing-files","Missing files to load external mesh source");return new K(r,()=>e.forEach(({source:n})=>n.dispose()),t,o)}var K=class e{constructor(t,o=()=>{},r=new Map,n){this.url=t,this.dispose=o,this.files=r,this.type=n}static fromBlob(t,o){let r=URL.createObjectURL(t);return new e(r,()=>URL.revokeObjectURL(r),void 0,o)}};function Ut(e,t){return zt.test(t)||De.test(e)?"gltf":Lt.test(t)||De.test(e)?"glb":void 0}var O=class extends ut{constructor(e){super(e),this.externalSources=new Je,this._explicitDisplaySource=null,this.addHandles(Xe(()=>this.externalSources,"after-remove",({item:t})=>{t===this._explicitDisplaySource&&(this._explicitDisplaySource=null)},{sync:!0,onListenerRemove:()=>this._explicitDisplaySource=null}))}get displaySource(){return this._explicitDisplaySource??this._implicitDisplaySource}set displaySource(e){if(e!=null&&!Ue(e))throw new Error("Cannot use this source for display: it is not in a supported format.");this._explicitDisplaySource=e,e&&this.externalSources.every(t=>!vt(t,e))&&this.externalSources.add(e)}clearSources(){this.externalSources.removeAll()}getExternalSourcesOnService(e){return this.externalSources.items.filter(t=>yt(t,e))}get _implicitDisplaySource(){return this.externalSources.find(Ue)}};h([g()],O.prototype,"externalSources",void 0),h([g()],O.prototype,"displaySource",null),h([g()],O.prototype,"_implicitDisplaySource",null),h([g()],O.prototype,"_explicitDisplaySource",void 0),O=h([ge("esri.geometry.support.meshUtils.Metadata")],O);function Vt(){let{faceDescriptions:e,faceVertexOffsets:t,uvScales:o}=xr,r=4*e.length,n=new Float64Array(3*r),a=new Float32Array(3*r),s=new Float32Array(2*r),i=new Uint32Array(2*e.length*3),l=0,c=0,p=0,f=0;for(let u=0;u<e.length;u++){let m=e[u],v=l/3;for(let R of t)i[f++]=v+R;let U=m.corners;for(let R=0;R<4;R++){let V=U[R],A=0;s[p++]=.25*o[R][0]+m.uvOrigin[0],s[p++]=m.uvOrigin[1]-.25*o[R][1];for(let P=0;P<3;P++)m.axis[P]!==0?(n[l++]=.5*m.axis[P],a[c++]=m.axis[P]):(n[l++]=.5*V[A++],a[c++]=0)}}return{position:n,normal:a,uv:s,faces:i}}function Bt(e,t){let o=e.components[0],r=o.faces,n=yr[t],a=6*n,s=new Array(6),i=new Array(r.length-6),l=0,c=0;for(let p=0;p<r.length;p++)p>=a&&p<a+6?s[l++]=r[p]:i[c++]=r[p];if(e.vertexAttributes.uv!=null){let p=new Float32Array(e.vertexAttributes.uv),f=4*n*2,u=[0,1,1,1,1,0,0,0];for(let m=0;m<u.length;m++)p[f+m]=u[m];e.vertexAttributes.uv=p}return e.components=[new L({faces:s,material:o.material}),new L({faces:i})],e}function Gt(e=0){let t=Math.round(8*2**e),o=2*t,r=(t-1)*(o+1)+2*o,n=new Float64Array(3*r),a=new Float32Array(3*r),s=new Float32Array(2*r),i=new Uint32Array(3*((t-1)*o*2)),l=0,c=0,p=0,f=0;for(let u=0;u<=t;u++){let m=u/t*Math.PI+.5*Math.PI,v=Math.cos(m),U=Math.sin(m);d[2]=U;let R=u===0||u===t,V=R?o-1:o;for(let A=0;A<=V;A++){let P=A/V*2*Math.PI;d[0]=-Math.sin(P)*v,d[1]=Math.cos(P)*v;for(let E=0;E<3;E++)n[l]=.5*d[E],a[l]=d[E],++l;s[c++]=(A+(R?.5:0))/o,s[c++]=u/t,u!==0&&A!==o&&(u!==t&&(i[p++]=f,i[p++]=f+1,i[p++]=f-o),u!==1&&(i[p++]=f,i[p++]=f-o,i[p++]=f-o-1)),f++}}return{position:n,normal:a,uv:s,faces:i}}function Dt(e=0){let o=Math.round(16*2**e),r=4*(o+1)+2*o,n=new Float64Array(3*r),a=new Float32Array(3*r),s=new Float32Array(2*r),i=new Uint32Array(3*(4*o)),l=0,c=0,p=0,f=0,u=0;for(let m=0;m<=5;m++){let v=m===0||m===5,U=m<=1||m>=4,R=m===2||m===4,V=v?o-1:o;for(let A=0;A<=V;A++){let P=A/V*2*Math.PI,E=v?0:.5;d[0]=E*Math.sin(P),d[1]=E*-Math.cos(P),d[2]=m<=2?.5:-.5;for(let D=0;D<3;D++)n[l++]=d[D],a[c++]=U?D===2?m<=1?1:-1:0:D===2?0:d[D]/E;s[p++]=(A+(v?.5:0))/o,s[p++]=m<=1?1*m/3:m<=3?1*(m-2)/3+1/3:1*(m-4)/3+2/3,R||m===0||A===o||(m!==5&&(i[f++]=u,i[f++]=u+1,i[f++]=u-o),m!==1&&(i[f++]=u,i[f++]=u-o,i[f++]=u-o-1)),u++}}return{position:n,normal:a,uv:s,faces:i}}function kt(e,t){let o=typeof t=="number"?t:t!=null?t.width:1,r=typeof t=="number"?t:t!=null?t.height:1;switch(e){case"up":case"down":return{width:o,depth:r};case"north":case"south":return{width:o,height:r};case"east":case"west":return{depth:o,height:r}}}function Wt(e){let t=fe.facingAxisOrderSwap[e],o=fe.position,r=fe.normal,n=new Float64Array(o.length),a=new Float32Array(r.length),s=0;for(let i=0;i<4;i++){let l=s;for(let c=0;c<3;c++){let p=t[c],f=Math.abs(p)-1,u=p>=0?1:-1;n[s]=o[l+f]*u,a[s]=r[l+f]*u,s++}}return{position:n,normal:a,uv:new Float32Array(fe.uv),faces:new Uint32Array(fe.faces),isPlane:!0}}var J=1,Q=2,X=3,fe={position:[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],normal:[0,0,1,0,0,1,0,0,1,0,0,1],uv:[0,1,1,1,1,0,0,0],faces:[0,1,2,0,2,3],facingAxisOrderSwap:{east:[X,J,Q],west:[-X,-J,Q],north:[-J,X,Q],south:[J,-X,Q],up:[J,Q,X],down:[J,-Q,-X]}};function ue(e,t,o){e.isPlane||hr(e),gr(e,dr(o?.size,o?.unit,t.spatialReference));let r=Y(t,o),n=t.spatialReference.isGeographic?Y(t):r,a=le({vertexAttributes:e,vertexSpace:n,spatialReference:t.spatialReference},r,{allowBufferReuse:!0});return{vertexAttributes:new $(he(oe({},a),{uv:e.uv})),vertexSpace:r,components:[new L({faces:e.faces,material:o?.material||null})],spatialReference:t.spatialReference}}function hr(e){for(let t=0;t<e.position.length;t+=3)e.position[t+2]+=.5}function dr(e,t,o){let r=xt(t,o);if(e==null&&r===1)return null;if(e==null)return[r,r,r];if(typeof e=="number"){let n=e*r;return[n,n,n]}return[e.width!=null?e.width*r:r,e.depth!=null?e.depth*r:r,e.height!=null?e.height*r:r]}function gr(e,t){if(t!=null){_[0]=t[0],_[4]=t[1],_[8]=t[2];for(let o=0;o<e.position.length;o+=3){for(let r=0;r<3;r++)d[r]=e.position[o+r];se(d,d,_);for(let r=0;r<3;r++)e.position[o+r]=d[r]}if(t[0]!==t[1]||t[1]!==t[2]){_[0]=1/t[0],_[4]=1/t[1],_[8]=1/t[2];for(let o=0;o<e.normal.length;o+=3){for(let r=0;r<3;r++)d[r]=e.normal[o+r];se(d,d,_),st(d,d);for(let r=0;r<3;r++)e.normal[o+r]=d[r]}}}}var xr={faceDescriptions:[{axis:[0,-1,0],uvOrigin:[0,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[1,0,0],uvOrigin:[.25,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,1,0],uvOrigin:[.5,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[-1,0,0],uvOrigin:[.75,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[0,0,1],uvOrigin:[0,.375],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,0,-1],uvOrigin:[0,.875],corners:[[-1,1],[1,1],[1,-1],[-1,-1]]}],uvScales:[[0,0],[1,0],[1,1],[0,1]],faceVertexOffsets:[0,1,2,0,2,3]},yr={south:0,east:1,north:2,west:3,up:4,down:5},d=y(),_=Re();var B=()=>C.getLogger("esri.geometry.support.meshUtils.rotate");function Ht(e,t,o){if(!e.vertexAttributes?.position||t[3]===0)return;let{spatialReference:r,vertexSpace:n}=e,a=o?.origin??e.anchor,s=o?.geographic,i=H(B,n,r,s);Pe(e)?vr(e,t,a):i?wr(e,t,a):Sr(e,t,a)}function vr(e,t,o){e.transform??=new z;let{vertexSpace:r,transform:n,spatialReference:a}=e,[s,i,l]=r.origin,c=new S({x:s,y:i,z:l,spatialReference:a}),p=ee;if(c.equals(o))ae(p,0,0,0);else if(!je(p,o,e))return void x(B(),o.spatialReference,a,M);At(Zt,t,Ve(t));let f=be(qt,Zt,W,rt,p),{localMatrix:u}=n,m=ve(qt,f,u);n.scale=Ae(y(),m),we(m,m,ye(ee,n.scale));let v=n.rotationAxis;n.rotation=ze(m),n.rotationAngle===0&&(n.rotationAxis=v),n.translation=Se(y(),m)}function wr(e,t,o){let r=e.spatialReference,n=Fe(r),a=Kt;if(!b(o,a,n)&&(x(B(),o.spatialReference,n,"Falling back to mesh origin"),!b(e.origin,a,n)))return void x(B(),e.origin.spatialReference,n);let s=e.vertexAttributes.position,i=e.vertexAttributes.normal,l=e.vertexAttributes.tangent,c=new Float64Array(s.length),p=i!=null?new Float32Array(i.length):null,f=l!=null?new Float32Array(l.length):null;dt(n,a,Le,n),ht($t,Le);let u=Yt;se(Yt,t,$t),u[3]=t[3],Ie(s,r,c)&&(i==null||p==null||Me(i,s,c,r,p))&&(l==null||f==null||Ee(l,s,c,r,f))?(te(c,u,3,a),Oe(c,s,r)&&(i==null||p==null||(te(p,u,3),Te(p,s,c,r,i)))&&(l==null||f==null||(te(f,u,4),Ce(f,s,c,r,l)))?e.vertexAttributesChanged():x(B(),n,r)):x(B(),r,n)}function Sr(e,t,o){let r=Kt;if(!b(o,r,e.spatialReference)){let n=e.origin;return r[0]=n.x,r[1]=n.y,r[2]=n.z,void x(B(),o.spatialReference,e.spatialReference,M)}te(e.vertexAttributes.position,t,3,r),te(e.vertexAttributes.normal,t,3),te(e.vertexAttributes.tangent,t,4),e.vertexAttributesChanged()}function te(e,t,o,r=W){if(e!=null){lt(Le,Ve(t),t);for(let n=0;n<e.length;n+=o){for(let a=0;a<3;a++)ee[a]=e[n+a]-r[a];it(ee,ee,Le);for(let a=0;a<3;a++)e[n+a]=ee[a]+r[a]}}}var ee=y(),qt=ie(),Yt=Ne(),Le=ie(),$t=Re(),Kt=y(),Zt=wt();var G=()=>C.getLogger("esri.geometry.support.meshUtils.scale");function Qt(e,t,o){if(!e.vertexAttributes?.position)return;let{vertexSpace:r,spatialReference:n}=e,a=o?.origin??e.anchor,s=o?.geographic,i=H(G,r,n,s);Pe(e)?Ar(e,t,a):i?br(e,t,a):Rr(e,t,a)}function Ar(e,t,o){e.transform??=new z;let{vertexSpace:r,transform:n,spatialReference:a}=e,[s,i,l]=r.origin,c=new S({x:s,y:i,z:l,spatialReference:a}),p=re;if(c.equals(o))ae(p,0,0,0);else if(!je(p,o,e))return void x(G(),o.spatialReference,a,M);let f=ae(Fr,t,t,t),u=be(Jt,St,W,f,p),{localMatrix:m}=n,v=ve(Jt,u,m);n.scale=Ae(y(),v),we(v,v,ye(re,n.scale));let U=n.rotationAxis;n.rotation=ze(v),n.rotationAngle===0&&(n.rotationAxis=U),n.translation=Se(y(),v)}function br(e,t,o){let r=e.spatialReference,n=Fe(r),a=er;if(!b(o,a,n)&&(x(G(),o.spatialReference,n,"Falling back to mesh origin"),!b(e.origin,a,n)))return void x(G(),e.origin.spatialReference,n);let s=e.vertexAttributes.position,i=e.vertexAttributes.normal,l=e.vertexAttributes.tangent,c=new Float64Array(s.length),p=i!=null?new Float32Array(i.length):null,f=l!=null?new Float32Array(l.length):null;Ie(s,r,c)&&(i==null||p==null||Me(i,s,c,r,p))&&(l==null||f==null||Ee(l,s,c,r,f))?(Xt(c,t,a),Oe(c,s,r)&&(i==null||p==null||Te(p,s,c,r,i))&&(l==null||f==null||Ce(f,s,c,r,l))?e.vertexAttributesChanged():x(G(),n,r)):x(G(),r,n)}function Rr(e,t,o){let r=er;if(!b(o,r,e.spatialReference)){let n=e.origin;return r[0]=n.x,r[1]=n.y,r[2]=n.z,void x(G(),o.spatialReference,e.spatialReference,M)}Xt(e.vertexAttributes.position,t,r),e.vertexAttributesChanged()}function Xt(e,t,o=W){if(e)for(let r=0;r<e.length;r+=3){for(let n=0;n<3;n++)re[n]=e[r+n]-o[n];at(re,re,t);for(let n=0;n<3;n++)e[r+n]=re[n]+o[n]}}var re=y(),Fr=y(),Jt=ie(),er=y();var F,rr="esri.geometry.Mesh";function I(){return C.getLogger(rr)}var Pr={base:null,key:"type",defaultKeyValue:"georeferenced",typeMap:{georeferenced:q,local:ce}},w=F=class extends et.LoadableMixin(Ke(tt)){constructor(e){super(e),this.components=null,this.vertexSpace=new q,this.transform=null,this.metadata=new O,this.hasZ=!0,this.hasM=!1,this.vertexAttributes=new $,this.type="mesh"}initialize(){(this.metadata.externalSources.length===0||this.vertexAttributes.position.length)&&(this.loadStatus="loaded"),this.when(()=>{this.addHandles(Qe(()=>({vertexAttributes:this.vertexAttributes,components:this.components?.map(e=>e.clone())}),()=>this._clearSources(),{once:!0,sync:!0}))})}get hasExtent(){return this.loaded?this.vertexAttributes.position.length>0&&(!this.components||this.components.length>0):this.metadata.displaySource?.extent!=null}get _transformedExtent(){let{components:e,spatialReference:t,vertexAttributes:o,vertexSpace:r}=this,n=o.position;if(n.length===0||e&&e.length===0)return new xe({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:t});if(N(r)){let{_untransformedBounds:a,transform:s}=this;return It(a,s,r,t)}return Ge(n,t)}get _untransformedBounds(){return Be(this.vertexAttributes.position)}get anchor(){let e=_e(this.vertexSpace,this.spatialReference);if(e!=null)return e;let{center:t,zmin:o}=this._transformedExtent;return new S({x:t.x,y:t.y,z:o,spatialReference:this.spatialReference})}get origin(){let e=_e(this.vertexSpace,this.spatialReference);return e??this._transformedExtent.center}get extent(){return this.loaded||this.metadata?.displaySource?.extent==null?this._transformedExtent:this.metadata.displaySource.extent.clone()}addComponent(e){this._checkIfLoaded("addComponent()")&&(this.components||(this.components=[]),this.components.push(L.from(e)),this.notifyChange("components"))}removeComponent(e){if(this._checkIfLoaded("removeComponent()")){if(this.components){let t=this.components.indexOf(e);if(t!==-1)return this.components.splice(t,1),void this.notifyChange("components")}I().error("removeComponent()",Pt)}}rotate(e,t,o,r){return bt(e,t,o,tr),Ht(this,tr,r),this}offset(e,t,o){if(!this._checkIfLoaded("offset()"))return this;let{vertexSpace:r,vertexAttributes:n}=this,a=n?.position;if(!a)return this;if(N(r)){let[s,i,l]=r.origin;r.origin=ne(s+e,i+t,l+o)}else{for(let s=0;s<a.length;s+=3)a[s]+=e,a[s+1]+=t,a[s+2]+=o;this.vertexAttributesChanged()}return this}scale(e,t){return this._checkIfLoaded("scale()")?(Qt(this,e,t),this):this}centerAt(e,t){return this._checkIfLoaded("centerAt()")?(Ot(this,e,t),this):this}load(e){let{metadata:{displaySource:t}}=this;return t&&this.addResolvingPromise(jt(this,t,e)),Promise.resolve(this)}addExternalSources(e){this.metadata.externalSources.addMany(e)}updateDisplaySource(e){this.metadata.displaySource=e}clone(){return this.cloneAndModifyVertexAttributes(this.vertexAttributes.clone(),this.vertexSpace.clone())}cloneAndModifyVertexAttributes(e,t){let o=null;if(this.components){let n=new Map,a=new Map;o=this.components.map(s=>s.cloneWithDeduplication(n,a))}let r={components:o,spatialReference:this.spatialReference,vertexAttributes:e,vertexSpace:t,transform:this.transform?.clone()??null,metadata:this.metadata.clone()};return new F(r)}cloneShallow(){return new F({components:this.components,spatialReference:this.spatialReference,vertexAttributes:this.vertexAttributes,vertexSpace:this.vertexSpace.clone(),transform:this.transform,metadata:this.metadata})}vertexAttributesChanged(){this.notifyChange("vertexAttributes")}toBinaryGLTF(e){return T(this,null,function*(){let[{toBinaryGLTF:t}]=yield Promise.all([import("./chunk-EVHLCEIK.js"),this.load(e)]);return k(e),yield t(this,e)})}get memoryUsage(){let e=0;if(e+=this.vertexAttributes.memoryUsage,this.components!=null)for(let t of this.components)e+=t.memoryUsage;return e}_clearSources(){this.metadata.clearSources()}_checkIfLoaded(e){return!!this.loaded||(I().error(e,Ft),!1)}static createBox(e,t){if(!(e instanceof S))return I().error(".createBox()",Z),null;let o=new F(ue(Vt(),e,t));return t?.imageFace&&t.imageFace!=="all"?Bt(o,t.imageFace):o}static createSphere(e,t){return e instanceof S?new F(ue(Gt(t?.densificationFactor||0),e,t)):(I().error(".createSphere()",Z),null)}static createCylinder(e,t){return e instanceof S?new F(ue(Dt(t?.densificationFactor||0),e,t)):(I().error(".createCylinder()",Z),null)}static createPlane(e,t){if(!(e instanceof S))return I().error(".createPlane()",Z),null;let o=t?.facing??"up",r=kt(o,t?.size);return new F(ue(Wt(o),e,he(oe({},t),{size:r})))}static createFromPolygon(e,t){if(!(e instanceof ct))return I().error(".createFromPolygon()",Mt),null;let o=Rt(e);return new F({vertexAttributes:new $({position:o.position}),components:[new L({faces:o.faces,shading:"flat",material:t?.material??null})],spatialReference:e.spatialReference,vertexSpace:new q})}static createFromGLTF(e,t,o){return T(this,null,function*(){if(!(e instanceof S)){let n=new pe;throw I().error(".createfromGLTF()",n.message),n}let{loadGLTFMesh:r}=yield de(import("./chunk-CFVJ2FYN.js"),o);return new F(yield r(e,t,o))})}static createFromFiles(e,t,o){return T(this,null,function*(){ke(I(),"`Mesh.createFromFiles` is deprecated in favor of 'SceneLayer.convertMesh'",{replacement:"SceneLayer.convertMesh",version:"4.29"});let r=n=>I().error(".createFromFiles()",n.message);if(!(e instanceof S)){let n=new pe;throw r(n),n}if(!o?.layer)throw new j("invalid:no-layer","SceneLayer required for file to mesh conversion.");return o.layer.convertMesh(t,oe({location:e},o))})}static createWithExternalSource(e,t,o){let r=o?.extent??null,{spatialReference:n}=e,a=o?.transform?.clone()??new z,s=Y(e,o),i={source:t,extent:r},l=new O;return l.externalSources.push(i),new F({metadata:l,transform:a,vertexSpace:s,spatialReference:n})}static createIncomplete(e,t){let{spatialReference:o}=e,r=t?.transform?.clone()??new z,n=Y(e,t),a=new F({transform:r,vertexSpace:n,spatialReference:o});return a.addResolvingPromise(Promise.reject(new j("mesh-incomplete","Mesh resources are not complete"))),a}};h([g({type:[L],json:{write:!0}})],w.prototype,"components",void 0),h([g({nonNullable:!0,types:Pr,constructOnly:!0,json:{write:!0}})],w.prototype,"vertexSpace",void 0),h([g({type:z,json:{write:!0}})],w.prototype,"transform",void 0),h([g({constructOnly:!0})],w.prototype,"metadata",void 0),h([g()],w.prototype,"hasExtent",null),h([g()],w.prototype,"_transformedExtent",null),h([g()],w.prototype,"_untransformedBounds",null),h([g()],w.prototype,"anchor",null),h([g()],w.prototype,"origin",null),h([g({readOnly:!0,json:{read:!1}})],w.prototype,"extent",null),h([g({readOnly:!0,json:{read:!1,write:!0,default:!0}})],w.prototype,"hasZ",void 0),h([g({readOnly:!0,json:{read:!1,write:!0,default:!1}})],w.prototype,"hasM",void 0),h([g({type:$,nonNullable:!0,json:{write:!0}})],w.prototype,"vertexAttributes",void 0),w=F=h([ge(rr)],w);var tr=Ne(),Un=w;export{Un as a};
