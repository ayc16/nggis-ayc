import{a as u}from"./chunk-P4OW2SYE.js";import{Na as w,T as s,V as p,_ as l,aa as m,b as F,c as h,ea as d,ja as S}from"./chunk-XRW3LQR2.js";import"./chunk-OCNYIIP3.js";import"./chunk-7RNEANFU.js";import{e as y,f as A}from"./chunk-7LMIBQVQ.js";import{a as g}from"./chunk-I6UFDVWV.js";import"./chunk-OM7Z3UKX.js";import"./chunk-KRMYHUR3.js";import"./chunk-5HCLBNUR.js";import"./chunk-33BSK37G.js";import"./chunk-TQAPQODA.js";import"./chunk-MRVR6F6G.js";import"./chunk-WXQQZY3K.js";import"./chunk-VPMDQK57.js";import"./chunk-BCREO4Q5.js";import"./chunk-76YVRX2R.js";import"./chunk-OZF6BMOL.js";import"./chunk-GJP6PTKT.js";import"./chunk-RSDQHAJX.js";import"./chunk-BENVXA3L.js";import"./chunk-SA4OMQAD.js";import"./chunk-24BLFS5R.js";import"./chunk-JDDD6VJ4.js";import"./chunk-VOYK3LZF.js";import"./chunk-HOJTYTYD.js";import"./chunk-XNEAL2YW.js";import"./chunk-J7M5V2SQ.js";import"./chunk-RQD6EDD6.js";import"./chunk-XPCG2OJX.js";import"./chunk-AUTL5LCV.js";import"./chunk-KUJG22IX.js";import"./chunk-OVHPPCBL.js";import"./chunk-W3WDPWBE.js";import"./chunk-GISCFF3Z.js";import"./chunk-MLSR6YE6.js";import"./chunk-SNFOAZZQ.js";import"./chunk-CPDJJRWA.js";import"./chunk-VU5W7W6Y.js";import"./chunk-HQMV3KQV.js";import"./chunk-CRMMDK2Z.js";import{h as f}from"./chunk-EAH6BNBL.js";function c(a,n,t,e){return f(this,null,function*(){if(t.length===1){if(l(t[0]))return u(a,t[0],s(t[1],-1));if(d(t[0]))return u(a,t[0].toArray(),s(t[1],-1))}else if(t.length===2){if(l(t[0]))return u(a,t[0],s(t[1],-1));if(d(t[0]))return u(a,t[0].toArray(),s(t[1],-1));if(m(t[0])){let i=yield t[0].load(),r=yield x(A.create(t[1],i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC),e,n);return v(n,yield t[0].calculateStatistic(a,r,s(t[2],1e3),n.abortSignal))}}else if(t.length===3&&m(t[0])){let i=yield t[0].load(),r=yield x(A.create(t[1],i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC),e,n);return v(n,yield t[0].calculateStatistic(a,r,s(t[2],1e3),n.abortSignal))}return u(a,t,-1)})}function v(a,n){return n instanceof y?g.fromReaderAsTimeStampOffset(n.toStorageFormat()):n instanceof Date?g.dateJSAndZoneToArcadeDate(n,w(a)):n}function x(a,n,t){return f(this,null,function*(){let e=a.getVariables();if(e.length>0){let i=[];for(let o=0;o<e.length;o++){let T={name:e[o]};i.push(yield n.evaluateIdentifier(t,T))}let r={};for(let o=0;o<e.length;o++)r[e[o]]=i[o];return a.parameters=r,a}return a})}function q(a){a.mode==="async"&&(a.functions.stdev=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("stdev",n,r,a))},a.functions.variance=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("variance",n,r,a))},a.functions.average=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("mean",n,r,a))},a.functions.mean=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("mean",n,r,a))},a.functions.sum=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("sum",n,r,a))},a.functions.min=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("min",n,r,a))},a.functions.max=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("max",n,r,a))},a.functions.count=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>f(this,null,function*(){if(S(r,1,1,n,t),m(r[0]))return r[0].count(e.abortSignal);if(l(r[0])||p(r[0]))return r[0].length;if(d(r[0]))return r[0].length();throw new h(n,F.InvalidParameter,t)}))})}export{q as registerFunctions};
