import{$ as D,Fa as T,Ga as z,P as c,Q as f,T as A,U as g,V as J,X as d,Y as h,Z as F,_ as N,a as S,aa as x,b as u,ba as L,c as l,ca as j,da as b,ea as E,fa as I,na as P,pa as C,qa as V,ra as q,sa as M}from"./chunk-VUJUH7MP.js";import{a as k}from"./chunk-JDLVIKS3.js";import{a as o}from"./chunk-LX3TXNPU.js";import{b as m}from"./chunk-UI76XBLJ.js";import{h as w}from"./chunk-EAH6BNBL.js";function K(t){B=t}var B;function y(t){return t===null?null:b(t)?t.clone():f(t)?t:d(t)?t.clone():j(t)?t.toArray().map(e=>y(e)):h(t)?t.map(e=>y(e)):F(t)?B.createFromArcadeFeature(t):x(t)||N(t)?t:D(t)||t?.declaredClass==="esri.arcade.Attachment"?t.deepClone():(t?.declaredClass==="esri.arcade.Portal"||L(t)||t instanceof S||c(t),t)}function p(t,e,s=!1,n=!1){if(t==null)return null;if(J(t))return V(t);if(g(t))return M(t);if(A(t))return P(t);if(b(t))return q(t,e);if(E(t)||I(t))return t;if(h(t)){let i=[];for(let a of t)i.push(p(a,e,s,n));return i}if(n&&d(t))return t;let r=new v;r.immutable=!1;for(let i of Object.keys(t)){let a=t[i];a!==void 0&&r.setField(i,p(a,e,s,n))}return r.immutable=s,r}var v=class t{constructor(e){this.declaredClass="esri.arcade.Dictionary",this.attributes=null,this.plain=!1,this.immutable=!0,this.attributes=e instanceof t?e.attributes:e??{}}field(e){let s=e.toLowerCase(),n=this.attributes[e];if(n!==void 0)return n;for(let r in this.attributes)if(r.toLowerCase()===s)return this.attributes[r];throw new l(null,u.FieldNotFound,null,{key:e})}setField(e,s){if(this.immutable)throw new l(null,u.Immutable,null);if(c(s))throw new l(null,u.NoFunctionInDictionary,null);let n=e.toLowerCase();if(s instanceof Date&&(s=o.dateJSToArcadeDate(s)),this.attributes[e]===void 0){for(let r in this.attributes)if(r.toLowerCase()===n)return void(this.attributes[r]=s);this.attributes[e]=s}else this.attributes[e]=s}hasField(e){let s=e.toLowerCase();if(this.attributes[e]!==void 0)return!0;for(let n in this.attributes)if(n.toLowerCase()===s)return!0;return!1}keys(){let e=[];for(let s in this.attributes)e.push(s);return e=e.sort(),e}castToText(e=!1){let s="";for(let n in this.attributes){s!==""&&(s+=",");let r=this.attributes[n];r==null?s+=JSON.stringify(n)+":null":g(r)||J(r)||A(r)?s+=JSON.stringify(n)+":"+JSON.stringify(r):r instanceof m?s+=JSON.stringify(n)+":"+C(r):r instanceof k||r instanceof Array?s+=JSON.stringify(n)+":"+C(r,null,e):r instanceof o?s+=e?JSON.stringify(n)+":"+JSON.stringify(r.getTime()):JSON.stringify(n)+":"+r.stringify():r!==null&&typeof r=="object"&&r.castToText!==void 0&&(s+=JSON.stringify(n)+":"+r.castToText(e))}return"{"+s+"}"}static convertObjectToArcadeDictionary(e,s,n=!0,r=!1){let i=new t;i.immutable=!1;for(let a in e){let O=e[a];O!==void 0&&i.setField(a.toString(),p(O,s,n,r))}return i.immutable=n,i}static convertJsonToArcade(e,s,n=!1,r=!1){return p(e,s,n,r)}castAsJson(e=null){let s={};for(let n in this.attributes){let r=this.attributes[n];r!==void 0&&(e?.keyTranslate&&(n=e.keyTranslate(n)),s[n]=T(r,e))}return s}castDictionaryValueAsJsonAsync(e,s,n,r=null,i){return w(this,null,function*(){let a=yield z(n,r,i);return e[s]=a,a})}castAsJsonAsync(e=null,s=null){return w(this,null,function*(){let n={},r=[];for(let i in this.attributes){let a=this.attributes[i];s?.keyTranslate&&(i=s.keyTranslate(i)),a!==void 0&&(f(a)||a instanceof m||a instanceof o?n[i]=T(a,s):r.push(this.castDictionaryValueAsJsonAsync(n,i,a,e,s)))}return r.length>0&&(yield Promise.all(r)),n})}deepClone(){let e=new t;e.immutable=!1;for(let s of this.keys())e.setField(s,y(this.field(s)));return e}};export{K as a,y as b,v as c};
