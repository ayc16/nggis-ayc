import{b as w}from"./chunk-SF6Z2K5H.js";import{e as E}from"./chunk-JOSG37QF.js";import{J as x}from"./chunk-AUTL5LCV.js";import{a as A,c as b,e as M,g,h as C,j as d,m as y,p as L,t as v}from"./chunk-GISCFF3Z.js";import{d as f}from"./chunk-MLSR6YE6.js";import{h as p}from"./chunk-EAH6BNBL.js";function k(r,s,n={}){return h(r,s,n,H)}function F(r,s,n={}){return h(r,s,n,P)}function h(r,s,n={},t){let e=null,i=n.once?(a,o)=>{t(a)&&(f(e),s(a,o))}:(a,o)=>{t(a)&&s(a,o)};if(e=x(r,i,n.sync,n.equals),n.initial){let a=r();i(a,a)}return e}function O(r,s,n,t={}){let e=null,i=null,a=null;function o(){e&&i&&(i.remove(),t.onListenerRemove?.(e),e=null,i=null)}function c(u){t.once&&t.once&&f(a),n(u)}let l=k(r,(u,m)=>{o(),g(u)&&(e=u,i=C(u,s,c),t.onListenerAdd?.(u))},{sync:t.sync,initial:!0});return a=A(()=>{l.remove(),o()}),a}function J(r,s){return T(r,P,s)}function T(r,s,n){if(y(n))return Promise.reject(d());let t=r();if(s?.(t))return Promise.resolve(t);let e=null;function i(){e=f(e)}return new Promise((a,o)=>{e=b([L(n,()=>{i(),o(d())}),h(r,c=>{i(),a(c)},{sync:!1,once:!0},s??H)])})}function H(r){return!0}function P(r){return!!r}function j(r,s){let n=new w,t=O(r,"after-splice",({added:e,start:i,deleteCount:a})=>{let o=n.splice(i,a);for(let c of o)c.remove();if(e?.length){let c=e.map(s);n.addMany(c,i)}},{sync:!0,onListenerRemove:()=>n.drain(e=>e.remove()),onListenerAdd:e=>n.addMany(e.items.map(s))});return n.addHandles(t),n}function K(r,s){let n=new w,t=j(r,o=>E(c=>p(this,null,function*(){let l=yield s(o,c);if(y(c))throw l.remove(),d();return l}))),e=()=>null,i=o=>p(this,null,function*(){let c=yield o.promise,l=t.indexOf(o);l<0||n.splice(l,1,c)});n.addMany(t.items.map(e));for(let o of t)v(i(o));let a=t.on("after-splice",({added:o,start:c,deleteCount:l})=>{let u=n.splice(c,l);for(let m of u)m?.remove();if(o?.length){n.addMany(o.map(e),c);for(let m of o)v(i(m))}});return n.addHandles([M(t),a]),n}var N={sync:!0},Q={initial:!0},S={sync:!0,initial:!0};export{k as a,F as b,O as c,J as d,K as e,N as f,Q as g,S as h};
