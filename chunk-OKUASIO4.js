import{a as B,b as T,c as M,f as U,i as G}from"./chunk-GTUZYOSX.js";import{a as A,h as H,i as q}from"./chunk-REV6BOW7.js";import{q as j}from"./chunk-TALIOOAA.js";import{i as O,m as W}from"./chunk-DHY7QZ2H.js";import{a as F}from"./chunk-MFP2OFDR.js";import{a as R}from"./chunk-MDSLION2.js";import{h as d}from"./chunk-EAH6BNBL.js";var J=30,K=12,N=[255,255,255],Q=[200,200,200],v=[128,128,128],_=20,$=5;function ee(e){return e.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function te(e){return e.declaredClass==="esri.symbols.PictureMarkerSymbol"}function ne(e){return e.declaredClass==="esri.symbols.SimpleLineSymbol"}function oe(e){return e.declaredClass==="esri.symbols.TextSymbol"}function le(e,t){let n=e.length-1;return e.map((l,o)=>U(l,o,n,t))}function ke(e,t,n,l,o,i,s){return d(this,null,function*(){let a=t.legendOptions,c=a?.customValues,m=s||(yield se(e,n)),y=t.stops,D=!!m,b=!!c,h=t.minSize!=null&&t.maxSize!=null,S=y&&y.length>1,g=!!t.target;if(!D||!b&&!(h||S&&!g))return;let f=q(m),p=!1,r=null,k=null;r=f&&!S?M([t.minDataValue,t.maxDataValue]):c??(yield ue(t,m,l,o?.type));let x=e?.authoringInfo,V=x?.type==="univariate-color-size",C=V&&x?.univariateTheme==="above-and-below";if(!r&&S&&(r=y.map(u=>u.value),p=y.some(u=>!!u.label),e.type==="flow"&&(r=M(r)),p&&(k=y.map(u=>u.label))),f&&r!=null&&r?.length>2&&!C&&(r=[r[0],r[r.length-1]]),!r)return null;V&&r?.length!==5&&(r=Z({minSize:r[0],maxSize:r[r.length-1]}));let I=f?ie(e,r):null,E=H(m),w=p?null:le(r,i);return(yield Promise.all(r.map((u,L)=>d(this,null,function*(){let P=f?I[L]:yield z(t,m,u,l,o?.type);return{value:u,symbol:fe(C&&e.type==="class-breaks"?re(e,L):m,P),label:p?k[L]:w[L],size:P,outlineSize:E}})))).reverse()})}function ie(e,t){let n=e?.authoringInfo,l=n?.type==="univariate-color-size",o=[K,J];if(l){let i=t[0],s=t[t.length-1],a=K,c=J;o=t.map(m=>a+(m-i)/(s-i)*(c-a))}return l&&n?.univariateTheme==="below"&&o.reverse(),o}function re(e,t){let n=e.classBreakInfos,l=n.length,o=l<2||!(t>=2)?n[0].symbol.clone():n[l-1].symbol.clone();return e.visualVariables.some(i=>i.type==="color")&&(o.type.includes("3d")?X(o):Y(o)),o}function se(e,t){return d(this,null,function*(){if(e.type==="flow")return G(e,t);if(e.type==="pie-chart")return new W({color:null,outline:e.outline?.width?e.outline:new O});let n=null,l=null;if(e.type==="simple")n=e.symbol;else if(e.type==="class-breaks"){let o=e.classBreakInfos;n=o&&o[0]&&o[0].symbol,l=o.length>1}else if(e.type==="unique-value"){let o=e.uniqueValueInfos;n=o?.[0]?.symbol,l=o!=null&&o.length>1}return!n||ae(n)?null:(n=n.clone(),(t||l)&&(n.type.includes("3d")?X(n):Y(n)),n)})}function ae(e){return e?j(e)?!!e.symbolLayers&&e.symbolLayers.some(t=>t&&t.type==="fill"):e.type.includes("fill"):!1}function X(e){e.type==="line-3d"?e.symbolLayers.forEach(t=>{t.material={color:v}}):e.symbolLayers.forEach(t=>{t.type!=="icon"||t.resource?.href?t.material={color:Q}:(t.material={color:N},t.outline={color:v,size:1.5})})}function Y(e){let t=R();e.type==="cim"?A(e,new F(Q)):e.type.includes("line")?e.color=v:(e.color=t?v:N,e.type==="simple-marker"&&(e.outline?e.outline?.color?.toHex()==="#ffffff"&&(e.outline.color=v):e.outline={color:v,width:1.5}))}function ue(e,t,n,l){return d(this,null,function*(){let o=(yield import("./chunk-YWI5QKEK.js")).getSizeRangeAtScale(e,n,l),i=o&&Z(o);if(!o||!i)return;let s=i.map(a=>ce(a,e,o));s=M(s);for(let a=1;a<s.length-1;a++){let c=yield me(e,t,s[a],s[a-1],n,l);c&&(s[a]=c[0],i[a]=c[1])}return s})}function Z(e){let t=e.minSize,n=e.maxSize,l=$,o=(n-t)/(l-1),i=[];for(let s=0;s<l;s++)i.push(t+o*s);return i}function ce(e,t,n){let l=n.minSize,o=n.maxSize,i=t.minDataValue,s=t.maxDataValue,a;return e<=l?a=i:e>=o?a=s:a=(e-l)/(o-l)*(s-i)+i,a}function me(e,t,n,l,o,i){return d(this,null,function*(){let s=yield z(e,t,n,o,i),a=yield z(e,t,l,o,i),c=B(n),m=c.fractional,y=_,D=c.integer,b=null,h=null;n>0&&n<1&&(b=10**m,D=B(n*=b).integer);for(let S=D-1;S>=0;S--){let g=10**S,f=Math.floor(n/g)*g,p=Math.ceil(n/g)*g;b!=null&&(f/=b,p/=b);let r=(f+p)/2;[,r]=M([f,r,p],{indexes:[1]});let k=yield z(e,t,f,o,i),x=yield z(e,t,p,o,i),V=yield z(e,t,r,o,i),C=T(s,k,a,null),I=T(s,x,a,null),E=T(s,V,a,null),w=C.previous<=y,u=I.previous<=y;if(w&&u&&(C.previous<=I.previous?(w=!0,u=!1):(u=!0,w=!1)),w?h=[f,k]:u?h=[p,x]:E.previous<=y&&(h=[r,V]),h)break}return h})}function z(e,t,n,l,o){return d(this,null,function*(){let{getSize:i}=yield import("./chunk-YWI5QKEK.js");return i(e,n,{scale:l,view:o,shape:t.type==="simple-marker"?t.style:null})})}function fe(e,t){let n=e.clone();if(j(n))q(n)||n.symbolLayers.forEach(l=>{l.type!=="fill"&&(l.size=t)});else if(ee(n))n.size=t;else if(te(n)){let l=n.width,o=n.height;n.height=t,n.width=t*(l/o)}else ne(n)?n.width=t:oe(n)&&n.font&&(n.font.size=t);return n}export{J as a,K as b,ke as c};
