import{b as _}from"./chunk-ZK263UMU.js";import{a as x}from"./chunk-MKR7D3TU.js";import"./chunk-63CLAPA5.js";import"./chunk-CX34C47X.js";import"./chunk-GJBALZEB.js";import"./chunk-B7IX6UFG.js";import"./chunk-ZAQLF7TN.js";import"./chunk-S3DH7XZE.js";import"./chunk-4KGZTO2H.js";import"./chunk-2774JW3N.js";import"./chunk-E3472BDJ.js";import"./chunk-AATZFFI5.js";import"./chunk-IY6MAS3P.js";import"./chunk-UJ6V7JUK.js";import"./chunk-47Q3ZDMA.js";import"./chunk-4XUOIGFO.js";import"./chunk-7LEG2VDW.js";import"./chunk-G24ZJINL.js";import{b as h}from"./chunk-ALQ3STGG.js";import"./chunk-AM3VOA32.js";import"./chunk-SAOUSUZE.js";import"./chunk-LECQV7I4.js";import"./chunk-4HISZWR4.js";import"./chunk-33BSK37G.js";import"./chunk-EBWCXIFH.js";import"./chunk-MRVR6F6G.js";import"./chunk-WXQQZY3K.js";import"./chunk-VPMDQK57.js";import"./chunk-BCREO4Q5.js";import"./chunk-76YVRX2R.js";import"./chunk-OZF6BMOL.js";import"./chunk-GJP6PTKT.js";import"./chunk-RSDQHAJX.js";import{b as y}from"./chunk-SF6Z2K5H.js";import"./chunk-GBTN5LIS.js";import"./chunk-JOSG37QF.js";import"./chunk-SLMQFZE3.js";import"./chunk-5ODCEDHC.js";import"./chunk-SA4OMQAD.js";import"./chunk-24BLFS5R.js";import"./chunk-JDDD6VJ4.js";import"./chunk-VOYK3LZF.js";import"./chunk-XNEAL2YW.js";import"./chunk-J7M5V2SQ.js";import"./chunk-RQD6EDD6.js";import"./chunk-XPCG2OJX.js";import{L as a}from"./chunk-AUTL5LCV.js";import{S as m}from"./chunk-KUJG22IX.js";import"./chunk-OVHPPCBL.js";import{a as r}from"./chunk-W3WDPWBE.js";import{B as F,a as S,c as $,t as C}from"./chunk-GISCFF3Z.js";import"./chunk-MLSR6YE6.js";import"./chunk-SNFOAZZQ.js";import"./chunk-CPDJJRWA.js";import"./chunk-VU5W7W6Y.js";import{r as b}from"./chunk-HQMV3KQV.js";import"./chunk-CRMMDK2Z.js";import{h as v}from"./chunk-EAH6BNBL.js";var c=Symbol(),U=d=>{let e=class extends d{constructor(){super(...arguments),this.layerViews=new y,this._debouncedUpdate=F(()=>v(this,null,function*(){let{layer:i,parent:s}=this,o=s?.footprintLayerView,n=[],p=this._createQuery();if(p&&o){let{features:f}=yield o.queryFeatures(p);this.suspended||(n=f.map(w=>i.acquireLayer(w)))}this.removeHandles(c),this.addHandles(n,c)}))}get creatingLayerViews(){return this.view?.layerViewManager.isCreatingLayerViewsForLayer(this.layer)??!1}isUpdating(){return this.creatingLayerViews||this.layer.updating||this.layerViews.some(i=>i.updating)}enableLayerUpdates(){return $([this._updatingHandles.addWhen(()=>this.parent?.footprintLayerView?.dataUpdating===!1,()=>this.updateLayers()),this._updatingHandles.add(()=>[this.layer.maximumVisibleSublayers,this.layer.parent?.orderBy,this.parent?.footprintLayerView?.filter,this.parent?.footprintLayerView?.timeExtent,this.suspended],()=>this.updateLayers()),S(()=>this.removeHandles(c))])}updateLayers(){this.suspended?this.removeHandles(c):this._updatingHandles.addPromise(C(this._debouncedUpdate()).catch(i=>{b.getLogger(this).error(i)}))}_createQuery(){let i=this.parent?.footprintLayerView,s=this.layer?.parent;if(!i||!s||s.destroyed)return null;let{layer:{maximumVisibleSublayers:o},view:{scale:n}}=this;if(!o)return null;let{itemTypeField:p,itemSourceField:f,itemNameField:w,minScaleField:g,maxScaleField:V,objectIdField:H,orderBy:I}=s,A=h(`${g} IS NULL OR ${n} <= ${g} OR ${g} = 0`,`${V} IS NULL OR ${n} >= ${V}`),l=I?.find(u=>u.field&&!u.valueExpression),t=i.createQuery();if(t.returnGeometry=!1,t.num=o,t.outFields=[H,f,w],t.where=h(t.where,A),this.unsupportedItemTypes!=null){let u=`${p} NOT IN (${this.unsupportedItemTypes.map(O=>`'${O}'`)})`;t.where=h(t.where,u)}return l?.field&&(t.orderByFields=[`${l.field} ${l.order==="descending"?"DESC":"ASC"}`],t.outFields.push(l.field)),t}};return r([a({readOnly:!0})],e.prototype,"creatingLayerViews",null),r([a()],e.prototype,"layer",void 0),r([a()],e.prototype,"layerViews",void 0),r([a({readOnly:!0})],e.prototype,"unsupportedItemTypes",void 0),r([a()],e.prototype,"parent",void 0),r([a({readOnly:!0})],e.prototype,"isUpdating",null),e=r([m("esri.views.layers.CatalogDynamicGroupLayerView")],e),e};var L=class extends U(_(x)){constructor(){super(...arguments),this.unsupportedItemTypes=["Scene Service"],this.layerViews=new y}attach(){this.addAttachHandles([this.layerViews.on("after-changes",()=>this._updateStageChildren()),this.enableLayerUpdates()])}detach(){this.container.removeAllChildren()}update(d){this.updateLayers()}viewChange(){}moveEnd(){this.requestUpdate()}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((d,e)=>this.container.addChildAt(d.container,e))}};L=r([m("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],L);var ie=L;export{ie as default};
