import{a as J,b as ln,c as dn,d as mn,j as wn,k as hn,l as pn}from"./chunk-I2ZQGXY4.js";import{a as Y}from"./chunk-GRKVI6KL.js";import{a as X}from"./chunk-6CZVQOI6.js";import{c as T}from"./chunk-C4KJ5QFP.js";import{Aa as D,Ba as Z,Na as O,R as m,V as k,Y as P,_ as L,b as i,c as s,ca as I,da as B,ea as G,fa as K,ha as w,na as q,qa as x,sa as fn,ta as U,ya as l,za as Q}from"./chunk-VUJUH7MP.js";import{A as $,D as qn,E as nn,F as en,G as rn,H as M,I as tn,J as z,b as yn,c as gn,d as vn,e as Pn,f as In,g as An,h as Fn,i as Rn,j as xn,k as Nn,l as bn,m as Sn,n as On,o as _,p as Tn,q as jn,r as Cn,s as Dn,t as Ln,u as Un,v as Jn,w as Mn,x as En,y as kn}from"./chunk-6LUFMGKP.js";import{d as C,f as p,g as R}from"./chunk-LX3TXNPU.js";import{f as H}from"./chunk-QBQKFGOZ.js";import{a as W,o as S,p as F}from"./chunk-F7PIPM6E.js";import{c as an}from"./chunk-U4U366GW.js";import{b as d,j as b,t as j}from"./chunk-UI76XBLJ.js";import{U as on}from"./chunk-BE76S5KT.js";import{T as un,U as cn,_ as V}from"./chunk-CTGIUUCS.js";import{h as A}from"./chunk-EAH6BNBL.js";function sn(a,e,r){return A(this,null,function*(){if(!cn?.findCredential(a.restUrl))return null;if(a.loadStatus==="loaded"&&e===""&&a.user?.sourceJSON&&r===!1)return a.user.sourceJSON;let o={responseType:"json",query:{f:"json"}};if(r&&(o.query.returnUserLicenseTypeExtensions=!0),e===""){let t=yield V(a.restUrl+"/community/self",o);if(t.data){let u=t.data;if(u?.username)return u}return null}let n=yield V(a.restUrl+"/community/users/"+e,o);if(n.data){let t=n.data;return t.error?null:t}return null})}function Zn(a){return un.indexOf("4.")===0?S.fromExtent(a):new S({spatialReference:a.spatialReference,rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]})}function N(a,e,r){if(w(a,2,2,e,r),!(a[0]instanceof d&&a[1]instanceof d)){if(!(a[0]instanceof d&&a[1]===null)){if(!(a[1]instanceof d&&a[0]===null)){if(a[0]!==null||a[1]!==null)throw new s(e,i.InvalidParameter,r)}}}}function zn(a,e){return A(this,null,function*(){if(a.type!=="polygon"&&a.type!=="polyline"&&a.type!=="extent")return 0;let r=1;(a.spatialReference.vcsWkid||a.spatialReference.latestVcsWkid)&&(r=ln(a.spatialReference)/on(a.spatialReference));let c=0;if(a.type==="polyline")for(let n of a.paths)for(let t=1;t<n.length;t++)c+=J(n[t],n[t-1],r);else if(a.type==="polygon")for(let n of a.rings){for(let t=1;t<n.length;t++)c+=J(n[t],n[t-1],r);(n[0][0]!==n[n.length-1][0]||n[0][1]!==n[n.length-1][1]||n[0][2]!==void 0&&n[0][2]!==n[n.length-1][2])&&(c+=J(n[0],n[n.length-1],r))}else a.type==="extent"&&(c+=2*J([a.xmin,a.ymin,0],[a.xmax,a.ymin,0],r),c+=2*J([a.xmin,a.ymin,0],[a.xmin,a.ymax,0],r),c*=2,c+=4*Math.abs(m(a.zmax,0)*r-m(a.zmin,0)*r));let o=new F({hasZ:!1,hasM:!1,spatialReference:a.spatialReference,paths:[[0,0],[0,c]]});return M(o,e)})}function me(a){a.mode==="async"&&(a.functions.disjoint=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]===null||n[1]===null||Nn(n[0],n[1])))},a.functions.intersects=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]!==null&&n[1]!==null&&Fn(n[0],n[1])))},a.functions.touches=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]!==null&&n[1]!==null&&Rn(n[0],n[1])))},a.functions.crosses=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]!==null&&n[1]!==null&&Pn(n[0],n[1])))},a.functions.within=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]!==null&&n[1]!==null&&xn(n[0],n[1])))},a.functions.contains=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]!==null&&n[1]!==null&&vn(n[0],n[1])))},a.functions.overlaps=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]!==null&&n[1]!==null&&bn(n[0],n[1])))},a.functions.equals=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(w(n,2,2,e,r),n[0]===n[1]||(n[0]instanceof d&&n[1]instanceof d?An(n[0],n[1]):(B(n[0])&&B(n[1])||!!(K(n[0])&&K(n[1])||G(n[0])&&G(n[1])))&&n[0].equals(n[1]))))},a.functions.relate=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,3,3,e,r),n[0]instanceof d&&n[1]instanceof d)return Sn(n[0],n[1],q(n[2]));if(n[0]instanceof d&&n[1]===null||n[1]instanceof d&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new s(e,i.InvalidParameter,r)})},a.functions.intersection=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]===null||n[1]===null?null:Dn(n[0],n[1])))},a.functions.union=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{let t=[];if((n=l(n)).length===0)throw new s(e,i.WrongNumberOfParameters,r);if(n.length===1)if(P(n[0])){let u=l(n[0]);for(let f=0;f<u.length;f++)if(u[f]!==null){if(!(u[f]instanceof d))throw new s(e,i.InvalidParameter,r);t.push(u[f])}}else{if(!I(n[0])){if(n[0]instanceof d)return U(R(n[0]),e.spatialReference);if(n[0]===null)return null;throw new s(e,i.InvalidParameter,r)}{let u=l(n[0].toArray());for(let f=0;f<u.length;f++)if(u[f]!==null){if(!(u[f]instanceof d))throw new s(e,i.InvalidParameter,r);t.push(u[f])}}}else for(let u=0;u<n.length;u++)if(n[u]!==null){if(!(n[u]instanceof d))throw new s(e,i.InvalidParameter,r);t.push(n[u])}return t.length===0?null:Ln(t)})},a.functions.difference=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]!==null&&n[1]===null?R(n[0]):n[0]===null?null:jn(n[0],n[1])))},a.functions.symmetricdifference=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>(N(n=l(n),e,r),n[0]===null&&n[1]===null?null:n[0]===null?R(n[1]):n[1]===null?R(n[0]):Cn(n[0],n[1])))},a.functions.clip=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,2,e,r),!(n[1]instanceof j)&&n[1]!==null)throw new s(e,i.InvalidParameter,r);if(n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return n[1]===null?null:yn(n[0],n[1])})},a.functions.cut=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,2,e,r),!(n[1]instanceof F)&&n[1]!==null)throw new s(e,i.InvalidParameter,r);if(n[0]===null)return[];if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return n[1]===null?[R(n[0])]:gn(n[0],n[1])})},a.functions.area=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>A(this,null,function*(){if(w(n,1,2,e,r),(n=l(n))[0]===null)return 0;if(L(n[0])){let t=yield n[0].sumArea(C(m(n[1],-1)),!1,e.abortSignal);if(e.abortSignal.aborted)throw new s(e,i.Cancelled,r);return t}if(P(n[0])||I(n[0])){let t=Q(n[0],e.spatialReference);return t===null?0:rn(t,C(m(n[1],-1)))}if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return rn(n[0],C(m(n[1],-1)))}))},a.functions.areageodetic=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>A(this,null,function*(){if(w(n,1,2,e,r),(n=l(n))[0]===null)return 0;if(L(n[0])){let t=yield n[0].sumArea(C(m(n[1],-1)),!0,e.abortSignal);if(e.abortSignal.aborted)throw new s(e,i.Cancelled,r);return t}if(P(n[0])||I(n[0])){let t=Q(n[0],e.spatialReference);return t===null?0:tn(t,C(m(n[1],-1)))}if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return tn(n[0],C(m(n[1],-1)))}))},a.functions.length=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>A(this,null,function*(){if(w(n,1,2,e,r),(n=l(n))[0]===null)return 0;if(L(n[0])){let t=yield n[0].sumLength(p(m(n[1],-1)),!1,e.abortSignal);if(e.abortSignal.aborted)throw new s(e,i.Cancelled,r);return t}if(P(n[0])||I(n[0])){let t=D(n[0],e.spatialReference);return t===null?0:M(t,p(m(n[1],-1)))}if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return M(n[0],p(m(n[1],-1)))}))},a.functions.length3d=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(w(n,1,2,e,r),(n=l(n))[0]===null)return 0;if(P(n[0])||I(n[0])){let t=D(n[0],e.spatialReference);return t===null?0:t.hasZ===!0?zn(t,p(m(n[1],-1))):M(t,p(m(n[1],-1)))}if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return n[0].hasZ===!0?zn(n[0],p(m(n[1],-1))):M(n[0],p(m(n[1],-1)))})},a.functions.lengthgeodetic=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>A(this,null,function*(){if(w(n,1,2,e,r),(n=l(n))[0]===null)return 0;if(L(n[0])){let t=yield n[0].sumLength(p(m(n[1],-1)),!0,e.abortSignal);if(e.abortSignal.aborted)throw new s(e,i.Cancelled,r);return t}if(P(n[0])||I(n[0])){let t=D(n[0],e.spatialReference);return t===null?0:z(t,p(m(n[1],-1)))}if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return z(n[0],p(m(n[1],-1)))}))},a.functions.distance=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{n=l(n),w(n,2,3,e,r);let t=n[0];(P(n[0])||I(n[0]))&&(t=Z(n[0],e.spatialReference));let u=n[1];if((P(n[1])||I(n[1]))&&(u=Z(n[1],e.spatialReference)),!(t instanceof d))throw new s(e,i.InvalidParameter,r);if(!(u instanceof d))throw new s(e,i.InvalidParameter,r);return In(t,u,p(m(n[2],-1)))})},a.functions.distancegeodetic=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{n=l(n),w(n,2,3,e,r);let t=n[0],u=n[1];if(!(t instanceof b))throw new s(e,i.InvalidParameter,r);if(!(u instanceof b))throw new s(e,i.InvalidParameter,r);let f=new F({paths:[],spatialReference:t.spatialReference});return f.addPath([t,u]),z(f,p(m(n[2],-1)))})},a.functions.densify=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,3,e,r),n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);let t=x(n[1]);if(isNaN(t))throw new s(e,i.InvalidParameter,r);if(t<=0)throw new s(e,i.InvalidParameter,r);return n[0]instanceof S||n[0]instanceof F?nn(n[0],t,p(m(n[2],-1))):n[0]instanceof j?nn(Zn(n[0]),t,p(m(n[2],-1))):n[0]})},a.functions.densifygeodetic=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,3,e,r),n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);let t=x(n[1]);if(isNaN(t))throw new s(e,i.InvalidParameter,r);if(t<=0)throw new s(e,i.InvalidParameter,r);return n[0]instanceof S||n[0]instanceof F?en(n[0],t,p(m(n[2],-1))):n[0]instanceof j?en(Zn(n[0]),t,p(m(n[2],-1))):n[0]})},a.functions.generalize=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,4,e,r),n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);let t=x(n[1]);if(isNaN(t))throw new s(e,i.InvalidParameter,r);return qn(n[0],t,fn(m(n[2],!0)),p(m(n[3],-1)))})},a.functions.buffer=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,3,e,r),n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);let t=x(n[1]);if(isNaN(t))throw new s(e,i.InvalidParameter,r);return t===0?R(n[0]):Jn(n[0],t,p(m(n[2],-1)))})},a.functions.buffergeodetic=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,3,e,r),n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);let t=x(n[1]);if(isNaN(t))throw new s(e,i.InvalidParameter,r);return t===0?R(n[0]):Mn(n[0],t,p(m(n[2],-1)))})},a.functions.offset=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,6,e,r),n[0]===null)return null;if(!(n[0]instanceof S||n[0]instanceof F))throw new s(e,i.InvalidParameter,r);let t=x(n[1]);if(isNaN(t))throw new s(e,i.InvalidParameter,r);let u=x(m(n[4],10));if(isNaN(u))throw new s(e,i.InvalidParameter,r);let f=x(m(n[5],0));if(isNaN(f))throw new s(e,i.InvalidParameter,r);return Un(n[0],t,p(m(n[2],-1)),q(m(n[3],"round")).toLowerCase(),u,f)})},a.functions.rotate=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{n=l(n),w(n,2,3,e,r);let t=n[0];if(t===null)return null;if(!(t instanceof d))throw new s(e,i.InvalidParameter,r);t instanceof j&&(t=S.fromExtent(t));let u=x(n[1]);if(isNaN(u))throw new s(e,i.InvalidParameter,r);let f=m(n[2],null);if(f===null)return $(t,u);if(f instanceof b)return $(t,u,f);throw new s(e,i.InvalidParameter,r)})},a.functions.centroid=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,1,1,e,r),n[0]===null)return null;let t=n[0];if((P(n[0])||I(n[0]))&&(t=Z(n[0],e.spatialReference)),t===null)return null;if(!(t instanceof d))throw new s(e,i.InvalidParameter,r);return t instanceof b?U(R(n[0]),e.spatialReference):t instanceof S?t.centroid:t instanceof F?dn(t):t instanceof W?mn(t):t instanceof j?t.center:null})},a.functions.measuretocoordinate=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,2,e,r),n[0]===null)return null;let t=n[0];if((P(n[0])||I(n[0]))&&(t=D(n[0],e.spatialReference)),t===null)return null;if(!(t instanceof d))throw new s(e,i.InvalidParameter,r);if(!(t instanceof F))throw new s(e,i.InvalidParameter,r);if(k(n[1]===!1))throw new s(e,i.InvalidParameter,r);let u=wn(t,n[1]);return u?T.convertObjectToArcadeDictionary(u,O(e),!1,!0):null})},a.functions.pointtocoordinate=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,2,e,r),n[0]===null)return null;let t=n[0];if((P(n[0])||I(n[0]))&&(t=D(n[0],e.spatialReference)),t===null)return null;if(!(t instanceof d))throw new s(e,i.InvalidParameter,r);if(!(t instanceof F))throw new s(e,i.InvalidParameter,r);let u=n[1];if(u===null)return null;if(!(u instanceof b))throw new s(e,i.InvalidParameter,r);if(k(n[1]===!1))throw new s(e,i.InvalidParameter,r);let f=pn(t,u);return f?T.convertObjectToArcadeDictionary(f,O(e),!1,!0):null})},a.functions.distancetocoordinate=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,2,2,e,r),n[0]===null)return null;let t=n[0];if((P(n[0])||I(n[0]))&&(t=D(n[0],e.spatialReference)),t===null)return null;if(!(t instanceof d))throw new s(e,i.InvalidParameter,r);if(!(t instanceof F))throw new s(e,i.InvalidParameter,r);if(k(n[1]===!1))throw new s(e,i.InvalidParameter,r);let u=hn(t,n[1]);return u?T.convertObjectToArcadeDictionary(u,O(e),!1,!0):null})},a.functions.multiparttosinglepart=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>A(this,null,function*(){n=l(n),w(n,1,1,e,r);let t=[];if(n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);if(n[0]instanceof b)return[U(R(n[0]),e.spatialReference)];if(n[0]instanceof j)return[U(R(n[0]),e.spatialReference)];let u=yield _(n[0]);if(u instanceof S){let f=[],y=[];for(let h=0;h<u.rings.length;h++)if(u.isClockwise(u.rings[h])){let g=H({rings:[u.rings[h]],hasZ:u.hasZ===!0,hazM:u.hasM===!0,spatialReference:u.spatialReference.toJSON()});f.push(g)}else y.push({ring:u.rings[h],pt:u.getPoint(h,0)});for(let h=0;h<y.length;h++)for(let g=0;g<f.length;g++)if(f[g].contains(y[h].pt)){f[g].addRing(y[h].ring);break}return f}if(u instanceof F){let f=[];for(let y=0;y<u.paths.length;y++){let h=H({paths:[u.paths[y]],hasZ:u.hasZ===!0,hazM:u.hasM===!0,spatialReference:u.spatialReference.toJSON()});f.push(h)}return f}if(n[0]instanceof W){let f=U(R(n[0]),e.spatialReference);for(let y=0;y<f.points.length;y++)t.push(f.getPoint(y));return t}return null}))},a.functions.issimple=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,1,1,e,r),n[0]===null)return!0;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return On(n[0])})},a.functions.simplify=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,1,1,e,r),n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return _(n[0])})},a.functions.convexhull=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>{if(n=l(n),w(n,1,1,e,r),n[0]===null)return null;if(!(n[0]instanceof d))throw new s(e,i.InvalidParameter,r);return Tn(n[0])})},a.functions.getuser=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>A(this,null,function*(){w(n,0,2,e,r);let t=m(n[1],""),u=t===!0;if(t=t===!0||t===!1?"":q(t),n.length===0||n[0]instanceof X){let y=null;y=e.services?.portal?e.services.portal:an.getDefault(),n.length>0&&(y=Y(n[0],y));let h=yield sn(y,t,u);if(h){let g=JSON.parse(JSON.stringify(h));for(let v of["lastLogin","created","modified"])g[v]!==void 0&&g[v]!==null&&(g[v]=new Date(g[v]));return T.convertObjectToArcadeDictionary(g,O(e))}return null}let f=null;if(L(n[0])&&(f=n[0]),f){if(u=!1,t)return null;yield f.load();let y=yield f.getOwningSystemUrl();if(!y){if(!t){let v=yield f.getIdentityUser();return v?T.convertObjectToArcadeDictionary({username:v},O(e)):null}return null}let h=null;h=e.services?.portal?e.services.portal:an.getDefault(),h=Y(new X(y),h);let g=yield sn(h,t,u);if(g){let v=JSON.parse(JSON.stringify(g));for(let E of["lastLogin","created","modified"])v[E]!==void 0&&v[E]!==null&&(v[E]=new Date(v[E]));return T.convertObjectToArcadeDictionary(v,O(e))}return null}throw new s(e,i.InvalidParameter,r)}))}),a.functions.nearestcoordinate=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>A(this,null,function*(){if(n=l(n),w(n,2,2,e,r),!(n[0]instanceof d||n[0]===null))throw new s(e,i.InvalidParameter,r);if(!(n[1]instanceof b||n[1]===null))throw new s(e,i.InvalidParameter,r);if(n[0]===null||n[1]===null)return null;let t=yield En(n[0],n[1]);return t===null?null:T.convertObjectToArcadeDictionary({coordinate:t.coordinate,distance:t.distance,sideOfLine:t.distance===0?"straddle":t.isRightSide?"right":"left"},O(e),!1,!0)}))},a.functions.nearestvertex=function(e,r){return a.standardFunctionAsync(e,r,(c,o,n)=>A(this,null,function*(){if(n=l(n),w(n,2,2,e,r),!(n[0]instanceof d||n[0]===null))throw new s(e,i.InvalidParameter,r);if(!(n[1]instanceof b||n[1]===null))throw new s(e,i.InvalidParameter,r);if(n[0]===null||n[1]===null)return null;let t=yield kn(n[0],n[1]);return t===null?null:T.convertObjectToArcadeDictionary({coordinate:t.coordinate,distance:t.distance,sideOfLine:t.distance===0?"straddle":t.isRightSide?"right":"left"},O(e),!1,!0)}))}}export{me as a};
