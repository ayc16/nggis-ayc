import{a as Vn,c as Uu,d as fr,e as rl}from"./chunk-RM56F5OF.js";import{b as lu,c as cu}from"./chunk-XRPMTSX6.js";import{a as tl,b as il}from"./chunk-QW25UBG2.js";import{b as el,c as me,d as Fu}from"./chunk-UWVTXX2V.js";import"./chunk-OQUBYVYT.js";import{a as zu}from"./chunk-QODWUC62.js";import{a as je,b as au,c as Dn,d as Rn}from"./chunk-ZZUOGAMH.js";import{d as ju,e as Bu,f as Wu,g as $u}from"./chunk-AJX3FWW2.js";import{b as Gu,g as Ku,k as ol}from"./chunk-BTFKH6KF.js";import"./chunk-I7V2OAI2.js";import{a as ho,e as Zu}from"./chunk-RAMEUAPV.js";import"./chunk-5NHMASEK.js";import"./chunk-3K3SLH5Z.js";import{a as Nn,b as Nu,c as mr,d as qu}from"./chunk-77GHZE77.js";import{a as Vu}from"./chunk-AHLE435U.js";import"./chunk-VORAPKV5.js";import"./chunk-A5T4FFTE.js";import"./chunk-LK45ZNWD.js";import"./chunk-WKQVOD3E.js";import"./chunk-4OC4J3KU.js";import"./chunk-TOLXLK6N.js";import{t as Hu}from"./chunk-CXJNPJ3A.js";import"./chunk-QU6JU243.js";import{a as Pu,c as Au,i as $}from"./chunk-7SVLZCA4.js";import{a as Du,b as Ru}from"./chunk-ZVNCKSTP.js";import"./chunk-QAJCY744.js";import{a as Ja}from"./chunk-BKLTKOZS.js";import{a as nu,b as Ka,d as su}from"./chunk-BZFJVAQS.js";import"./chunk-BWK3LBHF.js";import{a as On}from"./chunk-JC4ZKBNS.js";import"./chunk-GAF32LQP.js";import{c as ou}from"./chunk-JNONQQQT.js";import{a as K}from"./chunk-FHBFWDFD.js";import{e as ur}from"./chunk-S3DH7XZE.js";import{a as Xa,b as Iu,c as Eu,d as Lu,e as ku}from"./chunk-4VSZITBC.js";import{b as F,c as ru,d as j}from"./chunk-YKUB35EI.js";import"./chunk-ZJHI7U3R.js";import{a as Ge,b as An,c as du,d as Je,f as hu,g as uu,i as mu,j as fu,k as gu,l as yu,m as vu,n as _u,o as wu,p as bu,q as Su,r as Ya,s as Cu,u as Tu,v as Qa,w as Mu,y as xu}from"./chunk-RIQU3TLI.js";import{a as Pn,c as pu}from"./chunk-WBPLJNRU.js";import{b as Ou}from"./chunk-2FU5HSUP.js";import{a as Fn}from"./chunk-4KGZTO2H.js";import"./chunk-2774JW3N.js";import"./chunk-3SWZR32A.js";import"./chunk-DXCDSOAV.js";import"./chunk-4XUK6P2F.js";import"./chunk-46I2RIMB.js";import"./chunk-3SBNJPR7.js";import"./chunk-WRIQADAP.js";import{a as tu}from"./chunk-R4ZRZJFL.js";import"./chunk-L657QK52.js";import"./chunk-5UE35WME.js";import"./chunk-4Y7EKSO4.js";import"./chunk-SCOBUUIE.js";import"./chunk-X7ZCOG35.js";import{a as qa}from"./chunk-MW7BA4EZ.js";import{a as eu,b as $a,c as Za}from"./chunk-QNOFG4YA.js";import"./chunk-HHIR5BNR.js";import"./chunk-B6VNGUER.js";import"./chunk-X7HIK3PZ.js";import{a as Qh,b as kn,c as Xh,d as Jh}from"./chunk-2OOXFUAG.js";import"./chunk-4ZBUTOIE.js";import{e as qh,g as Kh,j as Yh}from"./chunk-CDCW33GU.js";import{a as ki}from"./chunk-7JGBMAQ4.js";import"./chunk-DJEFBPF6.js";import{b as Bh,c as Wh}from"./chunk-IGLWZTM3.js";import"./chunk-UJ32NKLH.js";import"./chunk-DYVXH2D6.js";import{a as Ba}from"./chunk-UOQLGDDP.js";import"./chunk-XHIF7VIS.js";import{a as xh,b as Ih}from"./chunk-X5XSKIWR.js";import{a as Fh}from"./chunk-MJN6ZDZD.js";import{a as ja}from"./chunk-E3472BDJ.js";import{a as Rh}from"./chunk-4D3QHJI2.js";import{c as Lh,e as kh,g as Oh,j as Dh}from"./chunk-E2J2V7JN.js";import{a as Mh}from"./chunk-AGT7IE2H.js";import{b as za}from"./chunk-37H4LYIE.js";import"./chunk-D6Q6GMSU.js";import{a as Eh}from"./chunk-IXG346EU.js";import"./chunk-HUYHDVA2.js";import"./chunk-YUIUJIOR.js";import"./chunk-4QS7PGAF.js";import"./chunk-NIYDRLW4.js";import{a as Wa}from"./chunk-XHOTVM3O.js";import"./chunk-H3VY6XFU.js";import"./chunk-LNYBTIG7.js";import"./chunk-ACH5BMOT.js";import"./chunk-UBMORCKY.js";import"./chunk-CLVC2DXO.js";import"./chunk-RZU6EEB3.js";import"./chunk-WDTJILD4.js";import"./chunk-ELOLYWII.js";import"./chunk-ITQMD4YG.js";import"./chunk-V5WEARAB.js";import"./chunk-UZW3KXUC.js";import"./chunk-EGCJAGQM.js";import"./chunk-TG4PXMOO.js";import{a as Bd}from"./chunk-HSRIUK76.js";import"./chunk-4S7NY4TS.js";import"./chunk-AN6X7B73.js";import"./chunk-FKIHG4NK.js";import"./chunk-UC7SIIH5.js";import"./chunk-4S7K5A3I.js";import"./chunk-SIDAXOMN.js";import"./chunk-S2CEVLI5.js";import"./chunk-ZLKXQ3X4.js";import"./chunk-DTDFZYW6.js";import"./chunk-XURBKGOF.js";import"./chunk-XSGDUFLB.js";import"./chunk-4VRL7OJD.js";import"./chunk-64QAVEVQ.js";import"./chunk-FCT46YZ7.js";import"./chunk-KQ3PALPO.js";import"./chunk-DYBVQO6C.js";import"./chunk-H5BQFJQG.js";import"./chunk-ZPGECEOH.js";import"./chunk-IK3IRLTV.js";import"./chunk-SFX6QP6J.js";import"./chunk-BRJSO7CG.js";import"./chunk-AATZFFI5.js";import"./chunk-YNG4NJVY.js";import"./chunk-3FOGM572.js";import"./chunk-4ANB723A.js";import"./chunk-IGVG5UOD.js";import"./chunk-GT3C7LC6.js";import{a as $h}from"./chunk-LNUI6KC7.js";import"./chunk-BXHQ44WX.js";import"./chunk-EWHTP5EW.js";import"./chunk-N3SZSSU6.js";import"./chunk-3JBDNTAW.js";import"./chunk-H63LVRK7.js";import"./chunk-72WWHQIV.js";import"./chunk-QPCBRHQI.js";import"./chunk-MZNGYP6Z.js";import"./chunk-3GCOAQPV.js";import"./chunk-SJU4N7KJ.js";import"./chunk-6NTJ4HVA.js";import"./chunk-X2KAPCU7.js";import"./chunk-JD3KGBGX.js";import"./chunk-GC4LGG7K.js";import"./chunk-VXW5JMKD.js";import"./chunk-QCG2T55M.js";import"./chunk-NJ5QXHI6.js";import"./chunk-SJTQM4NH.js";import"./chunk-AODEXMIK.js";import"./chunk-NYOCZ43I.js";import"./chunk-IFFYADB3.js";import"./chunk-TMYZ2I35.js";import"./chunk-CBIYPMNC.js";import"./chunk-LHY2TOIB.js";import"./chunk-F4UISFW6.js";import"./chunk-TXAFMDDV.js";import"./chunk-ZCSEBPCJ.js";import"./chunk-S3JJYXYO.js";import"./chunk-LOEAA5XF.js";import"./chunk-S2YBNG2F.js";import"./chunk-NSK56ILC.js";import{a as jh}from"./chunk-R2Q5NMSG.js";import{k as Ln,l as Vh,m as Nh}from"./chunk-QL456MD5.js";import{a as Cn,b as pr}from"./chunk-IY6MAS3P.js";import{B as po,e as zh,u as Gh}from"./chunk-RPWH7ONJ.js";import"./chunk-H76XKIVW.js";import{a as Hh,b as Uh}from"./chunk-UWZJQ7YC.js";import{i as Ph,k as Ah,m as Ga}from"./chunk-NC2NFLV7.js";import{a as vt}from"./chunk-UJ6V7JUK.js";import"./chunk-GK2MPWKO.js";import"./chunk-FZUISW3U.js";import"./chunk-3NCGJLJJ.js";import"./chunk-Z5FRAQHK.js";import"./chunk-LQWMDYLF.js";import"./chunk-BW3UVZYU.js";import{a as ni}from"./chunk-47Q3ZDMA.js";import{a as ah,b as lh}from"./chunk-QD5H3SJ3.js";import"./chunk-V2JYXY4D.js";import"./chunk-7LLNOPTV.js";import"./chunk-XRRPDCIR.js";import{d as Ua}from"./chunk-XF4ZC6Y7.js";import"./chunk-BBLWQBZT.js";import{a as Jd}from"./chunk-D6QUKPEY.js";import"./chunk-VIAVLHRB.js";import"./chunk-UMZZ3I5D.js";import"./chunk-LSEOQ2KR.js";import{a as _h}from"./chunk-VXJKEPDS.js";import"./chunk-J7IKN4ZN.js";import{a as Th}from"./chunk-I3S324BU.js";import"./chunk-OM7Z3UKX.js";import"./chunk-VNTMBMJI.js";import"./chunk-A66ZXMJV.js";import"./chunk-6KRFVLII.js";import"./chunk-OJB2TSJ7.js";import"./chunk-MCO7DSFO.js";import"./chunk-LUPAMFKK.js";import"./chunk-7JD62GP7.js";import"./chunk-HHJJPMV6.js";import"./chunk-F47ZTJ7Y.js";import"./chunk-YXPGI3LI.js";import"./chunk-LSFTWXAE.js";import{a as mh,d as fh}from"./chunk-OO35HBWJ.js";import"./chunk-R5OKRCI7.js";import"./chunk-2EF3JPLL.js";import"./chunk-FWB3IYJJ.js";import"./chunk-U6WVZEYH.js";import"./chunk-KRMYHUR3.js";import"./chunk-R4NNYEN7.js";import{a as hr}from"./chunk-PDBA6QOJ.js";import{b as wh,c as bh,g as Sh,h as Ha,i as Ch}from"./chunk-CF52RSJZ.js";import"./chunk-ALWV3RJ2.js";import"./chunk-7C6Z24SS.js";import{c as xn,e as uh,g as In,h as oi,r as En}from"./chunk-7G4KK3KW.js";import"./chunk-J3ZDC5ZE.js";import"./chunk-KYNKUTEO.js";import"./chunk-QWLQUMDY.js";import{a as dr,b as gh,d as yh,i as vh,s as Li}from"./chunk-2ETHV3H2.js";import{a as un,b as mn,c as Ra,d as Pa,e as Se,f as ne,g as le}from"./chunk-AUSMAEKP.js";import{b as Aa,g as y,h as Ld}from"./chunk-WVCJLLRA.js";import{c as kd}from"./chunk-MDSLION2.js";import{f as ao,k as Ed}from"./chunk-OVOWBDBP.js";import"./chunk-V2KSICSA.js";import{a as b,b as Ue,c as at,d as At,f as Ft,g as R,h as ae}from"./chunk-4XUOIGFO.js";import"./chunk-5HCLBNUR.js";import"./chunk-JZ3XIQ5W.js";import{a as ph,b as dh,c as hh}from"./chunk-OMYJOG47.js";import{b as iu}from"./chunk-3B4QONMA.js";import"./chunk-3SZQ2UT4.js";import{a as Od}from"./chunk-SPDSGGOE.js";import"./chunk-2OKSPLJT.js";import"./chunk-7LEG2VDW.js";import"./chunk-R2HWUZ3L.js";import{a as fn}from"./chunk-G24ZJINL.js";import{l as Zh}from"./chunk-T25YY3N7.js";import"./chunk-ALQ3STGG.js";import"./chunk-EETFV2SL.js";import{d as H}from"./chunk-AM3VOA32.js";import"./chunk-SAOUSUZE.js";import"./chunk-LECQV7I4.js";import{a as eh,b as th,c as ih,d as Tn,e as Mn,f as rh,g as ri,j as oh,n as nh,o as sh}from"./chunk-7HZKOXPR.js";import"./chunk-DFTBSFIN.js";import"./chunk-4HISZWR4.js";import"./chunk-33BSK37G.js";import{a as ch}from"./chunk-TQAPQODA.js";import"./chunk-M2GLXRA2.js";import"./chunk-EBWCXIFH.js";import{p as Sn,q as Xd}from"./chunk-MRVR6F6G.js";import{a as Fa,c as Wd,i as $d}from"./chunk-WXQQZY3K.js";import{a as Ei,h as Yd,j as wn,k as bn,s as Qd,v as Na}from"./chunk-VPMDQK57.js";import"./chunk-BCREO4Q5.js";import"./chunk-ZVHU7VE3.js";import{b as Va,d as co,f as _n,g as Kd}from"./chunk-76YVRX2R.js";import{l as qd}from"./chunk-OZF6BMOL.js";import"./chunk-GJP6PTKT.js";import{a as vn,c as Zd}from"./chunk-RSDQHAJX.js";import{b as Cd,d as Td}from"./chunk-HMKFQDR7.js";import"./chunk-2OT2C2UU.js";import{a as Da,b as Sd}from"./chunk-XIMCHX2H.js";import{b as L}from"./chunk-SF6Z2K5H.js";import{a as oe}from"./chunk-GBTN5LIS.js";import{c as Id,e as ii}from"./chunk-JOSG37QF.js";import"./chunk-SLMQFZE3.js";import"./chunk-FJDNRF2P.js";import"./chunk-VNB5ZT3P.js";import{a as lo}from"./chunk-NDG5FXLR.js";import"./chunk-EJG3F6VR.js";import{a as Md,b as xd}from"./chunk-5ODCEDHC.js";import"./chunk-BENVXA3L.js";import{e as Hd,h as Ud,i as zd,j as Gd,l as J,m as yn,o as jd,v as yt}from"./chunk-SA4OMQAD.js";import{a as Dd,b as cr}from"./chunk-24BLFS5R.js";import{A as Pd,I as Ad,N as Fd,O as Vd,R as Ii,a as Rd,ea as Nd,l as lr,m as gn}from"./chunk-JDDD6VJ4.js";import"./chunk-VOYK3LZF.js";import{a as wd,c as bd}from"./chunk-HOJTYTYD.js";import{a as ze}from"./chunk-XNEAL2YW.js";import"./chunk-J7M5V2SQ.js";import"./chunk-RQD6EDD6.js";import"./chunk-XPCG2OJX.js";import{E as md,F as fd,L as c,O as S,U as _d,W as ar,b as ir,d as Ea,f as od,g as La,h as hn,i as Pt,o as so,r as ud,s as st}from"./chunk-AUTL5LCV.js";import{H as ka,M as Oa,S as f,r as ti,t as gd,y as yd,z as vd}from"./chunk-KUJG22IX.js";import"./chunk-OVHPPCBL.js";import{a}from"./chunk-W3WDPWBE.js";import{B as dd,C as xi,a as De,c as rr,f as gt,h as nd,j as or,k as be,m as sd,p as nr,r as ei,s as sr,t as He,v as ad,x as ld,y as cd,z as pd}from"./chunk-GISCFF3Z.js";import{b as A,d as Z,e as Rt}from"./chunk-MLSR6YE6.js";import{a as hd}from"./chunk-SNFOAZZQ.js";import"./chunk-CPDJJRWA.js";import"./chunk-DKS57BVI.js";import"./chunk-VU5W7W6Y.js";import{$ as Op,$a as Qp,A as Tp,Aa as io,B as Mp,Ba as Wp,C as xp,Ca as $p,D as ft,Da as Zp,E as Ip,Ea as ro,F as _e,Fa as er,G as te,Ga as Me,H as N,Ha as oo,I as Ep,Ia as Dt,J as Le,Ja as Oe,K as sa,Ka as Qe,L as W,La as Si,M as I,Ma as ga,N as Xr,Na as ya,O as _i,Oa as va,P as aa,Pa as qp,Q as wi,Qa as tr,R as Lp,Ra as Ne,S as sn,Sa as Xe,T as bi,Ta as Ci,U as kp,Ua as Ti,V as la,Va as ln,W as ca,Wa as Kp,X as pa,Xa as Yp,Y as Qi,Ya as Mi,Z as da,Za as _a,_ as Jr,_a as wa,a as vp,aa as ha,ab as ba,b as _p,ba as Dp,bb as Xp,c as ea,ca as eo,cb as Jp,d as ta,da as Rp,db as we,e as Te,ea as ua,eb as cn,f as Ke,fa as Xi,fb as ed,g as Qt,ga as Ji,gb as Sa,h as nt,ha as Pp,hb as Ca,i as O,ia as Ap,ib as td,j as Yr,ja as Fp,jb as Ta,k as wp,ka as Vp,kb as id,l as bp,la as Np,m as X,ma as Hp,n as ia,na as Up,nb as rd,o as Ye,oa as Ot,ob as Ma,p as Sp,pa as ma,q as ra,qa as to,qb as pn,r as qi,ra as de,rb as dn,s as Ki,sa as Jt,sb as xa,t as Qr,ta as fa,u as oa,ua as zp,v as Yi,va as Gp,w as Cp,wa as an,x as nn,xa as jp,y as Xt,ya as ke,z as na,za as Bp}from"./chunk-6X3VH33M.js";import{b as no,r as E,t as P}from"./chunk-HQMV3KQV.js";import{a as ie,i as Ia,q as fe}from"./chunk-CRMMDK2Z.js";import"./chunk-MDAB6L5Y.js";import"./chunk-FMFGIQYB.js";import{a as g,b as T,d as yp,e as my,f as fy,h as _}from"./chunk-EAH6BNBL.js";var hy=my((mp,fp)=>{"use strict";(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof mp<"u"?t():(t(),e.FileSaver={})})(mp,function(){"use strict";function e(l,p){return typeof p>"u"?p={autoBom:!1}:typeof p!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function t(l,p,d){var h=new XMLHttpRequest;h.open("GET",l),h.responseType="blob",h.onload=function(){s(h.response,p,d)},h.onerror=function(){console.error("could not download file")},h.send()}function i(l){var p=new XMLHttpRequest;p.open("HEAD",l,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function r(l){try{l.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(p)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,n=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(l,p,d){var h=o.URL||o.webkitURL,u=document.createElement("a");p=p||l.name||"download",u.download=p,u.rel="noopener",typeof l=="string"?(u.href=l,u.origin===location.origin?r(u):i(u.href)?t(l,p,d):r(u,u.target="_blank")):(u.href=h.createObjectURL(l),setTimeout(function(){h.revokeObjectURL(u.href)},4e4),setTimeout(function(){r(u)},0))}:"msSaveOrOpenBlob"in navigator?function(l,p,d){if(p=p||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(e(l,d),p);else if(i(l))t(l,p,d);else{var h=document.createElement("a");h.href=l,h.target="_blank",setTimeout(function(){r(h)})}}:function(l,p,d,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof l=="string")return t(l,p,d);var u=l.type==="application/octet-stream",m=/constructor/i.test(o.HTMLElement)||o.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||u&&m||n)&&typeof FileReader<"u"){var w=new FileReader;w.onloadend=function(){var k=w.result;k=v?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=k:location=k,h=null},w.readAsDataURL(l)}else{var M=o.URL||o.webkitURL,V=M.createObjectURL(l);h?h.location=V:location.href=V,h=null,setTimeout(function(){M.revokeObjectURL(V)},4e4)}});o.saveAs=s.saveAs=s,typeof fp<"u"&&(fp.exports=s)})});var al=class extends Jp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},ll=class e extends al{static makeCurrent(){Xp(new e)}onAndCancel(t,i,r){return t.addEventListener(i,r),()=>{t.removeEventListener(i,r)}}dispatchEvent(t,i){t.dispatchEvent(i)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,i){return i=i||this.getDefaultDocument(),i.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,i){return i==="window"?window:i==="document"?t:i==="body"?t.body:null}getBaseHref(t){let i=_y();return i==null?null:wy(i)}resetBaseElement(){uo=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return ed(document.cookie,t)}},uo=null;function _y(){return uo=uo||document.querySelector("base"),uo?uo.getAttribute("href"):null}function wy(e){return new URL(e,document.baseURI).pathname}var by=(()=>{let t=class t{build(){return new XMLHttpRequest}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:t.\u0275fac});let e=t;return e})(),cl=new Le(""),em=(()=>{let t=class t{constructor(r,o){this._zone=o,this._eventNameToPlugin=new Map,r.forEach(n=>{n.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,o,n){return this._findPluginFor(o).addEventListener(r,o,n)}getZone(){return this._zone}_findPluginFor(r){let o=this._eventNameToPlugin.get(r);if(o)return o;if(o=this._plugins.find(s=>s.supports(r)),!o)throw new te(5101,!1);return this._eventNameToPlugin.set(r,o),o}};t.\u0275fac=function(o){return new(o||t)(W(cl),W(ke))},t.\u0275prov=N({token:t,factory:t.\u0275fac});let e=t;return e})(),Hn=class{constructor(t){this._doc=t}},nl="ng-app-id",tm=(()=>{let t=class t{constructor(r,o,n,s={}){this.doc=r,this.appId=o,this.nonce=n,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ta(s),this.resetHostNodes()}addStyles(r){for(let o of r)this.changeUsageCount(o,1)===1&&this.onStyleAdded(o)}removeStyles(r){for(let o of r)this.changeUsageCount(o,-1)<=0&&this.onStyleRemoved(o)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(o=>o.remove()),r.clear());for(let o of this.getAllStyles())this.onStyleRemoved(o);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let o of this.getAllStyles())this.addStyleToHost(r,o)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let o of this.hostNodes)this.addStyleToHost(o,r)}onStyleRemoved(r){let o=this.styleRef;o.get(r)?.elements?.forEach(n=>n.remove()),o.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${nl}="${this.appId}"]`);if(r?.length){let o=new Map;return r.forEach(n=>{n.textContent!=null&&o.set(n.textContent,n)}),o}return null}changeUsageCount(r,o){let n=this.styleRef;if(n.has(r)){let s=n.get(r);return s.usage+=o,s.usage}return n.set(r,{usage:o,elements:[]}),o}getStyleElement(r,o){let n=this.styleNodesInDOM,s=n?.get(o);if(s?.parentNode===r)return n.delete(o),s.removeAttribute(nl),s;{let l=this.doc.createElement("style");return this.nonce&&l.setAttribute("nonce",this.nonce),l.textContent=o,this.platformIsServer&&l.setAttribute(nl,this.appId),r.appendChild(l),l}}addStyleToHost(r,o){let n=this.getStyleElement(r,o),s=this.styleRef,l=s.get(o)?.elements;l?l.push(n):s.set(o,{elements:[n],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};t.\u0275fac=function(o){return new(o||t)(W(we),W(ha),W(ua,8),W(eo))},t.\u0275prov=N({token:t,factory:t.\u0275fac});let e=t;return e})(),sl={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},dl=/%COMP%/g,im="%COMP%",Sy=`_nghost-${im}`,Cy=`_ngcontent-${im}`,Ty=!0,My=new Le("",{providedIn:"root",factory:()=>Ty});function xy(e){return Cy.replace(dl,e)}function Iy(e){return Sy.replace(dl,e)}function rm(e,t){return t.map(i=>i.replace(dl,e))}var Un=(()=>{let t=class t{constructor(r,o,n,s,l,p,d,h=null){this.eventManager=r,this.sharedStylesHost=o,this.appId=n,this.removeStylesOnCompDestroy=s,this.doc=l,this.platformId=p,this.ngZone=d,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=Ta(p),this.defaultRenderer=new mo(r,l,d,this.platformIsServer)}createRenderer(r,o){if(!r||!o)return this.defaultRenderer;this.platformIsServer&&o.encapsulation===Xr.ShadowDom&&(o=T(g({},o),{encapsulation:Xr.Emulated}));let n=this.getOrCreateRenderer(r,o);return n instanceof zn?n.applyToHost(r):n instanceof fo&&n.applyStyles(),n}getOrCreateRenderer(r,o){let n=this.rendererByCompId,s=n.get(o.id);if(!s){let l=this.doc,p=this.ngZone,d=this.eventManager,h=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(o.encapsulation){case Xr.Emulated:s=new zn(d,h,o,this.appId,u,l,p,m);break;case Xr.ShadowDom:return new pl(d,h,r,o,l,p,this.nonce,m);default:s=new fo(d,h,o,u,l,p,m);break}n.set(o.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}};t.\u0275fac=function(o){return new(o||t)(W(em),W(tm),W(ha),W(My),W(we),W(eo),W(ke),W(ua))},t.\u0275prov=N({token:t,factory:t.\u0275fac});let e=t;return e})(),mo=class{constructor(t,i,r,o){this.eventManager=t,this.doc=i,this.ngZone=r,this.platformIsServer=o,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,i){return i?this.doc.createElementNS(sl[i]||i,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,i){(Yu(t)?t.content:t).appendChild(i)}insertBefore(t,i,r){t&&(Yu(t)?t.content:t).insertBefore(i,r)}removeChild(t,i){t&&t.removeChild(i)}selectRootElement(t,i){let r=typeof t=="string"?this.doc.querySelector(t):t;if(!r)throw new te(-5104,!1);return i||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,i,r,o){if(o){i=o+":"+i;let n=sl[o];n?t.setAttributeNS(n,i,r):t.setAttribute(i,r)}else t.setAttribute(i,r)}removeAttribute(t,i,r){if(r){let o=sl[r];o?t.removeAttributeNS(o,i):t.removeAttribute(`${r}:${i}`)}else t.removeAttribute(i)}addClass(t,i){t.classList.add(i)}removeClass(t,i){t.classList.remove(i)}setStyle(t,i,r,o){o&(to.DashCase|to.Important)?t.style.setProperty(i,r,o&to.Important?"important":""):t.style[i]=r}removeStyle(t,i,r){r&to.DashCase?t.style.removeProperty(i):t.style[i]=""}setProperty(t,i,r){t!=null&&(t[i]=r)}setValue(t,i){t.nodeValue=i}listen(t,i,r){if(typeof t=="string"&&(t=ba().getGlobalEventTarget(this.doc,t),!t))throw new Error(`Unsupported event target ${t} for event ${i}`);return this.eventManager.addEventListener(t,i,this.decoratePreventDefault(r))}decoratePreventDefault(t){return i=>{if(i==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(i)):t(i))===!1&&i.preventDefault()}}};function Yu(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var pl=class extends mo{constructor(t,i,r,o,n,s,l,p){super(t,n,s,p),this.sharedStylesHost=i,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=rm(o.id,o.styles);for(let h of d){let u=document.createElement("style");l&&u.setAttribute("nonce",l),u.textContent=h,this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,i){return super.appendChild(this.nodeOrShadowRoot(t),i)}insertBefore(t,i,r){return super.insertBefore(this.nodeOrShadowRoot(t),i,r)}removeChild(t,i){return super.removeChild(this.nodeOrShadowRoot(t),i)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},fo=class extends mo{constructor(t,i,r,o,n,s,l,p){super(t,n,s,l),this.sharedStylesHost=i,this.removeStylesOnCompDestroy=o,this.styles=p?rm(p,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},zn=class extends fo{constructor(t,i,r,o,n,s,l,p){let d=o+"-"+r.id;super(t,i,r,n,s,l,p,d),this.contentAttr=xy(d),this.hostAttr=Iy(d)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,i){let r=super.createElement(t,i);return super.setAttribute(r,this.contentAttr,""),r}},Ey=(()=>{let t=class t extends Hn{constructor(r){super(r)}supports(r){return!0}addEventListener(r,o,n){return r.addEventListener(o,n,!1),()=>this.removeEventListener(r,o,n)}removeEventListener(r,o,n){return r.removeEventListener(o,n)}};t.\u0275fac=function(o){return new(o||t)(W(we))},t.\u0275prov=N({token:t,factory:t.\u0275fac});let e=t;return e})(),Qu=["alt","control","meta","shift"],Ly={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ky={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},Oy=(()=>{let t=class t extends Hn{constructor(r){super(r)}supports(r){return t.parseEventName(r)!=null}addEventListener(r,o,n){let s=t.parseEventName(o),l=t.eventCallback(s.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ba().onAndCancel(r,s.domEventName,l))}static parseEventName(r){let o=r.toLowerCase().split("."),n=o.shift();if(o.length===0||!(n==="keydown"||n==="keyup"))return null;let s=t._normalizeKey(o.pop()),l="",p=o.indexOf("code");if(p>-1&&(o.splice(p,1),l="code."),Qu.forEach(h=>{let u=o.indexOf(h);u>-1&&(o.splice(u,1),l+=h+".")}),l+=s,o.length!=0||s.length===0)return null;let d={};return d.domEventName=n,d.fullKey=l,d}static matchEventFullKeyCode(r,o){let n=Ly[r.key]||r.key,s="";return o.indexOf("code.")>-1&&(n=r.code,s="code."),n==null||!n?!1:(n=n.toLowerCase(),n===" "?n="space":n==="."&&(n="dot"),Qu.forEach(l=>{if(l!==n){let p=ky[l];p(r)&&(s+=l+".")}}),s+=n,s===o)}static eventCallback(r,o,n){return s=>{t.matchEventFullKeyCode(s,r)&&n.runGuarded(()=>o(s))}}static _normalizeKey(r){return r==="esc"?"escape":r}};t.\u0275fac=function(o){return new(o||t)(W(we))},t.\u0275prov=N({token:t,factory:t.\u0275fac});let e=t;return e})();function om(e,t){return Qp(g({rootComponent:e},Dy(t)))}function Dy(e){return{appProviders:[...Vy,...e?.providers??[]],platformProviders:Fy}}function Ry(){ll.makeCurrent()}function Py(){return new da}function Ay(){return Op(document),document}var Fy=[{provide:eo,useValue:td},{provide:Dp,useValue:Ry,multi:!0},{provide:we,useFactory:Ay,deps:[]}];var Vy=[{provide:Lp,useValue:"root"},{provide:da,useFactory:Py,deps:[]},{provide:cl,useClass:Ey,multi:!0,deps:[we,ke,eo]},{provide:cl,useClass:Oy,multi:!0,deps:[we]},Un,tm,em,{provide:an,useExisting:Un},{provide:id,useClass:by,deps:[]},[]];var nm=(()=>{let t=class t{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};t.\u0275fac=function(o){return new(o||t)(W(we))},t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var hl=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:function(o){let n=null;return o?n=new(o||t):n=W(Ny),n},providedIn:"root"});let e=t;return e})(),Ny=(()=>{let t=class t extends hl{constructor(r){super(),this._doc=r}sanitize(r,o){if(o==null)return null;switch(r){case Ot.NONE:return o;case Ot.HTML:return Ji(o,"HTML")?Xi(o):Up(this._doc,String(o)).toString();case Ot.STYLE:return Ji(o,"Style")?Xi(o):o;case Ot.SCRIPT:if(Ji(o,"Script"))return Xi(o);throw new te(5200,!1);case Ot.URL:return Ji(o,"URL")?Xi(o):Hp(String(o));case Ot.RESOURCE_URL:if(Ji(o,"ResourceURL"))return Xi(o);throw new te(5201,!1);default:throw new te(5202,!1)}}bypassSecurityTrustHtml(r){return Pp(r)}bypassSecurityTrustStyle(r){return Ap(r)}bypassSecurityTrustScript(r){return Fp(r)}bypassSecurityTrustUrl(r){return Vp(r)}bypassSecurityTrustResourceUrl(r){return Np(r)}};t.\u0275fac=function(o){return new(o||t)(W(we))},t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var D="primary",ko=Symbol("RouteTitle"),yl=class{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let i=this.params[t];return Array.isArray(i)?i[0]:i}return null}getAll(t){if(this.has(t)){let i=this.params[t];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}};function wr(e){return new yl(e)}function Uy(e,t,i){let r=i.path.split("/");if(r.length>e.length||i.pathMatch==="full"&&(t.hasChildren()||r.length<e.length))return null;let o={};for(let n=0;n<r.length;n++){let s=r[n],l=e[n];if(s.startsWith(":"))o[s.substring(1)]=l;else if(s!==l.path)return null}return{consumed:e.slice(0,r.length),posParams:o}}function zy(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!_t(e[i],t[i]))return!1;return!0}function _t(e,t){let i=e?vl(e):void 0,r=t?vl(t):void 0;if(!i||!r||i.length!=r.length)return!1;let o;for(let n=0;n<i.length;n++)if(o=i[n],!hm(e[o],t[o]))return!1;return!0}function vl(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function hm(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;let i=[...e].sort(),r=[...t].sort();return i.every((o,n)=>r[n]===o)}else return e===t}function um(e){return e.length>0?e[e.length-1]:null}function li(e){return wp(e)?e:Kp(e)?nt(Promise.resolve(e)):O(e)}var Gy={exact:fm,subset:gm},mm={exact:jy,subset:By,ignored:()=>!0};function am(e,t,i){return Gy[i.paths](e.root,t.root,i.matrixParams)&&mm[i.queryParams](e.queryParams,t.queryParams)&&!(i.fragment==="exact"&&e.fragment!==t.fragment)}function jy(e,t){return _t(e,t)}function fm(e,t,i){if(!Di(e.segments,t.segments)||!Wn(e.segments,t.segments,i)||e.numberOfChildren!==t.numberOfChildren)return!1;for(let r in t.children)if(!e.children[r]||!fm(e.children[r],t.children[r],i))return!1;return!0}function By(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(i=>hm(e[i],t[i]))}function gm(e,t,i){return ym(e,t,t.segments,i)}function ym(e,t,i,r){if(e.segments.length>i.length){let o=e.segments.slice(0,i.length);return!(!Di(o,i)||t.hasChildren()||!Wn(o,i,r))}else if(e.segments.length===i.length){if(!Di(e.segments,i)||!Wn(e.segments,i,r))return!1;for(let o in t.children)if(!e.children[o]||!gm(e.children[o],t.children[o],r))return!1;return!0}else{let o=i.slice(0,e.segments.length),n=i.slice(e.segments.length);return!Di(e.segments,o)||!Wn(e.segments,o,r)||!e.children[D]?!1:ym(e.children[D],t,n,r)}}function Wn(e,t,i){return t.every((r,o)=>mm[i](e[o].parameters,r.parameters))}var si=class{constructor(t=new U([],{}),i={},r=null){this.root=t,this.queryParams=i,this.fragment=r}get queryParamMap(){return this._queryParamMap??=wr(this.queryParams),this._queryParamMap}toString(){return Zy.serialize(this)}},U=class{constructor(t,i){this.segments=t,this.children=i,this.parent=null,Object.values(i).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return $n(this)}},Oi=class{constructor(t,i){this.path=t,this.parameters=i}get parameterMap(){return this._parameterMap??=wr(this.parameters),this._parameterMap}toString(){return _m(this)}};function Wy(e,t){return Di(e,t)&&e.every((i,r)=>_t(i.parameters,t[r].parameters))}function Di(e,t){return e.length!==t.length?!1:e.every((i,r)=>i.path===t[r].path)}function $y(e,t){let i=[];return Object.entries(e.children).forEach(([r,o])=>{r===D&&(i=i.concat(t(o,r)))}),Object.entries(e.children).forEach(([r,o])=>{r!==D&&(i=i.concat(t(o,r)))}),i}var Bl=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:()=>new qn,providedIn:"root"});let e=t;return e})(),qn=class{parse(t){let i=new wl(t);return new si(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(t){let i=`/${go(t.root,!0)}`,r=Yy(t.queryParams),o=typeof t.fragment=="string"?`#${qy(t.fragment)}`:"";return`${i}${r}${o}`}},Zy=new qn;function $n(e){return e.segments.map(t=>_m(t)).join("/")}function go(e,t){if(!e.hasChildren())return $n(e);if(t){let i=e.children[D]?go(e.children[D],!1):"",r=[];return Object.entries(e.children).forEach(([o,n])=>{o!==D&&r.push(`${o}:${go(n,!1)}`)}),r.length>0?`${i}(${r.join("//")})`:i}else{let i=$y(e,(r,o)=>o===D?[go(e.children[D],!1)]:[`${o}:${go(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[D]!=null?`${$n(e)}/${i[0]}`:`${$n(e)}/(${i.join("//")})`}}function vm(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function jn(e){return vm(e).replace(/%3B/gi,";")}function qy(e){return encodeURI(e)}function _l(e){return vm(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Zn(e){return decodeURIComponent(e)}function lm(e){return Zn(e.replace(/\+/g,"%20"))}function _m(e){return`${_l(e.path)}${Ky(e.parameters)}`}function Ky(e){return Object.entries(e).map(([t,i])=>`;${_l(t)}=${_l(i)}`).join("")}function Yy(e){let t=Object.entries(e).map(([i,r])=>Array.isArray(r)?r.map(o=>`${jn(i)}=${jn(o)}`).join("&"):`${jn(i)}=${jn(r)}`).filter(i=>i);return t.length?`?${t.join("&")}`:""}var Qy=/^[^\/()?;#]+/;function ul(e){let t=e.match(Qy);return t?t[0]:""}var Xy=/^[^\/()?;=#]+/;function Jy(e){let t=e.match(Xy);return t?t[0]:""}var ev=/^[^=?&#]+/;function tv(e){let t=e.match(ev);return t?t[0]:""}var iv=/^[^&#]+/;function rv(e){let t=e.match(iv);return t?t[0]:""}var wl=class{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new U([],{}):new U([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(i).length>0)&&(r[D]=new U(t,i)),r}parseSegment(){let t=ul(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new te(4009,!1);return this.capture(t),new Oi(Zn(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let i=Jy(this.remaining);if(!i)return;this.capture(i);let r="";if(this.consumeOptional("=")){let o=ul(this.remaining);o&&(r=o,this.capture(r))}t[Zn(i)]=Zn(r)}parseQueryParam(t){let i=tv(this.remaining);if(!i)return;this.capture(i);let r="";if(this.consumeOptional("=")){let s=rv(this.remaining);s&&(r=s,this.capture(r))}let o=lm(i),n=lm(r);if(t.hasOwnProperty(o)){let s=t[o];Array.isArray(s)||(s=[s],t[o]=s),s.push(n)}else t[o]=n}parseParens(t){let i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=ul(this.remaining),o=this.remaining[r.length];if(o!=="/"&&o!==")"&&o!==";")throw new te(4010,!1);let n;r.indexOf(":")>-1?(n=r.slice(0,r.indexOf(":")),this.capture(n),this.capture(":")):t&&(n=D);let s=this.parseChildren();i[n]=Object.keys(s).length===1?s[D]:new U([],s),this.consumeOptional("//")}return i}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new te(4011,!1)}};function wm(e){return e.segments.length>0?new U([],{[D]:e}):e}function bm(e){let t={};for(let[r,o]of Object.entries(e.children)){let n=bm(o);if(r===D&&n.segments.length===0&&n.hasChildren())for(let[s,l]of Object.entries(n.children))t[s]=l;else(n.segments.length>0||n.hasChildren())&&(t[r]=n)}let i=new U(e.segments,t);return ov(i)}function ov(e){if(e.numberOfChildren===1&&e.children[D]){let t=e.children[D];return new U(e.segments.concat(t.segments),t.children)}return e}function br(e){return e instanceof si}function nv(e,t,i=null,r=null){let o=Sm(e);return Cm(o,t,i,r)}function Sm(e){let t;function i(n){let s={};for(let p of n.children){let d=i(p);s[p.outlet]=d}let l=new U(n.url,s);return n===e&&(t=l),l}let r=i(e.root),o=wm(r);return t??o}function Cm(e,t,i,r){let o=e;for(;o.parent;)o=o.parent;if(t.length===0)return ml(o,o,o,i,r);let n=sv(t);if(n.toRoot())return ml(o,o,new U([],{}),i,r);let s=av(n,o,e),l=s.processChildren?_o(s.segmentGroup,s.index,n.commands):Mm(s.segmentGroup,s.index,n.commands);return ml(o,s.segmentGroup,l,i,r)}function Kn(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function So(e){return typeof e=="object"&&e!=null&&e.outlets}function ml(e,t,i,r,o){let n={};r&&Object.entries(r).forEach(([p,d])=>{n[p]=Array.isArray(d)?d.map(h=>`${h}`):`${d}`});let s;e===t?s=i:s=Tm(e,t,i);let l=wm(bm(s));return new si(l,n,o)}function Tm(e,t,i){let r={};return Object.entries(e.children).forEach(([o,n])=>{n===t?r[o]=i:r[o]=Tm(n,t,i)}),new U(e.segments,r)}var Yn=class{constructor(t,i,r){if(this.isAbsolute=t,this.numberOfDoubleDots=i,this.commands=r,t&&r.length>0&&Kn(r[0]))throw new te(4003,!1);let o=r.find(So);if(o&&o!==um(r))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function sv(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new Yn(!0,0,e);let t=0,i=!1,r=e.reduce((o,n,s)=>{if(typeof n=="object"&&n!=null){if(n.outlets){let l={};return Object.entries(n.outlets).forEach(([p,d])=>{l[p]=typeof d=="string"?d.split("/"):d}),[...o,{outlets:l}]}if(n.segmentPath)return[...o,n.segmentPath]}return typeof n!="string"?[...o,n]:s===0?(n.split("/").forEach((l,p)=>{p==0&&l==="."||(p==0&&l===""?i=!0:l===".."?t++:l!=""&&o.push(l))}),o):[...o,n]},[]);return new Yn(i,t,r)}var vr=class{constructor(t,i,r){this.segmentGroup=t,this.processChildren=i,this.index=r}};function av(e,t,i){if(e.isAbsolute)return new vr(t,!0,0);if(!i)return new vr(t,!1,NaN);if(i.parent===null)return new vr(i,!0,0);let r=Kn(e.commands[0])?0:1,o=i.segments.length-1+r;return lv(i,o,e.numberOfDoubleDots)}function lv(e,t,i){let r=e,o=t,n=i;for(;n>o;){if(n-=o,r=r.parent,!r)throw new te(4005,!1);o=r.segments.length}return new vr(r,!1,o-n)}function cv(e){return So(e[0])?e[0].outlets:{[D]:e}}function Mm(e,t,i){if(e??=new U([],{}),e.segments.length===0&&e.hasChildren())return _o(e,t,i);let r=pv(e,t,i),o=i.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let n=new U(e.segments.slice(0,r.pathIndex),{});return n.children[D]=new U(e.segments.slice(r.pathIndex),e.children),_o(n,0,o)}else return r.match&&o.length===0?new U(e.segments,{}):r.match&&!e.hasChildren()?bl(e,t,i):r.match?_o(e,0,o):bl(e,t,i)}function _o(e,t,i){if(i.length===0)return new U(e.segments,{});{let r=cv(i),o={};if(Object.keys(r).some(n=>n!==D)&&e.children[D]&&e.numberOfChildren===1&&e.children[D].segments.length===0){let n=_o(e.children[D],t,i);return new U(e.segments,n.children)}return Object.entries(r).forEach(([n,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(o[n]=Mm(e.children[n],t,s))}),Object.entries(e.children).forEach(([n,s])=>{r[n]===void 0&&(o[n]=s)}),new U(e.segments,o)}}function pv(e,t,i){let r=0,o=t,n={match:!1,pathIndex:0,commandIndex:0};for(;o<e.segments.length;){if(r>=i.length)return n;let s=e.segments[o],l=i[r];if(So(l))break;let p=`${l}`,d=r<i.length-1?i[r+1]:null;if(o>0&&p===void 0)break;if(p&&d&&typeof d=="object"&&d.outlets===void 0){if(!pm(p,d,s))return n;r+=2}else{if(!pm(p,{},s))return n;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}function bl(e,t,i){let r=e.segments.slice(0,t),o=0;for(;o<i.length;){let n=i[o];if(So(n)){let p=dv(n.outlets);return new U(r,p)}if(o===0&&Kn(i[0])){let p=e.segments[t];r.push(new Oi(p.path,cm(i[0]))),o++;continue}let s=So(n)?n.outlets[D]:`${n}`,l=o<i.length-1?i[o+1]:null;s&&l&&Kn(l)?(r.push(new Oi(s,cm(l))),o+=2):(r.push(new Oi(s,{})),o++)}return new U(r,{})}function dv(e){let t={};return Object.entries(e).forEach(([i,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(t[i]=bl(new U([],{}),0,r))}),t}function cm(e){let t={};return Object.entries(e).forEach(([i,r])=>t[i]=`${r}`),t}function pm(e,t,i){return e==i.path&&_t(t,i.parameters)}var wo="imperative",ge=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(ge||{}),et=class{constructor(t,i){this.id=t,this.url=i}},Co=class extends et{constructor(t,i,r="imperative",o=null){super(t,i),this.type=ge.NavigationStart,this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ri=class extends et{constructor(t,i,r){super(t,i),this.urlAfterRedirects=r,this.type=ge.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},We=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(We||{}),Sl=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(Sl||{}),ai=class extends et{constructor(t,i,r,o){super(t,i),this.reason=r,this.code=o,this.type=ge.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Pi=class extends et{constructor(t,i,r,o){super(t,i),this.reason=r,this.code=o,this.type=ge.NavigationSkipped}},To=class extends et{constructor(t,i,r,o){super(t,i),this.error=r,this.target=o,this.type=ge.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Qn=class extends et{constructor(t,i,r,o){super(t,i),this.urlAfterRedirects=r,this.state=o,this.type=ge.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Cl=class extends et{constructor(t,i,r,o){super(t,i),this.urlAfterRedirects=r,this.state=o,this.type=ge.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tl=class extends et{constructor(t,i,r,o,n){super(t,i),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=n,this.type=ge.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ml=class extends et{constructor(t,i,r,o){super(t,i),this.urlAfterRedirects=r,this.state=o,this.type=ge.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xl=class extends et{constructor(t,i,r,o){super(t,i),this.urlAfterRedirects=r,this.state=o,this.type=ge.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Il=class{constructor(t){this.route=t,this.type=ge.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},El=class{constructor(t){this.route=t,this.type=ge.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ll=class{constructor(t){this.snapshot=t,this.type=ge.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kl=class{constructor(t){this.snapshot=t,this.type=ge.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ol=class{constructor(t){this.snapshot=t,this.type=ge.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Dl=class{constructor(t){this.snapshot=t,this.type=ge.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Mo=class{},xo=class{constructor(t){this.url=t}};var Rl=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new rs,this.attachRef=null}},rs=(()=>{let t=class t{constructor(){this.contexts=new Map}onChildOutletCreated(r,o){let n=this.getOrCreateContext(r);n.outlet=o,this.contexts.set(r,n)}onChildOutletDestroyed(r){let o=this.getContext(r);o&&(o.outlet=null,o.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let o=this.getContext(r);return o||(o=new Rl,this.contexts.set(r,o)),o}getContext(r){return this.contexts.get(r)||null}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),Xn=class{constructor(t){this._root=t}get root(){return this._root.value}parent(t){let i=this.pathFromRoot(t);return i.length>1?i[i.length-2]:null}children(t){let i=Pl(t,this._root);return i?i.children.map(r=>r.value):[]}firstChild(t){let i=Pl(t,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(t){let i=Al(t,this._root);return i.length<2?[]:i[i.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return Al(t,this._root).map(i=>i.value)}};function Pl(e,t){if(e===t.value)return t;for(let i of t.children){let r=Pl(e,i);if(r)return r}return null}function Al(e,t){if(e===t.value)return[t];for(let i of t.children){let r=Al(e,i);if(r.length)return r.unshift(t),r}return[]}var Be=class{constructor(t,i){this.value=t,this.children=i}toString(){return`TreeNode(${this.value})`}};function yr(e){let t={};return e&&e.children.forEach(i=>t[i.value.outlet]=i),t}var Jn=class extends Xn{constructor(t,i){super(t),this.snapshot=i,$l(this,t)}toString(){return this.snapshot.toString()}};function xm(e){let t=hv(e),i=new Ke([new Oi("",{})]),r=new Ke({}),o=new Ke({}),n=new Ke({}),s=new Ke(""),l=new Sr(i,r,n,s,o,D,e,t.root);return l.snapshot=t.root,new Jn(new Be(l,[]),t)}function hv(e){let t={},i={},r={},o="",n=new Io([],t,r,o,i,D,e,null,{});return new es("",new Be(n,[]))}var Sr=class{constructor(t,i,r,o,n,s,l,p){this.urlSubject=t,this.paramsSubject=i,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=n,this.outlet=s,this.component=l,this._futureSnapshot=p,this.title=this.dataSubject?.pipe(X(d=>d[ko]))??O(void 0),this.url=t,this.params=i,this.queryParams=r,this.fragment=o,this.data=n}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(X(t=>wr(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(X(t=>wr(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Wl(e,t,i="emptyOnly"){let r,{routeConfig:o}=e;return t!==null&&(i==="always"||o?.path===""||!t.component&&!t.routeConfig?.loadComponent)?r={params:g(g({},t.params),e.params),data:g(g({},t.data),e.data),resolve:g(g(g(g({},e.data),t.data),o?.data),e._resolvedData)}:r={params:g({},e.params),data:g({},e.data),resolve:g(g({},e.data),e._resolvedData??{})},o&&Em(o)&&(r.resolve[ko]=o.title),r}var Io=class{get title(){return this.data?.[ko]}constructor(t,i,r,o,n,s,l,p,d){this.url=t,this.params=i,this.queryParams=r,this.fragment=o,this.data=n,this.outlet=s,this.component=l,this.routeConfig=p,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=wr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=wr(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(r=>r.toString()).join("/"),i=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${i}')`}},es=class extends Xn{constructor(t,i){super(i),this.url=t,$l(this,i)}toString(){return Im(this._root)}};function $l(e,t){t.value._routerState=e,t.children.forEach(i=>$l(e,i))}function Im(e){let t=e.children.length>0?` { ${e.children.map(Im).join(", ")} } `:"";return`${e.value}${t}`}function fl(e){if(e.snapshot){let t=e.snapshot,i=e._futureSnapshot;e.snapshot=i,_t(t.queryParams,i.queryParams)||e.queryParamsSubject.next(i.queryParams),t.fragment!==i.fragment&&e.fragmentSubject.next(i.fragment),_t(t.params,i.params)||e.paramsSubject.next(i.params),zy(t.url,i.url)||e.urlSubject.next(i.url),_t(t.data,i.data)||e.dataSubject.next(i.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function Fl(e,t){let i=_t(e.params,t.params)&&Wy(e.url,t.url),r=!e.parent!=!t.parent;return i&&!r&&(!e.parent||Fl(e.parent,t.parent))}function Em(e){return typeof e.title=="string"||e.title===null}var uv=(()=>{let t=class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=D,this.activateEvents=new Jr,this.deactivateEvents=new Jr,this.attachEvents=new Jr,this.detachEvents=new Jr,this.parentContexts=I(rs),this.location=I(Bp),this.changeDetector=I(wa),this.environmentInjector=I(sn),this.inputBinder=I(Zl,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:o,previousValue:n}=r.name;if(o)return;this.isTrackedInParentContexts(n)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(n)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,o){this.activated=r,this._activatedRoute=o,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,o){if(this.isActivated)throw new te(4013,!1);this._activatedRoute=r;let n=this.location,l=r.snapshot.component,p=this.parentContexts.getOrCreateContext(this.name).children,d=new Vl(r,p,n.injector);this.activated=n.createComponent(l,{index:n.length,injector:d,environmentInjector:o??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=aa({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[kp]});let e=t;return e})(),Vl=class e{__ngOutletInjector(t){return new e(this.route,this.childContexts,t)}constructor(t,i,r){this.route=t,this.childContexts=i,this.parent=r}get(t,i){return t===Sr?this.route:t===rs?this.childContexts:this.parent.get(t,i)}},Zl=new Le("");function mv(e,t,i){let r=Eo(e,t._root,i?i._root:void 0);return new Jn(r,t)}function Eo(e,t,i){if(i&&e.shouldReuseRoute(t.value,i.value.snapshot)){let r=i.value;r._futureSnapshot=t.value;let o=fv(e,t,i);return new Be(r,o)}else{if(e.shouldAttach(t.value)){let n=e.retrieve(t.value);if(n!==null){let s=n.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(l=>Eo(e,l)),s}}let r=gv(t.value),o=t.children.map(n=>Eo(e,n));return new Be(r,o)}}function fv(e,t,i){return t.children.map(r=>{for(let o of i.children)if(e.shouldReuseRoute(r.value,o.value.snapshot))return Eo(e,r,o);return Eo(e,r)})}function gv(e){return new Sr(new Ke(e.url),new Ke(e.params),new Ke(e.queryParams),new Ke(e.fragment),new Ke(e.data),e.outlet,e.component,e)}var Lm="ngNavigationCancelingError";function km(e,t){let{redirectTo:i,navigationBehaviorOptions:r}=br(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,o=Om(!1,We.Redirect);return o.url=i,o.navigationBehaviorOptions=r,o}function Om(e,t){let i=new Error(`NavigationCancelingError: ${e||""}`);return i[Lm]=!0,i.cancellationCode=t,i}function yv(e){return Dm(e)&&br(e.url)}function Dm(e){return!!e&&e[Lm]}var vv=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=_i({type:t,selectors:[["ng-component"]],standalone:!0,features:[Ti],decls:1,vars:0,template:function(o,n){o&1&&Si(0,"router-outlet")},dependencies:[uv],encapsulation:2});let e=t;return e})();function _v(e,t){return e.providers&&!e._injector&&(e._injector=$p(e.providers,t,`Route: ${e.path}`)),e._injector??t}function ql(e){let t=e.children&&e.children.map(ql),i=t?T(g({},e),{children:t}):g({},e);return!i.component&&!i.loadComponent&&(t||i.loadChildren)&&i.outlet&&i.outlet!==D&&(i.component=vv),i}function wt(e){return e.outlet||D}function wv(e,t){let i=e.filter(r=>wt(r)===t);return i.push(...e.filter(r=>wt(r)!==t)),i}function Oo(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){let i=t.routeConfig;if(i?._loadedInjector)return i._loadedInjector;if(i?._injector)return i._injector}return null}var bv=(e,t,i,r)=>X(o=>(new Nl(t,o.targetRouterState,o.currentRouterState,i,r).activate(e),o)),Nl=class{constructor(t,i,r,o,n){this.routeReuseStrategy=t,this.futureState=i,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=n}activate(t){let i=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,r,t),fl(this.futureState.root),this.activateChildRoutes(i,r,t)}deactivateChildRoutes(t,i,r){let o=yr(i);t.children.forEach(n=>{let s=n.value.outlet;this.deactivateRoutes(n,o[s],r),delete o[s]}),Object.values(o).forEach(n=>{this.deactivateRouteAndItsChildren(n,r)})}deactivateRoutes(t,i,r){let o=t.value,n=i?i.value:null;if(o===n)if(o.component){let s=r.getContext(o.outlet);s&&this.deactivateChildRoutes(t,i,s.children)}else this.deactivateChildRoutes(t,i,r);else n&&this.deactivateRouteAndItsChildren(i,r)}deactivateRouteAndItsChildren(t,i){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,i):this.deactivateRouteAndOutlet(t,i)}detachAndStoreRouteSubtree(t,i){let r=i.getContext(t.value.outlet),o=r&&t.value.component?r.children:i,n=yr(t);for(let s of Object.values(n))this.deactivateRouteAndItsChildren(s,o);if(r&&r.outlet){let s=r.outlet.detach(),l=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:l})}}deactivateRouteAndOutlet(t,i){let r=i.getContext(t.value.outlet),o=r&&t.value.component?r.children:i,n=yr(t);for(let s of Object.values(n))this.deactivateRouteAndItsChildren(s,o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,i,r){let o=yr(i);t.children.forEach(n=>{this.activateRoutes(n,o[n.value.outlet],r),this.forwardEvent(new Dl(n.value.snapshot))}),t.children.length&&this.forwardEvent(new kl(t.value.snapshot))}activateRoutes(t,i,r){let o=t.value,n=i?i.value:null;if(fl(o),o===n)if(o.component){let s=r.getOrCreateContext(o.outlet);this.activateChildRoutes(t,i,s.children)}else this.activateChildRoutes(t,i,r);else if(o.component){let s=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let l=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),s.children.onOutletReAttached(l.contexts),s.attachRef=l.componentRef,s.route=l.route.value,s.outlet&&s.outlet.attach(l.componentRef,l.route.value),fl(l.route.value),this.activateChildRoutes(t,null,s.children)}else{let l=Oo(o.snapshot);s.attachRef=null,s.route=o,s.injector=l,s.outlet&&s.outlet.activateWith(o,s.injector),this.activateChildRoutes(t,null,s.children)}}else this.activateChildRoutes(t,null,r)}},ts=class{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},_r=class{constructor(t,i){this.component=t,this.route=i}};function Sv(e,t,i){let r=e._root,o=t?t._root:null;return yo(r,o,i,[r.value])}function Cv(e){let t=e.routeConfig?e.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:e,guards:t}}function Tr(e,t){let i=Symbol(),r=t.get(e,i);return r===i?typeof e=="function"&&!Ep(e)?e:t.get(e):r}function yo(e,t,i,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let n=yr(t);return e.children.forEach(s=>{Tv(s,n[s.value.outlet],i,r.concat([s.value]),o),delete n[s.value.outlet]}),Object.entries(n).forEach(([s,l])=>bo(l,i.getContext(s),o)),o}function Tv(e,t,i,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let n=e.value,s=t?t.value:null,l=i?i.getContext(e.value.outlet):null;if(s&&n.routeConfig===s.routeConfig){let p=Mv(s,n,n.routeConfig.runGuardsAndResolvers);p?o.canActivateChecks.push(new ts(r)):(n.data=s.data,n._resolvedData=s._resolvedData),n.component?yo(e,t,l?l.children:null,r,o):yo(e,t,i,r,o),p&&l&&l.outlet&&l.outlet.isActivated&&o.canDeactivateChecks.push(new _r(l.outlet.component,s))}else s&&bo(t,l,o),o.canActivateChecks.push(new ts(r)),n.component?yo(e,null,l?l.children:null,r,o):yo(e,null,i,r,o);return o}function Mv(e,t,i){if(typeof i=="function")return i(e,t);switch(i){case"pathParamsChange":return!Di(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Di(e.url,t.url)||!_t(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Fl(e,t)||!_t(e.queryParams,t.queryParams);case"paramsChange":default:return!Fl(e,t)}}function bo(e,t,i){let r=yr(e),o=e.value;Object.entries(r).forEach(([n,s])=>{o.component?t?bo(s,t.children.getContext(n),i):bo(s,null,i):bo(s,t,i)}),o.component?t&&t.outlet&&t.outlet.isActivated?i.canDeactivateChecks.push(new _r(t.outlet.component,o)):i.canDeactivateChecks.push(new _r(null,o)):i.canDeactivateChecks.push(new _r(null,o))}function Do(e){return typeof e=="function"}function xv(e){return typeof e=="boolean"}function Iv(e){return e&&Do(e.canLoad)}function Ev(e){return e&&Do(e.canActivate)}function Lv(e){return e&&Do(e.canActivateChild)}function kv(e){return e&&Do(e.canDeactivate)}function Ov(e){return e&&Do(e.canMatch)}function Rm(e){return e instanceof bp||e?.name==="EmptyError"}var Bn=Symbol("INITIAL_VALUE");function Cr(){return ft(e=>ia(e.map(t=>t.pipe(Yi(1),xp(Bn)))).pipe(X(t=>{for(let i of t)if(i!==!0){if(i===Bn)return Bn;if(i===!1||i instanceof si)return i}return!0}),qi(t=>t!==Bn),Yi(1)))}function Dv(e,t){return Ye(i=>{let{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:n,canDeactivateChecks:s}}=i;return s.length===0&&n.length===0?O(T(g({},i),{guardsResult:!0})):Rv(s,r,o,e).pipe(Ye(l=>l&&xv(l)?Pv(r,n,e,t):O(l)),X(l=>T(g({},i),{guardsResult:l})))})}function Rv(e,t,i,r){return nt(e).pipe(Ye(o=>Hv(o.component,o.route,i,t,r)),Xt(o=>o!==!0,!0))}function Pv(e,t,i,r){return nt(t).pipe(Qr(o=>Sp(Fv(o.route.parent,r),Av(o.route,r),Nv(e,o.path,i),Vv(e,o.route,i))),Xt(o=>o!==!0,!0))}function Av(e,t){return e!==null&&t&&t(new Ol(e)),O(!0)}function Fv(e,t){return e!==null&&t&&t(new Ll(e)),O(!0)}function Vv(e,t,i){let r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||r.length===0)return O(!0);let o=r.map(n=>ra(()=>{let s=Oo(t)??i,l=Tr(n,s),p=Ev(l)?l.canActivate(t,e):bi(s,()=>l(t,e));return li(p).pipe(Xt())}));return O(o).pipe(Cr())}function Nv(e,t,i){let r=t[t.length-1],n=t.slice(0,t.length-1).reverse().map(s=>Cv(s)).filter(s=>s!==null).map(s=>ra(()=>{let l=s.guards.map(p=>{let d=Oo(s.node)??i,h=Tr(p,d),u=Lv(h)?h.canActivateChild(r,e):bi(d,()=>h(r,e));return li(u).pipe(Xt())});return O(l).pipe(Cr())}));return O(n).pipe(Cr())}function Hv(e,t,i,r,o){let n=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!n||n.length===0)return O(!0);let s=n.map(l=>{let p=Oo(t)??o,d=Tr(l,p),h=kv(d)?d.canDeactivate(e,t,i,r):bi(p,()=>d(e,t,i,r));return li(h).pipe(Xt())});return O(s).pipe(Cr())}function Uv(e,t,i,r){let o=t.canLoad;if(o===void 0||o.length===0)return O(!0);let n=o.map(s=>{let l=Tr(s,e),p=Iv(l)?l.canLoad(t,i):bi(e,()=>l(t,i));return li(p)});return O(n).pipe(Cr(),Pm(r))}function Pm(e){return _p(_e(t=>{if(br(t))throw km(e,t)}),X(t=>t===!0))}function zv(e,t,i,r){let o=t.canMatch;if(!o||o.length===0)return O(!0);let n=o.map(s=>{let l=Tr(s,e),p=Ov(l)?l.canMatch(t,i):bi(e,()=>l(t,i));return li(p)});return O(n).pipe(Cr(),Pm(r))}var Lo=class{constructor(t){this.segmentGroup=t||null}},is=class extends Error{constructor(t){super(),this.urlTree=t}};function gr(e){return Yr(new Lo(e))}function Gv(e){return Yr(new te(4e3,!1))}function jv(e){return Yr(Om(!1,We.GuardRejected))}var Hl=class{constructor(t,i){this.urlSerializer=t,this.urlTree=i}lineralizeSegments(t,i){let r=[],o=i.root;for(;;){if(r=r.concat(o.segments),o.numberOfChildren===0)return O(r);if(o.numberOfChildren>1||!o.children[D])return Gv(t.redirectTo);o=o.children[D]}}applyRedirectCommands(t,i,r){let o=this.applyRedirectCreateUrlTree(i,this.urlSerializer.parse(i),t,r);if(i.startsWith("/"))throw new is(o);return o}applyRedirectCreateUrlTree(t,i,r,o){let n=this.createSegmentGroup(t,i.root,r,o);return new si(n,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(t,i){let r={};return Object.entries(t).forEach(([o,n])=>{if(typeof n=="string"&&n.startsWith(":")){let l=n.substring(1);r[o]=i[l]}else r[o]=n}),r}createSegmentGroup(t,i,r,o){let n=this.createSegments(t,i.segments,r,o),s={};return Object.entries(i.children).forEach(([l,p])=>{s[l]=this.createSegmentGroup(t,p,r,o)}),new U(n,s)}createSegments(t,i,r,o){return i.map(n=>n.path.startsWith(":")?this.findPosParam(t,n,o):this.findOrReturn(n,r))}findPosParam(t,i,r){let o=r[i.path.substring(1)];if(!o)throw new te(4001,!1);return o}findOrReturn(t,i){let r=0;for(let o of i){if(o.path===t.path)return i.splice(r),o;r++}return t}},Ul={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Bv(e,t,i,r,o){let n=Kl(e,t,i);return n.matched?(r=_v(t,r),zv(r,t,i,o).pipe(X(s=>s===!0?n:g({},Ul)))):O(n)}function Kl(e,t,i){if(t.path==="**")return Wv(i);if(t.path==="")return t.pathMatch==="full"&&(e.hasChildren()||i.length>0)?g({},Ul):{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};let o=(t.matcher||Uy)(i,e,t);if(!o)return g({},Ul);let n={};Object.entries(o.posParams??{}).forEach(([l,p])=>{n[l]=p.path});let s=o.consumed.length>0?g(g({},n),o.consumed[o.consumed.length-1].parameters):n;return{matched:!0,consumedSegments:o.consumed,remainingSegments:i.slice(o.consumed.length),parameters:s,positionalParamSegments:o.posParams??{}}}function Wv(e){return{matched:!0,parameters:e.length>0?um(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function dm(e,t,i,r){return i.length>0&&qv(e,i,r)?{segmentGroup:new U(t,Zv(r,new U(i,e.children))),slicedSegments:[]}:i.length===0&&Kv(e,i,r)?{segmentGroup:new U(e.segments,$v(e,i,r,e.children)),slicedSegments:i}:{segmentGroup:new U(e.segments,e.children),slicedSegments:i}}function $v(e,t,i,r){let o={};for(let n of i)if(os(e,t,n)&&!r[wt(n)]){let s=new U([],{});o[wt(n)]=s}return g(g({},r),o)}function Zv(e,t){let i={};i[D]=t;for(let r of e)if(r.path===""&&wt(r)!==D){let o=new U([],{});i[wt(r)]=o}return i}function qv(e,t,i){return i.some(r=>os(e,t,r)&&wt(r)!==D)}function Kv(e,t,i){return i.some(r=>os(e,t,r))}function os(e,t,i){return(e.hasChildren()||t.length>0)&&i.pathMatch==="full"?!1:i.path===""}function Yv(e,t,i,r){return wt(e)!==r&&(r===D||!os(t,i,e))?!1:Kl(t,e,i).matched}function Qv(e,t,i){return t.length===0&&!e.children[i]}var zl=class{};function Xv(e,t,i,r,o,n,s="emptyOnly"){return new Gl(e,t,i,r,o,s,n).recognize()}var Jv=31,Gl=class{constructor(t,i,r,o,n,s,l){this.injector=t,this.configLoader=i,this.rootComponentType=r,this.config=o,this.urlTree=n,this.paramsInheritanceStrategy=s,this.urlSerializer=l,this.applyRedirects=new Hl(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(t){return new te(4002,`'${t.segmentGroup}'`)}recognize(){let t=dm(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(X(i=>{let r=new Io([],Object.freeze({}),Object.freeze(g({},this.urlTree.queryParams)),this.urlTree.fragment,{},D,this.rootComponentType,null,{}),o=new Be(r,i),n=new es("",o),s=nv(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,n.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(n._root,null),{state:n,tree:s}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t,D).pipe(Ki(r=>{if(r instanceof is)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Lo?this.noMatchError(r):r}))}inheritParamsAndData(t,i){let r=t.value,o=Wl(r,i,this.paramsInheritanceStrategy);r.params=Object.freeze(o.params),r.data=Object.freeze(o.data),t.children.forEach(n=>this.inheritParamsAndData(n,r))}processSegmentGroup(t,i,r,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(t,i,r):this.processSegment(t,i,r,r.segments,o,!0).pipe(X(n=>n instanceof Be?[n]:[]))}processChildren(t,i,r){let o=[];for(let n of Object.keys(r.children))n==="primary"?o.unshift(n):o.push(n);return nt(o).pipe(Qr(n=>{let s=r.children[n],l=wv(i,n);return this.processSegmentGroup(t,l,s,n)}),Mp((n,s)=>(n.push(...s),n)),oa(null),Tp(),Ye(n=>{if(n===null)return gr(r);let s=Am(n);return e_(s),O(s)}))}processSegment(t,i,r,o,n,s){return nt(i).pipe(Qr(l=>this.processSegmentAgainstRoute(l._injector??t,i,l,r,o,n,s).pipe(Ki(p=>{if(p instanceof Lo)return O(null);throw p}))),Xt(l=>!!l),Ki(l=>{if(Rm(l))return Qv(r,o,n)?O(new zl):gr(r);throw l}))}processSegmentAgainstRoute(t,i,r,o,n,s,l){return Yv(r,o,n,s)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(t,o,r,n,s):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(t,o,i,r,n,s):gr(o):gr(o)}expandSegmentAgainstRouteUsingRedirect(t,i,r,o,n,s){let{matched:l,consumedSegments:p,positionalParamSegments:d,remainingSegments:h}=Kl(i,o,n);if(!l)return gr(i);o.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Jv&&(this.allowRedirects=!1));let u=this.applyRedirects.applyRedirectCommands(p,o.redirectTo,d);return this.applyRedirects.lineralizeSegments(o,u).pipe(Ye(m=>this.processSegment(t,r,i,m.concat(h),s,!1)))}matchSegmentAgainstRoute(t,i,r,o,n){let s=Bv(i,r,o,t,this.urlSerializer);return r.path==="**"&&(i.children={}),s.pipe(ft(l=>l.matched?(t=r._injector??t,this.getChildConfig(t,r,o).pipe(ft(({routes:p})=>{let d=r._loadedInjector??t,{consumedSegments:h,remainingSegments:u,parameters:m}=l,v=new Io(h,m,Object.freeze(g({},this.urlTree.queryParams)),this.urlTree.fragment,i_(r),wt(r),r.component??r._loadedComponent??null,r,r_(r)),{segmentGroup:w,slicedSegments:M}=dm(i,h,u,p);if(M.length===0&&w.hasChildren())return this.processChildren(d,p,w).pipe(X(k=>k===null?null:new Be(v,k)));if(p.length===0&&M.length===0)return O(new Be(v,[]));let V=wt(r)===n;return this.processSegment(d,p,w,M,V?D:n,!0).pipe(X(k=>new Be(v,k instanceof Be?[k]:[])))}))):gr(i)))}getChildConfig(t,i,r){return i.children?O({routes:i.children,injector:t}):i.loadChildren?i._loadedRoutes!==void 0?O({routes:i._loadedRoutes,injector:i._loadedInjector}):Uv(t,i,r,this.urlSerializer).pipe(Ye(o=>o?this.configLoader.loadChildren(t,i).pipe(_e(n=>{i._loadedRoutes=n.routes,i._loadedInjector=n.injector})):jv(i))):O({routes:[],injector:t})}};function e_(e){e.sort((t,i)=>t.value.outlet===D?-1:i.value.outlet===D?1:t.value.outlet.localeCompare(i.value.outlet))}function t_(e){let t=e.value.routeConfig;return t&&t.path===""}function Am(e){let t=[],i=new Set;for(let r of e){if(!t_(r)){t.push(r);continue}let o=t.find(n=>r.value.routeConfig===n.value.routeConfig);o!==void 0?(o.children.push(...r.children),i.add(o)):t.push(r)}for(let r of i){let o=Am(r.children);t.push(new Be(r.value,o))}return t.filter(r=>!i.has(r))}function i_(e){return e.data||{}}function r_(e){return e.resolve||{}}function o_(e,t,i,r,o,n){return Ye(s=>Xv(e,t,i,r,s.extractedUrl,o,n).pipe(X(({state:l,tree:p})=>T(g({},s),{targetSnapshot:l,urlAfterRedirects:p}))))}function n_(e,t){return Ye(i=>{let{targetSnapshot:r,guards:{canActivateChecks:o}}=i;if(!o.length)return O(i);let n=new Set(o.map(p=>p.route)),s=new Set;for(let p of n)if(!s.has(p))for(let d of Fm(p))s.add(d);let l=0;return nt(s).pipe(Qr(p=>n.has(p)?s_(p,r,e,t):(p.data=Wl(p,p.parent,e).resolve,O(void 0))),_e(()=>l++),na(1),Ye(p=>l===s.size?O(i):Qt))})}function Fm(e){let t=e.children.map(i=>Fm(i)).flat();return[e,...t]}function s_(e,t,i,r){let o=e.routeConfig,n=e._resolve;return o?.title!==void 0&&!Em(o)&&(n[ko]=o.title),a_(n,e,t,r).pipe(X(s=>(e._resolvedData=s,e.data=Wl(e,e.parent,i).resolve,null)))}function a_(e,t,i,r){let o=vl(e);if(o.length===0)return O({});let n={};return nt(o).pipe(Ye(s=>l_(e[s],t,i,r).pipe(Xt(),_e(l=>{n[s]=l}))),na(1),Cp(n),Ki(s=>Rm(s)?Qt:Yr(s)))}function l_(e,t,i,r){let o=Oo(t)??r,n=Tr(e,o),s=n.resolve?n.resolve(t,i):bi(o,()=>n(t,i));return li(s)}function gl(e){return ft(t=>{let i=e(t);return i?nt(i).pipe(X(()=>t)):O(t)})}var Vm=(()=>{let t=class t{buildTitle(r){let o,n=r.root;for(;n!==void 0;)o=this.getResolvedTitleForRoute(n)??o,n=n.children.find(s=>s.outlet===D);return o}getResolvedTitleForRoute(r){return r.data[ko]}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:()=>I(c_),providedIn:"root"});let e=t;return e})(),c_=(()=>{let t=class t extends Vm{constructor(r){super(),this.title=r}updateTitle(r){let o=this.buildTitle(r);o!==void 0&&this.title.setTitle(o)}};t.\u0275fac=function(o){return new(o||t)(W(nm))},t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),Yl=new Le("",{providedIn:"root",factory:()=>({})}),Ql=new Le(""),p_=(()=>{let t=class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=I(_a)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return O(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let o=li(r.loadComponent()).pipe(X(Nm),_e(s=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=s}),nn(()=>{this.componentLoaders.delete(r)})),n=new ta(o,()=>new Te).pipe(ea());return this.componentLoaders.set(r,n),n}loadChildren(r,o){if(this.childrenLoaders.get(o))return this.childrenLoaders.get(o);if(o._loadedRoutes)return O({routes:o._loadedRoutes,injector:o._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(o);let s=d_(o,this.compiler,r,this.onLoadEndListener).pipe(nn(()=>{this.childrenLoaders.delete(o)})),l=new ta(s,()=>new Te).pipe(ea());return this.childrenLoaders.set(o,l),l}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function d_(e,t,i,r){return li(e.loadChildren()).pipe(X(Nm),Ye(o=>o instanceof Wp||Array.isArray(o)?O(o):nt(t.compileModuleAsync(o))),X(o=>{r&&r(e);let n,s,l=!1;return Array.isArray(o)?(s=o,l=!0):(n=o.create(i).injector,s=n.get(Ql,[],{optional:!0,self:!0}).flat()),{routes:s.map(ql),injector:n}}))}function h_(e){return e&&typeof e=="object"&&"default"in e}function Nm(e){return h_(e)?e.default:e}var Xl=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:()=>I(u_),providedIn:"root"});let e=t;return e})(),u_=(()=>{let t=class t{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,o){return r}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),m_=new Le("");var f_=(()=>{let t=class t{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Te,this.transitionAbortSubject=new Te,this.configLoader=I(p_),this.environmentInjector=I(sn),this.urlSerializer=I(Bl),this.rootContexts=I(rs),this.location=I(cn),this.inputBindingEnabled=I(Zl,{optional:!0})!==null,this.titleStrategy=I(Vm),this.options=I(Yl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=I(Xl),this.createViewTransition=I(m_,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>O(void 0),this.rootComponentType=null;let r=n=>this.events.next(new Il(n)),o=n=>this.events.next(new El(n));this.configLoader.onLoadEndListener=o,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let o=++this.navigationId;this.transitions?.next(T(g(g({},this.transitions.value),r),{id:o}))}setupNavigations(r,o,n){return this.transitions=new Ke({id:0,currentUrlTree:o,currentRawUrl:o,extractedUrl:this.urlHandlingStrategy.extract(o),urlAfterRedirects:this.urlHandlingStrategy.extract(o),rawUrl:o,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:wo,restoredState:null,currentSnapshot:n.snapshot,targetSnapshot:null,currentRouterState:n,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(qi(s=>s.id!==0),X(s=>T(g({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),ft(s=>{let l=!1,p=!1;return O(s).pipe(ft(d=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",We.SupersededByNewNavigation),Qt;this.currentTransition=s,this.currentNavigation={id:d.id,initialUrl:d.rawUrl,extractedUrl:d.extractedUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?T(g({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let h=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=d.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!h&&u!=="reload"){let m="";return this.events.next(new Pi(d.id,this.urlSerializer.serialize(d.rawUrl),m,Sl.IgnoredSameUrlNavigation)),d.resolve(null),Qt}if(this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return O(d).pipe(ft(m=>{let v=this.transitions?.getValue();return this.events.next(new Co(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),v!==this.transitions?.getValue()?Qt:Promise.resolve(m)}),o_(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),_e(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=T(g({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let v=new Qn(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(v)}));if(h&&this.urlHandlingStrategy.shouldProcessUrl(d.currentRawUrl)){let{id:m,extractedUrl:v,source:w,restoredState:M,extras:V}=d,k=new Co(m,this.urlSerializer.serialize(v),w,M);this.events.next(k);let Yt=xm(this.rootComponentType).snapshot;return this.currentTransition=s=T(g({},d),{targetSnapshot:Yt,urlAfterRedirects:v,extras:T(g({},V),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=v,O(s)}else{let m="";return this.events.next(new Pi(d.id,this.urlSerializer.serialize(d.extractedUrl),m,Sl.IgnoredByUrlHandlingStrategy)),d.resolve(null),Qt}}),_e(d=>{let h=new Cl(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),X(d=>(this.currentTransition=s=T(g({},d),{guards:Sv(d.targetSnapshot,d.currentSnapshot,this.rootContexts)}),s)),Dv(this.environmentInjector,d=>this.events.next(d)),_e(d=>{if(s.guardsResult=d.guardsResult,br(d.guardsResult))throw km(this.urlSerializer,d.guardsResult);let h=new Tl(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.events.next(h)}),qi(d=>d.guardsResult?!0:(this.cancelNavigationTransition(d,"",We.GuardRejected),!1)),gl(d=>{if(d.guards.canActivateChecks.length)return O(d).pipe(_e(h=>{let u=new Ml(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(u)}),ft(h=>{let u=!1;return O(h).pipe(n_(this.paramsInheritanceStrategy,this.environmentInjector),_e({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(h,"",We.NoDataFromResolver)}}))}),_e(h=>{let u=new xl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(u)}))}),gl(d=>{let h=u=>{let m=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(u.routeConfig).pipe(_e(v=>{u.component=v}),X(()=>{})));for(let v of u.children)m.push(...h(v));return m};return ia(h(d.targetSnapshot.root)).pipe(oa(null),Yi(1))}),gl(()=>this.afterPreactivation()),ft(()=>{let{currentSnapshot:d,targetSnapshot:h}=s,u=this.createViewTransition?.(this.environmentInjector,d.root,h.root);return u?nt(u).pipe(X(()=>s)):O(s)}),X(d=>{let h=mv(r.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return this.currentTransition=s=T(g({},d),{targetRouterState:h}),this.currentNavigation.targetRouterState=h,s}),_e(()=>{this.events.next(new Mo)}),bv(this.rootContexts,r.routeReuseStrategy,d=>this.events.next(d),this.inputBindingEnabled),Yi(1),_e({next:d=>{l=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ri(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects))),this.titleStrategy?.updateTitle(d.targetRouterState.snapshot),d.resolve(!0)},complete:()=>{l=!0}}),Ip(this.transitionAbortSubject.pipe(_e(d=>{throw d}))),nn(()=>{!l&&!p&&this.cancelNavigationTransition(s,"",We.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ki(d=>{if(p=!0,Dm(d))this.events.next(new ai(s.id,this.urlSerializer.serialize(s.extractedUrl),d.message,d.cancellationCode)),yv(d)?this.events.next(new xo(d.url)):s.resolve(!1);else{this.events.next(new To(s.id,this.urlSerializer.serialize(s.extractedUrl),d,s.targetSnapshot??void 0));try{s.resolve(r.errorHandler(d))}catch(h){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(h)}}return Qt}))}))}cancelNavigationTransition(r,o,n){let s=new ai(r.id,this.urlSerializer.serialize(r.extractedUrl),o,n);this.events.next(s),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function g_(e){return e!==wo}var y_=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:()=>I(v_),providedIn:"root"});let e=t;return e})(),jl=class{shouldDetach(t){return!1}store(t,i){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,i){return t.routeConfig===i.routeConfig}},v_=(()=>{let t=class t extends jl{};t.\u0275fac=(()=>{let r;return function(n){return(r||(r=pa(t)))(n||t)}})(),t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),Hm=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:()=>I(__),providedIn:"root"});let e=t;return e})(),__=(()=>{let t=class t extends Hm{constructor(){super(...arguments),this.location=I(cn),this.urlSerializer=I(Bl),this.options=I(Yl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=I(Xl),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new si,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=xm(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(o=>{o.type==="popstate"&&r(o.url,o.state)})}handleRouterEvent(r,o){if(r instanceof Co)this.stateMemento=this.createStateMemento();else if(r instanceof Pi)this.rawUrlTree=o.initialUrl;else if(r instanceof Qn){if(this.urlUpdateStrategy==="eager"&&!o.extras.skipLocationChange){let n=this.urlHandlingStrategy.merge(o.finalUrl,o.initialUrl);this.setBrowserUrl(n,o)}}else r instanceof Mo?(this.currentUrlTree=o.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(o.finalUrl,o.initialUrl),this.routerState=o.targetRouterState,this.urlUpdateStrategy==="deferred"&&(o.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,o))):r instanceof ai&&(r.code===We.GuardRejected||r.code===We.NoDataFromResolver)?this.restoreHistory(o):r instanceof To?this.restoreHistory(o,!0):r instanceof Ri&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,o){let n=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(n)||o.extras.replaceUrl){let s=this.browserPageId,l=g(g({},o.extras.state),this.generateNgRouterState(o.id,s));this.location.replaceState(n,"",l)}else{let s=g(g({},o.extras.state),this.generateNgRouterState(o.id,this.browserPageId+1));this.location.go(n,"",s)}}restoreHistory(r,o=!1){if(this.canceledNavigationResolution==="computed"){let n=this.browserPageId,s=this.currentPageId-n;s!==0?this.location.historyGo(s):this.currentUrlTree===r.finalUrl&&s===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(o&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,o){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:o}:{navigationId:r}}};t.\u0275fac=(()=>{let r;return function(n){return(r||(r=pa(t)))(n||t)}})(),t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),vo=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(vo||{});function w_(e,t){e.events.pipe(qi(i=>i instanceof Ri||i instanceof ai||i instanceof To||i instanceof Pi),X(i=>i instanceof Ri||i instanceof Pi?vo.COMPLETE:(i instanceof ai?i.code===We.Redirect||i.code===We.SupersededByNewNavigation:!1)?vo.REDIRECTING:vo.FAILED),qi(i=>i!==vo.REDIRECTING),Yi(1)).subscribe(()=>{t()})}function b_(e){throw e}var S_={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},C_={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Um=(()=>{let t=class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=I(ln),this.stateManager=I(Hm),this.options=I(Yl,{optional:!0})||{},this.pendingTasks=I(Zp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=I(f_),this.urlSerializer=I(Bl),this.location=I(cn),this.urlHandlingStrategy=I(Xl),this._events=new Te,this.errorHandler=this.options.errorHandler||b_,this.navigated=!1,this.routeReuseStrategy=I(y_),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=I(Ql,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!I(Zl,{optional:!0}),this.eventsSubscription=new vp,this.isNgZoneEnabled=I(ke)instanceof ke&&ke.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(o=>{try{let n=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(n!==null&&s!==null){if(this.stateManager.handleRouterEvent(o,s),o instanceof ai&&o.code!==We.Redirect&&o.code!==We.SupersededByNewNavigation)this.navigated=!0;else if(o instanceof Ri)this.navigated=!0;else if(o instanceof xo){let l=this.urlHandlingStrategy.merge(o.url,n.currentRawUrl),p={info:n.extras.info,skipLocationChange:n.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||g_(n.source)};this.scheduleNavigation(l,wo,null,p,{resolve:n.resolve,reject:n.reject,promise:n.promise})}}M_(o)&&this._events.next(o)}catch(n){this.navigationTransitions.transitionAbortSubject.next(n)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),wo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,o)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",o)},0)})}navigateToSyncWithBrowser(r,o,n){let s={replaceUrl:!0},l=n?.navigationId?n:null;if(n){let d=g({},n);delete d.navigationId,delete d.\u0275routerPageId,Object.keys(d).length!==0&&(s.state=d)}let p=this.parseUrl(r);this.scheduleNavigation(p,o,l,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(ql),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,o={}){let{relativeTo:n,queryParams:s,fragment:l,queryParamsHandling:p,preserveFragment:d}=o,h=d?this.currentUrlTree.fragment:l,u=null;switch(p){case"merge":u=g(g({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let m;try{let v=n?n.snapshot:this.routerState.snapshot.root;m=Sm(v)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),m=this.currentUrlTree.root}return Cm(m,r,u,h??null)}navigateByUrl(r,o={skipLocationChange:!1}){let n=br(r)?r:this.parseUrl(r),s=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(s,wo,null,o)}navigate(r,o={skipLocationChange:!1}){return T_(r),this.navigateByUrl(this.createUrlTree(r,o),o)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,o){let n;if(o===!0?n=g({},S_):o===!1?n=g({},C_):n=o,br(r))return am(this.currentUrlTree,r,n);let s=this.parseUrl(r);return am(this.currentUrlTree,s,n)}removeEmptyProps(r){return Object.entries(r).reduce((o,[n,s])=>(s!=null&&(o[n]=s),o),{})}scheduleNavigation(r,o,n,s,l){if(this.disposed)return Promise.resolve(!1);let p,d,h;l?(p=l.resolve,d=l.reject,h=l.promise):h=new Promise((m,v)=>{p=m,d=v});let u=this.pendingTasks.add();return w_(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:o,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:s,resolve:p,reject:d,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(m=>Promise.reject(m))}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function T_(e){for(let t=0;t<e.length;t++)if(e[t]==null)throw new te(4008,!1)}function M_(e){return!(e instanceof Mo)&&!(e instanceof xo)}var x_=new Le("");function zm(e,...t){return wi([{provide:Ql,multi:!0,useValue:e},[],{provide:Sr,useFactory:I_,deps:[Um]},{provide:Yp,multi:!0,useFactory:E_},t.map(i=>i.\u0275providers)])}function I_(e){return e.routerState.root}function E_(){let e=I(Qi);return t=>{let i=e.get(Mi);if(t!==i.components[0])return;let r=e.get(Um),o=e.get(L_);e.get(k_)===1&&r.initialNavigation(),e.get(O_,null,sa.Optional)?.setUpPreloading(),e.get(x_,null,sa.Optional)?.init(),r.resetRootComponentType(i.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var L_=new Le("",{factory:()=>new Te}),k_=new Le("",{providedIn:"root",factory:()=>1});var O_=new Le("");var Gm=[];var D_="@",R_=(()=>{let t=class t{constructor(r,o,n,s,l){this.doc=r,this.delegate=o,this.zone=n,this.animationType=s,this.moduleImpl=l,this._rendererFactoryPromise=null,this.scheduler=I(zp,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-RCTVYVZX.js")).catch(o=>{throw new te(5300,!1)}).then(({\u0275createEngine:o,\u0275AnimationRendererFactory:n})=>{this._engine=o(this.animationType,this.doc,this.scheduler);let s=new n(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(r,o){let n=this.delegate.createRenderer(r,o);if(n.\u0275type===0)return n;typeof n.throwOnSyntheticProps=="boolean"&&(n.throwOnSyntheticProps=!1);let s=new Jl(n);return o?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(l=>{let p=l.createRenderer(r,o);s.use(p)}).catch(l=>{s.use(n)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};t.\u0275fac=function(o){fa()},t.\u0275prov=N({token:t,factory:t.\u0275fac});let e=t;return e})(),Jl=class{constructor(t){this.delegate=t,this.replay=[],this.\u0275type=1}use(t){if(this.delegate=t,this.replay!==null){for(let i of this.replay)i(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,i){return this.delegate.createElement(t,i)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,i){this.delegate.appendChild(t,i)}insertBefore(t,i,r,o){this.delegate.insertBefore(t,i,r,o)}removeChild(t,i,r){this.delegate.removeChild(t,i,r)}selectRootElement(t,i){return this.delegate.selectRootElement(t,i)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,i,r,o){this.delegate.setAttribute(t,i,r,o)}removeAttribute(t,i,r){this.delegate.removeAttribute(t,i,r)}addClass(t,i){this.delegate.addClass(t,i)}removeClass(t,i){this.delegate.removeClass(t,i)}setStyle(t,i,r,o){this.delegate.setStyle(t,i,r,o)}removeStyle(t,i,r){this.delegate.removeStyle(t,i,r)}setProperty(t,i,r){this.shouldReplay(i)&&this.replay.push(o=>o.setProperty(t,i,r)),this.delegate.setProperty(t,i,r)}setValue(t,i){this.delegate.setValue(t,i)}listen(t,i,r){return this.shouldReplay(i)&&this.replay.push(o=>o.listen(t,i,r)),this.delegate.listen(t,i,r)}shouldReplay(t){return this.replay!==null&&t.startsWith(D_)}};function jm(e="animations"){return jp("NgAsyncAnimations"),wi([{provide:an,useFactory:(t,i,r)=>new R_(t,i,r,e),deps:[we,Un,ke]},{provide:Rp,useValue:e==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Bm=["toast-component",""];function P_(e,t){if(e&1){let i=va();Oe(0,"button",5),tr("click",function(){la(i);let o=Ne();return ca(o.remove())}),Oe(1,"span",6),Xe(2,"\xD7"),Qe()()}}function A_(e,t){if(e&1&&(ga(0),Xe(1),ya()),e&2){let i=Ne(2);de(),Ci("[",i.duplicatesCount+1,"]")}}function F_(e,t){if(e&1&&(Oe(0,"div"),Xe(1),ro(2,A_,2,1,"ng-container",4),Qe()),e&2){let i=Ne();Dt(i.options.titleClass),er("aria-label",i.title),de(),Ci(" ",i.title," "),de(),Me("ngIf",i.duplicatesCount)}}function V_(e,t){if(e&1&&Si(0,"div",7),e&2){let i=Ne();Dt(i.options.messageClass),Me("innerHTML",i.message,ma)}}function N_(e,t){if(e&1&&(Oe(0,"div",8),Xe(1),Qe()),e&2){let i=Ne();Dt(i.options.messageClass),er("aria-label",i.message),de(),Ci(" ",i.message," ")}}function H_(e,t){if(e&1&&(Oe(0,"div"),Si(1,"div",9),Qe()),e&2){let i=Ne();de(),oo("width",i.width()+"%")}}function U_(e,t){if(e&1){let i=va();Oe(0,"button",5),tr("click",function(){la(i);let o=Ne();return ca(o.remove())}),Oe(1,"span",6),Xe(2,"\xD7"),Qe()()}}function z_(e,t){if(e&1&&(ga(0),Xe(1),ya()),e&2){let i=Ne(2);de(),Ci("[",i.duplicatesCount+1,"]")}}function G_(e,t){if(e&1&&(Oe(0,"div"),Xe(1),ro(2,z_,2,1,"ng-container",4),Qe()),e&2){let i=Ne();Dt(i.options.titleClass),er("aria-label",i.title),de(),Ci(" ",i.title," "),de(),Me("ngIf",i.duplicatesCount)}}function j_(e,t){if(e&1&&Si(0,"div",7),e&2){let i=Ne();Dt(i.options.messageClass),Me("innerHTML",i.message,ma)}}function B_(e,t){if(e&1&&(Oe(0,"div",8),Xe(1),Qe()),e&2){let i=Ne();Dt(i.options.messageClass),er("aria-label",i.message),de(),Ci(" ",i.message," ")}}function W_(e,t){if(e&1&&(Oe(0,"div"),Si(1,"div",9),Qe()),e&2){let i=Ne();de(),oo("width",i.width()+"%")}}var ec=class{_attachedHost;component;viewContainerRef;injector;constructor(t,i){this.component=t,this.injector=i}attach(t,i){return this._attachedHost=t,t.attach(this,i)}detach(){let t=this._attachedHost;if(t)return this._attachedHost=void 0,t.detach()}get isAttached(){return this._attachedHost!=null}setAttachedHost(t){this._attachedHost=t}},tc=class{_attachedPortal;_disposeFn;attach(t,i){return this._attachedPortal=t,this.attachComponentPortal(t,i)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(t){this._disposeFn=t}},ic=class{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new Te;_activate=new Te;_manualClose=new Te;_resetTimeout=new Te;_countDuplicate=new Te;constructor(t){this._overlayRef=t}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(t,i){t&&this._resetTimeout.next(),i&&this._countDuplicate.next(++this.duplicatesCount)}},Mr=class{toastId;config;message;title;toastType;toastRef;_onTap=new Te;_onAction=new Te;constructor(t,i,r,o,n,s){this.toastId=t,this.config=i,this.message=r,this.title=o,this.toastType=n,this.toastRef=s,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(t){this._onAction.next(t)}onAction(){return this._onAction.asObservable()}},Wm={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing"},$m=new Le("ToastConfig"),rc=class extends tc{_hostDomElement;_componentFactoryResolver;_appRef;constructor(t,i,r){super(),this._hostDomElement=t,this._componentFactoryResolver=i,this._appRef=r}attachComponentPortal(t,i){let r=this._componentFactoryResolver.resolveComponentFactory(t.component),o;return o=r.create(t.injector),this._appRef.attachView(o.hostView),this.setDisposeFn(()=>{this._appRef.detachView(o.hostView),o.destroy()}),i?this._hostDomElement.insertBefore(this._getComponentRootNode(o),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(o)),o}_getComponentRootNode(t){return t.hostView.rootNodes[0]}},$_=(()=>{class e{_document=I(we);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let i=this._document.createElement("div");i.classList.add("overlay-container"),i.setAttribute("aria-live","polite"),this._document.body.appendChild(i),this._containerElement=i}static \u0275fac=function(r){return new(r||e)};static \u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),oc=class{_portalHost;constructor(t){this._portalHost=t}attach(t,i=!0){return this._portalHost.attach(t,i)}detach(){return this._portalHost.detach()}},Z_=(()=>{class e{_overlayContainer=I($_);_componentFactoryResolver=I(Gp);_appRef=I(Mi);_document=I(we);_paneElements=new Map;create(i,r){return this._createOverlayRef(this.getPaneElement(i,r))}getPaneElement(i="",r){return this._paneElements.get(r)||this._paneElements.set(r,{}),this._paneElements.get(r)[i]||(this._paneElements.get(r)[i]=this._createPaneElement(i,r)),this._paneElements.get(r)[i]}_createPaneElement(i,r){let o=this._document.createElement("div");return o.id="toast-container",o.classList.add(i),o.classList.add("toast-container"),r?r.getContainerElement().appendChild(o):this._overlayContainer.getContainerElement().appendChild(o),o}_createPortalHost(i){return new rc(i,this._componentFactoryResolver,this._appRef)}_createOverlayRef(i){return new oc(this._createPortalHost(i))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Zm=(()=>{class e{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(i,r,o,n,s){this.overlay=r,this._injector=o,this.sanitizer=n,this.ngZone=s,this.toastrConfig=g(g({},i.default),i.config),i.config.iconClasses&&(this.toastrConfig.iconClasses=g(g({},i.default.iconClasses),i.config.iconClasses))}show(i,r,o={},n=""){return this._preBuildNotification(n,i,r,this.applyConfig(o))}success(i,r,o={}){let n=this.toastrConfig.iconClasses.success||"";return this._preBuildNotification(n,i,r,this.applyConfig(o))}error(i,r,o={}){let n=this.toastrConfig.iconClasses.error||"";return this._preBuildNotification(n,i,r,this.applyConfig(o))}info(i,r,o={}){let n=this.toastrConfig.iconClasses.info||"";return this._preBuildNotification(n,i,r,this.applyConfig(o))}warning(i,r,o={}){let n=this.toastrConfig.iconClasses.warning||"";return this._preBuildNotification(n,i,r,this.applyConfig(o))}clear(i){for(let r of this.toasts)if(i!==void 0){if(r.toastId===i){r.toastRef.manualClose();return}}else r.toastRef.manualClose()}remove(i){let r=this._findToast(i);if(!r||(r.activeToast.toastRef.close(),this.toasts.splice(r.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){let o=this.toasts[this.currentlyActive].toastRef;o.isInactive()||(this.currentlyActive=this.currentlyActive+1,o.activate())}return!0}findDuplicate(i="",r="",o,n){let{includeTitleDuplicates:s}=this.toastrConfig;for(let l of this.toasts){let p=s&&l.title===i;if((!s||p)&&l.message===r)return l.toastRef.onDuplicate(o,n),l}return null}applyConfig(i={}){return g(g({},this.toastrConfig),i)}_findToast(i){for(let r=0;r<this.toasts.length;r++)if(this.toasts[r].toastId===i)return{index:r,activeToast:this.toasts[r]};return null}_preBuildNotification(i,r,o,n){return n.onActivateTick?this.ngZone.run(()=>this._buildNotification(i,r,o,n)):this._buildNotification(i,r,o,n)}_buildNotification(i,r,o,n){if(!n.toastComponent)throw new Error("toastComponent required");let s=this.findDuplicate(o,r,this.toastrConfig.resetTimeoutOnDuplicate&&n.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&o||r)&&this.toastrConfig.preventDuplicates&&s!==null)return s;this.previousToastMessage=r;let l=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(l=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));let p=this.overlay.create(n.positionClass,this.overlayContainer);this.index=this.index+1;let d=r;r&&n.enableHtml&&(d=this.sanitizer.sanitize(Ot.HTML,r));let h=new ic(p),u=new Mr(this.index,n,d,o,i,h),m=[{provide:Mr,useValue:u}],v=Qi.create({providers:m,parent:this._injector}),w=new ec(n.toastComponent,v),M=p.attach(w,n.newestOnTop);h.componentInstance=M.instance;let V={toastId:this.index,title:o||"",message:r||"",toastRef:h,onShown:h.afterActivate(),onHidden:h.afterClosed(),onTap:u.onTap(),onAction:u.onAction(),portal:M};return l||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{V.toastRef.activate()})),this.toasts.push(V),V}static \u0275fac=function(r){return new(r||e)(W($m),W(Z_),W(Qi),W(hl),W(ke))};static \u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),q_=(()=>{class e{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=io(-1);toastClasses="";state;get _state(){return this.state()}get displayStyle(){if(this.state().value==="inactive")return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(i,r,o){this.toastrService=i,this.toastPackage=r,this.ngZone=o,this.message=r.message,this.title=r.title,this.options=r.config,this.originalTimeout=r.config.timeOut,this.toastClasses=`${r.toastType} ${r.config.toastClass}`,this.sub=r.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=r.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=r.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=r.toastRef.countDuplicate().subscribe(n=>{this.duplicatesCount=n}),this.state=io({value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.update(i=>T(g({},i),{value:"active"})),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let i=new Date().getTime(),r=this.hideTime-i;this.width.set(r/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(o=>100-o),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.update(i=>T(g({},i),{value:"active"})),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){this.state().value!=="removed"&&(clearTimeout(this.timeout),this.state.update(i=>T(g({},i),{value:"removed"})),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){this.state().value!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state().value!=="removed"&&this.options.disableTimeOut!=="extendedTimeOut"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state().value==="removed"||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(i,r){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(i),r)):this.timeout=setTimeout(()=>i(),r)}outsideInterval(i,r){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(i),r)):this.intervalId=setInterval(()=>i(),r)}runInsideAngular(i){this.ngZone?this.ngZone.run(()=>i()):i()}static \u0275fac=function(r){return new(r||e)(Jt(Zm),Jt(Mr),Jt(ke))};static \u0275cmp=_i({type:e,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(r,o){r&1&&tr("click",function(){return o.tapToast()})("mouseenter",function(){return o.stickAround()})("mouseleave",function(){return o.delayedHideToast()}),r&2&&(qp("@flyInOut",o._state),Dt(o.toastClasses),oo("display",o.displayStyle))},standalone:!0,features:[Ti],attrs:Bm,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(r,o){r&1&&ro(0,P_,3,0,"button",0)(1,F_,3,5,"div",1)(2,V_,1,3,"div",2)(3,N_,2,4,"div",3)(4,H_,2,2,"div",4),r&2&&(Me("ngIf",o.options.closeButton),de(),Me("ngIf",o.title),de(),Me("ngIf",o.message&&o.options.enableHtml),de(),Me("ngIf",o.message&&!o.options.enableHtml),de(),Me("ngIf",o.options.progressBar))},dependencies:[Sa],encapsulation:2,data:{animation:[rd("flyInOut",[dn("inactive",pn({opacity:0})),dn("active",pn({opacity:1})),dn("removed",pn({opacity:0})),xa("inactive => active",Ma("{{ easeTime }}ms {{ easing }}")),xa("active => removed",Ma("{{ easeTime }}ms {{ easing }}"))])]},changeDetection:0})}return e})(),K_=T(g({},Wm),{toastComponent:q_}),qm=(e={})=>wi([{provide:$m,useValue:{default:K_,config:e}}]);var Y_=(()=>{class e{toastrService;toastPackage;appRef;message;title;options;duplicatesCount;originalTimeout;width=io(-1);toastClasses="";get displayStyle(){return this.state()==="inactive"?"none":null}state=io("inactive");timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(i,r,o){this.toastrService=i,this.toastPackage=r,this.appRef=o,this.message=r.message,this.title=r.title,this.options=r.config,this.originalTimeout=r.config.timeOut,this.toastClasses=`${r.toastType} ${r.config.toastClass}`,this.sub=r.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=r.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=r.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=r.toastRef.countDuplicate().subscribe(n=>{this.duplicatesCount=n})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.set("active"),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.timeout=setTimeout(()=>{this.remove()},this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))),this.options.onActivateTick&&this.appRef.tick()}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let i=new Date().getTime(),r=this.hideTime-i;this.width.set(r/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(o=>100-o),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.set("active"),this.options.timeOut=this.originalTimeout,this.timeout=setTimeout(()=>this.remove(),this.originalTimeout),this.hideTime=new Date().getTime()+(this.originalTimeout||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))}remove(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.state.set("removed"),this.timeout=setTimeout(()=>this.toastrService.remove(this.toastPackage.toastId)))}tapToast(){this.state()!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state()==="removed"||(this.timeout=setTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10)))}static \u0275fac=function(r){return new(r||e)(Jt(Zm),Jt(Mr),Jt(Mi))};static \u0275cmp=_i({type:e,selectors:[["","toast-component",""]],hostVars:4,hostBindings:function(r,o){r&1&&tr("click",function(){return o.tapToast()})("mouseenter",function(){return o.stickAround()})("mouseleave",function(){return o.delayedHideToast()}),r&2&&(Dt(o.toastClasses),oo("display",o.displayStyle))},standalone:!0,features:[Ti],attrs:Bm,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(r,o){r&1&&ro(0,U_,3,0,"button",0)(1,G_,3,5,"div",1)(2,j_,1,3,"div",2)(3,B_,2,4,"div",3)(4,W_,2,2,"div",4),r&2&&(Me("ngIf",o.options.closeButton),de(),Me("ngIf",o.title),de(),Me("ngIf",o.message&&o.options.enableHtml),de(),Me("ngIf",o.message&&!o.options.enableHtml),de(),Me("ngIf",o.options.progressBar))},dependencies:[Sa],encapsulation:2,changeDetection:0})}return e})(),fS=T(g({},Wm),{toastComponent:Y_});var Km={providers:[zm(Gm),jm(),qm({timeOut:3e3,positionClass:"toast-bottom-full-width",progressBar:!0})]};var nc,Ro=nc=class extends ar{constructor(e){super(e),this.type="none"}clone(){return new nc({type:this.type})}};a([ch({none:"none",stayAbove:"stay-above"})],Ro.prototype,"type",void 0),Ro=nc=a([f("esri.ground.NavigationConstraint")],Ro);var sc,Vt=sc=class extends _d(lo){constructor(e){super(e),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new L;let t=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&E.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",r=>t(r.item)),this.layers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(e=>{sr(e)||E.getLogger(this).error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){let e=this.layers.removeAll();for(let t of e)A(t);this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=g({},e)).resourceInfo),e}set layers(e){this._set("layers",fn(e,this._get("layers")))}writeLayers(e,t,i,r){let o=[];e&&(r=T(g({},r),{layerContainerType:"ground"}),e.forEach(n=>{if("write"in n){let s={};Th(n)().write(s,r)&&o.push(s)}else r?.messages&&r.messages.push(new P("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))})),t.layers=o}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return Od(this,e=>{e(this.layers)})}queryElevation(e,t){return _(this,null,function*(){yield this.load({signal:t?.signal});let{ElevationQuery:i}=yield import("./chunk-EID4UUYZ.js");be(t);let r=new i,o=this.layers.filter(Ym).toArray();return r.queryAll(o,e,t)})}createElevationSampler(e,t){return _(this,null,function*(){yield this.load({signal:t?.signal});let{ElevationQuery:i}=yield import("./chunk-EID4UUYZ.js");be(t);let r=new i,o=this.layers.filter(Ym).toArray();return r.createSamplerAll(o,e,t)})}clone(){let e={opacity:this.opacity,surfaceColor:no(this.surfaceColor),navigationConstraint:no(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new sc({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){let t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}_loadLayersFromJSON(e,t,i){return _(this,null,function*(){let r=t?.origin||"web-scene",o=t?.portal||null,n=t?.url||null,{populateOperationalLayers:s}=yield import("./chunk-UKWGPRCB.js");be(i);let l=[];if(e.layers&&Array.isArray(e.layers)){let p={context:{origin:r,url:n,portal:o,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};l.push(s(this.layers,e.layers,p))}yield Promise.allSettled(l)})}};function Q_(e){return e&&"createElevationSampler"in e}function Ym(e){return e.type==="elevation"||Q_(e)}a([c({json:{read:!1}})],Vt.prototype,"layers",null),a([Dd("layers")],Vt.prototype,"writeLayers",null),a([c({readOnly:!0})],Vt.prototype,"resourceInfo",void 0),a([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:ka,read:{reader:Uh,source:"transparency"},write:{writer:(e,t)=>{t.transparency=Hh(e)},target:"transparency"}}})],Vt.prototype,"opacity",void 0),a([c({type:vt,json:{type:[ka],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],Vt.prototype,"surfaceColor",void 0),a([c({type:Ro,json:{write:!0}})],Vt.prototype,"navigationConstraint",void 0),Vt=sc=a([f("esri.Ground")],Vt);var xr=Vt;var ns=new WeakMap;function ac(e){return!e.destroyed&&(ns.has(e)||e.addHandles([b(()=>{let t=e.parent;return!(!t||!("type"in t))&&(t.type==="catalog-dynamic-group"||ac(t))},t=>ns.set(e,t),ae),De(()=>ns.delete(e))]),ns.get(e))}function X_(e){return typeof e=="object"&&e!=null&&"loaded"in e&&e.loaded===!0&&"type"in e}function Qm(e){return!(!X_(e)||!nh(e)?.operations?.supportsEditing||"editingEnabled"in e&&!sh(e)||ac(e))}var Xm={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function Jm(e){let t=null;if(typeof e=="string")if(e in Xm){let i=Xm[e];t=new xr({resourceInfo:{data:{layers:[i]}}})}else E.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else t=vd(xr,e);return t}var lt=class extends Jh(Xh(oe.EventedMixin(S))){constructor(e){super(e),this.allLayers=new ki({getCollections:()=>[this.basemap?.baseLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=Qh(this),this.basemap=null,this.editableLayers=new ki({getCollections:()=>[this.allLayers],itemFilterFunction:Qm}),this.ground=new xr,this._basemapCache=ph()}destroy(){dh(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=A(this.basemap),A(this.ground),this._set("ground",null)}castBasemap(e){return hh(e,this._basemapCache)}castGround(e){return Jm(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};a([c({readOnly:!0,dependsOn:[]})],lt.prototype,"allLayers",void 0),a([c({readOnly:!0})],lt.prototype,"allTables",void 0),a([c({type:iu,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],lt.prototype,"basemap",void 0),a([ze("basemap")],lt.prototype,"castBasemap",null),a([c({readOnly:!0})],lt.prototype,"editableLayers",void 0),a([c({type:xr,nonNullable:!0})],lt.prototype,"ground",void 0),a([ze("ground")],lt.prototype,"castGround",null),a([c()],lt.prototype,"undoRedo",void 0),lt=a([f("esri.Map")],lt);var lc=lt;var ss={widthBreakpoint:{getValue(e){let t=e.viewSize[0],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){let t=e.viewSize[1],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){let t=e.viewSize,i=t[0],r=t[1],o=this.values;return r>=i?o.portrait:o.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},cc={xsmall:544,small:768,medium:992,large:1200};function J_(e){let t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}function pc(e,t){return t?ss[e].valueToClassName[t].split(" "):[]}var ef=e=>{let t=class extends e{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=cc}initialize(){this.addHandles(b(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),R))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!J_(i)){let r=JSON.stringify(cc,null,2);console.warn("provided breakpoints are not valid, using defaults:"+r),i=cc}this._set("breakpoints",g({},i))}}_updateClassNames(){if(!this.container)return;let i=so.acquire(),r=so.acquire(),o,n=!1;for(o in ss){let s=this[o],l=ss[o].getValue({viewSize:this.size,breakpoints:this.breakpoints});s!==l&&(n=!0,this[o]=l,pc(o,s).forEach(p=>r.push(p)),pc(o,l).forEach(p=>i.push(p)))}n&&(this._applyClassNameChanges(i,r),so.release(i),so.release(r))}_applyClassNameChanges(i,r){let o=this.container;o&&(r.forEach(n=>o.classList.remove(n)),i.forEach(n=>o.classList.add(n)))}_removeActiveClassNames(){let i=this.container;if(!i)return;let r;for(r in ss)pc(r,this[r]).forEach(o=>i.classList.remove(o))}};return a([c()],t.prototype,"breakpoints",null),a([c()],t.prototype,"orientation",void 0),a([c()],t.prototype,"widthBreakpoint",void 0),a([c()],t.prototype,"heightBreakpoint",void 0),t=a([f("esri.views.BreakpointsOwner")],t),t};var ci=class extends S{constructor(){super(...arguments),this.items=new L,this._watchUpdatingTracking=new ni,this._callbacks=new Map,this._projector=Aa(),this._hiddenProjector=Aa()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){let e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(let i of t.added){let r=()=>i.render();this._callbacks.set(i,r),this._projector.append(this.surface,r)}for(let i of t.removed){let r=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(r.domNode),this._callbacks.delete(i)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){let t=this._hiddenSurface,i=this._hiddenProjector,r,o=()=>(r=e.render(),r);i.append(t,o),i.renderNow();let n={left:0,top:0,right:0,bottom:0};if(r?.domNode){let s=r.domNode.getBoundingClientRect();n.left=s.left,n.top=s.top,n.right=s.right,n.bottom=s.bottom}for(i.detach(o);t.firstChild;)t.removeChild(t.firstChild);return n}overlaps(e,t){let i=this.computeBoundingRect(e),r=this.computeBoundingRect(t);return Math.max(i.left,r.left)<=Math.min(i.right,r.right)&&Math.max(i.top,r.top)<=Math.min(i.bottom,r.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}prepare(){return _(this,null,function*(){yield document.fonts.load(this._fontString()).catch(()=>{})})}renderCanvas(e,t){let i=!!t?.disableDecorations;if(!this.items.some(o=>o.visible&&!(i&&o.isDecoration)))return;let r=e.getContext("2d");r.save(),r.font=this._fontString(),this.items.forEach(o=>{i&&o.isDecoration||(r.save(),o.renderCanvas(r),r.restore())}),r.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};a([c({readOnly:!0})],ci.prototype,"surface",void 0),a([c({readOnly:!0})],ci.prototype,"items",void 0),a([c({readOnly:!0})],ci.prototype,"needsRender",null),a([c({readOnly:!0})],ci.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],ci.prototype,"updating",null),ci=a([f("esri.views.overlay.ViewOverlay")],ci);var dc=ci;var hc=[0,0];function ew(e){let t=(e.ownerDocument||window.document).defaultView,i=e.getBoundingClientRect();return hc[0]=i.left+(t?.pageXOffset??0),hc[1]=i.top+(t?.pageYOffset??0),hc}function tf(e){e&&(mn(e),e.parentNode&&e.parentNode.removeChild(e))}function tw(e){let t=document.createElement("div");return e.appendChild(t),t}var Po=16,as=750,iw=512,rw=2,rf=e=>{let t=class extends e{constructor(...i){super(...i),this._freqInfo={freq:Po,time:as},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([b(()=>this.cursor,r=>{let{surface:o}=this;o&&o.setAttribute("data-cursor",r)}),b(()=>this.navigating,r=>{let{surface:o}=this;o&&o.setAttribute("data-navigating",r.toString())})])}initialize(){this.addHandles([b(()=>this.ui,(i,r)=>this._handleUIChange(i,r),R),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=A(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(i){let r=this._get("container"),o=un(i);if(o||typeof i!="string"||E.getLogger(this).error("#container",`element with id '${i}' not found`),r===o)return;if(this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(tf(this.root),this._set("root",null)),this.userContent&&(Pa(this.userContent,r),tf(this.userContent),this._set("userContent",null))),!o)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);o.classList.add("esri-view");let n=document.createElement("div");n.className="esri-view-user-storage",Pa(o,n),o.appendChild(n),this._set("userContent",n);let s=document.createElement("div");s.className="esri-view-root",o.insertBefore(s,o.firstChild),this._set("root",s);let l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,s.appendChild(l),this._set("surface",l);let p=new dc;s.appendChild(p.surface),this._set("overlay",p),this.addHandles(b(()=>p.needsRender,d=>{d&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=st({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=Z(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",o),this._startMeasuring()}get focused(){let i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(i,r,o){let n=this.position;return i-=n?n[0]:0,r-=n?n[1]:0,o?(o[0]=i,o[1]=r):o=[i,r],o}containerToPage(i,r,o){let n=this.position;return i+=n?n[0]:0,r+=n?n[1]:0,o?(o[0]=i,o[1]=r):o=[i,r],o}_handleUIChange(i,r){this.removeHandles("ui"),r&&r!==i&&r.destroy(),i&&(i.view=this,this.addHandles(b(()=>this.root,o=>{i.container=o?tw(o):null},R),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){let i=this._freqInfo;i.freq=Po,i.time=as,this.addHandles([nd(window,"resize",()=>{i.freq=Po,i.time=as}),st({prepare:r=>{let o=this._measure(),n=this._freqInfo;if(n.time+=r.deltaTime,o&&(n.freq=Po,this._get("resizing")||this._set("resizing",!0)),n.time<n.freq)return;n.time=0;let s=this._position();n.freq=s||o?Po:Math.min(as,n.freq*rw),!o&&n.freq>=iw&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){let i=this.container,r=i?i.clientWidth:0,o=i?i.clientHeight:0;if(r===0||o===0)return this.suspended||this._set("suspended",!0),!1;let n=this.width,s=this.height;return r===n&&o===s?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",o),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:s,width:r,height:o}),!0)}_position(){let i=this.container,r=this.position,o=i&&ew(i);return!!o&&(!r||o[0]!==r[0]||o[1]!==r[1])&&(this._set("position",[o[0],o[1]]),!0)}forceDOMReadyCycle(){}};return a([c()],t.prototype,"container",null),a([c({readOnly:!0})],t.prototype,"focused",null),a([c({readOnly:!0})],t.prototype,"height",void 0),a([c()],t.prototype,"messagesCommon",void 0),a([c({type:dc})],t.prototype,"overlay",void 0),a([c({readOnly:!0})],t.prototype,"position",void 0),a([c({readOnly:!0})],t.prototype,"resizing",void 0),a([c({readOnly:!0})],t.prototype,"root",void 0),a([c({value:null,readOnly:!0})],t.prototype,"size",null),a([c({readOnly:!0})],t.prototype,"surface",void 0),a([c({readOnly:!0})],t.prototype,"suspended",void 0),a([c()],t.prototype,"ui",void 0),a([c({readOnly:!0})],t.prototype,"userContent",void 0),a([c({readOnly:!0})],t.prototype,"width",void 0),a([c()],t.prototype,"widthBreakpoint",void 0),t=a([f("esri.views.DOMContainer")],t),t};function Nt(e){return e!=null&&"open"in e&&"declaredClass"in e}function of(e){return e!=null&&"declaredClass"in e&&"dockOptions"in e}var nf=e=>{let t=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([b(()=>[this.ui,this.popup],([i,r],o)=>{let n="popup",s="manual";if(o){let[l,p]=o;l&&Nt(p)&&(p.view=null,of(p)&&l.remove(p,n))}i&&Nt(r)&&(r.view=this,of(r)&&i.add(r,{key:n,position:s,internal:!0}))},R),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(Nt(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(()=>_(this,null,function*(){yield this.setupPopup(),Nt(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)})))},j.WIDGET)]),At(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{import("./chunk-7MOWAMF6.js")})}destroy(){this.destroyed||this.closePopup()}openPopup(i){return _(this,null,function*(){if(Nt(this.popup))return this.popup.open(i);try{if(yield this.setupPopup(),!this.popup)return void E.getLogger(this).error(new P("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}})}closePopup(){this._popupSetupTask?.abort(),Nt(this.popup)&&this.popup.close()}fetchPopupFeatures(i,r){return _(this,null,function*(){return yield this.when(),this._popupHitsToFeatures(yield this._getPopupHits(i,r),r)})}setupPopup(){return _(this,null,function*(){if(this._popupSetupTask?.abort(),this.popup&&!Nt(this.popup))return this._popupSetupTask=ii(i=>_(this,null,function*(){let{default:r}=yield import("./chunk-7MOWAMF6.js");if(be(i),!this.popup||Nt(this.popup))return;let o=this.popup;delete o.open,delete o.close,this.popup=new r(o)})),this._popupSetupTask.promise})}_popupHitsToFeatures(n,s){return _(this,arguments,function*({location:i,hits:r},o){let l=[],p=[],d=!1,h=cd(o,ie("popup-view-fetch-timeout")??ow),u=w=>{let M=new uc(w);return p.push(M),l.push(M.promise),M},m=w=>{let M=p.at(-1);return M&&M.layerView===w&&!d?M:u(w)};for(let w of r)"graphic"in w?(m(w.layerView).graphics.push(w.graphic),d=!1):(l.push(w.layerView.fetchPopupFeaturesAtLocation(w.mapPoint,h)),d=!0);p.map(w=>w.resolve(h));let v=ad(l).then(w=>w.filter(M=>!!M).flat());return{pendingFeatures:l,allGraphicsPromise:v,location:i}})}_getPopupHits(i,r){return _(this,null,function*(){let{hits:o,location:n}=yield this.popupHitTest(i);be(r);let s=[];for(let l of o)if("graphic"in l){if(this._isValidPopupGraphic(l.graphic,r)){let p=this._isValidPopupGraphicsLayerView(l.layerView)?l.layerView:void 0;s.push({graphic:l.graphic,layerView:p})}}else this._isValidPopupLocationLayerView(l.layerView)&&s.push({mapPoint:l.mapPoint,layerView:l.layerView});return{hits:s,location:n}})}_isValidPopupGraphic(i,r){return i&&!!i.getEffectivePopupTemplate(r?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return a([c({cast(i){return!i||Nt(i)||typeof i=="object"&&(i.open=r=>(Ea(E.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(r)),i.close=()=>(Ea(E.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),i}})],t.prototype,"popup",void 0),a([c()],t.prototype,"popupEnabled",void 0),t=a([f("esri.views.PopupView")],t),t},uc=class{constructor(t){this.layerView=t,this._resolver=xi(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(t){let{layerView:i,graphics:r,_resolver:o}=this;if(!i)return o.resolve(r),o.promise;let n;return i.fetchPopupFeaturesFromGraphics(r,t).catch(s=>(n=s,null)).then(s=>{s?o.resolve(s):o.reject(n)}),o.promise}},ow=5e3;var Ao=class extends eu{constructor(e){super(e),this.addHandles(this.on("before-add",t=>{t.item!=null&&t.item.parent===this.owner&&(E.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};Ao=a([f("esri.support.AnalysesCollection")],Ao);var Ht=class extends S{constructor(e){super(e),this.view=null,this.baseLayerViews=new L,this.referenceLayerViews=new L,this._loadingHandle=b(()=>this.view?.map?.basemap,t=>{t&&t.load().catch(()=>{})},R)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(let e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(let e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){if(this.view?.suspended)return!1;let e=this.view?.map?.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(t=>t.updating)||this.referenceLayerViews.some(t=>t.updating))}};a([c({constructOnly:!0})],Ht.prototype,"view",void 0),a([c({readOnly:!0})],Ht.prototype,"baseLayerViews",void 0),a([c({readOnly:!0})],Ht.prototype,"referenceLayerViews",void 0),a([c({readOnly:!0})],Ht.prototype,"suspended",null),a([c({type:Boolean,readOnly:!0})],Ht.prototype,"updating",null),Ht=a([f("esri.views.BasemapView")],Ht);function nw(e){return"tryRecycleWith"in e}function sw(e){return e!=null&&typeof e=="object"&&"layerViews"in e}var mc=class{constructor(t,i,r){this.layer=t,this.view=i,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=xi(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,nr(this._controller.signal,()=>{let o=new P("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(o)})}tryRecycle(t){if(!this.done||!this.layerView||!nw(this.layerView))return null;let i=this.layer.type,r=this._controller.signal;for(let o=0;o<t.length;o++){let n=t[o];if(n.type!==i)continue;let s=this.layerView.tryRecycleWith(n,{signal:r});if(s){t.splice(o,1),this.layer=n;let l=this.layerView,p=l.view;return this.promise=Promise.race([s.then(()=>(be(this._controller.signal),n.emit("layerview-destroy",{view:p,layerView:l}),p.emit("layerview-destroy",{view:p,layerView:l}),n.emit("layerview-create",{view:p,layerView:l}),p.emit("layerview-create",{view:p,layerView:l}),l)),new Promise((d,h)=>nr(this._controller.signal,()=>h(or())))]),this.promise}}return null}destroy(){this._controller.abort();let{layerView:t}=this;if(t){let{layer:i,view:r}=this;i.emit("layerview-destroy",{view:r,layerView:t}),r.emit("layerview-destroy",{layer:i,layerView:t})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}start(){return _(this,null,function*(){if(this._started)return;this._started=!0;let{_controller:{signal:t},layer:i,view:r}=this;this._map=r.map;try{let o,n;if(yield i.load({signal:t}),i.prefetchResources&&(yield i.prefetchResources({signal:t})),aw(i))o=yield i.createLayerView(r,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new P("layer:view-not-supported","No layerview implementation was found");let p=yield this.layerViewImporter.importLayerView(i);be(t),o="default"in p?new p.default({layer:i,view:r}):new p({layer:i,view:r})}let s=()=>{n=Z(n),o.destroyed||o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0};n=nr(t,s),be(t);try{yield o.when()}catch(p){throw s(),p}if(!this._map?.allLayers?.includes(i))return s(),void this._deferred.reject(new P("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=o,i.emit("layerview-create",{view:r,layerView:o}),r.emit("layerview-create",{layer:i,layerView:o}),this.done=!0,this._deferred.resolve(o)}catch(o){i.emit("layerview-create-error",{view:r,error:o}),r.emit("layerview-create-error",{layer:i,error:o}),this.done=!0,this._deferred.reject(new P("layerview:create-error","layerview creation failed",{layer:i,error:o}))}})}},tt=class extends S{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new ni,this.supportsGround=!0,this._preloadLayerViewModules=()=>{let t=this.view.map?.allLayers;if(t)for(let i of t)this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=xi(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(ud(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;let t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");let i=new Set,r=[],o=this.view.ready,n=l=>{if(l!=null){for(let p of l)if(p){i.add(p);let d=this._layerLayerViewInfoMap.get(p);d&&o?d.start():d||this._recyclingInfoMap.has(p)||r.push(p),"layers"in p&&p.layers&&n(p.layers)}}};for(let l of this._rootCollectionNames)n(Pt(this,l));for(let[l,p]of this._layerLayerViewInfoMap)if(!i.has(l)){this._layerLayerViewInfoMap.delete(p.layer);let d=p.tryRecycle(r);d?(this.notifyChange("updating"),this._recyclingInfoMap.set(p.layer,p),d.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(p.layer),this._layerLayerViewInfoMap.set(p.layer,p),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(p.layer),p.destroy(),this._reschedule()})):p.destroy()}for(let[l,p]of this._recyclingInfoMap)i.has(l)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(p.layer),p.destroy());for(let l of r)this._createLayerView(l);this._refreshCollections();let s=[t?.ground?.layers,t?.basemap?.baseLayers,t?.basemap?.referenceLayers,t?.layers].filter(l=>!!l);i.forEach(l=>"layers"in l&&s.push(l.layers)),this.addHandles(s.map(l=>this._watchUpdatingTracking.addOnCollectionChange(()=>l,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([at(()=>this.view?.map?.allLayers,"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),b(()=>{let e=this.view,t=e?.map;return[t?.basemap,t?.ground,t?.layers,e?.ready]},()=>this._reschedule(),ae)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),kn(this._recyclingInfoMap),kn(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(or()),this._workPromise=null)}get _layersToLayerViews(){let e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||ti(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(let t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){this.destroyed||(kn(this._layerLayerViewInfoMap),this._refreshCollections())}whenLayerView(e){return _(this,null,function*(){if(yield this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new P("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise})}isCreatingLayerViewsForLayer(e,t){this.commitProperty("updatingRemaining");let i=this._layerLayerViewInfoMap.get(e);if(!i?.done)return!0;let r=i.layerView;return!(!r||!t||r.parent===t)||!!(i.done&&r&&"layers"in e&&e.layers?.length)&&e.layers.some(o=>this.isCreatingLayerViewsForLayer(o,r))}_refreshCollections(){for(let[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners(Pt(this,e),Pt(this,t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,i){if(!e||!t)return void(t&&t.removeAll());let r=0;for(let o of e){let n=this._layerLayerViewInfoMap.get(o);if(!n?.layerView)continue;let s=n.layerView;s.layer=o,s.parent=i,t.at(r)!==s&&t.splice(r,0,s),"layers"in o&&sw(s)&&this._populateLayerViewsOwners(o.layers,s.layerViews,s),r+=1}r<t.length&&t.splice(r,t.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);let t=new mc(e,this.view,this.layerViewImporter);t.promise.then(()=>this._refreshCollections(),i=>{i&&(sr(i)||i.name==="cancelled:layerview-create")||E.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:i}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};a([c()],tt.prototype,"_workPromise",void 0),a([c({readOnly:!0})],tt.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],tt.prototype,"_layersToLayerViews",null),a([c({readOnly:!0})],tt.prototype,"_rootCollectionNames",null),a([c()],tt.prototype,"layerViewImporter",void 0),a([c()],tt.prototype,"supportsGround",void 0),a([c({readOnly:!0})],tt.prototype,"updating",null),a([c({readOnly:!0})],tt.prototype,"updatingRemaining",null),a([c({constructOnly:!0})],tt.prototype,"view",void 0),tt=a([f("esri.views.LayerViewManager")],tt);var sf=tt;function aw(e){return"createLayerView"in e&&e.createLayerView!=null}var $e=class extends S{constructor(e){super(e),this.factor=1.5,this.offset=H(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};a([c({type:Number})],$e.prototype,"factor",void 0),a([c({nonNullable:!0})],$e.prototype,"offset",void 0),a([c()],$e.prototype,"position",void 0),a([c({type:Number,range:{min:0}})],$e.prototype,"size",void 0),a([c()],$e.prototype,"maskUrl",void 0),a([c()],$e.prototype,"maskEnabled",void 0),a([c()],$e.prototype,"overlayUrl",void 0),a([c()],$e.prototype,"overlayEnabled",void 0),a([c({readOnly:!0})],$e.prototype,"version",null),a([c({type:Boolean})],$e.prototype,"visible",void 0),$e=a([f("esri.views.Magnifier")],$e);var fc=$e;function Fo(e){return!!(e!=null&&typeof e=="object"&&"createQuery"in e&&e.createQuery&&"on"in e&&e.on)}var Ut=class extends oe.EventedAccessor{constructor(e){super(e),this._selectionMap=new Eh,this._sources=new L,this._trashCan=[],this._layerEditHandles=new L,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([b(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),at(()=>this.sources,"change",t=>{let i=this._selectionMap;for(let r of t.removed)i.delete(r);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);let e=new L;this.view.when().then(()=>{this.view.map&&(this.view.map.allLayers.flatten(t=>"sublayers"in t&&t.sublayers?t.sublayers:null).forEach(t=>{(Fo(t)&&!rh(t)||ri(t))&&e.add(t)}),this.sources=e)})}destroy(){this._layerEditHandles.drain(Z)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{let[t,i]=e;return{layer:t,selection:[...i.selection]}})}get count(){let e=0;for(let t of this._selectionMap.values())e+=t.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){fn(e,this._sources)}getSelectedFeatures(r){return _(this,arguments,function*(e,t={},i="layerView"){let{view:o,selections:n}=this,s=(e!==void 0?n.filter(l=>e.includes(l.layer)):n).filter(l=>l.selection.length>0).map(l=>_(this,null,function*(){let{layer:p,selection:d}=l,h=ri(p)?p.parent:p;if(h==null||!lf(h))return null;if(i==="layer")return cf(h,d,t);if(af(h))return null;let u=yield o.whenLayerView(h).catch(()=>null);return u?cf(u,d,t):null}));return(yield Promise.all(s)).filter(l=>l!=null)})}updateSelection(e){let t=new Map;for(let[o,n]of this._selectionMap)t.set(o,[...n.selection]);let i=!1,r=e.current.concat(e.added);for(let o of r){let n=o.sourceLayer,s=o.getObjectId();if(this.sources.includes(n)&&(Fo(n)||ri(n))&&s!==null){let l=gd(t,n,()=>[]);l.includes(s)||(l.push(s),i=!0)}}for(let o of e.removed){let n=o.sourceLayer,s=o.getObjectId();if(this.sources.includes(n)&&(Fo(n)||ri(n))&&s!==null){let l=t.get(n),p=l?.indexOf(s);p!==void 0&&p>=0&&(l?.splice(p,1),i=!0)}}if(i){let{_selectionMap:o,_trashCan:n}=this,s=[];for(let[l,p]of t){let d=o.get(l);d!==void 0&&n.push(d),o.set(l,{selection:p}),s.push(g({layer:l,selection:p},Ia(d!==void 0?d.selection:[],p)))}this._onSelectionChange(s)}}setSelection(e,t){this._setSelection(e,t)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,t){let i=this._selectionMap.get(e),r=i!==void 0?[...i.selection]:[];for(let o of t)r.includes(o)||r.push(o);this._setSelection(e,r)}removeFromSelection(e,t){let i=this._selectionMap.get(e);if(!i)return;let r=[];for(let o of i.selection)t.includes(o)||r.push(o);this._setSelection(e,r)}toggleInSelection(e,t){let i=this._selectionMap.get(e);if(!i||i.selection.length===0)return void this._setSelection(e,t);let r=new Set(i.selection),o=new Set(t),n=md(r,o);this._setSelection(e,Array.from(n))}clear(){let e=this._selectionMap.values();this._trashCan.push(...e);let t=[];for(let[i,r]of this._selectionMap.entries())t.push({layer:i,added:[],removed:[...r.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(t)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();let{sources:e,view:t,_selectionMap:i,showHighlight:r}=this,o=this._vizTaskId;for(let n of e){let s=i.get(n),l=ri(n)?n.parent:n;if(l!=null&&lf(l)){if(af(l))continue;t.whenLayerView(l).then(p=>{s?.highlightHandle?.remove(),s!=null&&r&&o===this._vizTaskId&&"highlight"in p&&typeof p.highlight=="function"&&s.selection.length>0&&(s.highlightHandle=p.highlight(s.selection,"selection"))}).catch(()=>{s?.highlightHandle?.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(Z);for(let e of this.sources){let t=ri(e)?e.parent:e;if(t!=null&&Fo(t)){let i=t.on("edits",r=>{this._handleEditChanges(r,e)});this._layerEditHandles.push(i)}}}_handleEditChanges(e,t){if(e.deletedFeatures!==void 0&&e.deletedFeatures.length>0&&this._selectionMap.has(t)){let i=e.deletedFeatures.filter(r=>r.error==null).map(r=>r.objectId).filter(fe);this.removeFromSelection(t,i)}}_setSelection(e,t){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);let i=this._selectionMap.get(e);if(i===void 0||!cw(i,{selection:t})){i!==void 0&&this._trashCan.push(i),this._selectionMap.set(e,{selection:[...t]});let r=g({layer:e,selection:[...t]},Ia(i!==void 0?i.selection:[],t));this._onSelectionChange([r])}}};a([c({readOnly:!0,nonNullable:!0})],Ut.prototype,"selections",null),a([c({readOnly:!0,nonNullable:!0})],Ut.prototype,"count",null),a([c({constructOnly:!0,nonNullable:!0})],Ut.prototype,"view",void 0),a([c({readOnly:!0,nonNullable:!0})],Ut.prototype,"hasSelection",null),a([c()],Ut.prototype,"showHighlight",void 0),a([c()],Ut.prototype,"sources",null),Ut=a([f("esri.views.SelectionManager")],Ut);var af=e=>ri(e)?e.parent?.isTable===!0:e.isTable,lw=e=>e.layer!==void 0,lf=e=>e?.when!==void 0,cw=(e,t)=>{if(e==null&&t==null)return!0;if(e!=null&&t==null||e==null&&t!=null)return!1;if(e!=null&&t!=null&&e.selection!=null&&t.selection!=null){let i=[...e.selection],r=[...t.selection];if(i.length!==r.length)return!1;i.sort(),r.sort();for(let o=0;o<i.length;o++)if(i[o]!==r[o])return!1}return!0},cf=(r,o,...n)=>_(void 0,[r,o,...n],function*(e,t,i={}){let s;if(lw(e)){let l=e;s=l===void 0?null:yield l.queryFeatures(new Ua(T(g({},i),{objectIds:t}))).then(p=>({data:p,layer:e.layer}))}else{let l=e;s=l===void 0?null:yield l.queryFeatures(new Ua(T(g({},i),{objectIds:t}))).then(p=>({data:p,layer:l}))}return s}),pf=Ut;var Vo=class extends _h(S){constructor(e){super(e),this.accentColor=new vt([255,127,0]),this.textColor=new vt([255,255,255])}};a([c({type:vt,nonNullable:!0})],Vo.prototype,"accentColor",void 0),a([c({type:vt,nonNullable:!0})],Vo.prototype,"textColor",void 0),Vo=a([f("esri.views.Theme")],Vo);var ls=Vo;var yc=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],df={};function hf(e){return!!df[e]}function pw(e){for(let t of e)if(!hf(t))return!1;return!0}yc.forEach(e=>{df[e]=!0});var cs=class{constructor(t){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this._handlers.forEach(({handler:i,priority:r},o)=>this.inputManager?.installHandlers(o,[i],r))}disconnect(){this.inputManager&&this._handlers.forEach((t,i)=>this.inputManager?.uninstallHandlers(i)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(t,i,r,o){let n=Array.isArray(t)?t:t.split(",");if(!pw(n))return n.some(hf)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let s,l;Array.isArray(i)?l=i:(s=i,l=[]),typeof r=="function"?s=r:o=r,o=o??j.DEFAULT;let p=this._createUniqueGroupName(),d=new gc(this.view,n,l,s);this._handlers.set(p,{handler:d,priority:o});for(let h of n){let u=this._handlerCounts.get(h)||0;this._handlerCounts.set(h,u+1)}return this.inputManager&&this.inputManager.installHandlers(p,[d],o),De(()=>this._removeHandler(p,n))}hasHandler(t){return!!this._handlerCounts.get(t)}_removeHandler(t,i){if(this._handlers.has(t)){this._handlers.delete(t);for(let r of i){let o=this._handlerCounts.get(r);o===void 0||(o===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,o-1))}}this.inputManager&&this.inputManager.uninstallHandlers(t)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},gc=class extends F{constructor(t,i,r,o){super(!0),this._latestDragStart=void 0,this.view=t;for(let n of i)switch(n){case"click":this.registerIncoming("click",r,s=>o(uw(t,s)));break;case"double-click":this.registerIncoming("double-click",r,s=>o(mw(t,s)));break;case"immediate-click":this.registerIncoming("immediate-click",r,s=>o(fw(t,s)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,s=>o(gw(t,s)));break;case"hold":this.registerIncoming("hold",r,s=>o(yw(t,s)));break;case"drag":this.registerIncoming("drag",r,s=>{let l=this._wrapDrag(s);l&&o(l)});break;case"key-down":this.registerIncoming("key-down",r,s=>o(vw(s)));break;case"key-up":this.registerIncoming("key-up",r,s=>o(_w(s)));break;case"pointer-down":this.registerIncoming("pointer-down",r,s=>o(No(s,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,s=>o(No(s,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,s=>o(No(s,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,s=>o(ww(s)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,s=>o(bw(s)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,s=>o(No(s,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,s=>o(No(s,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,s=>{o(Sw(s))});break;case"focus":this.registerIncoming("focus",r,s=>{o(dw(s))});break;case"blur":this.registerIncoming("blur",r,s=>{o(hw(s))})}}_wrapDrag(t){let i=t.data,{x:r,y:o}=i.center,{action:n,pointerType:s,button:l}=i;if(n==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;let p=i.pointer.native,d=i.buttons,{cancelable:h,timestamp:u}=t,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return n==="end"&&(this._latestDragStart=void 0),{type:"drag",action:n,x:r,y:o,origin:m,pointerType:s,button:l,buttons:d,radius:i.radius,angle:Kd(i.angle),native:p,timestamp:u,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:v=>t.async(v),preventDefault:()=>t.preventDefault()}}};function dw(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function hw(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function uw(e,t){let{pointerType:i,button:r,buttons:o,x:n,y:s,native:l,eventId:p}=t.data,{cancelable:d,timestamp:h}=t;return{type:"click",pointerType:i,button:r,buttons:o,x:n,y:s,native:l,timestamp:h,screenPoint:H(n,s),mapPoint:Ho(e,n,s),eventId:p,cancelable:d,stopPropagation:()=>t.stopPropagation(),async:u=>t.async(u),preventDefault:()=>t.preventDefault()}}function mw(e,t){let{pointerType:i,button:r,buttons:o,x:n,y:s,native:l,eventId:p}=t.data,{cancelable:d,timestamp:h}=t;return{type:"double-click",pointerType:i,button:r,buttons:o,x:n,y:s,native:l,timestamp:h,mapPoint:Ho(e,n,s),eventId:p,cancelable:d,stopPropagation:()=>t.stopPropagation(),async:u=>t.async(u),preventDefault:()=>t.preventDefault()}}function fw(e,t){let{pointerType:i,button:r,buttons:o,x:n,y:s,native:l,eventId:p}=t.data,d=l.pointerId,{cancelable:h,timestamp:u}=t;return{type:"immediate-click",pointerId:d,pointerType:i,button:r,buttons:o,x:n,y:s,native:l,timestamp:u,mapPoint:Ho(e,n,s),eventId:p,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:m=>t.async(m),preventDefault:()=>t.preventDefault()}}function gw(e,t){let{pointerType:i,button:r,buttons:o,x:n,y:s,native:l,eventId:p}=t.data,d=l.pointerId,{cancelable:h,timestamp:u}=t;return{type:"immediate-double-click",pointerId:d,pointerType:i,button:r,buttons:o,x:n,y:s,native:l,timestamp:u,mapPoint:Ho(e,n,s),eventId:p,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:m=>t.async(m),preventDefault:()=>t.preventDefault()}}function yw(e,t){let{pointerType:i,button:r,buttons:o,x:n,y:s,native:l}=t.data,{cancelable:p,timestamp:d}=t;return{type:"hold",pointerType:i,button:r,buttons:o,x:n,y:s,native:l,timestamp:d,mapPoint:Ho(e,n,s),cancelable:p,stopPropagation:()=>t.stopPropagation(),async:h=>t.async(h),preventDefault:()=>t.preventDefault()}}function Ho(e,t,i){return e.toMap(H(t,i),{exclude:[]})}function vw(e){let{key:t,repeat:i,native:r}=e.data,{cancelable:o,timestamp:n}=e;return{type:"key-down",key:t,repeat:i,native:r,timestamp:n,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:s=>e.async(s),preventDefault:()=>e.preventDefault()}}function _w(e){let{key:t,native:i}=e.data,{cancelable:r,timestamp:o}=e;return{type:"key-up",key:t,native:i,timestamp:o,cancelable:r,stopPropagation:()=>e.stopPropagation(),async:n=>e.async(n),preventDefault:()=>e.preventDefault()}}function No(e,t){let{x:i,y:r,button:o,buttons:n,native:s,eventId:l}=e.data,p=s.pointerId,d=s.pointerType,{cancelable:h,timestamp:u}=e;return{type:t,x:i,y:r,pointerId:p,pointerType:d,button:o,buttons:n,native:s,timestamp:u,eventId:l,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}function ww(e){let{x:t,y:i,buttons:r,native:o,eventId:n}=e.data.currentEvent,{button:s}=e.data.startEvent,l=e.data.startEvent.native.pointerId,p=e.data.startEvent.native.pointerType,d=e.data.action,h={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:u,timestamp:m}=e;return{type:"pointer-drag",x:t,y:i,pointerId:l,pointerType:p,button:s,buttons:r,action:d,origin:h,native:o,timestamp:m,eventId:n,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:v=>e.async(v),preventDefault:()=>e.preventDefault()}}function bw(e){let{cancelable:t,data:i,timestamp:r}=e,{x:o,y:n,deltaY:s,native:l}=i;return{type:"mouse-wheel",x:o,y:n,deltaY:s,native:l,timestamp:r,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}function Sw(e){let{action:t,state:i,device:r}=e.data,{cancelable:o,timestamp:n}=e,{buttons:s,axes:l}=i;return{type:"gamepad",device:r,timestamp:n,action:t,buttons:s,axes:l,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}function uf(e){return[e.on("before-add",t=>{let i=t.item;if(i==null||e.includes(i))return E.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();i.onAdd()}),e.on("after-remove",t=>{let i=t.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function Uo(e){return e.visible&&e.getEditableFlag!=null&&e.getEditableFlag(ho.USER)&&e.getEditableFlag(ho.MANAGER)}var ps=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(t,i){let r=()=>t.stopPropagation();switch(t.type){case"pointer-move":ff(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(r(),t.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!gf(t))break;let o=je(t),n=Ir(o,t.pointerType,i.forEachTool);if(n==null)break;let s=n.manipulator,l=n.tool;s==null||l==null||!s.interactive||s.grabbable&&s.grabbableForEvent(t)||!s.grabbing||s.dragging||this._releaseManipulatorBeforeDragging(s,t,i),s!=null&&l!=null&&s.interactive&&s.grabbable&&s.grabbableForEvent(t)&&!s.grabbing&&(this._grabbedManipulators.set(t.pointerId,{manipulator:s,tool:l,start:o,pointerType:t.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(n.tool)),s.grabbing=!0,s.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:o}),r());break}case"pointer-up":this._draggedManipulators.has(t.pointerId)||this._handlePointerEnd(t,i);break;case"pointer-drag":{if(!gf(t))break;let o=this._grabbedManipulators.get(t.pointerId),n=o?.manipulator,s=o?.tool;if(n==null||s==null)break;let l=je(t);l.x=Va(l.x,0,i.view.width),l.y=Va(l.y,0,i.view.height);let p=o.start,d=this._draggedManipulators.get(t.pointerId);switch(t.action){case"start":case"update":t.action!=="update"&&this._grabbedManipulators.size!==1||(n.dragging=!0,d?n.events.emit("drag",{action:"update",start:p,screenPoint:l}):n.events.emit("drag",{action:"start",start:p,screenPoint:l,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{tool:s,manipulator:n,start:p}));break;case"end":n.dragging=!1,d&&n.events.emit("drag",{action:"end",start:p,screenPoint:l}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,i)}r();break}case"immediate-click":{let o=je(t),n=Ir(o,t.pointerType,i.forEachTool);if(Cw(t)||i.forEachTool(d=>{if((n==null||n.tool!==d||d.automaticManipulatorSelection)&&d.manipulators){let h=!1;d.manipulators.forEach(({manipulator:u})=>{u.selected&&(u.selected=!1,h=!0)}),h&&d.onManipulatorSelectionChanged&&d.onManipulatorSelectionChanged()}}),n==null)break;let{manipulator:s,tool:l}=n;if(!s.interactive)break;s.selectable&&l.automaticManipulatorSelection&&(s.selected=!s.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());let p=t.native.shiftKey;s.events.emit("immediate-click",{screenPoint:o,button:t.button,pointerType:t.pointerType,shiftKey:p,stopPropagation:r}),vc(s,r);break}case"click":{let o=je(t),n=Ir(o,t.pointerType,i.forEachTool),s=n?.manipulator;if(s==null||!s.interactive)break;let l=t.native.shiftKey;s.events.emit(t.type,{screenPoint:o,button:t.button,pointerType:t.pointerType,shiftKey:l}),r();break}case"double-click":{let o=je(t),n=Ir(o,t.pointerType,i.forEachTool),s=n!=null?n.manipulator:null;if(s==null||!s.interactive)break;let l=t.native.shiftKey;s.events.emit("double-click",{screenPoint:o,button:t.button,pointerType:t.pointerType,shiftKey:l,stopPropagation:r}),vc(s,r);break}case"immediate-double-click":{let o=je(t),n=Ir(o,t.pointerType,i.forEachTool),s=n!=null?n.manipulator:null;if(s==null||!s.interactive)break;let l=t.native.shiftKey;s.events.emit("immediate-double-click",{screenPoint:o,button:t.button,pointerType:t.pointerType,shiftKey:l,stopPropagation:r}),vc(s,r);break}}this._onFocusChange(i.forEachTool)}_releaseManipulatorBeforeDragging(t,i,r){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:je(i)}),this._grabbedManipulators.forEach(({manipulator:o},n)=>{o===t&&this._grabbedManipulators.delete(n)}),this._afterManipulatorRelease(r.setActiveTool)}_handlePointerEnd(t,i){let r=this._grabbedManipulators.get(t.pointerId)?.manipulator;r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:je(t)}),this._grabbedManipulators.delete(t.pointerId),this._afterManipulatorRelease(i.setActiveTool))}_onFocusChange(t){this._updateCursor(),this._updateFocusedManipulatorTools(t)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=mf(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=mf(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(t){let i=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:o})=>{i.add(o)}),this._hoveredManipulators.forEach(({tool:o})=>{r.add(o)}),t(o=>{o.hasGrabbedManipulators=i.has(o),o.hasHoveredManipulators=r.has(o);let n=this._grabbedManipulators.values(),s=od(n,({tool:l})=>l===o);o.firstGrabbedManipulator=s!=null?s.manipulator:null})}clearPointers(t,{forEachTool:i,setActiveTool:r},o=!0,n){let s=(l,p)=>l===t&&(n==null||n===p);this._grabbedManipulators.forEach(({tool:l,manipulator:p,pointerType:d},h)=>{s(l,p)&&(this._grabbedManipulators.delete(h),p.grabbing=!1,p.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:d}))}),this._draggedManipulators.forEach(({tool:l,manipulator:p},d)=>{s(l,p)&&(this._draggedManipulators.delete(d),p.dragging=!1,p.events.emit("drag",{action:"cancel"}))}),o&&this._hoveredManipulators.forEach(({tool:l,manipulator:p},d)=>{s(l,p)&&(this._hoveredManipulators.delete(d),p.hovering=!1)}),this._afterManipulatorRelease(r),this._onFocusChange(i)}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach((i,r)=>{this._updateHoveredStateForPointerAtScreenPosition(H(i.x,i.y),r,i.pointerType,t)})}handleHoverEvent(t,i){t.type!=="pointer-up"&&t.type!=="immediate-click"&&t.type!=="pointer-move"||!ff(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(je(t),t.pointerId,t.pointerType,i)}_updateHoveredStateForPointerAtScreenPosition(t,i,r,o){let n=Ir(t,r,o),s=this._hoveredManipulators.get(i)?.manipulator;n==null||n.manipulator.interactive||(n=null),n!=null&&s===n.manipulator||(s!=null&&(s.hovering=!1),n!=null?(n.manipulator.hovering=!0,this._hoveredManipulators.set(i,n)):this._hoveredManipulators.delete(i),this._onFocusChange(o))}_afterManipulatorRelease(t){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(t(null),this._revertToNullActiveTool=!1)}};function mf(e){let t=null;return ti(e,({manipulator:i})=>!(i==null||!i.interactive)&&(i.grabbing&&i.grabCursor?(t=i.grabCursor,!0):!!i.cursor&&(t=i.cursor,!0))),t}function Ir(e,t,i){let r=null;return i(o=>{if(o.manipulators==null||!Uo(o))return!1;let n=o.manipulators.intersect(e,t);return n!=null&&(r={tool:o,manipulator:n},!0)}),r}function ff(e){return e==="mouse"}function gf(e){return e.pointerType!=="mouse"||e.button===0}function Cw(e){return!!e.native.shiftKey}function vc(e,t){e?.consumesClicks&&t()}var yf="attached",_c="tools",Tw=1e3,ct=class extends S{constructor(e){super(e),this._updatingHandles=new ni,this._clock=gt,this._manipulatorState=new ps,this.tools=new L,this.cursor=null,this._interacting=!1,this._interactingTimeout=Tw,this._interactingTimeoutHandle=null,this._forEachTool=t=>{for(let i of this.tools.items)if(t(i))return}}initialize(){this.addHandles([this.view.on(yc,e=>{this._handleInputEvent(e)},j.TOOL),...uf(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void E.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;let t=this.activeTool;this._set("activeTool",e),t?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(let i of this.tools){this._updateToolEditableFlag(i);let r=Uo(i);this.activeTool!=null&&r||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!r)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Z(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([b(()=>{let{state:e}=this.view;return"camera"in e&&e.camera},()=>this._forEachManipulator(e=>e.onViewChange())),this.view.elevationProvider?.on("elevation-change",e=>this._forEachManipulator(t=>t.onElevationChange(e)))],yf):this.addHandles(b(()=>this.view.extent,()=>this._forEachManipulator(e=>e.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(yf),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:i})=>e(i,t))})}_handleInputEvent(e){let t=!1,i=T(g({},e),{stopPropagation:()=>{t=!0,e.stopPropagation()}});this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool(r=>{!t&&r.visible&&r.handleInputEvent(i)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),t||this.activeTool==null||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(_c),this._forEachTool(e=>{if(e instanceof S){let t=b(()=>[e.cursor,e.visible,e.editable],()=>{Uo(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(t,_c)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],_c)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag?.(ho.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(t=>!(t.cursor==null||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(e==null||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}get test(){}};a([c({constructOnly:!0,nonNullable:!0})],ct.prototype,"view",void 0),a([c({value:null})],ct.prototype,"activeTool",null),a([c({readOnly:!0,type:L})],ct.prototype,"tools",void 0),a([c({readOnly:!0})],ct.prototype,"cursor",void 0),a([c({readOnly:!0})],ct.prototype,"updating",null),a([c()],ct.prototype,"_interacting",void 0),a([c({readOnly:!0})],ct.prototype,"interacting",null),ct=a([f("esri.views.ToolViewManager")],ct);var Er=class extends S{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Mw.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){let e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return xw[this.deviceType]}};a([c({nonNullable:!0,readOnly:!0})],Er.prototype,"nativeIndex",void 0),a([c({type:String,readOnly:!0})],Er.prototype,"deviceType",null),a([c({type:Number,readOnly:!0})],Er.prototype,"axisThreshold",null),Er=a([f("esri.views.input.gamepad.GamepadInputDevice")],Er);var Lr=Er,Mw=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),xw={standard:.15,spacemouse:.025,unknown:0};var zo=class extends S{constructor(...e){super(...e),this.devices=new L,this.enabledFocusMode="document"}};a([c({type:L.ofType(Lr),readOnly:!0})],zo.prototype,"devices",void 0),a([c({type:["document","view","none"]})],zo.prototype,"enabledFocusMode",void 0),zo=a([f("esri.views.input.gamepad.GamepadSettings")],zo);var vf=zo;var ds=class extends S{constructor(){super(...arguments),this.gamepad=new vf}};a([c({readOnly:!0})],ds.prototype,"gamepad",void 0),ds=a([f("esri.views.input.Input")],ds);var _f=ds;var pi=class extends S{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};a([c({type:Boolean,nonNullable:!0})],pi.prototype,"enabled",void 0),a([c({type:Lr})],pi.prototype,"device",void 0),a([c({type:["pan","zoom"],nonNullable:!0})],pi.prototype,"mode",void 0),a([c({type:["forward-down","forward-up"],nonNullable:!0})],pi.prototype,"tiltDirection",void 0),a([c({type:Number,nonNullable:!0})],pi.prototype,"velocityFactor",void 0),pi=a([f("esri.views.navigation.gamepad.GamepadSettings")],pi);var wc=pi;var Ai=class extends S{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new wc,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!On()}};a([c({type:Boolean})],Ai.prototype,"browserTouchPanEnabled",void 0),a([c({type:wc,nonNullable:!0})],Ai.prototype,"gamepad",void 0),a([c({type:Boolean})],Ai.prototype,"momentumEnabled",void 0),a([c({type:Boolean})],Ai.prototype,"mouseWheelZoomEnabled",void 0),Ai=a([f("esri.views.navigation.Navigation")],Ai);var bc=Ai;var Cc,Sc=null;function Iw(e){return _(this,null,function*(){Sc||(Sc=import("./chunk-KLZMRINO.js").then(t=>Cc=t)),yield Sc,be(e)})}function Tc(e,t,i,r){return _(this,null,function*(){if(!e)return null;let o=e.spatialReference;return xn()||En(o,t)?oi(e,t):Cc?Cc.projectGeometry(e,t,i,r):(yield Promise.race([Iw(r),In(r)]),Tc(e,t,i,r))})}var z=class extends S{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Rt(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){let e=this.map?.(),t=[];return this.priorityCollection!=null&&t.push(this.priorityCollection),t.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let{layers:e,updating:t}=this._allLayers,i=null;for(let o of e){let n=this._getSupportedSpatialReferences(o);if(n.length>0){let s=this._narrowDownSpatialReferenceCandidates(i,n);s!=null&&(i=s)}if(i!=null&&i.length===1)break}if(t&&(i==null||i.length!==1))return{updating:!0};let r=this._pickSpatialReferenceCandidate(i);return{spatialReference:r?.spatialReference??null,viewingMode:r?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};let{layers:e,updating:t}=this._collectLayers([{parent:this.map?.()?.basemap,layers:this.map?.()?.basemap?.baseLayers},{layers:this.map?.()?.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){let i=e[0].tileInfo;return{tileInfo:i?.spatialReference.equals(this.spatialReference)?i:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let{layers:e,updating:t}=this._allLayers;for(let i of e)if(cu(i)){let r=lu(i);if(r)return{heightModelInfo:r,vcsWkid:i.spatialReference?.vcsWkid,latestVcsWkid:i.spatialReference?.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};let e=this._allLayers,t=e.updating,i=[];for(let r of e.layers){let o="fullExtents"in r&&r.fullExtents||(r.fullExtent!=null?[r.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:o[0],s=o.find(l=>l.spatialReference.equals(this.spatialReference))??n;if(s)return{candidates:[{extent:s,layer:r}],updating:!1};if(this._getSupportedSpatialReferences(r).length>0)for(let l of o)i.push({extent:l,layer:r})}return{candidates:i,updating:t}}get _extentTask(){let{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};let i=this._pickExtentCandidate(e),r=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&r.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=Rt(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:r.clone(),task:ii(o=>_(this,null,function*(){try{let n=yield Tc(i.extent,r,"portalItem"in i.layer?i.layer.portalItem:void 0,o);this._projectExtentTask=T(g({},this._projectExtentTask),{task:null,output:n})}catch{if(sd(o))return;this._projectExtentTask=T(g({},this._projectExtentTask),{task:null})}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(e==null)return t;let i=new Array;for(let r of e)for(let o of t){if(!r.spatialReference.equals(o.spatialReference))continue;let n=Ew(r.viewingMode,o.viewingMode);if(n!==!1){i.push({spatialReference:r.spatialReference,viewingMode:n});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){let t=this.defaultSpatialReference;return e==null||e.length<1?t?{spatialReference:t,viewingMode:null}:null:(t!=null&&e.length>1&&e.some(({spatialReference:i})=>i.equals(t))&&(e=e.filter(({spatialReference:i})=>i.equals(t))),e.length>1&&e.some(({viewingMode:i})=>i!==Wa.Local)&&(e=e.filter(({viewingMode:i})=>i!==Wa.Local)),e[0])}_getSupportedSpatialReferences(e){let t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];let i=[];for(let r of t){let o=this.getSpatialReferenceSupport(r,e);if(o!=null){let n=o.constraints??[{spatialReference:r,viewingMode:null}];for(let{spatialReference:s,viewingMode:l}of n)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!s.equals(this.userSpatialReference)||i.push({spatialReference:s,viewingMode:l})}}return i}_pickExtentCandidate(e){let t=this.spatialReference;return e.find(({extent:i})=>t.equals(i.spatialReference))||e[0]}_collectLayers(e){if(this._loadMaybe(this.map?.())!=="loaded")return{layers:[],updating:!0};let t=new Mc;for(let i of e)if(this._collectCollection(i,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(let i of e.layers){switch(this._loadMaybe(i)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(i),"layers"in i&&this._collectCollection({layers:i.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(t=>{sr(t)||console.log(t)}),"loading"):e.loadStatus:"loaded"}};a([c()],z.prototype,"required",void 0),a([c({constructOnly:!0})],z.prototype,"map",void 0),a([c({constructOnly:!0})],z.prototype,"getSpatialReferenceSupport",void 0),a([c()],z.prototype,"defaultSpatialReference",void 0),a([c()],z.prototype,"userSpatialReference",void 0),a([c()],z.prototype,"sourcePreloadCount",void 0),a([c()],z.prototype,"priorityCollection",void 0),a([c()],z.prototype,"requiresExtentInSpatialReference",void 0),a([c()],z.prototype,"suspended",void 0),a([c({readOnly:!0})],z.prototype,"ready",null),a([c({readOnly:!0})],z.prototype,"heightModelInfoReady",null),a([c({readOnly:!0})],z.prototype,"spatialReference",null),a([c({readOnly:!0})],z.prototype,"extent",null),a([c({readOnly:!0})],z.prototype,"heightModelInfo",null),a([c({readOnly:!0})],z.prototype,"vcsWkid",null),a([c({readOnly:!0})],z.prototype,"latestVcsWkid",null),a([c({readOnly:!0})],z.prototype,"viewingMode",null),a([c({readOnly:!0})],z.prototype,"tileInfo",null),a([c({readOnly:!0})],z.prototype,"mapCollections",null),a([c({readOnly:!0})],z.prototype,"_allLayers",null),a([c({readOnly:!0})],z.prototype,"_spatialReferenceTask",null),a([c({readOnly:!0})],z.prototype,"_tileInfoTask",null),a([c({readOnly:!0})],z.prototype,"_heightModelInfoTask",null),a([c({readOnly:!0})],z.prototype,"_extentCandidatesTask",null),a([c()],z.prototype,"_extentTask",null),a([c()],z.prototype,"_projectExtentTask",void 0),z=a([f("esri.views.support.DefaultsFromMap")],z);var Mc=class{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}};function Ew(e,t){return e!=null?t!=null?e===t&&e:e:t}var Go,C=Go=class extends oe.EventedMixin(Md(S)){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.handles=new hn,this.updatingHandles=new ni,this.allLayerViews=new ki({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:Lw}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new Za,this.analyses=new Ao,this.typeSpecificPreconditionsReady=!0,this.layerViews=new L,this.magnifier=new fc,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new _f,this.navigation=new bc,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new cs(this),this.persistableViewModels=new L,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this.theme=null,this.handles.add(b(()=>this.preconditionsReady,t=>{let i=this.ready;if(t?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,Go.views.add(this)):(this._lockedSpatialReference=null,Go.views.remove(this)),this.notifyChange("spatialReference"),!t&&i)this.toolViewManager?.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(t&&!i){try{this._startup()}catch(r){return void queueMicrotask(()=>{this.fatalError=new P("startup-error",null,r)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},Ft))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,At(()=>this.ready)))),this.basemapView=new Ht({view:this}),this.layerViewManager=new sf({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new ct({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new pf({view:this}),this.addHandles([b(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required=T(g({},this.defaultsFromMap.required),{extent:e}),ae),b(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},Ft),b(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},ae)])}_setupSpatialReferenceLogger(){let e=null;this.addHandles([b(()=>this.defaultsFromMap?.ready,t=>{let i=this.map?.allLayers.length>0;if(t&&!this.spatialReference&&i){if(e!=null)return;let r=De(()=>e=Rt(e));e=ii(o=>_(this,null,function*(){try{yield ld(this.spatialReferenceWarningDelay,null,o)}catch{return}finally{e=null}E.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})),this.addHandles(r,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")},{sync:!0})])}destroy(){this.destroyed||(Go.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=A(this.graphics),this.analyses=A(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),A(this.analysisViewManager),this.toolViewManager=A(this.toolViewManager),this.layerViewManager=A(this.layerViewManager),this.selectionManager=A(this.selectionManager),this.basemapView=A(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach(e=>e.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=A(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return E.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new z(g({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,t)=>this.getSpatialReferenceSupport(e,t)},this._defaultsFromMapSettings))}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||lo.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(E.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),lo.isLoadable(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get spatialReference(){let e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){let t=e.clone();return t.vcsWkid=this.defaultsFromMap.vcsWkid,t.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,t}return e}set spatialReference(e){let t=!lr(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Da}set timeZone(e){let t=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map(r=>r.toLowerCase()));this._userTimeZone=e,e===Da||e===Sd||t.has(e.toLowerCase())||i.has(e.toLowerCase())||E.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new ls}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}importLayerView(e){throw new P("importLayerView() not implemented")}hasLayerViewModule(e){return!1}validate(){return _(this,null,function*(){})}loadAsyncDependencies(){return _(this,null,function*(){})}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,t){return this.isResolved()&&!this.ready&&E.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,t)}forceReadyCycle(){this.ready&&(Ue(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}};C.views=new L,a([c()],C.prototype,"_userSpatialReference",void 0),a([c()],C.prototype,"activeTool",null),a([c({readOnly:!0})],C.prototype,"allLayerViews",void 0),a([c()],C.prototype,"groundView",void 0),a([c()],C.prototype,"animation",null),a([c()],C.prototype,"basemapView",void 0),a([c()],C.prototype,"center",null),a([c({readOnly:!0})],C.prototype,"_defaultsFromMapSettings",null),a([c()],C.prototype,"defaultsFromMap",null),a([c()],C.prototype,"fatalError",void 0),a([c({type:yt})],C.prototype,"extent",null),a([c($a(Za,"graphics"))],C.prototype,"graphics",void 0),a([c($a(Ao,"analyses"))],C.prototype,"analyses",void 0),a([c({readOnly:!0,type:Bd})],C.prototype,"heightModelInfo",null),a([c({readOnly:!0})],C.prototype,"interacting",null),a([c({readOnly:!0})],C.prototype,"navigating",null),a([c({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],C.prototype,"preconditionsReady",null),a([c({readOnly:!0})],C.prototype,"typeSpecificPreconditionsReady",void 0),a([c({type:L,readOnly:!0})],C.prototype,"layerViews",void 0),a([c()],C.prototype,"resolution",null),a([c({type:fc})],C.prototype,"magnifier",void 0),a([c({value:null,type:lc})],C.prototype,"map",null),a([c()],C.prototype,"padding",void 0),a([c({readOnly:!0})],C.prototype,"ready",void 0),a([c({type:cr})],C.prototype,"spatialReference",null),a([c()],C.prototype,"spatialReferenceWarningDelay",void 0),a([c()],C.prototype,"stationary",null),a([c({readOnly:!0})],C.prototype,"supportsGround",void 0),a([c({type:Jd})],C.prototype,"timeExtent",void 0),a([c({type:String,nonNullable:!0})],C.prototype,"timeZone",null),a([c()],C.prototype,"tools",null),a([c()],C.prototype,"toolViewManager",void 0),a([c({readOnly:!0})],C.prototype,"type",void 0),a([c({type:Number})],C.prototype,"scale",void 0),a([c({readOnly:!0})],C.prototype,"updating",void 0),a([c({readOnly:!0})],C.prototype,"initialExtentRequired",void 0),a([c({readOnly:!0})],C.prototype,"initialExtent",null),a([c()],C.prototype,"cursor",null),a([c({readOnly:!0})],C.prototype,"input",void 0),a([c({type:bc,nonNullable:!0})],C.prototype,"navigation",void 0),a([c()],C.prototype,"layerViewManager",void 0),a([c()],C.prototype,"analysisViewManager",void 0),a([c()],C.prototype,"selectionManager",void 0),a([c()],C.prototype,"width",void 0),a([c()],C.prototype,"height",void 0),a([c({readOnly:!0})],C.prototype,"resizing",void 0),a([c({value:null,readOnly:!0})],C.prototype,"size",null),a([c({readOnly:!0})],C.prototype,"suspended",void 0),a([c({readOnly:!0})],C.prototype,"viewEvents",void 0),a([c({readOnly:!0})],C.prototype,"persistableViewModels",void 0),a([c()],C.prototype,"_isValid",void 0),a([c()],C.prototype,"_readyCycleForced",void 0),a([c()],C.prototype,"_lockedSpatialReference",void 0),a([c()],C.prototype,"_userTimeZone",void 0),a([c()],C.prototype,"_lockedTimeZone",void 0),a([c({type:ls})],C.prototype,"theme",void 0),a([c({readOnly:!0,type:ls})],C.prototype,"effectiveTheme",null),C=Go=a([f("esri.views.View")],C);var wf=C;function Lw(e){return e.layerViews}var di=class extends xd{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=xi(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new P("ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,t){t||(t=pd(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};a([c({readOnly:!0})],di.prototype,"done",null),a([c({readOnly:!0,type:String})],di.prototype,"state",void 0),a([c()],di.prototype,"target",void 0),di=a([f("esri.views.ViewAnimation")],di),function(e){e.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(di||(di={}));var jo=di;function kw(e){return e instanceof Float32Array&&e.length>=2}function Ow(e){return Array.isArray(e)&&e.length>=2}function hs(e){return kw(e)||Ow(e)}var xc,zt=[0,0],hi=xc=class extends ar{constructor(e){super(e),this._viewpoint2D={center:hr(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new yt,this.id=0,this.inverseTransform=Pn(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Pn(),this.transformNoRotation=Pn(),this.displayMat3=Fn(),this.displayViewMat3=Fn(),this.viewMat3=Fn(),this.viewMat2d=Rh(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(e){this._set("pixelRatio",e),this._update()}set size(e){this._set("size",e),this._update()}set viewpoint(e){if(e){let t=this._viewpoint2D,i=e.targetGeometry;t.center[0]=i.x,t.center[1]=i.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=i.spatialReference}this._update()}copy(e){let t=this.size,i=this.viewpoint;return i&&t?(this.viewpoint=Je(i,e.viewpoint),this._set("size",dr(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}clone(){return new xc({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(e,t,i){return hs(t)?Li(e,t,this.inverseTransform):(zt[0]=t,zt[1]=i,Li(e,zt,this.inverseTransform))}toScreen(e,t,i){return hs(t)?Li(e,t,this.transform):(zt[0]=t,zt[1]=i,Li(e,zt,this.transform))}toScreenNoRotation(e,t,i){return hs(t)?Li(e,t,this.transformNoRotation):(zt[0]=t,zt[1]=i,Li(e,zt,this.transformNoRotation))}wrapMapCoordinate(e,t){dr(e,t);let[i]=t,[r]=this.center,{extent:o,spatialReference:n}=this,{xmin:s,xmax:l}=o;if(n.isWrappable){let p=_u(n)/2;s=Math.max(s,r-p),l=Math.min(l,r+p)}return(i<s||i>l)&&(e[0]=fh(i,r,n)),e}getScreenTransform(e,t){let{center:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,o=this._get("size");return gu(e,i,o,t,0,r),e}_update(){let{center:e,spatialReference:t,scale:i,rotation:r}=this._viewpoint2D,o=this._get("pixelRatio")||1,n=this._get("size"),s=new Ge({targetGeometry:new J(e[0],e[1],t),scale:i,rotation:r});if(this._set("viewpoint",s),!n||!t||!i)return;this.resolution=mu(s),this.rotation=r,this.scale=i,this.spatialReference=t,dr(this.center,e);let l=n[0]!==0?2/n[0]:0,p=n[1]!==0?-2/n[1]:0;wh(this.displayMat3,l,0,0,0,p,0,-1,1,1);let d=bh(this.viewMat3),h=za(n[0]/2,n[1]/2),u=za(-n[0]/2,-n[1]/2),m=Zd(r);Ha(d,d,h),Ch(d,d,m),Ha(d,d,u),Sh(this.displayViewMat3,this.displayMat3,d);let v=Dh(this.viewMat2d,h);return kh(v,v,m),Oh(v,v,u),hu(this.extent,s,n),yu(this.transform,s,n,o),Lh(this.inverseTransform,this.transform),vu(this.transformNoRotation,s,n,o),this.worldScreenWidth=wu(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};a([c({readOnly:!0})],hi.prototype,"id",void 0),a([c({value:1,json:{write:!0}})],hi.prototype,"pixelRatio",null),a([c({json:{write:!0}})],hi.prototype,"size",null),a([c()],hi.prototype,"spatialReference",void 0),a([c({type:Ge,json:{write:!0}})],hi.prototype,"viewpoint",null),hi=xc=a([f("esri.views.2d.ViewState")],hi);var Ic=hi;var Ec,Lc,Gt=Ec=class extends S{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Ec({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};a([c()],Gt.prototype,"left",void 0),a([c()],Gt.prototype,"top",void 0),a([c()],Gt.prototype,"right",void 0),a([c()],Gt.prototype,"bottom",void 0),Gt=Ec=a([f("esri.views.2d.PaddedViewState.Padding")],Gt);var kr=Lc=class extends Ic{constructor(...e){super(...e),this.paddedViewState=new Ic,this._updateContent=(()=>{let t=hr();return()=>{let i=this._get("size"),r=this._get("padding");if(!i||!r)return;let o=this.paddedViewState;gh(t,r.left+r.right,r.top+r.bottom),yh(t,i,t),dr(o.size,t);let n=o.viewpoint;n&&(this.viewpoint=n)}})(),this.addHandles(b(()=>[this.size,this.padding],()=>this._updateContent(),Ft)),this.padding=new Gt,this.size=[0,0]}set padding(e){this._set("padding",e||new Gt)}set viewpoint(e){if(e){this.paddedViewState.viewpoint=e;let t=this._viewpoint2D;if(this._get("padding")){let i=e.clone();Su(i,e,this._get("size"),this._get("padding"));let r=i.targetGeometry;t.center[0]=r.x,t.center[1]=r.y,t.rotation=i.rotation,t.scale=i.scale,t.spatialReference=r.spatialReference}else{let i=e.targetGeometry;t.center[0]=i.x,t.center[1]=i.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=i.spatialReference}this._update()}}clone(){return new Lc({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};a([c()],kr.prototype,"paddedViewState",void 0),a([c({type:Gt})],kr.prototype,"padding",null),a([c()],kr.prototype,"viewpoint",null),kr=Lc=a([f("esri.views.2d.PaddedViewState")],kr);var Or=kr;var Bo=class{constructor(t){this._view=t,this.viewpoint=new Ge({targetGeometry:new J,scale:0,rotation:0})}get view(){return this._view}get size(){let[t,i]=this._view.size;return Math.sqrt(t*t+i*i)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return fu(this.center.spatialReference)}pixelsPerPanAtZoom(t){return 1/(t*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(t){return 1/(t*this.scaleToResolutionFactor)}pixelsPerRotateAtZoom(t){return this.size/2}compareTo(t,i){i.pan=Gd(this.center,t.center);let r=Math.abs(t.rotation-this.rotation);r=r>=180?360-r:r,i.rotate=_n(r),i.sourceZoom=this.scale,i.targetZoom=t.scale}interpolate(t,i,r){let{pan:o,rotate:n,zoom:s,zoomOffset:l}=r,{center:p}=this;p.spatialReference=t.center.spatialReference,p.x=co(t.center.x,i.center.x,o),p.y=co(t.center.y,i.center.y,o),this.viewpoint.scale=co(t.scale,i.scale+l,s);let d=t.rotation,h=i.rotation;Math.abs(h-d)>=180&&(d+=360*(d<h?1:-1)),this.viewpoint.rotation=co(d,h,n)}copyFrom(t){Je(this.viewpoint,t.viewpoint),this._view=t.view}};var kc=e=>e*e,bf=e=>1-kc(1-e);var Dw=e=>2**(10*(e-1)),Sf=e=>1-Dw(1-e);function it(e){let t=2*(e-Math.sqrt((e-1)*e)),i=t/2/e;return r=>r<i?e*r*r:t*r-t+1}function rt(e,t){return(i,r)=>i<t?t*e(i/t,r):1-e((1-i)/(1-t),r)*(1-t)}var ek=rt(it(1),1),tk=rt(it(1),0),Oc=rt(it(1),.5),ik=rt(it(2),1),rk=rt(it(2),0),ok=rt(it(2),.5),nk=rt(it(3),1),sk=rt(it(3),0),ak=rt(it(3),.5),lk=rt(it(4),1),ck=rt(it(4),0),pk=rt(it(4),.5);var us=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};var Fi={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},Dc=T(g({},Fi),{maxDuration:4e3});var fs=class e{constructor(t){this._createCamera=t,this.compared=new us,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Fi.desiredScreenFlow},this.source=t(),this.target=t()}clone(){let t=new e(this._createCamera);return t.copyFrom(this),t}copyFrom(t){this.update(t.source,t.target,t.settings)}update(t,i,r){this.source!==t&&this.source.copyFrom(t),this.target!==i&&this.target.copyFrom(i),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow!=null?r.desiredScreenFlow:Fi.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(t){let i=this.target.pixelsPerPanAtZoom(t);return this.halfWindowSize/i}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>vn()}get hasFov(){return Math.abs(this.compared.fov)>vn()}get hasRotate(){return this.compared.rotate>vn()}};var gs=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}};var Tf=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,t)=>e+t.time,0)}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,r=0,o=this.definition,n=this.segments.reduce((s,l)=>s||l.definition.hasZoom,!1);for(let s=0;s<this.segments.length;s++){let l=this.segments[s],p=l.definition;if(e<=l.time||s===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:e/l.time,t),o.hasPan&&!isNaN(t.pan)&&isFinite(o.compared.pan)?t.pan=(i+p.compared.pan*t.pan)/o.compared.pan:t.pan=1,o.hasRotate&&!isNaN(t.rotate)&&isFinite(o.compared.rotate)?t.rotate=(r+p.compared.rotate*t.rotate)/o.compared.rotate:t.rotate=1,n&&!isNaN(t.zoom)&&isFinite(p.compared.targetZoom)){let{sourceZoom:d,targetZoom:h}=p.compared,u=t.zoom*(h-d)+d,m=this.segments[0].definition.compared.sourceZoom,v=this.segments[this.segments.length-1].definition.compared.targetZoom,w=Math.abs(h-m)>Math.abs(d-m)?h:d;t.zoomOffset=w-v,t.zoom=(u-m)/(w-m)}else t.zoom=1;return t}e-=l.time,i+=p.compared.pan,r+=p.compared.rotate}}segmentInterpolateComponentsAt(e,t,i){e.interpolateComponentsAt(t,i)}};var Dr=class{get time(){return this._time}constructor(t){t&&this.update(t)}update(t){t&&(this.definition?this.definition.copyFrom(t):this.definition=t.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){let t=this.definition,i=t.compared,r=i.sourceZoom,o=i.targetZoom;this._zoomSign=r>o?1:-1,this._panPixelsAtSource=i.pan*t.source.pixelsPerPanAtZoom(r);let n=(t.source.pixelsPerRotateAtZoom(r)+t.target.pixelsPerRotateAtZoom(o))/2;this._rotatePixels=i.rotate*n}_updatePixelFlow(){let t=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom,{hasZoom:r,hasPan:o,hasRotate:n}=this.definition,s=0,l=0;r&&(o&&(s=(i/t-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),n&&(l=this._zoomSign*(Math.log(t/i)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;let p=this.definition.desiredPixelFlow;if(r&&o&&n){let d=s+l+s*l;this._zoomPixelFlow=s*l/d*p,this._panPixelFlow=l/d*p,this._rotatePixelFlow=s/d*p}else if(r&&o){let d=1+s;this._zoomPixelFlow=s/d*p,this._panPixelFlow=1/d*p}else if(r&&n){let d=1+l;this._zoomPixelFlow=l/d*p,this._rotatePixelFlow=1/d*p}else if(o&&n){let d=this._panPixelsAtSource/this._rotatePixels,h=1+d;this._panPixelFlow=d/h*p,this._rotatePixelFlow=1/h*p}else o?this._panPixelFlow=p:r?this._zoomPixelFlow=p:n&&(this._rotatePixelFlow=p);this._time=this.rotateTime??this.zoomTime??this.panTime??this.fovTime??0}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:null}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:null}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/Rw:null}get panTime(){if(this.definition.hasPan){if(this.definition.hasZoom){let t=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,i=t*this._panPixelsAtSource;return Math.log(i*(this._zoomPixelFlow/this._panPixelFlow)+1)/(t*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}}_interpolateComponentsZoom(t){if(t===0||t===1)return t;if(this.definition.hasZoom){let i=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(i*(i/r)**-t-i)/(r-i)}return t}_interpolateComponentsFov(t){if(t===0)return this.definition.segmentStart;if(t===1)return this.definition.segmentEnd;if(this.definition.hasFov){let{segmentStart:i,segmentEnd:r}=this.definition;return i+t*(r-i)}return this.definition.segmentStart}_interpolateComponentsPan(t){if(t===0||t===1)return t;if(this.definition.hasPan&&this.definition.hasZoom){let i=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(i*t*this._time)-1))/(i*Math.LN2)}return t}_interpolateComponentsRotate(t){return t}interpolateComponentsAt(t,i){t=Math.min(Math.max(t,0),1),i.zoom=this._interpolateComponentsZoom(t),i.pan=this._interpolateComponentsPan(t),i.rotate=this._interpolateComponentsRotate(t),i.zoomOffset=0,i.fov=this._interpolateComponentsFov(t)}},Rw=_n(90);function Mf(e,t,i){let r=t-e.compared.sourceZoom,o=e.halfWindowPanAtZoom(r);return-e.halfWindowSize*(i.ascensionFactor*Math.LN2*e.compared.pan+o)*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2*o)}function xf(e,t,i){let r=1/t,o=Math.log(e.compared.sourceZoom*r),n=1/e.desiredPixelFlow,s=1/Math.LN2,l=t-e.compared.sourceZoom,p=1/l,d=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(l))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*r*n*s*p*d-e.halfWindowSize*o*n*s*p+e.halfWindowSize*o*n*s*d/(l*l)}function If(e,t,i){let r=t-e.compared.sourceZoom,o=1/r,n=1/t,s=Math.log(e.compared.sourceZoom*n),l=(i.ascensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(r))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*o*(-2*o*n*l+2*o*s+2*n-2*s*l/(r*r)-l/(t*t))/(e.desiredPixelFlow*Math.LN2)}function Ef(e,t){return-e.halfWindowSize*Math.log(e.compared.sourceZoom/t)/(e.desiredPixelFlow*Math.LN2)}function Lf(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function kf(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function Of(e,t,i){return-e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t))}function Df(e,t,i){return e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t))}function Rf(e,t,i){return-2*e.compared.pan*e.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(e.desiredPixelFlow*e.halfWindowPanAtZoom(t*t*t))}function Pf(e,t,i){return e.halfWindowSize*(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*e.halfWindowPanAtZoom(-t+e.compared.targetZoom))}function Af(e,t,i){let r=Math.log(t/e.compared.targetZoom),o=1/e.desiredPixelFlow,n=1/Math.LN2,s=-t+e.compared.targetZoom,l=1/s,p=(-e.halfWindowPanAtZoom(t)-i.descensionFactor*Math.LN2*e.compared.pan+e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return-e.halfWindowSize*r*o*n*l+e.halfWindowSize*r*o*n*p/(s*s)+e.halfWindowSize*o*n*l*p/t}function Ff(e,t,i){let r=t-e.compared.targetZoom,o=1/r,n=1/t,s=Math.log(t/e.compared.targetZoom),l=(e.halfWindowPanAtZoom(t)+i.descensionFactor*Math.LN2*e.compared.pan-e.halfWindowPanAtZoom(e.compared.targetZoom))/e.halfWindowPanAtZoom(1);return e.halfWindowSize*o*(-2*o*n*l-2*o*s+2*n+2*s*l/(r*r)-l/(t*t))/(e.desiredPixelFlow*Math.LN2)}function Vf(e,t){return e.halfWindowSize*Math.log(t/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2)}function Nf(e,t){return e.halfWindowSize/(t*e.desiredPixelFlow*Math.LN2)}function Hf(e,t){return-e.halfWindowSize/(t*t*e.desiredPixelFlow*Math.LN2)}function Uf(e){let t=e.compared.sourceZoom-e.compared.targetZoom;if(t===0)return e.compared.pan*e.halfWindowSize/(e.desiredPixelFlow*e.halfWindowPanAtZoom(e.compared.sourceZoom));let i=Math.LN2*e.compared.pan,r=t,o=e.halfWindowPanAtZoom(r),n=e.halfWindowSize*Math.log(e.compared.sourceZoom/e.compared.targetZoom)/(e.desiredPixelFlow*Math.LN2*o);return e.compared.sourceZoom<=e.compared.targetZoom?n*(i-o):n*(i+o)}function zf(e,t){let i=Pw(e,t),r={ascensionFactor:t.ascensionFactor!=null?t.ascensionFactor:.5,descensionFactor:t.descensionFactor!=null?t.descensionFactor:.5},o=r.ascensionFactor===0,n=r.descensionFactor===0,s=o?Ef:Mf,l=o?Lf:xf,p=o?kf:If,d=n?Vf:Pf,h=n?Nf:Af,u=n?Hf:Ff,m=Q=>s(e,Q,r)+Of(e,Q,r)+d(e,Q,r),v=Q=>l(e,Q,r)+Df(e,Q,r)+h(e,Q,r),w=Q=>p(e,Q,r)+Rf(e,Q,r)+u(e,Q,r),M=m(i),V=Uf(e),k,Yt=t.maximumIterations||20,re=t.maximumDistance!=null?t.maximumDistance:1/0;for(k=0;k<Yt;k++){let Q=t.desiredSlope??1e-6,qe=v(i);Math.abs(qe)>Q&&(qe+=Q);let mt=qe/w(i);if(isNaN(mt)||i>=re&&mt<0){if(!isFinite(re))return null;i=re,M=m(i);break}if(i-=mt,i<e.compared.sourceZoom||i<e.compared.targetZoom)return null;let Zi=m(i);if(Math.abs(Zi-M)/M<=.005)break;M=Zi}return M>V*(1-.3)||i<e.compared.sourceZoom||i<e.compared.targetZoom?null:i}function Pw(e,t){let i=Math.max(e.compared.sourceZoom,e.compared.targetZoom),r=e.source.zoomAtPixelsPerPan(e.desiredPixelFlow/e.compared.pan)/2;return r<i?t.maximumDistance!=null?i+(t.maximumDistance-i)/2:1.5*i:t.maximumDistance?Math.min(t.maximumDistance,r):r}var ys=class extends Tf{constructor(t,i){super(),this._preallocSegments=[new Dr,new Dr,new Dr],this._ascensionSegment=null,this._descensionSegment=null,this.update(t,i)}update(t,i){if(!t)return;this.definition?this.definition.copyFrom(t):this.definition=t.clone();let r=i?.apex?zf(t,i.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r?this._updateWithApex(r,i?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(t,i,r){t.interpolateComponentsAt(i,r),t===this._ascensionSegment?r.zoom=bf(r.zoom):t===this._descensionSegment&&(r.zoom=kc(r.zoom))}_updateWithApex(t,i){let[r,o,n]=this._preallocSegments,s=i?.ascensionFactor??.5,l=Math.min(1-s,i?.ascensionFactor!=null&&i.descensionFactor!=null?i.descensionFactor:.5),p=1-s-l;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=t,r.definition.compared.pan=this.definition.compared.pan*s,r.definition.compared.rotate=this.definition.compared.rotate*s,r.definition.segmentEnd=s,r.update(),this._ascensionSegment=r,this.segments.push(r),p>0&&(o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.copyFrom(this.definition),o.definition.compared.sourceZoom=t,o.definition.compared.targetZoom=t,o.definition.compared.pan=this.definition.compared.pan*p,o.definition.compared.rotate=this.definition.compared.rotate*p,o.definition.segmentStart=r.definition.segmentEnd,o.definition.segmentEnd=r.definition.segmentEnd+p,o.update(),this.segments.push(o)),n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.sourceZoom=t,n.definition.compared.pan=this.definition.compared.pan*l,n.definition.compared.rotate=this.definition.compared.rotate*l,n.definition.segmentStart=s+p,n.update(),this._descensionSegment=n,this.segments.push(n)}_updateWithoutApex(){let[t]=this._preallocSegments;t.update(this.definition),this.segments.push(t)}};var Aw=new gs,Gf=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=Oc,this.definition=new fs(e),this.path=new ys}update(e,t,i){this.definition.update(e,t,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings(hd(isFinite(this.path.time)?this.path.time:0),i),this._easing=i.easing??(this._time>=1e3?Oc:Sf)}cameraAt(e,t){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);let i=this.path.interpolateComponentsAt(e,Aw);t.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){let t=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(i-t)}_applyTimeSettings(e,t){let i=t.speedFactor!=null?t.speedFactor:1,r=t.minDuration??Fi.minDuration/i,o=t.maxDuration??Fi.maxDuration/i;return e=t.duration!=null?t.duration:Math.min(Math.max(e/i,r),o)}};var jf=2e3,Fw=64,Rc=class{constructor(t){this._view=t,this._animation=new Gf(()=>new Bo(this._view)),this._current=new Bo(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(t,i,r={}){Je(this._current.viewpoint,t),Je(this._source.viewpoint,t),Je(this._target.viewpoint,i),this._animation.update(this._source,this._target,r)}applyRatio(t,i){this._animation.cameraAt(i,this._current),Je(t,this._current.viewpoint)}},Rr=class extends S{constructor(e){super(e),this._animation=null,this._destinationViewState=new Or,this.updateFunction=null,this.easing=Bh.ease,this.viewpoint=new Ge({targetGeometry:new J,scale:0,rotation:0}),this._updateTask=st({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new Rc(e.view)}destroy(){this._updateTask=Z(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,t,i){this.stop();let r=this.viewpoint;Je(r,t);let o=(typeof i?.easing=="string"?Wh(i.easing):i?.easing)||this.easing,n=e.target;this._transition.update(this.viewpoint,n,{apex:{maximumDistance:Math.min(Math.min(t.scale,n.scale)*Fw,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:i?.animationMode==="auto"?1/0:i?.maxDuration??Dc.maxDuration,speedFactor:i?.speedFactor,easing:typeof o=="function"?l=>o(l):void 0}),i?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=n,Vw(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,n,{duration:0}));let s=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;let i=new jo({target:e.clone()}),r=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(r,r),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){let t=this.animation;if(t&&t.state!==jo.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{let i=performance.now()-this._startTime,r=this._transition.duration,o=r>0?i/r:1,n=o>=1;this._transition.applyRatio(this.viewpoint,o),n&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function Vw(e,t,i,r){if(t?.duration!=null)return!0;let{time:o,isLinear:n}=e,s=t?.speedFactor||1,l=t?.maxDuration??Dc.maxDuration/s;if(ie("esri-goto-debug")&&(console.log("speed factor:",s),console.log("adjusted duration:		",o),console.log("adjusted max duration:	",l),console.log("is linear:",n)),o>l)return ie("esri-goto-debug")&&console.warn(`failed "auto" heuristic: animations must be shorter than ${l/1e3}s`),!1;if(n){let d=hr(),h=H(...r.toScreen(d,...i.center)),u=H(...i.toScreen(d,...r.center)),m=u!=null&&u.x>-(1.5-.5)*i.size[0]&&u.x<(1.5+.5)*i.size[0]&&u.y>-(1.5-.5)*i.size[1]&&u.y<(1.5+.5)*i.size[1],v=h!=null&&h.x>-(1.5-.5)*r.size[0]&&h.x<(1.5+.5)*r.size[0]&&h.y>-(1.5-.5)*r.size[1]&&h.y<(1.5+.5)*r.size[1];if(ie("esri-goto-debug")&&(console.log(`dest is within ${1.5} screens at start view:`,m),console.log(`start is within ${1.5} screens at dest view:`,v)),o>jf/s&&!m&&!v)return ie("esri-goto-debug")&&console.warn(`failed "auto" heuristic: linear animations must be...
  - shorter than ${jf/1e3/s}s, or
  - shorter than ${l/1e3}s and the destination is close enough to the starting screen, or
  - shorter than ${l/1e3}s and the start point is close enough to the destination screen`),!1}return!0}a([c()],Rr.prototype,"easing",void 0),a([c()],Rr.prototype,"view",void 0),a([c()],Rr.prototype,"viewpoint",void 0),Rr=a([f("esri.views.2d.AnimationManager")],Rr);var Bf=Rr;var vs=class{constructor(t){this.view=t,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation&&!("then"in this.view.animation.target)&&(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=()=>{if(this._updateRequested=!1,this.view?.destroyed)return;let{allLayerViews:i,graphicsView:r,labelManager:o,state:{id:n}}=this.view;i.forEach(this._updateLayerView,this),o!=null&&(o.lastUpdateId!==n&&(o.viewChange(),o.lastUpdateId=n),o.updateRequested&&o.processUpdate(this._updateParameters)),r!=null&&(r.lastUpdateId!==n&&(r.viewChange(),r.lastUpdateId=n),r.updateRequested&&r.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle?.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;let t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,targetState:new Or,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=b(()=>t.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=st(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){if(!t.attached)return void this.requestUpdate();let i=this.view.state,r=t.lastUpdateId;r!=null&&(this.stationary||t.moving)||(t.moving=!0),r!==i.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=i.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&t.layerViews?.forEach(this._updateLayerView,this)}};var Wo=class extends S{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}goTo(e,t){return _(this,null,function*(){if(!e)return void E.getLogger(this).error("#goTo()","target cannot be null or undefined");let i=new jo;this.view.animation=i,yield At(()=>this.view.ready,t);let r=T(g({},t),{animate:t?.animate??!On(),animationMode:t?.animationMode??"auto"}),{extent:o,spatialReference:n,size:s,viewpoint:l,constraints:p,padding:d,allLayerViews:h}=this.view,u=du(e,{extent:o,spatialReference:n,size:s,viewpoint:l,constraints:p,padding:d,allLayerViews:h,pickClosestTarget:t?.pickClosestTarget??!0});return i?.update(u),this._gotoTask={},r.animate?this._gotoAnimated(u,r):this._gotoImmediate(u,r)})}_gotoImmediate(e,t){let i=this._gotoTask,r=this.view.animation,o=e.then(n=>{if(be(t),i!==this._gotoTask)throw new P("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=r.target=n,r.finish()});return this._cancellableGoTo(i,r,o,t)}_gotoAnimated(e,t){let i=this._gotoTask,r=this.view.animation;if(!r)return Promise.resolve();let o=e.then(n=>{if(be(t),i!==this._gotoTask)throw new P("view:goto-interrupted","Goto was interrupted");return r.update(n),this.view.animationManager.animate(r,this.view.viewpoint,t),r.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,r,o,t)}_cancellableGoTo(e,t,i,r){let o=()=>e===this._gotoTask;return ei(i,r).finally(()=>{o()&&(t.done||t.stop())})}};a([c({constructOnly:!0})],Wo.prototype,"view",void 0),Wo=a([f("esri.views.2d.GoToManager")],Wo);function Y(){return Promise.all([import("./chunk-OG3VJURW.js"),import("./chunk-JZJZTRGD.js")])}var $o=()=>Y().then(()=>import("./chunk-J7RGW3D5.js")),Pr=()=>Y().then(()=>import("./chunk-QPP3X6VE.js")),Wf={"base-dynamic":()=>Y().then(()=>import("./chunk-WD2UYXXN.js")),"base-tile":$o,"bing-maps":$o,catalog:()=>Y().then(()=>import("./chunk-U2AYWYEC.js")),"catalog-dynamic-group":()=>Y().then(()=>import("./chunk-D4E7PKL5.js")),"catalog-footprint":()=>Y().then(()=>import("./chunk-TTRMYILC.js")),csv:Pr,"geo-rss":()=>Y().then(()=>import("./chunk-6RH7MGFU.js")),feature:Pr,geojson:Pr,graphics:()=>Y().then(()=>import("./chunk-OYNNY66T.js")),group:()=>Y().then(()=>import("./chunk-F77UWWUD.js")),imagery:()=>Y().then(()=>import("./chunk-PWZMAYNF.js")),"imagery-tile":()=>Y().then(()=>import("./chunk-HAP7IIPR.js")),kml:()=>Y().then(()=>import("./chunk-R6SHPWYZ.js")),"knowledge-graph":()=>Y().then(()=>import("./chunk-VKSUWD3O.js")),"link-chart":()=>Y().then(()=>import("./chunk-VKSUWD3O.js")),"knowledge-graph-sublayer":Pr,"map-image":()=>Y().then(()=>import("./chunk-JGFYZ3RZ.js")),"map-notes":()=>Y().then(()=>import("./chunk-3ZEGV35L.js")),media:()=>Y().then(()=>import("./chunk-LPWHH3Q5.js")),"ogc-feature":()=>Y().then(()=>import("./chunk-GMRM56KP.js")),"open-street-map":$o,"oriented-imagery":Pr,route:()=>Y().then(()=>import("./chunk-FOSXS5A3.js")),stream:()=>Y().then(()=>import("./chunk-QTU5GZDC.js")),"subtype-group":()=>Y().then(()=>import("./chunk-WB4G6LY6.js")),tile:$o,"vector-tile":()=>Y().then(()=>import("./chunk-P7OLI7G2.js")),video:()=>Y().then(()=>import("./chunk-6CHJAAYC.js")),wcs:()=>Y().then(()=>import("./chunk-HAP7IIPR.js")),"web-tile":$o,wfs:Pr,wms:()=>Y().then(()=>import("./chunk-XDXQ6D7I.js")),wmts:()=>Y().then(()=>import("./chunk-6VJURNPV.js")),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function Nw(e){let t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",i=t.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new P(`${i}:view-not-supported`,`${t} is not supported in 2D`)}var Pc={hasLayerViewModule:e=>Wf[e.type]!=null,importLayerView:e=>{let t=Wf[e.type];if(t==null)throw Nw(e);return t(e)}};function $f(e,t){let{spatialReference:i}=t,r=[t.x,t.y],o=Number.POSITIVE_INFINITY,n=0,s=0,l=[0,0],p=e.type==="extent"?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:e.rings;for(let d of p)for(let h=0;h<d.length-1;h++){Wd(l,r,d,h);let u=vh(r,l);u<o&&(o=u,n=l[0],s=l[1])}return{coordinate:new J({x:n,y:s,spatialReference:i}),distance:o}}var Ac,ui=Ac=class extends pr(S){constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return oi(this.geometry,this.spatialReference)}catch(e){return E.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:e}),null}return this.geometry}constrain(e,t){if(this.normalizedGeometry==null)return e;let i=e.targetGeometry;if(this.normalizedGeometry.type==="extent"?yn(this.normalizedGeometry,i):jd(this.normalizedGeometry,i))return e;let{coordinate:r}=$f(this.normalizedGeometry,i);return r&&(e.targetGeometry=r),e}clone(){return new Ac({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};a([c({constructOnly:!0})],ui.prototype,"geometry",void 0),a([c({readOnly:!0})],ui.prototype,"normalizedGeometry",null),a([c({constructOnly:!0})],ui.prototype,"spatialReference",void 0),ui=Ac=a([f("esri.views.2d.constraints.GeometryConstraint")],ui);var Fc,Zo=Fc=class extends pr(S){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t&&(this.rotationEnabled||(e.rotation=t.rotation)),e}clone(){return new Fc({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};a([c()],Zo.prototype,"enabled",void 0),a([c()],Zo.prototype,"rotationEnabled",void 0),Zo=Fc=a([f("esri.views.2d.constraints.RotationConstraint")],Zo);var Vc=Zo;var Nc,Re=Nc=class extends pr(S){constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:i,maxScale:r,minZoom:o,maxZoom:n}=this,s=-1,l=-1,p=!1,d=!1;if(i!==0&&r!==0&&i<r&&([i,r]=[r,i]),!t?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",r);t=t.map(h=>h.clone()),t.sort((h,u)=>u.scale-h.scale),t.forEach((h,u)=>h.level=u);for(let h of t)!p&&i>0&&i>=h.scale&&(s=h.level,p=!0),!d&&r>0&&r>=h.scale&&(l=e?e.level:-1,d=!0),e=h;o===-1&&(o=i===0?0:s),n===-1&&(n=r===0?t.length-1:l),o=Math.max(o,0),o=Math.min(o,t.length-1),n=Math.max(n,0),n=Math.min(n,t.length-1),o>n&&([o,n]=[n,o]),i=t[o].scale,r=t[n].scale,t.splice(0,o),t.splice(n-o+1,t.length),t.forEach((h,u)=>{this._lodByScale[h.scale]=h,this._scales[u]=h.scale}),this._set("effectiveLODs",t),this._set("effectiveMinZoom",o),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",r)}constrain(e,t){if(t&&e.scale===t.scale)return e;let i=this.effectiveMinScale,r=this.effectiveMaxScale,o=e.targetGeometry,n=t&&t.targetGeometry,s=r!==0&&e.scale<r,l=i!==0&&e.scale>i;if(s||l){let p=l?i:r;if(t&&n){let d=(p-t.scale)/(e.scale-t.scale);o.x=n.x+(o.x-n.x)*d,o.y=n.y+(o.y-n.y)*d}e.scale=p}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);let t=this.scaleToZoom(e.scale),i=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(i>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);let t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];let i=Math.floor(e),r=Math.ceil(e);return t[i]+(e-i)*(t[r]-t[i])}scaleToZoom(e){if(!this.effectiveLODs)return-1;let t=this._scales,i,r;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let o=0;o<t.length-1;o++){if(i=t[o],r=t[o+1],r===e)return o+this.effectiveMinZoom+1;if(i>e&&r<e)return o+this.effectiveMinZoom+1-(e-r)/(i-r)}return-1}snapToClosestScale(e){if(!this.effectiveLODs)return e;let t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;let i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;let i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i-1)}clone(){return new Nc({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce((t,i)=>Math.abs(i-e)<=Math.abs(t-e)?i:t,this._scales[0])),this._lodByScale[e].scale}};a([c({readOnly:!0})],Re.prototype,"effectiveLODs",void 0),a([c({readOnly:!0})],Re.prototype,"effectiveMinZoom",void 0),a([c({readOnly:!0})],Re.prototype,"effectiveMaxZoom",void 0),a([c({readOnly:!0})],Re.prototype,"effectiveMinScale",void 0),a([c({readOnly:!0})],Re.prototype,"effectiveMaxScale",void 0),a([c()],Re.prototype,"lods",void 0),a([c()],Re.prototype,"minZoom",void 0),a([c()],Re.prototype,"maxZoom",void 0),a([c()],Re.prototype,"minScale",void 0),a([c()],Re.prototype,"maxScale",void 0),a([c()],Re.prototype,"snapToZoom",void 0),Re=Nc=a([f("esri.views.2d.constraints.ZoomConstraint")],Re);var Hc=Re;var Hw={base:null,key:"type",typeMap:{extent:yt,polygon:Sn}},se=class extends S{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new L}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){let e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new ui({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new Vc({rotationEnabled:this.rotationEnabled})}get _zoom(){let e=this._get("_zoom"),t=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,r=this.maxZoom,o=this.minScale,n=this.maxScale,s=this.snapToZoom;return e&&e.lods===t&&e.minZoom===i&&e.maxZoom===r&&e.minScale===o&&e.maxScale===n&&e.snapToZoom===s?e:new Hc({lods:t,minZoom:i,maxZoom:r,minScale:o,maxScale:n,snapToZoom:s})}canZoomInTo(e){let t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){let t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),this.customConstraints.forEach(i=>i.constrain(e,t)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(t=>t.applyPanConstraint?.(e)),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};a([c({readOnly:!0})],se.prototype,"effectiveLODs",null),a([c({readOnly:!0})],se.prototype,"effectiveMinScale",null),a([c({readOnly:!0})],se.prototype,"effectiveMaxScale",null),a([c({readOnly:!0})],se.prototype,"effectiveMinZoom",null),a([c({readOnly:!0})],se.prototype,"effectiveMaxZoom",null),a([c({types:Hw,value:null})],se.prototype,"geometry",null),a([c({type:[ah]})],se.prototype,"lods",void 0),a([c()],se.prototype,"minScale",void 0),a([c()],se.prototype,"maxScale",void 0),a([c()],se.prototype,"minZoom",void 0),a([c()],se.prototype,"maxZoom",void 0),a([c()],se.prototype,"rotationEnabled",void 0),a([c()],se.prototype,"snapToZoom",void 0),a([c({type:L})],se.prototype,"customConstraints",void 0),a([c()],se.prototype,"view",void 0),a([c({readOnly:!0})],se.prototype,"version",null),a([c({type:ui,readOnly:!0})],se.prototype,"_geometry",null),a([c({type:Vc})],se.prototype,"_rotation",null),a([c({readOnly:!0,type:Hc})],se.prototype,"_zoom",null),se=a([f("esri.views.2d.MapViewConstraints")],se);var Uc=se;var Ce=class extends S{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([b(()=>this.constraints?.version,t=>{this.constraints&&t&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},Ft)])}get center(){if(!this.ready)return this._get("center");let{center:e,spatialReference:t}=this.state.paddedViewState;return this.state.commitProperty("id"),new J({x:e[0],y:e[1],spatialReference:t})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let t;try{t=this._project(e,this.state.spatialReference)}catch(r){return void E.getLogger(this).error(new P("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:r}))}let i=this.viewpoint;Ya(i,i,t),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void E.getLogger(this).error(new P("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let t;try{t=this._project(e,this.state.spatialReference)}catch(r){return void E.getLogger(this).error(new P("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:r}))}let i=this.viewpoint;uu(i,i,t,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);let t=this.viewpoint;Tu(t,t,e),this.viewpoint=t}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);let i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}let t=this.viewpoint;Qa(t,t,e),this.viewpoint=t}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let t,i;try{t=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?i=new P("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(i=new P("mapview:invalid-viewpoint","geometry not defined"))}catch(o){i=new P("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(i)return void E.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;let r=new Ge({targetGeometry:new J,scale:0,rotation:0});Je(r,t),this.constraints?.constrain(r,this.state.paddedViewState.viewpoint),this.state.viewpoint=r,this._set("viewpoint",r)}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);let r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}let t=this.constraints?.zoomToScale(e)??0;if(!t)return void this._set("zoom",-1);let i=this.viewpoint;Qa(i,i,t),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};let{padding:t,constraints:i}=this,r=this._get("center"),o=this._get("extent"),n=this._get("scale"),s=this._get("rotation"),l=this._get("viewpoint"),p=this._get("zoom"),d=p!=null&&i!=null&&i.zoomToScale(p)||void 0,h,u,m,v=l?.rotation,w=l?.targetGeometry;w?.type==="extent"?h=w:w?.type==="point"&&(u=w,m=l?.scale);let M=o??h;return{center:r??u??M?.center,rotation:s??v,scale:(n??d??m??(M&&An(M,[e[0]-t.left-t.right,e[1]-t.top-t.bottom])))||void 0}}startup(e,t,i,r){let o=e.targetGeometry;try{this._project(e,i)}catch(n){E.getLogger(this).warn(new Oa("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:o.toJSON(),spatialReference:i,error:n})),e.targetGeometry=r||new J({x:0,y:0,spatialReference:i})}this.constraints?.fit(e),this._set("state",new Or({padding:this.padding,size:t,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);let{center:[e,t],spatialReference:i,rotation:r,scale:o}=this.state.paddedViewState,n=new J({x:e,y:t,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",n),this._set("zoom",-1),this._set("rotation",r),this._set("scale",o),this._set("state",null)}changeSpatialReference(e){let t=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=t.scale;else{let l=t.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=l}let i=t.clone(),[r,o]=t.center,n=null;try{n=this._project(new J({x:r,y:o,spatialReference:t.spatialReference}),e)}catch(l){Rd()||E.getLogger(this).warn(new Oa("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:n?.toJSON(),spatialReference:e,error:l}))}n||(n=new J({x:0,y:0,spatialReference:e}));let s=Ya(new Ge({targetGeometry:new J,scale:0,rotation:0}),t.viewpoint,n);i.viewpoint=s;try{let p=[t.size[0]/2,t.size[1]/2],d=[p[0]+20,p[1]],h=t.toMap([0,0],d),{x:u,y:m}=this._project(new J({x:h[0],y:h[1],spatialReference:t.spatialReference}),e);h[0]=u,h[1]=m,i.toScreen(h,h);let v=bu(p,h,d),w=Math.hypot(h[0]-p[0],h[1]-p[1])/20;!Number.isFinite(w)||Math.abs(w)>4?(s.rotation=0,s.targetGeometry=new J({x:0,y:0,spatialReference:e})):(s.scale*=w,s.scale>ie("mapview-srswitch-adjust-rotation-scale-threshold")?s.rotation=0:s.rotation+=Number.isFinite(v)?v:0)}catch{}this._get("constraints")?.constrain(s,void 0),this._get("state").viewpoint=s}resize(e,t){if(!this.ready)return;let i=this.state,r=this.state.paddedViewState.viewpoint,o=this.state.paddedViewState.size.concat();i.size=[e,t],Cu(r,r,o,this.state.paddedViewState.size,this.resizeAlign),r=this.constraints?.constrain(r,void 0)??r,this.state.viewpoint=r}toMap(e){if(!this.ready)return null;let t=[0,0],[i,r]=this.state.toMap(t,[e.x,e.y]),o=this.state.spatialReference;return new J({x:i,y:r,spatialReference:o})}toScreen(e,t){if(!this.ready)return null;let i=this._project(e,this.state.spatialReference),r=[i.x,i.y];return t?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(r,r),this.state.toScreen(r,r),H(r[0],r[1])}_project(e,t){let i=e?.targetGeometry||e;if(!t)return e;if(!i)return null;if(t.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem||lr(t,i.spatialReference))return e;let r=oi(i,t);if(!r)throw new P("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:t});return Uw(e)?(e.targetGeometry=r,e):r}};function Uw(e){return e?.declaredClass==="esri.Viewpoint"}a([c({type:J})],Ce.prototype,"center",null),a([c()],Ce.prototype,"constraints",void 0),a([c({type:yt})],Ce.prototype,"extent",null),a([c({value:{top:0,right:0,bottom:0,left:0},cast:e=>g({top:0,right:0,bottom:0,left:0},e)})],Ce.prototype,"padding",null),a([c()],Ce.prototype,"ready",void 0),a([c()],Ce.prototype,"resizeAlign",void 0),a([c({readOnly:!0})],Ce.prototype,"resolution",null),a([c({type:Number})],Ce.prototype,"rotation",null),a([c({type:Number})],Ce.prototype,"scale",null),a([c({readOnly:!0})],Ce.prototype,"state",void 0),a([c({type:Ge})],Ce.prototype,"viewpoint",null),a([c()],Ce.prototype,"zoom",null),Ce=a([f("esri.views.2d.ViewStateManager")],Ce);function Ar(e,t){switch(t){case"primary":return e.pointerType==="touch"||e.button===0;case"secondary":return e.pointerType!=="touch"&&e.button===2;case"tertiary":return e.pointerType!=="touch"&&e.button===1}}var qo=class extends F{constructor(t,i){super(!0),this._view=t,this.registerIncoming("double-click",i,r=>this._handleDoubleClick(r,i))}_handleDoubleClick(t,i){Ar(t.data,"primary")&&(t.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this._view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}};var _s=class extends F{constructor(t,i,r){super(!0),this.view=t,this.pointerType=i,this.registerIncoming("double-tap-drag",r,o=>this._handleDoubleTapDrag(o))}_handleDoubleTapDrag(t){let{data:i}=t,{pointerType:r}=i;if(r!==this.pointerType)return;t.stopPropagation();let{action:o,delta:n}=i,{view:s}=this,{mapViewNavigation:l}=s;switch(o){case"begin":{let{scale:p}=s;this._startScale=p,this._currentScale=p,this._previousDelta=n,l.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;let p=1.015**n.y,d=this._startScale*p,h=d/this._currentScale;l.setViewpointImmediate(h),this._currentScale=d;break}case"end":{let{constraints:p}=s,{effectiveLODs:d,snapToZoom:h}=p;if(!h||!d)return void l.end();let u=p.snapScale(this._currentScale),m=(n.y>0?Math.max(u,p.snapToPreviousScale(this._startScale)):Math.min(u,p.snapToNextScale(this._startScale)))/this._currentScale;l.zoom(m).then(()=>{l.end()});break}}}};var bt=class{constructor(t){this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(t){let i=t.data,r=i.pointers.size;switch(i.action){case"start":this._currentCount=r,this._emitStart(t);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(t);break;case"end":this._emitEnd(t),this._currentCount=0}this._previousEvent=t}_emitStart(t){this._startEvent=t,this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.start(this._currentCount,t,this._startEvent)}_emitUpdate(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.update(this._currentCount,t,this._startEvent)}_emitEnd(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.end(this._currentCount,t,this._startEvent),this._startEvent=null}};var ws=class extends F{constructor(t,i,r){super(!0),this.view=t,this.pointerAction=i,this.registerIncoming("drag",r,o=>this._handleDrag(o)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(t){super.onInstall(t),this._dragEventSeparator=new bt({start:(i,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(i,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(i,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(i,r)=>i===1&&Ar(r.data,this.pointerAction)})}_handleDrag(t){let i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}};var bs=class extends F{constructor(t,i,r){super(!0),this._view=t,this.pointerAction=i;let o=this._view.mapViewNavigation;this._dragEventSeparator=new bt({start:(n,s)=>{o.rotate.begin(this._view,s.data),s.stopPropagation()},update:(n,s)=>{o.rotate.update(this._view,s.data),s.stopPropagation()},end:(n,s)=>{o.rotate.end(),s.stopPropagation()},condition:(n,s)=>n===1&&Ar(s.data,this.pointerAction)}),this.registerIncoming("drag",r,n=>this._dragEventSeparator.handle(n))}};function pt(e){let t=e*e;return e<0&&(t*=-1),t}function Zf(e){return e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0,e}function qf(e,t,i){let r=i,o=e.state,n=e.device,s=t.tiltDirection==="forward-down"?1:-1,l=1;return n.deviceType==="standard"?(r.translation[0]=pt(o.axes[0]),r.translation[1]=pt(o.axes[1]),r.translation[2]=pt(o.buttons[7])-pt(o.buttons[6]),r.heading=pt(o.axes[2]),r.tilt=pt(o.axes[3])):n.deviceType==="spacemouse"&&(r.translation[0]=1.2*pt(o.axes[0]),r.translation[1]=1.2*pt(o.axes[1]),r.translation[2]=2*-pt(o.axes[2]),r.heading=1.2*pt(o.axes[5]),r.tilt=1.2*pt(o.axes[3])),r.tilt*=s,qd(r.translation,r.translation,l),r}function Kf(e){return e.translation[0]===0&&e.translation[1]===0&&e.translation[2]===0&&e.heading===0&&e.tilt===0&&e.zoom===0}var Ss=class extends F{constructor(t){super(!0),this._view=t,this._frameTask=null,this._watchHandles=new hn,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([b(()=>this._view.navigation.gamepad?.enabled,i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=st({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},R)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){let i=this._view.navigation.gamepad.device;i&&t.data.device!==i||this._currentDevice&&this._currentDevice!==t.data.device||(t.data.action==="end"?(this._currentDevice=null,Zf(this._transformation)):(this._currentDevice=t.data.device,qf(t.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(t){let i=this._transformation;if(Kf(i))return;let r=this._view.viewpoint.clone(),o=this._view.navigation.gamepad.velocityFactor,n=Gw*o*t;xu(r,r,[i.translation[0]*n,-i.translation[1]*n]);let s=1+i.translation[2]*jw*t,l=this._view.constraints.rotationEnabled?-i.heading*zw*t:0,p=this._view.size,d=[p[0]/2,p[1]];Mu(r,r,s,l,d,p);let h=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=h}},zw=.06,Gw=.7,jw=6e-4;function Cs(e){let t=()=>e(document.visibilityState==="visible");return document.addEventListener("visibilitychange",t),De(()=>document.removeEventListener("visibilitychange",t))}var Ts=class extends F{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=o=>{let n=this._keyMap[o.data.key];if(o.modifiers.has("Meta")||o.modifiers.has("Control"))return void this._stopMovement();if(n==null)return;o.stopPropagation(),o.preventDefault();let s=o.type==="key-down";if(this._pressedKeys[s?"add":"delete"](n),s){if(this._direction===n)return;this._direction=n,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{let l=this._timeout===void 0,p=this._pressedKeys.size>0;l||p?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=Cs(o=>o?null:this._stopMovement())}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(t){let i=this._currentDirection!=null;if(t!=null){if(i||this.view.mapViewNavigation.begin(),this._currentDirection!==t)switch(t){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else i&&this.view.mapViewNavigation.stop();this._currentDirection=t}_setTimeout(t){clearTimeout(this._timeout),this._timeout=t===void 0?void 0:setTimeout(()=>{this._timeout=void 0,t()},this._stickyKeyDuration)}};var Ms=class extends F{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",r,o=>this._handleKeyDown(o)),this.registerIncoming("key-up",r,o=>this._handleKeyUp(o)),this.registerIncoming("blur",r,()=>this._handleStop()),this._visibilityHandle=Cs(o=>o?null:this._handleStop())}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,i){let r=t.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;let o=this._keyToDirection[t.data.key];if(this._pressed=o!=null,this._pressed){if(t.preventDefault(),i)switch(this.view.mapViewNavigation.begin(),o){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}};var Fr;(function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"})(Fr||(Fr={}));var xs=class extends F{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",r,o=>this._handleKeyDown(o)),i.zoomIn.forEach(o=>this._keysToZoomAction[o]=Fr.IN),i.zoomOut.forEach(o=>this._keysToZoomAction[o]=Fr.OUT)}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){let i=t.modifiers;if(i.size>0&&!i.has("Shift"))return;let{key:r}=t.data;if(!(r in this._keysToZoomAction))return;let o=this._keysToZoomAction[r],{mapViewNavigation:n}=this.view,s=null;switch(o){case Fr.IN:s=n.zoomIn();break;case Fr.OUT:s=n.zoomOut();break;default:return}n.begin(),s.then(()=>n.end()),t.stopPropagation()}};var Bw=.6,Is=class extends F{constructor(t,i){super(!0),this._view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,r=>this._handleMouseWheel(r))}_handleMouseWheel(t){if(!this._view.navigation.mouseWheelZoomEnabled||(t.preventDefault(),t.stopPropagation(),!this._canZoom))return;let i=this._view.mapViewNavigation,{x:r,y:o,deltaY:n}=t.data,s=1/Bw**(1/60*n),l=i.zoom(s,[r,o]);l&&(this._canZoom=!1,l.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}};var Es=class extends F{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());let i=this.view.mapViewNavigation;this._dragEventSeparator=new bt({start:(r,o)=>{i.pinch.begin(this.view,o.data),o.stopPropagation()},update:(r,o)=>{i.pinch.update(this.view,o.data),o.stopPropagation()},end:(r,o)=>{i.pinch.end(this.view),o.stopPropagation()},condition:r=>r>=2})}_handleDrag(t){this._dragEventSeparator.handle(t)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function zc(e){let t=e.native;return t?{buttons:t.buttons.map(i=>i.pressed?i.value||1:0),axes:t.axes.map(i=>Ww(i,e.axisThreshold))}:{buttons:[],axes:[]}}function Yf(e,t){if(e.axes.length!==t.axes.length||e.buttons.length!==t.buttons.length)return!1;for(let i=0;i<e.axes.length;i++)if(e.axes[i]!==t.axes[i])return!1;for(let i=0;i<e.buttons.length;i++)if(e.buttons[i]!==t.buttons[i])return!1;return!0}function Qf(e){for(let t=0;t<e.axes.length;t++)if(e.axes[t]!==0)return!1;for(let t=0;t<e.buttons.length;t++)if(e.buttons[t]!==0)return!1;return!0}function Ww(e,t){let i=Math.abs(e);return i<t?0:Math.sign(e)*(i-t)/(1-t)}var Ls=class{constructor(t,i){this._element=t,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=n=>{this._connectGamepad(n.gamepad)},this._onDisconnectGamepad=n=>{let s=n.gamepad,l=s.index,p=this._inputDevices[l];p&&(this._emitGamepadEvent(s,zc(p),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(p),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;let r="getGamepads"in window.navigator,o=window.isSecureContext;this.supported=r&&o,this.supported&&(Xf(n=>this._connectGamepad(n)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this._callback=t}_connectGamepad(t){let i=new Lr(t);i.deviceType!=="unknown"&&(this._inputDevices[t.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=st({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){let t=document.hasFocus(),i=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!t||this._input.gamepad.enabledFocusMode==="view"&&!i;Xf(o=>{let n=this._inputDevices[o.index];if(!n)return;let s=this._latestUpdate[o.index],l=zc(n),p=r||Qf(l);s&&(s.timestamp===o.timestamp||!s.active&&p||Yf(s.state,l))||this._emitGamepadEvent(o,l,!p)})}_emitGamepadEvent(t,i,r){let o=this._latestUpdate[t.index],n=o&&o.active;if(!n&&!r)return;let s=!n&&r?"start":n&&r?"update":"end";this._latestUpdate[t.index]={timestamp:t.timestamp,state:i,active:r},this._callback&&this._callback({device:this._inputDevices[t.index],state:i,action:s})}};function $w(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}function Xf(e){let t=window.navigator.getGamepads();for(let i=0;i<t.length;i++){let r=t[i];$w(r)&&e(r)}}var Jf=ie("edge"),Zw=ie("chrome"),qw=ie("ff"),Kw=ie("safari"),eg="esri-view-surface",Vr={touchNone:`${eg}--touch-none`,touchPan:`${eg}--touch-pan`},tg=(()=>{class e{constructor(i,r){this._input=r,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=i,i.getAttribute("tabindex")||i.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Ls(i,this._input),this._gamepadSource.onEvent=o=>this._callback("gamepad",o)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(i=>{this._releasePointerCaptureSafe(i)}),this._gamepadSource=A(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(i){this._browserTouchPanningEnabled=i,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(i){this._callback=i}set activeEvents(i){for(let r in this._active)if(!i||!i.has(r)){let o=this._active[r];this._element.removeEventListener(Gc[r],o),delete this._active[r]}i&&i.forEach(r=>{if(!this._active[r]&&Gc[r]){let o=(this._eventHandlers[r]||this._handleDefault).bind(this,r);this._element.addEventListener(Gc[r],o),this._active[r]=o}}),this._gamepadSource.hasEventListeners=i?.has("gamepad")??!1}setPointerCapture(i,r){r?this._setPointerCatpureSafe(i.pointerId):(this._releasePointerCaptureSafe(i.pointerId),this._activePointerCaptures.delete(i.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?Vr.touchNone:Vr.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?Vr.touchPan:Vr.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(Vr.touchNone),this._element.classList.remove(Vr.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(i){try{this._element.setPointerCapture(i),this._activePointerCaptures.add(i)}catch{}}_releasePointerCaptureSafe(i){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(i))return;this._element.releasePointerCapture(i)}catch{}}_updateNormalizedPointerLikeEvent(i,r){let o=au(this._element,i);return e.test.disableSubpixelCoordinates&&(o.x=Math.round(o.x),o.y=Math.round(o.y)),r.x=o.x,r.y=o.y,r}_handleKey(i,r){let{key:o}=r;o&&i==="key-up"&&this._keyDownState.delete(o);let n={native:r,key:o,repeat:!!o&&this._keyDownState.has(o)};o&&i==="key-down"&&this._keyDownState.add(n.key),this._callback(i,n)}_handlePointer(i,r){let o=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});this._callback(i,o)}_handlePointerPreventDefault(i,r){let o=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});r.preventDefault(),this._callback(i,o)}_handleMouseWheel(i,r){let o=r.deltaY;switch(r.deltaMode){case 0:Jf&&(o=o/document.documentElement.clientHeight*600);break;case 1:o*=30;break;case 2:o*=900}Jf?o*=.7:Zw||Kw?o*=.6:qw&&(o*=1.375);let n=100,s=Math.abs(o);s>n&&(o=o/s*200/(1+Math.exp(-.02*(s-n))));let l=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,deltaY:o});this._callback(i,l)}_handlePointerCaptureLost(i,r){this._activePointerCaptures.delete(r.pointerId),this._handleDefault(i,r)}_handleDefault(i,r){let o={native:r};r.preventDefault(),this._callback(i,o)}_preventAltKeyDefault(i){i.key==="Alt"&&i.preventDefault()}_preventMultiTouchPanning(i){i.touches.length>1&&i.preventDefault()}}return e.test={disableSubpixelCoordinates:!1},e})(),Gc={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};var ks=class extends F{constructor(){super(!0),this.registerIncoming("context-menu",t=>{t.data.native.preventDefault()})}};var ce={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function Vi(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function ig(e,t){let i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)}function rg(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:H()},e.length===0)return t;if(e.length===1)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(e.length===2){let[re,Q]=e,[qe,mt]=[Q.x-re.x,Q.y-re.y];return t.radius=Math.sqrt(qe*qe+mt*mt)/2,t.center.x=(re.x+Q.x)/2,t.center.y=(re.y+Q.y)/2,t}let i=0,r=0;for(let re=0;re<e.length;re++)i+=e[re].x,r+=e[re].y;i/=e.length,r/=e.length;let o=e.map(re=>re.x-i),n=e.map(re=>re.y-r),s=0,l=0,p=0,d=0,h=0,u=0,m=0;for(let re=0;re<o.length;re++){let Q=o[re],qe=n[re],mt=Q*Q,Zi=qe*qe;s+=mt,l+=Zi,p+=Q*qe,d+=mt*Q,h+=Zi*qe,u+=Q*Zi,m+=qe*mt}let v=.5*(d+u),w=.5*(h+m),M=s*l-p*p,V=(v*l-w*p)/M,k=(s*w-p*v)/M,Yt=H(V+i,k+r);return{radius:Math.sqrt(V*V+k*k+(s+l)/e.length),center:Yt}}function St(e){let{native:t}=e,{pointerId:i,button:r,pointerType:o}=t;return o==="mouse"?`${i}:${r}`:`${o}`}var Os=class extends F{constructor(t=ce.maximumDoubleClickDelay,i=ce.maximumDoubleClickDistance,r=ce.maximumDoubleTouchDelay,o=ce.maximumDoubleTouchDistance,n=gt){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=o,this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=H(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new bt({start:(s,l)=>this._dragStart(s,l),update:(s,l)=>this._dragUpdate(l),end:(s,l)=>this._dragEnd(l)}),this.registerIncoming("drag",s=>this._dragEventSeparator.handle(s)),this.registerIncoming("pointer-down",s=>this._handlePointerDown(s)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(t=>{t.doubleTapTimeout=Z(t.doubleTapTimeout)})}get hasPendingInputs(){return ti(this._pointerState,t=>t.doubleTapTimeout!=null)}_clearPointerDown(t){let i=this._pointerState.get(t);i&&(i.doubleTapTimeout=Z(i.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_dragStart(t,i){if(!this._doubleTapDragReady||t!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;let{data:r,modifiers:o}=i,{center:n}=r;this._dragStartCenter=n;let s=jc("begin",H(0,0),r);this._doubleTapDrag.emit(s,void 0,o),i.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;let{data:i,modifiers:r}=t,{center:o}=i,n=jc("update",H(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(n,void 0,r),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;let{data:i,modifiers:r}=t,{center:o}=i,n=jc("end",H(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(n,void 0,r),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){let{data:i}=t,r=St(i),o=this._pointerState.get(r),{pointerType:n}=i.native;if(o){let s=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(r),Vi(o.event.data,i)>s?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){let{data:i}=t,{pointerType:r}=i.native,o=St(i),n=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,s=this._clock.setTimeout(()=>this._clearPointerDown(o),n);this._pointerState.set(o,{event:t,doubleTapTimeout:s}),this.refreshHasPendingInputs()}};function jc(e,t,i){let{button:r,buttons:o,pointer:n,pointers:s,pointerType:l,timestamp:p}=i;return{action:e,delta:t,button:r,buttons:o,pointer:n,pointers:s,pointerType:l,timestamp:p}}var Ps=class extends F{constructor(t){super(!1),this._navigationTouch=t,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(t,i,r,o){return{action:t,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:o,pointers:Yw(this._activePointerMap),pointer:i,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(t){let i=t.native.pointerId,r=Ds(this._activePointerMap).angle,o={event:t,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,o);let n=Rs(o,ng(this._activePointerMap));o.initialAngle=n,o.lastAngle=n,this._updatePointerAngles(r)}_updatePointer(t){if(t&&t.x==null&&t.y==null)return;let i=t.native.pointerId,r=this._activePointerMap.get(i);r?r.event=t:this._addPointer(t)}_removePointer(t){let i=Ds(this._activePointerMap).angle;this._activePointerMap.delete(t),this._updatePointerAngles(i)}_updatePointerAngles(t){let i=Ds(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=Rs(r,i)-t,r.lastAngle=Rs(r,i)-t})}_emitEvent(t,i,r){let o=Ds(this._activePointerMap);this._drag.emit(this._createPayload(t,i,o,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(t){let i=t.data.native.pointerId,r=t.timestamp;this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(t.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",t.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",t.data,t.timestamp)))}_handlePointerDrag(t){let i=t.data,r=i.currentEvent,o=t.timestamp;switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,o)):(this._addPointer(r),this._emitEvent("added",r,o),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=t.data.startEvent.pointerType,this._mouseButton=t.data.startEvent.button,this._startStateModifiers=t.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,o))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function ng(e){let t=[];return e.forEach(i=>{t.push(H(i.event.x,i.event.y))}),rg(t)}function Ds(e){let t=ng(e),i=0;return e.forEach(r=>{let o=Rs(r,t),n=o-r.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;o=r.lastAngle+n,r.lastAngle=o;let s=o-r.initialAngle;i+=s}),i/=e.size||1,{angle:i,radius:t.radius,center:t.center}}function Yw(e){let t=new Map;return e.forEach((i,r)=>t.set(r,i.event)),t}function Rs(e,t){let i=e.event,r=i.x-t.center.x,o=i.y-t.center.y;return Math.atan2(o,r)}var og;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right",e[e.Back=3]="Back",e[e.Forward=4]="Forward",e[e.Undefined=-1]="Undefined"})(og||(og={}));var As=class extends F{constructor(t=ce.maximumDoubleClickDelay,i=ce.maximumDoubleClickDistance,r=ce.maximumDoubleTouchDelay,o=ce.maximumDoubleTouchDistance,n=gt){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=o,this._clock=n,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(t){let i=t.data,r=St(i);if(!this._pointerState.has(r)){let o={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(r,o),this.startCapturingPointer(i.native)}}_handlePointerUp(t){let i=t.data,r=St(i),o=this._pointerState.get(r);if(o&&o.downButton===i.native.button){let n=o.immediateDoubleClick,s=t.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;n?(n.timeoutHandle.remove(),Vi(n,t.data)>s?this._startImmediateDoubleClick(t,o):(this._immediateDoubleClick.emit(t.data,void 0,n.modifiers),this._removeState(i))):Vi(o,t.data)>s?this._removeState(i):this._startImmediateDoubleClick(t,o)}}_startImmediateDoubleClick(t,i){let r=t.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(t.data),r)}}_removeState(t){let i=St(t);this._pointerState.delete(i),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}};var Vs=class extends F{constructor(t=ce.maximumClickDelay,i=ce.movementUntilMouseDrag,r=ce.movementUntilPenDrag,o=ce.movementUntilTouchDrag,n=ce.holdDelay,s=gt){super(!1),this._maximumClickDelay=t,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=r,this._movementUntilTouchDrag=o,this._holdDelay=n,this._clock=s,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",l=>{this._handlePointerLoss(l,"pointer-up")}),this.registerIncoming("pointer-capture-lost",l=>{this._handlePointerLoss(l,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",l=>{this._handlePointerLoss(l,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(t=>{t.holdTimeout=Z(t.holdTimeout)}),super.onUninstall()}_handlePointerDown(t){let i=t.data,r=i.native.pointerId,o=null;this._pointerState.size===0&&(o=this._clock.setTimeout(()=>{let s=this._pointerState.get(r);if(s){if(!s.isDragging){let l=s.previousEvent;this._pointerHold.emit(l,void 0,t.modifiers),s.holdEmitted=!0}s.holdTimeout=null}},this._holdDelay));let n={startEvent:i,previousEvent:i,startTimestamp:t.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:o,modifiers:new Set};this._pointerState.set(r,n),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t)}_handlePointerMove(t){let i=t.data,r=i.native.pointerId,o=this._pointerState.get(r);o&&(o.isDragging?this._pointerDrag.emit(Fs("update",o,i),void 0,o.modifiers):ig(i,o.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(t),o.previousEvent=i)}_getDragThreshold(t){switch(t){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(t){let i=t.data,r=i.native.pointerId;this._pointerState.forEach(o=>{o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging||(o.modifiers=t.modifiers,o.isDragging=!0,r===o.startEvent.native.pointerId?this._pointerDrag.emit(Fs("start",o,i)):this._pointerDrag.emit(Fs("start",o,o.previousEvent),t.timestamp))})}_handlePointerLoss(t,i){let r=t.data,o=r.native.pointerId,n=this._pointerState.get(o);n&&(n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(Fs("end",n,i==="pointer-up"?r:n.previousEvent),void 0,n.modifiers):i==="pointer-up"&&n.downButton===r.native.button&&t.timestamp-n.startTimestamp<=this._maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(o),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};function Fs(e,t,i){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:i}}var Ns=class extends F{constructor(t=ce.maximumDoubleClickDelay,i=ce.maximumDoubleClickDistance,r=ce.maximumDoubleTouchDelay,o=ce.maximumDoubleTouchDistance,n=gt){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=o,this._clock=n,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(t=>t.doubleClickTimer=Z(t.doubleClickTimer))}get hasPendingInputs(){return ti(this._pointerState,t=>t.doubleClickTimer!=null)}_clearDoubleClickTimer(t,i){let r=this._pointerState.get(t);r&&(r.doubleClickTimer=Z(r.doubleClickTimer),i&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){let i=this._pointerState.get(t);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}_handleImmediateClick(t){let i=t.data,{pointerType:r}=i.native,o=Qw(i);if(!this._pointerState.has(o))return void this._startClick(t);let n=this._pointerState.get(o),{data:s,modifiers:l}=n.event,p=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Vi(s,i)>p?(this._clearDoubleClickTimer(o,!0),this._startClick(t)):(this._clearDoubleClickTimer(o,!1),n.pointerDownCount===2&&this._doubleClick.emit(s,void 0,l))}_handlePointerDown(t){let i=St(t.data),r=this._pointerState.get(i);r&&(r.pointerDownCount+=1)}_startClick(t){let{data:i}=t,{native:{pointerType:r}}=i,o=St(i),n=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,s=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(o),n);this._pointerState.set(o,{event:t,doubleClickTimer:s,pointerDownCount:1}),this.refreshHasPendingInputs()}};function Qw(e){let{pointerId:t,pointerType:i,button:r}=e.native;return i==="mouse"?`${t}:${r}`:`${i}`}var Hs={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}},Ni=class extends S{initialize(){let e=()=>this.view?.ready;this.addHandles([Ue(()=>!e(),()=>this._disconnect()),Ue(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=A(this._inputManager)}_connect(){let e=this.view.surface,t=new tg(e,this.view.input),i=[new As,new Vs,new Ns,new Ps(this.view.navigation),new Os],r=new ru({eventSource:t,recognizers:i});r.installHandlers("prevent-context-menu",[new ks],j.INTERNAL),r.installHandlers("navigation",[new Es(this.view),new Ss(this.view),new Is(this.view),new qo(this.view),new qo(this.view,[Hs.counter]),new ws(this.view,"primary"),new Ts(this.view,Hs.pan),new xs(this.view,Hs.zoom),new Ms(this.view,Hs.rotate),new bs(this.view,"secondary"),new _s(this.view,"touch")],j.INTERNAL),this.view.viewEvents.connect(r),this._source=t,this._inputManager=r,b(()=>this.view?.navigation?.browserTouchPanEnabled,o=>{this._source&&(this._source.browserTouchPanningEnabled=!o)},R)}get test(){}};a([c()],Ni.prototype,"view",void 0),a([c()],Ni.prototype,"latestPointerType",null),a([c()],Ni.prototype,"latestPointerLocation",null),a([c()],Ni.prototype,"multiTouchActive",null),Ni=a([f("esri.views.2d.input.MapViewInputManager")],Ni);var sg=Ni;var Hi={added:[],removed:[]},Bc=new Set,Xw=new Mh(0,0,0,0);function Jw(e,t){let i=gn(t);if(!i)return null;let[r,o]=i.valid;return e[2]>o?[Ei([e[0],e[1],o,e[3]]),Ei([r,e[1],r+e[2]-o,e[3]])]:e[0]<r?[Ei([r,e[1],e[2],e[3]]),Ei([o-(r-e[0]),e[1],o,e[3]])]:null}var Us=class extends oe{constructor(t){super(),this._tiles=new Map,this._index=Fh(9,ie("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}getIntersectingTiles(t){if(!t||wn(t)===0||bn(t)===0)return[];let i=Jw(t,this.tileScheme.spatialReference);return i!=null?[...new Set([...this.boundsIntersections(i[0]),...this.boundsIntersections(i[1])])]:this.boundsIntersections(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){let i={added:[],removed:[]};for(let r of t.added)if(!this.has(r)){let o=new Ba(this.tileScheme,r);this._tiles.set(r,o),this._index.insert(o),i.added.push(o)}for(let r of t.removed)if(this.has(r)){let o=this.get(r);this._tiles.delete(r),this._index.remove(o),i.removed.push(o)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(t){let i=this.tileScheme.getTileCoverage(t,0);if(!i)return;let{spans:r,lodInfo:o}=i,{level:n}=o;if(r.length>0)for(let{row:s,colFrom:l,colTo:p}of r)for(let d=l;d<=p;d++){let h=Xw.set(n,s,o.normalizeCol(d),o.getWorldForColumn(d)).id;if(Bc.add(h),!this.has(h)){let u=new Ba(this.tileScheme,h);this._tiles.set(h,u),this._index.insert(u),this.tiles.push(u),Hi.added.push(u)}}for(let s=this.tiles.length-1;s>=0;s--){let l=this.tiles[s];Bc.has(l.id)||(this._tiles.delete(l.id),this.tiles.splice(s,1),this._index.remove(l),Hi.removed.push(l))}(Hi.added.length||Hi.removed.length)&&this.emit("update",Hi),xh.pool.release(i),Bc.clear(),Hi.added.length=0,Hi.removed.length=0}};function cg(e,t,i){return _(this,null,function*(){let r=Rn(t)?Dn(e,t):t;if(!e.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let o=new Set,n=new Set,s=!1,l=null,p=null;i?.include?lg(i.include,ag(e,m=>{o.add(m),Wc(m,v=>n.add(v))},(m,v)=>{n.add(m),o.add(v)},m=>{l||(l=new Set),l.add(m)},m=>o.add(m),()=>s=!0)):(s=!0,o=new Set(e.allLayerViews),o.forEach(m=>{Wc(m,v=>n.add(v))})),i?.exclude&&lg(i.exclude,ag(e,m=>{o.delete(m),Wc(m,v=>n.delete(v))},m=>n.delete(m),m=>{p||(p=new Set),p.add(m)}));let d=e.toMap(r),h=e.allLayerViews.filter(m=>!m.suspended&&o.has(m)&&m.clips.every(v=>Ou(e,v,r,d))).reverse(),u=[...s?e.graphicsView.hitTest(d).map(m=>({type:"graphic",graphic:m,layer:null,mapPoint:d})):[],...yield Promise.all(h.map(m=>m.hitTest(d,r)).toArray())].filter(fe).flat().filter(fe);return u=u.filter(m=>m.type!=="graphic"||m.layer?.type!=="subtype-group"||n.has(m.graphic.layer)),l&&(u=u.filter(m=>!("graphic"in m)||!m.graphic||l?.has($c(m.graphic)))),p&&(u=u.filter(m=>!("graphic"in m)||!m.graphic||!p?.has($c(m.graphic)))),{screenPoint:r,results:u}})}function ag(e,t,i,r,o,n){return s=>{if(s instanceof jh){if(s.layer===e)n?.();else{let l=e.allLayerViews.find(p=>p.layer===s.layer);l&&o?.(l)}r($c(s))}else if(!("layer"in s&&"element"in s))if(s.type==="subtype-sublayer"){let l=e.allLayerViews.find(p=>p.layer===s.parent);l&&i(s,l)}else{let l=e.allLayerViews.find(p=>p.layer===s);l&&t(l)}}}function lg(e,t){if(e)if(La(e))for(let i of e)if(La(i))for(let r of i)t(r);else t(i);else t(e)}function $c(e){let t=e.getObjectId();return t?`${e.layer?.uid??e.sourceLayer?.uid??"MapView"}/${t}`:`"MapView/${e.uid}`}function Wc({layer:e},t){e?.type==="subtype-group"&&e.sublayers.forEach(i=>{t(i)})}var pg={flipY:!0,premultipliedAlpha:!0};function dg(e,t){return _(this,null,function*(){let i=yield ug(e,t),{format:r,quality:o}=Lu(t?.format,t?.quality);return Iu(i,{format:r,quality:o,rotation:0,disableDecorations:!1},pg)})}function hg(e,t){return _(this,null,function*(){let i=yield ug(e,t);return Eu(i,pg)})}function ug(e,t){let i=ib(t||{},tb(e.stage,e.size),e.size,e.padding),r=eb(t,e.allLayerViews);return e.stage.takeScreenshot(i,r,e.backgroundColor,t?.rotation)}function eb(e={},t){if(!e.layers)return;let i=[];return e.layers.forEach(r=>{let o=t.find(n=>n.layer.id===r.id);o?.container&&i.push(o.container)}),i}function tb(e,t){return Math.min(4,ku(t,Math.min(4096,e.context.parameters.maxTextureSize)))}function ib(e,t,i,r){e.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let o=null;e.width!=null&&e.height!=null?o=[e.width,e.height]:e.width==null&&e.height!=null?o=[e.height,e.height]:e.width!=null&&e.height==null?o=[e.width,e.width]:e.width==null&&e.height==null&&(o=null);let n=i[0]-(r.left+r.right),s=i[1]-(r.top+r.bottom),l,p,d=e.area||{x:0,y:0,width:n,height:s};if(o){let h=n/s,u=o[0]/o[1];if(u>h){let m=d.width/u;d={x:d.x,y:Math.round(d.y+(d.height-m)/2),width:d.width,height:Math.round(m)}}else{let m=d.height*u;d={x:Math.round(d.x+(d.width-m)/2),y:d.y,width:Math.round(m),height:d.height}}}else o=[d.width,d.height];return o[0]>d.width?(l=Math.min(o[0]/d.width,t),p=o[0]/d.width/l):(l=1,p=o[0]/d.width),{cropArea:{x:Math.round((d.x+r.left)*l),y:Math.round((d.y+r.top)*l),width:Math.round(d.width*l),height:Math.round(d.height*l)},outputScale:p,resolutionScale:l}}var mg=160,Nr=class extends S{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=mg&&this.clear()},mg))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};a([c()],Nr.prototype,"_timer",void 0),a([c()],Nr.prototype,"stationary",null),Nr=a([f("esri.views.2d.support.StationaryManager")],Nr);function fg(e){let t=tu();return t.available?e==="3d"&&t.majorPerformanceCaveat?new P("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):t.supportsHighPrecisionFragment?t.supportsVertexShaderSamplers?null:new P("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new P("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new P("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function rb(e){return e&&"nodeType"in e}function ob(e){return e&&typeof e.render=="function"}var gg={component:"esri-component"},Ui=class extends S{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){let t=this._get("node");e!==t&&(e&&e.classList.add(gg.component),t&&t.classList.remove(gg.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||rb(e)?(this._set("widget",null),un(e)):(ob(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};a([c()],Ui.prototype,"id",null),a([c()],Ui.prototype,"node",null),a([ze("node")],Ui.prototype,"castNode",null),a([c({readOnly:!0})],Ui.prototype,"widget",void 0),Ui=a([f("esri.views.ui.Component")],Ui);var Hr=Ui;var nb={left:0,top:0,bottom:0,right:0},yg={bottom:30,top:15,right:15,left:15},jt="esri-ui",Pe={ui:jt,corner:`${jt}-corner`,innerContainer:`${jt}-inner-container`,manualContainer:`${jt}-manual-container`,cornerContainer:`${jt}-corner-container`,topLeft:`${jt}-top-left`,topRight:`${jt}-top-right`,bottomLeft:`${jt}-bottom-left`,bottomRight:`${jt}-bottom-right`};function sb(e){return e&&!e._started&&typeof e.postMixInProperties=="function"&&typeof e.buildRendering=="function"&&typeof e.postCreate=="function"&&typeof e.startup=="function"}function zs(e){return e===0?"0":`${e}px`}function Zc(e){let t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?e:null}function qc(e,{top:t,bottom:i,left:r,right:o}){e.style.top=t,e.style.bottom=i,e.style.left=r,e.style.right=o}var Ct=class extends oe.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=wd(),this.view=null,this._applyViewPadding=()=>{let t=this.container;t&&qc(t,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{let t=this._innerContainer;t&&qc(t,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([b(()=>[this.view?.padding,this.container],this._applyViewPadding,R),b(()=>this.padding,this._applyUIPadding,R),b(()=>[this.container,this._locale],([e,t])=>{e&&e.setAttribute("lang",t)},R),bd(e=>{this._locale=e})])}destroy(){this.container=null;for(let e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){let t=this._get("container");e!==t&&(e&&(e.classList.add(Pe.ui),kd(e),this._attachContainers(e)),t&&(t.classList.remove(Pe.ui),qc(t,{top:"",bottom:"",left:"",right:""}),mn(t)),this._set("container",e))}get height(){let e=this.view?.height??0;if(e===0)return e;let t=this._getViewPadding(),{top:i,bottom:r}=t;return Math.max(e-i-r,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:g(g({},yg),e)}get width(){let e=this.view?.width??0;if(e===0)return e;let t=this._getViewPadding(),{left:i,right:r}=t;return Math.max(e-i-r,0)}add(e,t){let i,r,o;if(Array.isArray(e))return void e.forEach(s=>this.add(s,t));let n=Zc(e);n&&({index:i,position:t,component:e,key:r}=n),t&&typeof t=="object"&&({index:i,key:r,position:t,internal:o}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,i,r,o)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map(r=>this.remove(r,t));let i=this._find(e);if(i){if(this._componentMap.has(i)&&this._componentMap.get(i)?.key!==t)return;let r=this._components.indexOf(i);return i.node.parentNode?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(r,1)[0]}}empty(e,t={removeInternal:!1}){if(Array.isArray(e)){for(let o of e)this.empty(o,t);return}let i=this._positionNameToContainerLookup[e??"manual"],r=Array.prototype.slice.call(i.children).map(o=>this._findByNode(o)).filter(o=>o==null?!1:!(this._componentMap.get(o)?.internal??!1)||t.removeInternal);for(let o of r)this.remove(o)}move(e,t){if(Array.isArray(e)&&e.forEach(n=>this.move(n,t)),!e)return;let i,r=Zc(e)||Zc(t);if(r&&(i=r.index,t=r.position,e=r.component||e),t&&!this._isValidPosition(t))return;let o=this.remove(e);o&&this.add(o,{position:t,index:i})}find(e){if(!e)return null;let t=this._findById(e);return t&&(t.widget||t.node)}getComponents(e,t={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(i=>this._getComponentsAtPosition(i,t)):this._getComponentsAtPosition(e,t):this._components.filter(i=>t.includeInternal||!this._componentMap.get(i)?.internal).map(({widget:i,node:r})=>i??r)}getPosition(e){for(let t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,i,r,o){e instanceof Hr||(e=new Hr({node:e}));let{widget:n}=e;n!=null&&n instanceof S&&n.addHandles(De(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey),this._place({component:e,position:t,index:i}),this._components.push(e),this._componentMap.set(e,{key:r,internal:o})}_find(e){return e?e instanceof Hr?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.view?.padding??nb}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){let e=document.createElement("div");e.classList.add(Pe.innerContainer,Pe.cornerContainer);let t=document.createElement("div");t.classList.add(Pe.innerContainer,Pe.manualContainer);let i=document.createElement("div");i.classList.add(Pe.topLeft,Pe.corner),e.appendChild(i);let r=document.createElement("div");r.classList.add(Pe.topRight,Pe.corner),e.appendChild(r);let o=document.createElement("div");o.classList.add(Pe.bottomLeft,Pe.corner),e.appendChild(o);let n=document.createElement("div");n.classList.add(Pe.bottomRight,Pe.corner),e.appendChild(n),this._innerContainer=e,this._manualContainer=t;let s=ao();this._cornerNameToContainerLookup={"top-left":i,"top-right":r,"bottom-left":o,"bottom-right":n,"top-leading":s?r:i,"top-trailing":s?i:r,"bottom-leading":s?n:o,"bottom-trailing":s?o:n},this._positionNameToContainerLookup=g({manual:t},this._cornerNameToContainerLookup)}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){let t=e.position??"manual",{component:i,index:r}=e,o=this._positionNameToContainerLookup[t],n=r!=null&&r>-1;if(sb(i.widget)&&i.widget.startup(),!n)return void o.appendChild(i.node);let s=Array.from(o.children);if(r===0)return void(o.firstChild?Ra(i.node,o.firstChild):o.appendChild(i.node));r>=s.length?o.appendChild(i.node):Ra(i.node,s[r])}_toPixelPosition(e){return{top:zs(e.top),left:zs(e.left),right:zs(e.right),bottom:zs(e.bottom)}}_findByComponent(e){return this._components.find(t=>t===e)??null}_findById(e){return this._components.find(({id:t})=>t===e)??null}_findByNode(e){return this._components.find(({node:t})=>t===e)??null}_getComponentsAtPosition(e,t){let i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map(r=>this._findByNode(r)).filter(fe).filter(r=>t.includeInternal||!this._componentMap.get(r)?.internal).map(({widget:r,node:o})=>r??o)}};a([c()],Ct.prototype,"_locale",void 0),a([c()],Ct.prototype,"container",null),a([c()],Ct.prototype,"height",null),a([c({value:yg})],Ct.prototype,"padding",null),a([ze("padding")],Ct.prototype,"castPadding",null),a([c()],Ct.prototype,"view",void 0),a([c()],Ct.prototype,"width",null),Ct=a([f("esri.views.ui.UI")],Ct);var vg=Ct;var ab=new Map;function _g(e){return ab.get(e)}function wg(e,t){return e&&"copyright"in e&&(!t||typeof e.originOf=="function"&&e.originOf("copyright")==="user")}function lb(e,t){return e.length!==t.length||e.some((i,r)=>i.text!==t[r].text)}function Ko(e,t,i){!i||!t||e.find(r=>r.layerView===t&&r.text===i)||e.push({text:i,layerView:t})}function cb(e){return e.type==="bing-maps"}var Bt=[],Ur=class extends S{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new L,this.view=null,this._allLayerViewsChange=t=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");let i=this.view?.allLayerViews;i&&(this.addHandles(i.map(r=>b(()=>[r.suspended,r.layer?.attributionVisible],()=>this._updateAttributionItems())).toArray(),"suspension"),i.forEach(r=>{r.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(r.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),t?.removed&&t.removed.forEach(r=>{this._pendingAttributions.delete(r),this._fetchedAttributionData.delete(r)}),this._updateAttributionItems()},this.addHandles([at(()=>this.view?.allLayerViews,"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Ue(()=>this.view?.stationary===!0,()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){let e=this.view,t=e?.allLayerViews;if(Bt.length=0,!e||!t)return void this._clear();t.forEach(r=>{if(r.suspended||!r.layer?.attributionVisible)return;let o=r.layer;if(wg(o,"user"))return void Ko(Bt,r,o.copyright);if(o.hasAttributionData){if(this._fetchedAttributionData.has(r)){let s=this._fetchedAttributionData.get(r);return void(s?Ko(Bt,r,this._getDynamicAttribution(s,e,o)):wg(o)&&Ko(Bt,r,o.copyright))}return void this._fetchAttributionData(r)}let n="portalItem"in o?o.portalItem?.accessInformation:void 0;Ko(Bt,r,n||o.copyright)});let i=t.find(r=>r.layer?.type==="integrated-mesh-3dtiles");if(this.view&&i){let r=_g(this.view);if(r){let o=r.getAttributionText();for(let n=0;n<o.length;++n)Ko(Bt,i,o[n])}}lb(this.items,Bt)&&(this.items.removeAll(),this.items.addMany(Bt)),Bt.length=0,this.notifyChange("state")}_fetchAttributionData(e){return _(this,null,function*(){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);let t=yield Id(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){let i=t.ok?this._createContributionIndex(t.value,cb(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()})}_createContributionIndex(e,t){let i=e.contributors,r={};if(!i)return r;for(let o=0;o<i.length;o++){let n=i[o],s=n.coverageAreas;if(!s)return;for(let l of s){let p=l.bbox,d=l.zoomMin-(t&&l.zoomMin?1:0),h=l.zoomMax-(t&&l.zoomMax?1:0),u=new yt({xmin:p[1],ymin:p[0],xmax:p[3],ymax:p[2],spatialReference:cr.WGS84}),m={extent:Ud(u),attribution:n.attribution||"",score:l.score!=null?l.score:100,id:o};for(let v=d;v<=h;v++)r[v]??=[],r[v].push(m)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(e,t,i){let{extent:r,scale:o}=t,n=i.tileInfo?.scaleToZoom(o)??0;if(n=Math.min(e.maxKey??0,Math.round(n)),!r||n==null||n<=-1)return"";let s=e[n],l=Hd(r.center.clone().normalize(),t.spatialReference),p=new Set;return s?s.filter(d=>{let h=d.id,u=!p.has(h)&&l&&d.extent&&yn(d.extent,l);return u&&p.add(h),u}).sort((d,h)=>h.score-d.score||d.objectId-h.objectId).map(d=>d.attribution).join(", "):""}};a([c({readOnly:!0,type:L})],Ur.prototype,"items",void 0),a([c({readOnly:!0})],Ur.prototype,"state",null),a([c()],Ur.prototype,"view",void 0),Ur=a([f("esri.widgets.Attribution.AttributionViewModel")],Ur);var Kc=Ur;var zr="esri-attribution",Gr={base:zr,poweredBy:`${zr}__powered-by`,sources:`${zr}__sources`,open:`${zr}--open`,sourcesOpen:`${zr}__sources--open`,link:`${zr}__link`},xe=class extends ne{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(i=>i.forEach(({target:r})=>this._checkSourceTextOverflow(r))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Kc}initialize(){this.addHandles(at(()=>this.viewModel?.items,"change",()=>this.scheduleRender()))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){let e={[Gr.open]:this._isOpen};return y("div",{bind:this,class:this.classes(Gr.base,K.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return y("div",{class:Gr.poweredBy},"Powered by"," ",y("a",{class:Gr.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){let e=this._isOpen,t=this._isInteractive,i=t?0:void 0,{attributionText:r}=this,o={[Gr.sourcesOpen]:e,[K.interactive]:t};return y("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Gr.sources,o),innerHTML:r,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1,{clientHeight:i,clientWidth:r,scrollWidth:o}=e,n=o>r,s=this._attributionTextOverflowed!==n;if(this._attributionTextOverflowed=n,s&&(t=!0),this._isOpen){let l=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,l&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};a([c()],xe.prototype,"_isOpen",void 0),a([c()],xe.prototype,"_isInteractive",null),a([c()],xe.prototype,"_attributionTextOverflowed",void 0),a([c()],xe.prototype,"_prevSourceNodeHeight",void 0),a([c({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],xe.prototype,"attributionText",null),a([c()],xe.prototype,"icon",null),a([c()],xe.prototype,"itemDelimiter",void 0),a([c()],xe.prototype,"label",null),a([c(),le("esri/widgets/Attribution/t9n/Attribution")],xe.prototype,"messages",void 0),a([c()],xe.prototype,"view",null),a([c({type:Kc})],xe.prototype,"viewModel",void 0),a([ou()],xe.prototype,"_toggleState",null),xe=a([f("esri.widgets.Attribution")],xe);var bg=xe;function Sg(e){return e?.spatialReference?.isWebMercator||e?.spatialReference?.isGeographic||!1}var zi=class extends su(S){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles(b(()=>this.view,this._updateRotationWatcher,R))}destroy(){this.view=null}get canShowNorth(){return Sg(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:ie("mapview-essential-goto-duration")}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;let t=-e.heading;this._set("orientation",{x:0,y:0,z:t})}_updateRotationWatcher(e){this.removeAllHandles(),e&&this.addHandles(e.type==="2d"?b(()=>e?.rotation,this._updateForRotation,R):b(()=>e?.camera,this._updateForCamera,R))}};a([c({readOnly:!0})],zi.prototype,"canShowNorth",null),a([c({readOnly:!0})],zi.prototype,"orientation",void 0),a([c({readOnly:!0})],zi.prototype,"state",null),a([c()],zi.prototype,"view",void 0),zi=a([f("esri.widgets.Compass.CompassViewModel")],zi);var Yc=zi;var Cg="esri-compass",Qc={base:Cg,iconContainer:`${Cg}__icon-container`};var Wt=class extends ne{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new Yc,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=i=>({transform:`rotateZ(${i.z}deg)`})}loadDependencies(){return Se({button:()=>import("./chunk-J63POI2Y.js"),icon:()=>import("./chunk-4HUBSTEF.js")})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){let{orientation:e,state:t}=this.viewModel,{messages:i}=this;return y("div",{class:this.classes(Qc.base,K.widget)},y("calcite-button",{class:K.widgetButton,disabled:t==="disabled",kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},y("div",{"aria-hidden":"true",class:Qc.iconContainer,title:i.reset},y("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};a([c()],Wt.prototype,"goToOverride",null),a([c()],Wt.prototype,"icon",null),a([c()],Wt.prototype,"label",null),a([c(),le("esri/widgets/Compass/t9n/Compass")],Wt.prototype,"messages",void 0),a([c()],Wt.prototype,"view",null),a([c({type:Yc})],Wt.prototype,"viewModel",void 0),Wt=a([f("esri.widgets.Compass")],Wt);var Tg=Wt;var Mg="esri-navigation-toggle",Xc={base:Mg,isLayoutHorizontal:`${Mg}--horizontal`};var jr=class extends S{constructor(e){super(e),this._navigationMode="pan",this.view=null}initialize(){this.addHandles(Ue(()=>this.view?.inputManager,()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._setNavigationMode()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_setNavigationMode(){let e=this.view?.inputManager;e&&(e.primaryDragAction=this._navigationMode==="pan"?"pan":"rotate")}};a([c({readOnly:!0})],jr.prototype,"state",null),a([c()],jr.prototype,"_navigationMode",void 0),a([c()],jr.prototype,"view",void 0),jr=a([f("esri.widgets.NavigationToggle.NavigationToggleViewModel")],jr);var Jc=jr;var $t=class extends ne{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new Jc,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{(this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton)?.setFocus(),this.toggle()}}loadDependencies(){return Se({button:()=>import("./chunk-J63POI2Y.js")})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){let e=this.viewModel?.state==="disabled",t=this.viewModel?.navigationMode==="pan",i=this.messages.toggle;return y("div",{class:this.classes(Xc.base,K.widget,{[Xc.isLayoutHorizontal]:this.layout==="horizontal"})},y("calcite-button",{afterCreate:r=>{this._panButton=r},appearance:t?"outline-fill":"solid",class:K.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:t?void 0:-1,title:i}),y("calcite-button",{afterCreate:r=>{this._rotateButton=r},appearance:t?"solid":"outline-fill",class:K.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:t?-1:void 0,title:i}))}};a([c()],$t.prototype,"icon",null),a([c()],$t.prototype,"label",null),a([c({value:"vertical"})],$t.prototype,"layout",null),a([c(),le("esri/widgets/NavigationToggle/t9n/NavigationToggle")],$t.prototype,"messages",void 0),a([c()],$t.prototype,"view",null),a([c({type:Jc})],$t.prototype,"viewModel",void 0),$t=a([f("esri.widgets.NavigationToggle")],$t);var xg=$t;var Gi=class extends S{get canZoomIn(){if(!this.view?.ready)return!1;let t=this.view?.constraints?.effectiveMaxScale;return t===0||this._scale>t}get canZoomOut(){let{view:e}=this;if(!e?.ready)return!1;let i=e.constraints?.effectiveMinScale;return i===0||this._scale<i}get _scale(){let e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};a([c({readOnly:!0})],Gi.prototype,"canZoomIn",null),a([c({readOnly:!0})],Gi.prototype,"canZoomOut",null),a([c()],Gi.prototype,"view",void 0),a([c()],Gi.prototype,"_scale",null),Gi=a([f("esri.widgets.Zoom.ZoomConditions2D")],Gi);var Ig=Gi;var Br=class extends S{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};a([c({readOnly:!0})],Br.prototype,"canZoomIn",null),a([c({readOnly:!0})],Br.prototype,"canZoomOut",null),a([c()],Br.prototype,"view",void 0),Br=a([f("esri.widgets.Zoom.ZoomConditions3D")],Br);var Eg=Br;var mi=class extends S{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Ig({view:e}):e.type==="3d"&&(this._zoomConditions=new Eg({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;let e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():He(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;let e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():He(e.goTo({zoomFactor:.5}))}};a([c()],mi.prototype,"_zoomConditions",void 0),a([c()],mi.prototype,"canZoomIn",null),a([c()],mi.prototype,"canZoomOut",null),a([c({readOnly:!0})],mi.prototype,"state",null),a([c()],mi.prototype,"view",null),mi=a([f("esri.widgets.Zoom.ZoomViewModel")],mi);var ep=mi;var Lg={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"},Zt=class extends ne{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new ep,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return Se({button:()=>import("./chunk-J63POI2Y.js")})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){let e={[Lg.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:t,canZoomOut:i}=this.viewModel,{zoomIn:r,zoomOut:o}=this.messages;return y("div",{class:this.classes(Lg.base,K.widget,e)},y("calcite-button",{class:K.widgetButton,disabled:!t,iconStart:"plus",kind:"neutral",label:r,onclick:this.zoomIn,title:r}),y("calcite-button",{class:K.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};a([c()],Zt.prototype,"icon",null),a([c()],Zt.prototype,"label",null),a([c({value:"vertical"})],Zt.prototype,"layout",null),a([c(),le("esri/widgets/Zoom/t9n/Zoom")],Zt.prototype,"messages",void 0),a([c()],Zt.prototype,"view",null),a([c({type:ep})],Zt.prototype,"viewModel",void 0),Zt=a([f("esri.widgets.Zoom")],Zt);var kg=Zt;function pb(e){return e?.view!==void 0}var Gs=class extends vg{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=t=>{this.components.forEach(i=>{let r=this._find(i),o=r?.widget;pb(o)&&(o.view=t)})},this._componentsWatcher=(t,i)=>{this._removeComponents(i),this._addComponents(t),this._adjustPadding(t)}}initialize(){this.addHandles([b(()=>this.components,this._componentsWatcher,R),b(()=>this.view,this._updateViewAwareWidgets,R)])}_add(e,t,i,r,o){let n=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;n=this._createComponent(e)}super._add(n,t,i,r,o)}_removeComponents(e){e.forEach(t=>{let i=this._find(t);i&&(this.remove(i),i.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){let{top:t}=this.padding;this.padding=t}}_addComponents(e){this.constructed&&e.forEach(t=>this.add(this._createComponent(t),this._defaultPositionLookup[t]))}_createComponent(e){let t=this._createWidget(e);return new Hr({id:e,node:t})}_createWidget(e){let t=this.view;switch(e){case"attribution":return new bg({view:t});case"compass":return new Tg({view:t});case"navigation-toggle":return new xg({view:t});case"zoom":return new kg({view:t})}}};a([c()],Gs.prototype,"components",void 0),Gs=a([f("esri.views.ui.DefaultUI")],Gs);var js=Gs;var Bs=class extends js{constructor(e){super(e),this.components=["attribution","zoom"]}};a([c()],Bs.prototype,"components",void 0),Bs=a([f("esri.views.ui.2d.DefaultUI2D")],Bs);var tp=Bs;var ip,Ws=ip=class extends ar{constructor(e){super(e),this.color=new vt([0,0,0,1])}clone(){return new ip(no({color:this.color}))}};a([c({type:vt,json:{write:!0}})],Ws.prototype,"color",void 0),Ws=ip=a([f("esri.webmap.background.ColorBackground")],Ws);var Og=Ws;var Dg,Rg,Pg,Ag,Fg,Vg;function db(){return _(this,null,function*(){let[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:i,MapViewNavigation:r,MagnifierView2D:o,Stage:n}]=yield Promise.all([import("./chunk-OG3VJURW.js"),import("./chunk-JZJZTRGD.js")]);Rg=e,Pg=t,Ag=i,Fg=r,Vg=o,Dg=n})}var x=class extends ef(nf(rf(wf))){constructor(e){super(e),this._magnifierView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new ki({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new Wo({view:this}),this.graphicsView=null,this.stateManager=new Ce({constraints:new Uc({view:this})}),this.stationaryManager=new Nr,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new vs(this),this.floors=new L,this.highlightOptions=new ja,this.inputManager=new sg({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new Xa,this.type="2d",this.ui=new tp,this.test={takeScreenshot:t=>_(this,null,function*(){return hg(this._getScreenshotView(t),t)})},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([b(()=>this.viewpoint,()=>this.stationaryManager.flip(),Ft),this.on("resize",t=>this.stateManager.resize(t.width,t.height))]),$h()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=A(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Us(this.featuresTilingScheme)}get constraintsInfo(){let e=this.defaultsFromMap?.tileInfo,t=this.spatialReference;return{lods:e?.spatialReference?.equals(t)?e.lods:null,spatialReference:t}}get state(){return this.stateManager.state}get initialExtentRequired(){if(!this.stateManager)return!1;let{scale:e,constraints:t,center:i,viewpoint:r,extent:o}=this,n=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!o&&(t?.effectiveLODs||(n=-1),(!i||e===0&&n===-1)&&(r?.targetGeometry==null||r.targetGeometry.type!=="extent"&&!r.scale))}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get typeSpecificPreconditionsReady(){let e=this._getDefaultViewpoint();if(!e)return!1;let t=e.targetGeometry,i=this.spatialReference;return uh(t.spatialReference,i)}set animation(e){let t=this._get("animation");if(e===t)return;if(t&&t.stop(),e!==this.animationManager.animation&&this.animationManager.stop(),!e||e.isFulfilled())return this._set("animation",null),void(this.frameTask.animationInProgress=!1);this._set("animation",e),this.frameTask.animationInProgress=!0;let i=()=>{this.destroyed||(e===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame()),this.frameTask.animationInProgress=!1)};e.when(i,i)}get background(){return Ja(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get constraints(){return this.stateManager?.constraints}set constraints(e){e.view=this;let t=this.stateManager.constraints;this.stateManager.constraints=e,t?.destroy()}get extent(){return this.stateManager?.extent??null}set extent(e){this.stateManager.extent=e}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(e){let{rotationEnabled:t}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=e,this.constraints.rotationEnabled=t}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){let e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),t=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(i=>!i.destroyed&&!("layerViews"in i)&&i.updating===!0)||e);if(ie("esri-2d-log-updating")){let i=this.allLayerViews.reduce((r,o)=>T(g({},r),{[`${o.layer.id}(${o.layer.type})`]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${t}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(i)}
-> updatingMagnifier: ${e}
`)}return t}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}goTo(e,t){return this.goToManager.goTo(e,t)}hitTest(e,t){return _(this,null,function*(){return cg(this,e,t)})}takeScreenshot(e){return _(this,null,function*(){return dg(this._getScreenshotView(e),e)})}toMap(e){if(!this.ready)return null;let t=Rn(e)?Dn(this,e):e;return this.stateManager.toMap(t)}toScreen(e,t){return this.stateManager.toScreen(e,t)}on(e,t,i,r){return this.inputManager&&this.viewEvents.on(e,t,i,r)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map?.initialViewProperties?.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return Ja(this.map)?this.map.initialViewProperties.timeZone:null}hasLayerViewModule(e){return Pc.hasLayerViewModule(e)}importLayerView(e){return Pc.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(E.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(e){return _(this,null,function*(){let t=this.toMap(e),i=yield this.hitTest(e),r=this.allLayerViews.toArray().reverse(),o=new globalThis.Map(r.map(p=>[p.layer.uid,p])),n=[],s=0,l=0;for(;s<i.results.length||l<r.length;){let p=i.results.at(s);if(p&&p.type!=="graphic"){++s;continue}let d=o.get((p?.layer??p?.graphic.layer)?.uid);if((!p||d)&&l<r.length&&r.at(l)!==d){let h=r.at(l);"fetchPopupFeaturesAtLocation"in h&&n.push({mapPoint:t,layerView:h}),++l}else p&&(n.push({graphic:p.graphic,layerView:d}),++s)}return{hits:n,location:t}})}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){return _(this,null,function*(){let e=fg(this.type);if(ie("safari")&&ie("safari")<9&&(e=new P("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ie("safari")})),e!=null)throw E.getLogger(this).warn("#validate()",e.message),e})}loadAsyncDependencies(){return db()}_getDefaultViewpoint(){let{constraints:e,initialExtent:t,map:i,padding:r,size:o}=this;if(!e)return null;let n=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,s=this.stateManager.getUserStartupOptions(this.size),l=n?.viewpoint,p=l?.targetGeometry?.extent??t,d=p?.center,h=l?.rotation??0,u=l?.scale||p&&An(p,[o[0]-r.left-r.right,o[1]-r.top-r.bottom]),m=s.center??d,v=s.rotation??h,w=s.scale??u;return m&&w?new Ge({targetGeometry:m,scale:w,rotation:v}):null}_startup(){this.timeline.begin("MapView Startup");let e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;let t=new Dg(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=t,this._magnifierView=new Vg,this._magnifierView.magnifier=this.magnifier;let i=new Ag({view:this});this._set("labelManager",i);let r=new Bf({view:this});this._set("animationManager",r);let o=new Fg({view:this,animationManager:r});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),t.on("webgl-error",s=>this.fatalError=s.error),b(()=>this.stationary,s=>t.stationary=s,ae),b(()=>this.background,s=>{t.backgroundColor=s?.color,this._magnifierView.backgroundColor=s?.color},ae),b(()=>this.magnifier,s=>this._magnifierView.magnifier=s,ae),b(()=>this.renderingOptions,s=>t.renderingOptions=s,ae),b(()=>this.highlightOptions,s=>t.highlightOptions=s,ae),b(()=>this.state.id,()=>t.state=this.state,ae)],"map-view"),this._updateStageChildren();let n=this._resolveWhenReady;this._resolveWhenReady=[],n.forEach(s=>s(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(t=>{this.stage.addChild(t.container)});let e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){let e=new Ih(lh.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);let t=new Rg({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Pg(e)});this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){let e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){let{allLayerViews:t,padding:i,size:r,stage:o}=this;return{allLayerViews:t,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:i,size:r,stage:o}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(let t of this.allLayerViews)t.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(let t of this.allLayerViews)t.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};x.type="2d",a([c({readOnly:!0})],x.prototype,"animationManager",void 0),a([c({constructOnly:!0})],x.prototype,"deactivatedWebGLExtensions",void 0),a([c({constructOnly:!0})],x.prototype,"debugWebGLExtensions",void 0),a([c({readOnly:!0})],x.prototype,"featuresTilingScheme",void 0),a([c({readOnly:!0})],x.prototype,"fullOpacity",void 0),a([c()],x.prototype,"goToManager",void 0),a([c({readOnly:!0})],x.prototype,"graphicsTileStore",null),a([c()],x.prototype,"graphicsView",void 0),a([c()],x.prototype,"stateManager",void 0),a([c()],x.prototype,"constraintsInfo",null),a([c({readOnly:!0})],x.prototype,"state",null),a([c()],x.prototype,"initialExtentRequired",null),a([c()],x.prototype,"labelManager",void 0),a([c({readOnly:!0})],x.prototype,"mapViewNavigation",void 0),a([c({constructOnly:!0})],x.prototype,"renderCanvas",void 0),a([c()],x.prototype,"renderingOptions",void 0),a([c({constructOnly:!0})],x.prototype,"supersampleScreenshotsEnabled",void 0),a([c({readOnly:!0})],x.prototype,"supportsGround",void 0),a([c()],x.prototype,"_defaultsFromMapSettings",null),a([c({readOnly:!0})],x.prototype,"typeSpecificPreconditionsReady",null),a([c()],x.prototype,"animation",null),a([c({type:Og})],x.prototype,"background",null),a([c()],x.prototype,"center",null),a([c({type:Uc})],x.prototype,"constraints",null),a([c()],x.prototype,"extent",null),a([c()],x.prototype,"floors",void 0),a([c({type:ja})],x.prototype,"highlightOptions",void 0),a([c({readOnly:!0})],x.prototype,"inputManager",void 0),a([c()],x.prototype,"map",void 0),a([c()],x.prototype,"padding",null),a([c({readOnly:!0})],x.prototype,"rendering",null),a([c()],x.prototype,"resizeAlign",null),a([c({readOnly:!0})],x.prototype,"resolution",null),a([c()],x.prototype,"rotation",null),a([c()],x.prototype,"scale",null),a([c({constructOnly:!0})],x.prototype,"spatialReferenceLocked",void 0),a([c()],x.prototype,"stationary",null),a([c({readOnly:!0})],x.prototype,"tileInfo",null),a([c({type:Xa,readOnly:!0})],x.prototype,"timeline",void 0),a([c({readOnly:!0})],x.prototype,"type",void 0),a([c({readOnly:!0})],x.prototype,"updating",null),a([c()],x.prototype,"viewpoint",null),a([c()],x.prototype,"zoom",null),a([c({readOnly:!0})],x.prototype,"navigating",null),a([c(),ze(e=>e instanceof js?e:yd(tp,e))],x.prototype,"ui",void 0),x=a([f("esri.views.MapView")],x);var Ie="esri-scale-bar",q={base:Ie,labelContainer:`${Ie}__label-container`,rulerLabelContainer:`${Ie}__label-container--ruler`,lineLabelContainer:`${Ie}__label-container--line`,topLabelContainer:`${Ie}__label-container--top`,bottomLabelContainer:`${Ie}__label-container--bottom`,label:`${Ie}__label`,line:`${Ie}__line`,topLine:`${Ie}__line--top`,bottomLine:`${Ie}__line--bottom`,ruler:`${Ie}__ruler`,rulerBlock:`${Ie}__ruler-block`,barContainer:`${Ie}__bar-container`,rulerBarContainer:`${Ie}__bar-container--ruler`,lineBarContainer:`${Ie}__bar-container--line`};function hb(e){return e>.5?{min:.5,max:1}:e>.2?{min:.2,max:.5}:{min:.1,max:.2}}function ub(e,t){switch(t){case"metric":return e>1e3?{distance:Ii(e,"meters","kilometers"),unit:"kilometer"}:e>1?{distance:e,unit:"meter"}:e>.01?{distance:Ii(e,"meters","centimeters"),unit:"centimeter"}:{distance:Ii(e,"meters","millimeters"),unit:"millimeter"};case"imperial":return e>1609.344?{distance:Ii(e,"meters","miles"),unit:"mile"}:e>.3048?{distance:Ii(e,"meters","feet"),unit:"foot"}:{distance:Ii(e,"meters","inches"),unit:"inch"}}}function mb(e){let{isWebMercator:t,wkt:i,wkt2:r}=e;return t||((r||i)?.includes("WGS_1984_Web_Mercator")??!1)}function Ng({state:{paddedViewState:e},spatialReference:t,width:i}){return t.isWrappable&&e.worldScreenWidth<i}function Hg(e,t){let{x:i,y:r}=e?zd(t,!0):t;return[i,r]}var Wr=class extends S{constructor(e){super(e),this.scaleComputedFrom=H(),this.view=null}get state(){return this.view?.ready&&this.view?.type==="2d"?"ready":"disabled"}getScaleBarProperties(e,t){if(this.state==="disabled"||isNaN(e)||!t||!this.view)return null;let i=this._getDistanceInMeters();return i==null?null:this._getScaleBarProps(e,i,t)}_getDistanceInMeters(){let{state:e,spatialReference:t}=this.view;if(!Pd(t))return null;let{isGeographic:i}=t,r=mb(t);if(!i&&!r)return e.extent.width*(Nd(t)??1);let[o,n]=this._getScaleMeasuringPoints(),s=r||i&&!Pu(t)?cr.WGS84:t,l=new Xd({paths:[[Hg(r,o),Hg(r,n)]],spatialReference:s}),p=mh(l,10),d;try{[d]=Au([p],"meters")}catch{return null}return d}_getScaleMeasuringPoints(){let e=this.view,{width:t,height:i,position:r,spatialReference:o}=e;if(Ng(e)){let p=gn(o),{valid:d}=p;return[new J(d[0],0,o),new J(d[1],0,o)]}let n=this.scaleComputedFrom.y-r[1];n>i?n=i:n<0&&(n=0);let s=H(0,n),l=H(t,n);return[e.toMap(s),e.toMap(l)]}_getScaleBarProps(e,t,i){let r=this.view,o=e*t/(Ng(r)?r.state.paddedViewState.worldScreenWidth:r.width);if(o<.001)return null;let n=ub(o,i),{distance:s,unit:l}=n,p=s,d=0;for(;p>=1;)p/=10,d++;let{min:h,max:u}=hb(p),m=u/p>=p/h?h:u;return{length:e*(m/p),value:10**d*m,unit:l}}};a([c()],Wr.prototype,"scaleComputedFrom",void 0),a([c({readOnly:!0})],Wr.prototype,"state",null),a([c()],Wr.prototype,"view",void 0),Wr=a([f("esri.widgets.ScaleBar.ScaleBarViewModel")],Wr);var Ug=Wr;function zg(e,t){return Cd(e,{style:"unit",unit:t,unitDisplay:"short"})}var Tt=class extends ne{constructor(e,t){super(e,t),this.messages=null,this.style="line",this.viewModel=new Ug}initialize(){this.addHandles(b(()=>{let{view:e}=this;return[e?.stationary,e?.center,e?.scale,e?.zoom]},([e])=>{e&&this.scheduleRender()}))}get icon(){return"actual-size"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get unit(){return this._defaultUnit}set unit(e){this._overrideIfSome("unit",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){let e=this.viewModel.state==="disabled",t={[K.disabled]:e},i,r;if(!e){let{unit:o,style:n}=this,s=o==="metric"||o==="dual",l=100,p=o==="dual"?"line":n;if(o==="imperial"||o==="dual"){let d=this.viewModel.getScaleBarProperties(l,"imperial");d&&(r=p==="ruler"?this._renderRuler(d):this._renderLine(d,"bottom"))}if(s){let d=this.viewModel.getScaleBarProperties(l,"metric");d&&(i=p==="ruler"?this._renderRuler(d):this._renderLine(d,"top"))}}return y("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(q.base,K.widget,t)},i,r)}_renderRuler(e){let{length:t,unit:i,value:r}=e,o=Math.round(t),n=zg(r,i);return y("div",{class:this.classes(q.barContainer,q.rulerBarContainer),key:q.rulerBarContainer},y("div",{class:q.ruler,styles:{width:`${o}px`}},y("div",{class:q.rulerBlock}),y("div",{class:q.rulerBlock}),y("div",{class:q.rulerBlock}),y("div",{class:q.rulerBlock})),y("div",{class:this.classes(q.labelContainer,q.rulerLabelContainer)},y("div",{class:q.label},"0"),y("div",{class:q.label},n)))}_renderLine(e,t){let{length:i,unit:r,value:o}=e,n=Math.round(i),s=zg(o,r),l={[q.topLabelContainer]:t==="top",[q.bottomLabelContainer]:t==="bottom"},p=y("div",{class:this.classes(q.labelContainer,q.lineLabelContainer,l),key:q.labelContainer},y("div",{class:q.label},s)),d={[q.topLine]:t==="top",[q.bottomLine]:t==="bottom"},h=y("div",{class:this.classes(q.line,d),key:q.line,styles:{width:`${n}px`}});return y("div",{class:this.classes(q.barContainer,q.lineBarContainer),key:q.lineBarContainer},[h,p])}_handleRootCreateOrUpdate(e){if(!this.viewModel)return;let{scaleComputedFrom:t}=this.viewModel,i=e.getBoundingClientRect(),r=i.left+window.pageXOffset,o=i.top+window.pageYOffset,n=H(r,o);(n.x!==t.x||n.y!==t.y)&&(this.viewModel.scaleComputedFrom=n)}};a([c(Vn)],Tt.prototype,"_defaultUnit",void 0),a([c()],Tt.prototype,"icon",null),a([c()],Tt.prototype,"label",null),a([c(),le("esri/widgets/ScaleBar/t9n/ScaleBar")],Tt.prototype,"messages",void 0),a([c({type:["ruler","line"]})],Tt.prototype,"style",void 0),a([c({type:["metric","imperial","dual"]})],Tt.prototype,"unit",null),a([c()],Tt.prototype,"view",null),a([c()],Tt.prototype,"viewModel",void 0),Tt=a([f("esri.widgets.ScaleBar")],Tt);function Gg(e){return fb(e).result}function fb(e){if(e.graphic&&e.graphic.layer?.type!=="graphics")return{result:me.GRAPHICS_LAYER_MISSING};if(!e.operations)return{result:me.GEOMETRY_MISSING};if(Yh(e.elevationInfo))return{result:me.ELEVATION_MODE_UNSUPPORTED};let t=e.operations.data.type,i=e.operations.data.geometry;return t==="point"||t==="mesh"||t==="polyline"||t==="polygon"?{result:me.SUPPORTED,geometry:i}:{result:me.GEOMETRY_TYPE_UNSUPPORTED}}function jg(e){if(e.layer?.type!=="graphics")return me.GRAPHICS_LAYER_MISSING;if(e.geometry==null)return me.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return me.SUPPORTED;default:return me.GEOMETRY_TYPE_UNSUPPORTED}let t=e.symbol!=null&&e.symbol.type==="point-3d"&&e.symbol.symbolLayers;return!t||!t.some(i=>i.type==="object")?me.SYMBOL_TYPE_UNSUPPORTED:qh(e)!=="on-the-ground"&&Kh(e)?me.ELEVATION_MODE_UNSUPPORTED:me.SUPPORTED}var ye=class extends oe.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:this.activeComponent}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){let e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};a([c()],ye.prototype,"activeComponent",void 0),a([c()],ye.prototype,"cancelled",void 0),a([c()],ye.prototype,"history",void 0),a([c()],ye.prototype,"tool",null),a([c()],ye.prototype,"type",void 0),a([c()],ye.prototype,"canUndo",null),a([c()],ye.prototype,"canRedo",null),a([c()],ye.prototype,"onEnd",void 0),a([c()],ye.prototype,"undo",null),a([c()],ye.prototype,"redo",null),a([c()],ye.prototype,"toggleTool",void 0),a([c()],ye.prototype,"addToSelection",void 0),a([c()],ye.prototype,"removeFromSelection",void 0),ye=a([f("esri.widgets.Sketch.support.OperationHandle")],ye);var Yo=class extends ye{};a([c()],Yo.prototype,"activeComponent",void 0),Yo=a([f("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],Yo);var Mt=class extends ye{};a([c()],Mt.prototype,"activeComponent",void 0),Mt=a([f("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],Mt);var Bg={defaultZ:0},Qo={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"},G=class extends oe.EventedAccessor{constructor(e){super(e),this._numUpdating=0,this._defaultSnappingManager=null,this._internalGraphicsLayer=new qa({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new Ga({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Ah({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new Ph({color:[130,130,130,1],width:2}),this.meshSymbol=new Gh({symbolLayers:new L([new zh])}),this.updateGraphics=new L,this.updateOnGraphicClick=!0,this.vertexSymbol=new Ga({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new mr,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=Bg,this.defaultUpdateOptions=Qo,this.snappingOptions=e?.snappingManager?.options??e?.snappingOptions??new fr}initialize(){this.addHandles([at(()=>this.view?.map?.layers,"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),at(()=>this.layer?.graphics,"change",e=>{if(this._operationHandle!=null)for(let t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())}),b(()=>this.layer?.elevationInfo??null,e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},ae),b(()=>this.view,e=>{this._defaultSnappingManager=A(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new rl({view:e,options:this.snappingOptions})),e.type==="2d"?import("./chunk-CTF447HT.js"):e.type==="3d"&&(import("./chunk-Z4YWSKAI.js"),import("./chunk-GMKENNNU.js")))},ae),b(()=>this.view?.spatialReference,(e,t)=>{e&&t&&!e.equals(t)&&this.cancel()})]),Hu(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=A(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this.emit("destroy")}get updating(){return this._numUpdating>0||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",g(g({},Bg),e))}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",T(g(g({},Qo),e),{reshapeOptions:g(g({},Qo.reshapeOptions),e?.reshapeOptions),highlightOptions:g(g({},Qo.highlightOptions),e?.highlightOptions)}))}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){return this.snappingManager?.options??this._get("snappingOptions")}set snappingOptions(e){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=A(this._defaultSnappingManager)),this._override("snappingManager",e);else{let{view:t}=this;!this._defaultSnappingManager&&t&&(this._defaultSnappingManager=new rl({options:this.snappingOptions,view:t})),this._clearOverride("snappingManager")}}get state(){let e=!(!this.view?.ready||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){let t=this._get("view");if(t){let{container:r,map:o}=t;r&&(t.cursor=null),o?.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}let i="view-ready";this.removeHandles(i),e&&this.addHandles(Ue(()=>e.ready,r=>{this.removeHandles(this._viewHandlesKey),r&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},ae),i),this._set("view",e)}cancel(){this._moduleLoaderAbortController=Rt(this._moduleLoaderAbortController),this._viewReadyAbortController=Rt(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){let{state:e,updateGraphics:t}=this;if(e==="active"&&t.length){let{activeTool:i,layer:r}=this,o=t.toArray();r.removeMany(o),this.cancel(),this._emitDeleteEvent({graphics:o,tool:i})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){let e=this.updateGraphics.map(t=>t.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}create(e,t){return _(this,null,function*(){this.cancel(),yield this._waitViewReady();let{view:i,layer:r}=this;if(!i||this.state==="disabled")throw r||this._logMissingLayer(),or();if(i.activeTool!=null&&(i.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");tl(i,this._internalGraphicsLayer);let o=yield this._setupCreateOperation(e,t);if(o==null||this.destroyed)return void i.map.remove(this._internalGraphicsLayer);let n=()=>{if(o===this._operationHandle){let s=this.createGraphic,l=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view?.map&&this.view.map.remove(this._internalGraphicsLayer),o.cancelled||s==null||r.add(s),this.emit("create",{graphic:s,state:l?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}};o.on("complete",n),this._operationHandle=o,i.ready&&i.focus()})}place(e,t){return _(this,null,function*(){return this.create("mesh",g({mode:"click",hasZ:e.hasZ,geometryToPlace:e},t))})}update(e,t){return _(this,null,function*(){this.cancel(),yield this._waitViewReady();let{layer:i,view:r,state:o}=this;if(!r||o==="disabled")throw i||this._logMissingLayer(),or();r.activeTool!=null&&(r.activeTool=null);let n=Array.isArray(e)?e:[e];if(e==null||!n?.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(n.some(l=>l.layer!==i?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):l.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;let s=yield this._setupUpdateOperation(n,t);this.destroyed||s==null||pe(s)||(tl(r,this._internalGraphicsLayer),this._setUpdateOperationHandle(s,t),this.emit("update",{graphics:n,state:"start",aborted:!1,tool:s.tool,toolEventInfo:null,type:"update"}))})}_updateSpatialReference(e){return _(this,null,function*(){let t=this.view;if(t){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(let i of e)i.geometry==null||i.geometry.type==="mesh"||lr(i.geometry.spatialReference,t.spatialReference)||(En(i.geometry.spatialReference,t.spatialReference)||xn()||(yield In()),i.geometry=oi(i.geometry,t.spatialReference));this._endAsyncOperation()}else this._logMissingView()})}undo(){this.canUndo()&&this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!!this._operationHandle?.canUndo()}canRedo(){return!!this._operationHandle?.canRedo()}toggleUpdateTool(){this._operationHandle?.toggleTool()}_getFirstHit(e){return _(this,null,function*(){let t=this.view;if(!t)return this._logMissingView(),null;if(t.type==="2d"){let o=[];t.map.allLayers.forEach(s=>{s.type!=="vector-tile"&&s.type!=="imagery"||o.push(s)});let n=yield t.hitTest(e,{exclude:o});return zu(n.results)}let i=[t.map.ground];t.map.allLayers.forEach(o=>{oh(o.type)&&i.push(o)});let r=yield t.hitTest(e,{exclude:i});if(r.results.length>0){let o=r.results[0];if(o!=null&&o.type==="graphic"&&o.graphic&&(!r.ground.mapPoint||t.map.ground.opacity<1||r.ground.distance-(o.distance??0)>-Math.min(3*r.ground.distance,t.viewingMode==="global"?Ad(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return o}return null})}_generateViewHandles(e){return[e.on("immediate-click",t=>_(this,null,function*(){let i=this.state==="active"&&this._operationHandle?.type==="create";if(this.state==="disabled"||i||!this.updateOnGraphicClick)return;this._beginAsyncOperation();let r=yield t.async(()=>this._getFirstHit(je(t))),o=null;if(r!=null){let n=r.graphic;this.updateGraphics.includes(n)||n.layer===this.layer?(t.stopPropagation(),o=n):e.type!=="2d"||this._isComponentGraphic(n)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();o==null||this.updateGraphics.includes(o)||(yield this.update([o],T(g({},this.defaultUpdateOptions),{reshapeOptions:g({},this.defaultUpdateOptions.reshapeOptions)}))),this._endAsyncOperation()}),j.WIDGET)]}_setupCreateOperation(e,t){return _(this,null,function*(){let i=this.view;if(!i)return this._logMissingView(),null;let r=g(g({hasZ:i.type==="3d"},this.defaultCreateOptions),t),o=yield this._setupDrawGraphicTool(e,i,r);return o==null?null:(i.tools.add(o),i.activeTool=o,this._setupCreateOperationHandle(o))})}_setupDrawGraphicTool(e,t,i){return _(this,null,function*(){if(e==="multipoint"&&t.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;let{cursor:r,defaultZ:o,hasZ:n,geometryToPlace:s,graphicProperties:l,mode:p,preserveAspectRatio:d}=i,h=e==="rectangle"||e==="circle"?"hybrid":"click",u=d??e!=="rectangle",m={centered:e!=="rectangle"&&!(e==="circle"&&!u),cursor:r,defaultZ:o,forceUniformSize:u,graphicProperties:l,geometryToPlace:s,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:n,mode:p??h,snappingManager:this.snappingManager,snapToScene:!1,view:t};return t.type==="2d"?this._makeDrawGraphicTool2D(m):this._makeDrawGraphicTool3D(m)})}_makeDrawGraphicTool2D(e){return _(this,null,function*(){let t=yield this._requireModule(import("./chunk-CTF447HT.js"));return pe(t)||this.destroyed?null:new t.module.DrawGraphicTool2D(T(g({},e),{activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:yb(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions}))})}_makeDrawGraphicTool3D(e){return _(this,null,function*(){let t=yield this._requireModule(import("./chunk-Z4YWSKAI.js"));if(pe(t)||this.destroyed)return null;let{elevationInfo:i}=this.layer;return new t.module.DrawGraphicTool3D(T(g({},e),{elevationInfo:i,snapToScene:!0,sketchOptions:this.sketchOptions}))})}_setupCreateOperationHandle(e){let t=this.view;if(!t)return this._logMissingView(),null;let i=null,r=e.forceUniformSize,o=e.centered,n=[t.on("key-down",l=>{if(l.key===$.pan)l.stopPropagation(),l.repeat||(e.enabled=!1);else if(l.key===$.complete)l.stopPropagation(),e.completeCreateOperation();else if(l.key!==$.vertexAdd||l.repeat)l.key===$.undo?(l.stopPropagation(),s.undo()):l.key===$.redo?(l.stopPropagation(),s.redo()):l.key!==$.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||l.repeat?l.key===$.center&&(l.repeat||(e.centered=!o,l.stopPropagation())):(e.forceUniformSize=!r,l.stopPropagation());else{let p=e.drawOperation.geometryType;p!=="polyline"&&p!=="polygon"&&p!=="multipoint"||(l.stopPropagation(),e.drawOperation.commitStagedVertex())}},j.WIDGET),t.on("key-up",l=>{l.key===$.pan?e.enabled=!0:l.key!==$.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?l.key===$.center&&(e.centered=o,l.stopPropagation()):(e.forceUniformSize=r,l.stopPropagation())},j.WIDGET),e.on("vertex-add",l=>{switch(i=i==null?"start":"active",l.operation){case"apply":this.emit("create",{graphic:e.graphic,state:i,tool:this.activeTool,toolEventInfo:l,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",l=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:l.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",l=>{switch(l.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:l,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",l=>{this._set("createGraphic",l.graphic),i="complete",l.aborted?s&&s.cancel():s&&s.complete()}),b(()=>this._getGraphicSymbolFromTool(e.geometryType),l=>{e.graphicSymbol=l})],s=new Yo({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{n.forEach(l=>l.remove()),n.length=0,t.tools?.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return s}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}_setupUpdateOperation(e,t){return _(this,null,function*(){let{layer:i,view:r}=this;if(!r)return this._logMissingView(),null;let o=T(g(g({},this.defaultUpdateOptions),t),{reshapeOptions:g(g({},this.defaultUpdateOptions.reshapeOptions),t?.reshapeOptions),highlightOptions:g(g({},this.defaultUpdateOptions.highlightOptions),t?.highlightOptions)}),n=o.tool??Qo.tool;for(let s of e)i.remove(s),i.add(s);if(r.type==="3d"){if(e.length===0)return null;switch(n){case"move":return this._setupMove3DOperation(e,o,r,n);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],o,r);case"transform":return this._setupGraphicTransform3DOperation(e,o,r)}}switch(n){case"move":return this._setupMove2DOperation(e,o,r);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,n,o,r);case"transform":if(e.length===1){let s=e[0].geometry?.type;s!=="point"&&s!=="multipoint"||(n="reshape")}return this._setupTransformOrReshape2DOperation(e,n,o,r)}})}_setupMove3DOperation(e,t,i,r,o=!1){return _(this,null,function*(){let n=yield this._requireModule(import("./chunk-Z4YWSKAI.js"));if(pe(n))return n;let{ManipulatedObject3DGraphic:s,MoveTool3D:l}=n.module,p=new Map,d=()=>{p.forEach(v=>v.destroy()),p.clear()};for(let v of e){let w=new s({view:i,graphic:v}),M=Fu(w);if(M!==me.SUPPORTED)return d(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${el(M)}).`),null;p.set(v,w)}let h=new l({view:i,enableZ:t.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(h),h.objects.addMany(Array.from(p.values())),o||this.updateGraphics.addMany(e);let u=[],m=new Mt({activeComponent:h,tool:r,type:"update",onEnd:()=>{u.forEach(v=>v.remove()),u.length=0,i.tools?.remove(h),h.destroyed||h.destroy(),d()},undo:()=>{$g(this.view,h),$s(m,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{Zs(m,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:v=>{this.updateGraphics.push(v);let w=new s({view:i,graphic:v});p.set(v,w),h.objects.push(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[v],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:v=>{let w=this.updateGraphics.indexOf(v);if(m.history.undo.forEach(V=>V.updates.splice(w,1)),m.history.redo.forEach(V=>V.updates.splice(w,1)),this.updateGraphics.remove(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[v],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void m.complete();let M=p.get(v);M&&(h.objects.remove(M),M.destroy(),p.delete(v))},toggleTool:()=>_(this,null,function*(){if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1||r!=="transform")return;let v=this.updateGraphics.at(0),w=yield this._setupReshape3DOperation(v,t,i,!0);w&&!pe(w)&&(m.onEnd(),m.destroy(),this._setUpdateOperationHandle(w,t))})});return u.push(...this._getHandlesForComponent(m,t),i.on("immediate-click",v=>this._getCommonUpdateOperationClickHandlers(m,v,t),j.WIDGET),i.on("key-down",v=>{this._getCommonUpdateOperationKeyDownHandlers(m,v)},j.WIDGET)),m})}_setupGraphicTransform3DOperation(e,t,i,r=!1){if(e.length===1&&jg(e[0])===me.SUPPORTED){let o=e[0],n=o.geometry;if(n!=null&&(n.type==="point"||n.type==="mesh"))return this._setupPointTransform3DOperation(o,t,i);if(n!=null&&(n.type==="polygon"||n.type==="polyline"))return this._setupPolyTransform3DOperation(o,t,i,r)}return this._setupMove3DOperation(e,t,i,"transform",r)}_setupPointTransform3DOperation(e,t,i){return _(this,null,function*(){let r="transform",{enableRotation:o,enableScaling:n,enableZ:s}=t,l=yield this._requireModule(import("./chunk-Z4YWSKAI.js"));if(pe(l))return l;let{TransformTool3D:p,ManipulatedObject3DGraphic:d}=l.module,h=new d({graphic:e,view:i}),u=new p({object:h,view:i,enableRotation:o,enableScaling:n,enableZ:s,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(u),this.updateGraphics.add(e);let m=[],v=new Mt({activeComponent:u,tool:r,type:"update",onEnd:()=>{m.forEach(w=>w.remove()),m.length=0,i.tools?.remove(u),u.destroyed||u.destroy(),h.destroy()},undo:()=>{$g(this.view,u),$s(v,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{Zs(v,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:w=>_(this,null,function*(){this.updateGraphics.add(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[w],removed:[],type:"selection-change"},type:"update"}),v.onEnd(),v.destroy();let M=yield this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);pe(M)||this._setUpdateOperationHandle(M,t)}),removeFromSelection:w=>{this.updateGraphics.remove(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[w],type:"selection-change"},type:"update"}),v.complete()},toggleTool:()=>{}});return m.push(...this._getHandlesForComponent(v,t),i.on("immediate-click",w=>this._getCommonUpdateOperationClickHandlers(v,w,t),j.WIDGET),i.on("key-down",w=>{this._getCommonUpdateOperationKeyDownHandlers(v,w)},j.WIDGET)),v})}_setupPolyTransform3DOperation(e,t,i,r=!1){return _(this,null,function*(){let o="transform",{enableRotation:n,enableScaling:s,enableZ:l,preserveAspectRatio:p}=t,d=yield this._requireModule(import("./chunk-Z4YWSKAI.js"));if(pe(d))return d;let{ManipulatedObject3DGraphic:h,ExtentTransformTool:u}=d.module,m=this.view?.inputManager?.isModifierKeyDown($.constraint),v=new h({view:i,graphic:e}),w=new u({object:v,view:i,enableRotation:n,enableScaling:s,enableZ:l,preserveAspectRatio:!!p!=!!m,sketchOptions:this.sketchOptions});i.tools.add(w),r||this.updateGraphics.add(e);let M=[],V=new Mt({activeComponent:w,tool:o,type:"update",onEnd:()=>{M.forEach(k=>k.remove()),M.length=0,i.tools?.remove(w),w.destroyed||w.destroy(),v.destroy()},canUndo:()=>w.canUndo,undo:()=>{w.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},canRedo:()=>w.canRedo,redo:()=>{w.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:k=>_(this,null,function*(){this.updateGraphics.add(k),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[k],removed:[],type:"selection-change"},type:"update"}),V.onEnd(),V.destroy();let Yt=yield this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);pe(Yt)||this._setUpdateOperationHandle(Yt,t)}),removeFromSelection:k=>{this.updateGraphics.remove(k),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[k],type:"selection-change"},type:"update"}),V.complete()},toggleTool:()=>_(this,null,function*(){if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1)return;let k=yield this._setupReshape3DOperation(e,t,i,!0);k&&!pe(k)&&(V.onEnd(),V.destroy(),this._setUpdateOperationHandle(k,t))})});return M.push(...this._getHandlesForComponent(V,t),i.on("immediate-click",k=>this._getCommonUpdateOperationClickHandlers(V,k,t),j.WIDGET),i.on("key-down",k=>this._getCommonUpdateOperationKeyDownHandlers(V,k),j.WIDGET),i.on("key-down",k=>{k.key!==$.constraint||k.repeat||(w.preserveAspectRatio=!w.preserveAspectRatio,k.stopPropagation())},j.WIDGET),i.on("key-up",k=>{k.key===$.constraint&&(w.preserveAspectRatio=!w.preserveAspectRatio,k.stopPropagation())},j.WIDGET)),V})}_setupMove2DOperation(e,t,i){return _(this,null,function*(){let r="move";this.updateGraphics.addMany(e),yield this._updateSpatialReference(e);let o=yield this._getGraphicMover(e,t,i);if(pe(o))return o;let n=new Mt({activeComponent:o,tool:r,type:"update",onEnd:()=>{this._displayDefaultCursor(),p.forEach(d=>d.remove()),l.forEach(d=>d.remove()),p=[],l=[],o.destroy(),this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{let d=this.updateGraphics.toArray();$s(n,d),n.refreshComponent(),this._emitUndoEvent({graphics:d,tool:r})},redo:()=>{let d=this.updateGraphics.toArray();Zs(n,d),n.refreshComponent(),this._emitRedoEvent({graphics:d,tool:r})},addToSelection:d=>_(this,null,function*(){yield this._updateSpatialReference(d),this.updateGraphics.push(d),o.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[d],removed:[],type:"selection-change"},type:"update"})}),removeFromSelection:d=>{let h=this.updateGraphics.indexOf(d);n.history.undo.forEach(m=>m.updates.splice(h,1)),n.history.redo.forEach(m=>m.updates.splice(h,1)),this.updateGraphics.remove(d);let u=this.updateGraphics.toArray();this.emit("update",{graphics:u,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[d],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?o.graphics=u:n.complete()}}),s=!1,l=[i.on("immediate-click",d=>this._getCommonUpdateOperationClickHandlers(n,d,t),j.WIDGET),i.on("key-down",d=>{this._getCommonUpdateOperationKeyDownHandlers(n,d),d.key!==$.constraint||d.repeat||(s=!0,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},j.WIDGET),i.on("key-up",d=>{d.key===$.constraint&&s&&(s=!1,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},j.WIDGET)],p=this._getHandlesForComponent(n,t);return n})}_setupReshape3DOperation(e,t,i,r=!1){return _(this,null,function*(){let o="reshape",n=yield this._requireModule(import("./chunk-Z4YWSKAI.js"));if(pe(n))return n;let{ManipulatedObject3DGraphic:s,ReshapeTool3D:l}=n.module,p=new s({view:i,graphic:e}),d=Gg(p);if(d!==me.SUPPORTED)return p.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${el(d)}).`),null;let h=t.reshapeOptions,u=new l({view:i,object:p,enableZVertex:t.enableZ&&h?.vertexOperation==="move",enableZShape:t.enableZ&&h?.shapeOperation==="move",enableMoveObject:h?.shapeOperation==="move"||h?.shapeOperation==="move-xy",enableMidpoints:h?.edgeOperation==="split",enableEdgeOffset:h?.edgeOperation==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(u),r||this.updateGraphics.add(p.graphic);let m=[],v=new Mt({activeComponent:u,tool:o,type:"update",onEnd:()=>{m.forEach(w=>w.remove()),m.length=0,i.tools?.remove(u),u.destroyed||u.destroy(),p.destroy()},canUndo:()=>u.canUndo,undo:()=>{u.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},canRedo:()=>u.canRedo,redo:()=>{u.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:w=>_(this,null,function*(){this.updateGraphics.add(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[w],removed:[],type:"selection-change"},type:"update"}),v.onEnd(),v.destroy();let M=yield this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);pe(M)||this._setUpdateOperationHandle(M,t)}),removeFromSelection:w=>{this.updateGraphics.remove(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[w],type:"selection-change"},type:"update"}),v.complete()},toggleTool:()=>_(this,null,function*(){if(t.toggleToolOnClick===!1)return;v.onEnd(),v.destroy();let w=yield this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,i,!0);pe(w)||this._setUpdateOperationHandle(w,t)})});return m.push(...this._getHandlesForComponent(v,t),i.on("immediate-click",w=>this._getCommonUpdateOperationClickHandlers(v,w,t),j.WIDGET),i.on("key-down",w=>{this._getCommonUpdateOperationKeyDownHandlers(v,w)},j.WIDGET)),v})}_setupTransformOrReshape2DOperation(e,t,i,r){return _(this,null,function*(){this.updateGraphics.addMany(e),yield this._updateSpatialReference(e);let o=t==="transform"?yield this._getBox(e,i,r):yield this._getReshape(e,i,r);if(pe(o))return o;let n=new Mt({activeComponent:o,type:"update",onEnd:()=>{l.forEach(p=>p.remove()),s.forEach(p=>p.remove()),l=[],s=[],n.activeComponent&&!n.activeComponent.destroyed&&n.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{$s(n,this.updateGraphics.toArray()),n.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n.tool})},redo:()=>{Zs(n,this.updateGraphics.toArray()),n.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n.tool})},addToSelection:p=>_(this,null,function*(){let d=n.activeComponent;if(d?.type==="reshape"){let h=[...this.updateGraphics,p];this.updateGraphics.removeAll(),n.onEnd(),n.destroy();let u=yield this._setupTransformOrReshape2DOperation(h,"transform",i,r);if(pe(u))return;this._setUpdateOperationHandle(u,i)}else this.updateGraphics.add(p),d.graphics=this.updateGraphics.toArray(),d.refresh(),n.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[p],removed:[],type:"selection-change"},type:"update"})}),removeFromSelection:p=>_(this,null,function*(){let d=this.updateGraphics.indexOf(p);n.history.undo.forEach(u=>u.updates.splice(d,1)),n.history.redo.forEach(u=>u.updates.splice(d,1)),this.updateGraphics.remove(p);let h=this.updateGraphics.toArray();if(h.length===0)n.complete();else{let u=h[0].geometry;h.length!==1||u==null||u.type!=="point"&&u.type!=="multipoint"?n.activeComponent.graphics=h:n.toggleTool()}this.emit("update",{graphics:h,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[p],type:"selection-change"},type:"update"})}),toggleTool:()=>_(this,null,function*(){if(this.updateGraphics.length>1)return;let p=this.updateGraphics.at(0),d=p.geometry;if(d!=null&&(n.tool==="reshape"&&(d.type==="point"||d.type==="multipoint")||n.tool==="transform"&&d.type==="extent"))return;let h=null;n.tool==="transform"?h=yield this._getReshape([p],i,r):n.tool==="reshape"&&(h=yield this._getBox([p],i,r)),pe(h)||(n.activeComponent?.destroy(),n.activeComponent=h,n.activeComponent&&(l.forEach(u=>u.remove()),l=this._getHandlesForComponent(n,i)))})}),s=[r.on("immediate-click",p=>this._getCommonUpdateOperationClickHandlers(n,p,i),j.WIDGET),r.on("key-down",p=>{if(this._getCommonUpdateOperationKeyDownHandlers(n,p),p.key===$.constraint&&!p.repeat&&n){let d=n.activeComponent;d&&d.type==="box"&&(d.preserveAspectRatio=!d.preserveAspectRatio)}},j.WIDGET),r.on("key-up",p=>{if(p.key===$.constraint&&n){let d=n.activeComponent;d&&d.type==="box"&&(d.preserveAspectRatio=!d.preserveAspectRatio)}},j.WIDGET)],l=this._getHandlesForComponent(n,i);return n})}_getGraphicMover(e,t,i){return _(this,null,function*(){let{enableMoveAllGraphics:r,highlightOptions:o}=t,n=yield this._requireModule(import("./chunk-BKFQMIA6.js"));return pe(n)?n:new n.module.default({enableMoveAllGraphics:r,highlightsEnabled:!!o?.enabled,indicatorsEnabled:!1,graphics:e,view:i,callbacks:{onGraphicMoveStart:({dx:s,dy:l,graphic:p})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:s,dy:l,mover:p,type:"move-start"},type:"update"})},onGraphicMove:({dx:s,dy:l,graphic:p})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:s,dy:l,mover:p,type:"move"},type:"update"}),onGraphicMoveStop:({dx:s,dy:l,graphic:p})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:s,dy:l,mover:p,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})})}_getBox(e,t,i){return _(this,null,function*(){let{enableRotation:r,enableScaling:o,highlightOptions:n,preserveAspectRatio:s}=t,l=yield this._requireModule(import("./chunk-5BZOO7C5.js"));if(pe(l))return l;let p=this.view?.inputManager?.isModifierKeyDown($.constraint);return new l.module.default({graphics:e,enableRotation:r,enableScaling:o,highlightsEnabled:!!n?.enabled,preserveAspectRatio:!!s!=!!p,layer:this._internalGraphicsLayer,view:i,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"}),onMove:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"}),onMoveStop:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"}),onScaleStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"}),onScale:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"}),onScaleStop:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"}),onRotateStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"}),onRotate:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"}),onRotateStop:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},d),type:"update"})}})})}_getReshape(e,t,i){return _(this,null,function*(){let r=t.reshapeOptions?.edgeOperation==="split",o=t.reshapeOptions?.shapeOperation==="move",n=!!t.highlightOptions?.enabled,s=yield this._requireModule(import("./chunk-3EGHHX2T.js"));return pe(s)?s:new s.module.default({enableMidpoints:r,enableMovement:o,graphic:e[0],highlightsEnabled:n,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:i,callbacks:{onReshapeStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},l),type:"update"}),onReshape:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:g({},l),type:"update"}),onReshapeStop:({mover:l,type:p})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:l,type:p},type:"update"}),onMoveStart:({dx:l,dy:p,mover:d,type:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:d,type:h},type:"update"}),onMove:({dx:l,dy:p,mover:d,type:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:d,type:h},type:"update"}),onMoveStop:({dx:l,dy:p,mover:d,type:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:d,type:h},type:"update"}),onVertexAdd:({added:l,type:p,vertices:d})=>{let h=l.map(u=>Fa(u.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:h,vertices:d,type:p},type:"update"})},onVertexRemove:({removed:l,type:p,vertices:d})=>{let h=l.map(u=>Fa(u.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:h,vertices:d,type:p},type:"update"})}}})})}_getHandlesForComponent(e,t){let i=e.activeComponent;if(!i)return[];switch(i.type){case"graphic-mover":return[i.on("graphic-click",({graphic:r,viewEvent:o})=>{o.native?.shiftKey&&(o.stopPropagation(),e.removeFromSelection(r))}),i.on("graphic-move-start",r=>e.addToHistory(fi(r.allGraphics)))];case"box":return[i.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,t,r)),i.on("move-start",r=>e.addToHistory(fi(r.graphics))),i.on("rotate-start",r=>e.addToHistory(fi(r.graphics))),i.on("scale-start",r=>e.addToHistory(fi(r.graphics)))];case"reshape":return[i.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,t,r)),i.on("move-start",r=>e.addToHistory(fi([r.mover]))),i.on("reshape-start",r=>e.addToHistory(fi([r.graphic]))),i.on("vertex-add",r=>e.addToHistory(fi([r.oldGraphic]))),i.on("vertex-remove",r=>e.addToHistory(fi([r.oldGraphic])))];case"move-3d":return[i.events.on("record-undo",({updates:r})=>{e.addToHistory({updates:r})}),i.events.on("move-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.objects.length>0?r.objects[0].graphic:null,type:"move-start"},type:"update"})}),i.events.on("move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:r.dx,dy:r.dy,mover:r.objects.length>0?r.objects[0].graphic:null,type:"move"},type:"update"})}),i.events.on("move-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.objects.length>0?r.objects[0].graphic:null,type:"move-stop"},type:"update"})}),i.events.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.object.graphic],e,t):e.toggleTool()})];case"transform-3d":return[i.events.on("record-undo",({updates:r})=>{e.addToHistory({updates:r})}),i.events.on("translate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-start"},type:"update"})}),i.events.on("translate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-stop"},type:"update"})}),i.events.on("rotate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,angle:r.angle,type:"rotate-start"},type:"update"})}),i.events.on("rotate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,angle:r.angle,type:"rotate-stop"},type:"update"})}),i.events.on("scale-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-start"},type:"update"})}),i.events.on("scale-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-stop"},type:"update"})}),i.events.on("translate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move"},type:"update"})}),i.events.on("rotate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,angle:r.angle,type:"rotate"},type:"update"})}),i.events.on("scale",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale"},type:"update"})}),i.events.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.object.graphic],e,t):e.toggleTool()})];case"reshape-3d":return[i.events.on("reshape",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:T(g({},r),{mover:r.object.graphic}),type:"update"})}),i.events.on("move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:T(g({},r),{mover:r.object.graphic}),type:"update"})}),i.events.on("vertex-add",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),i.events.on("vertex-remove",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),i.events.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.object.graphic],e,t):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,t,i){let{graphic:r,viewEvent:o}=i;return o.native?.shiftKey&&r.layer===this.layer?(o.stopPropagation(),e.removeFromSelection(r)):t.toggleToolOnClick?(o.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){this._operationHandle=e;let i=this.view?.map;this._disablePopup(t);let r=()=>{if(e===this._operationHandle){let o=this.updateGraphics.toArray(),n=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),i&&i.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:o,state:"complete",aborted:e.cancelled,tool:n,toolEventInfo:null,type:"update"})}};e.on("complete",r)}_getCommonUpdateOperationClickHandlers(e,t,i){return _(this,null,function*(){let r=je(t),o=yield t.async(()=>this._getFirstHit(r));if(o==null)return void e.complete();if(t.native.shiftKey&&this._toggleSelection([o.graphic],e,i))return void t.stopPropagation();this.updateGraphics.includes(o.graphic)?t.stopPropagation():e.complete()})}_toggleSelection(e,t,i){let r=!!i.multipleSelectionEnabled;return e.some(o=>o!=null&&!(!r||o.layer!==this.layer)&&(this.updateGraphics.includes(o)?t.removeFromSelection(o):t.addToSelection(o),!0))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;let i=t.key;i===$.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):i===$.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):i===$.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&$.delete.includes(i)&&this._onDeleteKey(t)}_onDeleteKey(e){if(!this._operationHandle||this._operationHandle.type!=="update")return;let t=this.activeComponent,i=this.updateGraphics.toArray();t!=null&&(t.type!=="reshape"||i.length===1&&i[0].geometry?.type==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=A(this._internalGraphicsLayer))}_isComponentGraphic(e){let{activeComponent:t}=this;return!(!e||t==null)&&(e.attributes?.esriSketchTool||t.type==="draw-2d"&&t.graphic===e||(t.type==="box"||t.type==="reshape")&&t.isUIGraphic(e))}_displayPointerCursor(){this.view?.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view?.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view?.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,t,i){E.getLogger(this).error(new P(e,t,i))}_requireModule(e){return _(this,null,function*(){let t=new AbortController;this._moduleLoaderAbortController=t;let i=yield e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:i}})}_emitUndoEvent(e){this.emit("undo",T(g({},e),{type:"undo"}))}_emitRedoEvent(e){this.emit("redo",T(g({},e),{type:"redo"}))}_emitDeleteEvent(e){this.emit("delete",T(g({},e),{type:"delete"}))}get test(){}wait(){return At(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){return this.view?.type!=="3d"||this.updateOnGraphicClick||(e?.toggleToolOnClick??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}_waitViewReady(){return _(this,null,function*(){let e=this.view;e?(Rt(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,yield ei(At(()=>e?.ready),this._viewReadyAbortController.signal)):this._logMissingView()})}_logMissingView(){this._logError("sketch:missing-property",Wg("view"))}_logMissingLayer(){this._logError(gb,Wg("layer"))}};a([c()],G.prototype,"_defaultSnappingManager",void 0),a([c()],G.prototype,"updating",null),a([c()],G.prototype,"_operationHandle",void 0),a([c({readOnly:!0})],G.prototype,"activeTool",null),a([c()],G.prototype,"activeFillSymbol",void 0),a([c()],G.prototype,"activeLineSymbol",void 0),a([c()],G.prototype,"activeVertexSymbol",void 0),a([c()],G.prototype,"allowDeleteKey",void 0),a([c({readOnly:!0})],G.prototype,"createGraphic",null),a([c()],G.prototype,"defaultCreateOptions",null),a([c()],G.prototype,"defaultUpdateOptions",null),a([c({type:Vu,nonNullable:!0})],G.prototype,"labelOptions",null),a([c()],G.prototype,"layer",void 0),a([c({types:po})],G.prototype,"pointSymbol",void 0),a([c({types:po})],G.prototype,"polygonSymbol",void 0),a([c({types:po})],G.prototype,"polylineSymbol",void 0),a([c()],G.prototype,"meshSymbol",void 0),a([c({type:fr,nonNullable:!0})],G.prototype,"snappingOptions",null),a([c()],G.prototype,"snappingManager",null),a([c({readOnly:!0})],G.prototype,"state",null),a([c({type:Nu,nonNullable:!0})],G.prototype,"tooltipOptions",null),a([c({readOnly:!0})],G.prototype,"updateGraphics",void 0),a([c()],G.prototype,"updateOnGraphicClick",void 0),a([c({type:Nn,nonNullable:!0})],G.prototype,"valueOptions",null),a([c({types:po})],G.prototype,"vertexSymbol",void 0),a([c({value:null})],G.prototype,"view",null),a([c({constructOnly:!0,type:mr})],G.prototype,"sketchOptions",void 0),G=a([f("esri.widgets.Sketch.SketchViewModel")],G);var gb="sketch:missing-property",Wg=e=>`Property '${e}' is missing on SketchViewModel.`;function yb(e){return e==="polygon"||e==="rectangle"||e==="circle"}function $s(e,t){Zg("undo",e.history.undo,e.history.redo,t)}function Zs(e,t){Zg("redo",e.history.redo,e.history.undo,t)}function Zg(e,t,i,r){let o=t.pop();if(!o)return;let n=o.updates,s=[];r.forEach((l,p)=>{let d=n[p];d!=null&&("geometry"in d&&d.geometry!=null&&(s.push({geometry:l.geometry}),l.geometry=d.geometry),"symbol"in d&&d.symbol!=null&&(s.push({symbol:l.symbol}),l.symbol=d.symbol),"undo"in d&&(s.push(d),d[e](l)))}),i.push({updates:s})}function $g(e,t){e!=null&&t.hasGrabbedManipulators&&(e.activeTool=null)}function fi(e){return{updates:e.map(({geometry:t})=>t?.type==="mesh"?{geometry:t.cloneShallow()}:{geometry:t})}}function pe(e){return"requireError"in e&&e.requireError==="aborted"}var qg=G;var qt=class extends S{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.header=!1,this.layerList=!0,this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};a([c({type:Boolean,nonNullable:!0})],qt.prototype,"enabledToggle",void 0),a([c({type:Boolean,nonNullable:!0})],qt.prototype,"featureEnabledToggle",void 0),a([c({type:Boolean,nonNullable:!0})],qt.prototype,"header",void 0),a([c({type:Boolean,nonNullable:!0})],qt.prototype,"layerList",void 0),a([c({type:Boolean,nonNullable:!0})],qt.prototype,"layerListToggleLayersButton",void 0),a([c({type:Boolean,nonNullable:!0})],qt.prototype,"selfEnabledToggle",void 0),qt=a([f("esri.widgets.support.SnappingControls.VisibleElements")],qt);var $r=qt;var dt=class extends S{constructor(e){super(e),this.point=!0,this.polyline=!0,this.polygon=!0,this.rectangle=!0,this.circle=!0,this.multipoint=!0,this.mesh=!0}};a([c({type:Boolean,nonNullable:!0})],dt.prototype,"point",void 0),a([c({type:Boolean,nonNullable:!0})],dt.prototype,"polyline",void 0),a([c({type:Boolean,nonNullable:!0})],dt.prototype,"polygon",void 0),a([c({type:Boolean,nonNullable:!0})],dt.prototype,"rectangle",void 0),a([c({type:Boolean,nonNullable:!0})],dt.prototype,"circle",void 0),a([c({type:Boolean,nonNullable:!0})],dt.prototype,"multipoint",void 0),a([c({type:Boolean,nonNullable:!0})],dt.prototype,"mesh",void 0),dt=a([f("esri.widgets.Sketch.VisibleElements.CreateToolVisibilityMap")],dt);var ji=class extends S{constructor(e){super(e),this["rectangle-selection"]=!0,this["lasso-selection"]=!0,this["custom-selection"]=!0}};a([c({nonNullable:!0})],ji.prototype,"rectangle-selection",void 0),a([c({nonNullable:!0})],ji.prototype,"lasso-selection",void 0),a([c({nonNullable:!0})],ji.prototype,"custom-selection",void 0),ji=a([f("esri.widgets.Sketch.VisibleElements.SelectionToolVisibilityMap")],ji);var Ze=class extends S{constructor(e){super(e),this.createTools=new dt,this.directionModePicker=!1,this.duplicateButton=!0,this.labelsToggle=!0,this.selectionTools=new ji,this.settingsMenu=!0,this.snappingControls=!0,this.snappingControlsElements=new $r,this.tooltipsToggle=!0,this.undoRedoMenu=!0}};a([c({type:dt,nonNullable:!0})],Ze.prototype,"createTools",void 0),a([c({type:Boolean,nonNullable:!0})],Ze.prototype,"directionModePicker",void 0),a([c({type:Boolean,nonNullable:!0})],Ze.prototype,"duplicateButton",void 0),a([c({type:Boolean,nonNullable:!0})],Ze.prototype,"labelsToggle",void 0),a([c({type:ji,nonNullable:!0})],Ze.prototype,"selectionTools",void 0),a([c({type:Boolean,nonNullable:!0})],Ze.prototype,"settingsMenu",void 0),a([c({type:Boolean,nonNullable:!0})],Ze.prototype,"snappingControls",void 0),a([c({type:$r,nonNullable:!0})],Ze.prototype,"snappingControlsElements",void 0),a([c({type:Boolean,nonNullable:!0})],Ze.prototype,"tooltipsToggle",void 0),a([c({type:Boolean,nonNullable:!0})],Ze.prototype,"undoRedoMenu",void 0),Ze=a([f("esri.widgets.Sketch.VisibleElements")],Ze);var rp=Ze;var Ee=class extends S{constructor(e){super(e),this.coordinates=void 0,this.strokeDash=[],this.strokeWidth=1,this.strokeColor=[0,0,0,1],this.strokeDashColor=[255,255,255,1],this.fillColor=[0,0,0,0],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){let e=this.strokeColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _strokeBackgroundStyle(){let e=this.strokeDashColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _fillStyle(){let e=this.fillColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _renderCoordinates(){let e=[];if(!this.coordinates)return{coordinates:e,rect:Na};let t=Qd(Yd(Ei(Na),this.coordinates),2*this.strokeWidth);t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]+.5),t[3]=Math.ceil(t[3]+.5);for(let i of this.coordinates)e.push([Math.floor(i[0]-t[0])+.5,Math.floor(i[1]-t[1])+.5]);return e.reverse(),{coordinates:e,rect:t}}render(){let{coordinates:e,rect:t}=this._renderCoordinates,i=wn(t),r=bn(t);return y("div",{classes:{"esri-outline-overlay-item":!0},styles:{left:t[0]+"px",top:t[1]+"px",width:i+"px",height:r+"px",visibility:this.visible?"visible":"hidden"}},y("svg",{height:r,styles:{display:"block"},width:i},y("polygon",{fill:this._fillStyle,points:e.map(([o,n])=>`${o},${n}`).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),y("polygon",{fill:"transparent",points:e.map(([o,n])=>`${o},${n}`).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};a([c()],Ee.prototype,"coordinates",void 0),a([c()],Ee.prototype,"strokeDash",void 0),a([c()],Ee.prototype,"strokeWidth",void 0),a([c()],Ee.prototype,"strokeColor",void 0),a([c()],Ee.prototype,"strokeDashColor",void 0),a([c()],Ee.prototype,"fillColor",void 0),a([c()],Ee.prototype,"visible",void 0),a([c()],Ee.prototype,"isDecoration",void 0),a([c({readOnly:!0})],Ee.prototype,"_strokeStyle",null),a([c({readOnly:!0})],Ee.prototype,"_strokeBackgroundStyle",null),a([c({readOnly:!0})],Ee.prototype,"_fillStyle",null),a([c({readOnly:!0})],Ee.prototype,"_renderCoordinates",null),Ee=a([f("esri.views.overlay.OutlineOverlayItem")],Ee);var Kg=Ee;var Ae=class extends oe.EventedMixin(Zu){constructor(e){super(e),this._overlayItem=void 0,this.geometryType=null,this.mode=null,this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();let e=t=>this.drawOperation.on(t,i=>{this._updateVisuals(),this.emit(t,i)});this.addHandles([e("vertex-add"),e("vertex-remove"),e("vertex-update"),e("cursor-update"),e("complete")]),this.finishToolCreation()}destroy(){this.drawOperation=A(this.drawOperation),this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centeredToggled(e){this._set("centeredToggled",e),this._updateVisuals()}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}set uniformSizeToggled(e){this._set("uniformSizeToggled",e),this._updateVisuals()}get updating(){return this.drawOperation?.updating??!1}get cursor(){return this.geometryType==="point"?"default":"crosshair"}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(e){this.destroyed||this.drawOperation.onInputEvent(e)}redo(){this.drawOperation.redo()}undo(){this.drawOperation.undo()}reset(){}_makeDrawOperation(){let{view:e}=this;return new Ku({view:e,manipulators:this.manipulators,geometryType:vb(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new ol,hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor})}get coordinates(){let{drawOperation:e}=this;if(!e?.geometryIncludingUncommittedVertices.length)return[];let{coordinateHelper:t}=e,i=e.committableVertex,r=e.committedVertices.slice();i!=null&&r.push(t.pointToArray(i));let o=r.length;switch(this.geometryType){case"circle":case"rectangle":{let n=new Gu(pu,ol.spatialReference),s=this.geometryType==="circle"?Wu:ju,l=this.geometryType==="circle"?$u:Bu;if(o===1&&e.isCompleted){let p=r[0],d=n.makeMapPoint(p[0]+_b,p[1]);return s([p,d],n,!0)?.geometry.rings[0]??[]}if(o===2){let p=this.geometryType!=="rectangle",d=this.centeredToggled!==p,h=this.geometryType!=="rectangle";return(this.uniformSizeToggled!==h?s(r,n,d)?.geometry.rings[0]:l(r,n,d)?.geometry.rings[0])??[]}return[]}}return r}_updateVisuals(){if(!this._overlayItem){let e=new Kg({strokeDash:[5],strokeDashColor:[255,255,255,255]});this.view.overlay?.addItem(e),this.addHandles(De(()=>{this.view.overlay?.removeItem(e),e?.destroy(),this._overlayItem=void 0})),this._overlayItem=e}this._overlayItem.coordinates=this.coordinates}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}};function vb(e){switch(e){case"polygon":case"point":return e;case"circle":case"rectangle":return"segment"}}a([c({value:!1})],Ae.prototype,"centeredToggled",null),a([c()],Ae.prototype,"drawOperation",void 0),a([c({value:!0})],Ae.prototype,"enabled",null),a([c({value:!1})],Ae.prototype,"uniformSizeToggled",null),a([c({constructOnly:!0})],Ae.prototype,"geometryType",void 0),a([c({constructOnly:!0})],Ae.prototype,"mode",void 0),a([c({readOnly:!0})],Ae.prototype,"type",void 0),a([c({readOnly:!0})],Ae.prototype,"updating",null),a([c({constructOnly:!0,nonNullable:!0})],Ae.prototype,"view",void 0),a([c()],Ae.prototype,"cursor",null),Ae=a([f("esri.views.draw.DrawScreenTool")],Ae);var _b=48;function wb(){return _(this,null,function*(){return import("./chunk-PM74IUJK.js")})}function bb(){return _(this,null,function*(){return wb().then(({contains:e,intersects:t,overlaps:i,simplify:r})=>({contains:e,intersects:t,overlaps:i,simplify:r}))})}function Qg(e){return _(this,null,function*(){let{currentSelection:t,selector:i,signal:r,sources:o,view:n}=e;if(!o?.length)return{added:[],removed:[]};let{layers:s,layerViews:l,graphicsLayers:p}=Mb(o),d=(yield ei(Promise.all([Cb(i,s,n,r),Tb(i,l,n,r),Sb(i,p,n)]),r)).flat();if(!t)return{added:d,removed:[]};let h=t.toArray(),u=d.filter(v=>!Yg(h,v)),m=h.filter(v=>!Yg(d,v));return t.removeMany(m),t.addMany(u),{added:u,removed:m}})}var Sb=(e,t,i)=>_(void 0,null,function*(){return Lb({candidates:t.flatMap(r=>r.graphics.toArray())??[],selector:e,view:i})}),Cb=(e,t,i,r)=>_(void 0,null,function*(){let o=yield He(Ib({selector:e,signal:r,layers:t,view:i}));return o?Xg(o):[]}),Tb=(e,t,i,r)=>_(void 0,null,function*(){let o=yield He(xb({selector:e,signal:r,layerViews:t,view:i}));return o?Xg(o):[]});function Xg(e){let t=[];for(let i=0;i<e.length;i++){let r=e[i];r.status==="fulfilled"&&t.push(...r.value)}return t}function Mb(e){let t=[],i=[],r=[];return e.forEach(o=>{eh(o)?t.push(o):(Tn(o)||Mn(o))&&o.layers?.length?t.push(...o.layers.toArray()):ih(o)&&o.sublayers?.length?r.push(...o.sublayers.toArray()):th(o)?r.push(o):ur(o)&&i.push(o)}),{layers:t,layerViews:i,graphicsLayers:r}}function Yg(e,t){if(e.includes(t))return!0;let i=t.getObjectId(),r=i!=null,{layer:o,uid:n}=t;return r?e.some(s=>{if(o===s.layer)return i===s.getObjectId()}):e.some(s=>{if(o===s.layer)return n===s.uid})}function xb(e){return _(this,null,function*(){let{layerViews:t,selector:i,signal:r,view:o}=e;return ei(Promise.allSettled(t.map(n=>_(this,null,function*(){let s=n.createQuery(),{geometry:l}=Jg(i,n.layer,o);return s.outFields=["*"],s.geometry=l,s.returnGeometry=!0,s.outSpatialReference=o.spatialReference,n.queryFeatures(s,{signal:r}).then(({features:p})=>p)}))),r)})}function Ib(e){return _(this,null,function*(){let{layers:t,selector:i,signal:r,view:o}=e;return ei(Promise.allSettled(t.map(n=>_(this,null,function*(){return n.queryFeatures(Eb(n.createQuery(),i,n,o),{signal:r}).then(({features:s})=>s)}))),r)})}function Jg(e,t,i){let r="displayField"in t?t.displayField:null,o=Zh({displayField:r,fields:t.fields}),n=[t.objectIdField];o!=null&&t.fieldsIndex.has(o)&&n.push(o);let s="renderer"in t?Du({renderer:t.renderer}):0;return{geometry:e.type==="point"?Ru(e,s,i):e,outFields:n}}function Eb(e,t,i,r){let{outFields:o,geometry:n}=Jg(t,i,r);return e.outFields=o,e.geometry=n,e.returnGeometry=!0,e.outSpatialReference=r.spatialReference,e}function Lb(e){return _(this,null,function*(){let{selector:t,candidates:i,view:r}=e;if(!i?.length||!t)return[];let{spatialReference:o}=r,n=t,s=yield bb();return i.filter(l=>s.intersects(o,n,l.geometry))})}var kb=100,Bi=class extends oe.EventedAccessor{constructor(e){super(e),this._processTask=null,this.options=null,this.selection=new L,this.sources=null,this._process=dd((t,i)=>_(this,null,function*(){let{callback:r,selector:o,completed:n}=t,s=ii(l=>_(this,null,function*(){let{sources:p,selection:d,view:h}=this;if(!(!p?.length&&!h?.selectionManager.sources.length)&&h){if(o&&p!=null){let u=yield Qg({currentSelection:d,selector:o,signal:l,sources:p,view:h});n&&h.selectionManager?.updateSelection(g({current:d.toArray()},u))}r&&r()}else d.removeAll()}));return nr(i,()=>s.abort()),this._processTask=s,s.promise}),kb)}initialize(){this._setup()}cancel(){this.removeAllHandles(),this._processTask?.abort()}_setup(){return _(this,null,function*(){let{view:e}=this;if(yield e.whenReady(),this.destroyed)return;let t=this.options,i=t?.createTool??"rectangle",r=t?.mode??(i==="polygon"?"click":"hybrid"),o=Symbol();this._tool=new Ae({view:e,mode:r,geometryType:i}),t?.selectOnComplete||this.addHandles(this._tool.on(["cursor-update","vertex-add","vertex-remove"],()=>He(this._process({selector:this._selectionArea}))),o),this.addHandles([e.on("key-down",n=>{if(!n.repeat)switch(n.key){case $.constraint:this._tool.uniformSizeToggled=!0,n.stopPropagation();break;case $.center:this._tool.centeredToggled=!0,n.stopPropagation()}}),e.on("key-up",n=>{switch(n.key){case $.constraint:this._tool.uniformSizeToggled=!1,n.stopPropagation();break;case $.center:this._tool.centeredToggled=!1,n.stopPropagation()}}),this._tool.on("complete",n=>_(this,null,function*(){this.removeHandles(o);let s=()=>{this.removeAllHandles(),this.emit("complete",{aborted:n.aborted,selection:this.selection.toArray()})};n.aborted?(this.cancel(),this.selection.removeAll(),s()):yield this._process({selector:this._selectionArea,callback:s,completed:!0})}))],o),this.addHandles(De(()=>e.tools.remove(this._tool))),e.addAndActivateTool(this._tool)})}get _selectionArea(){let e=H(),t=this._tool.coordinates,i=this.view.spatialReference,r=n=>{e.x=n[0],e.y=n[1];let{x:s,y:l}=this.view.toMap(e);return[s,l]};if(t.length===1){let[n,s]=r(t[0]);return new J({x:n,y:s,spatialReference:i})}let o=this._tool.coordinates.map(r);if(o.length!==0)return $d(o)||o.reverse(),new Sn({spatialReference:i,rings:[o]})}};a([c()],Bi.prototype,"options",void 0),a([c({readOnly:!0})],Bi.prototype,"selection",void 0),a([c()],Bi.prototype,"sources",void 0),a([c({constructOnly:!0})],Bi.prototype,"view",void 0),Bi=a([f("esri.widgets.support.Selector2D.SelectionOperation")],Bi);var ey=Bi;var Kt=class extends oe.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.sources=null}initialize(){this.addHandles([b(()=>this._sources,e=>{this.activeOperation&&(this.activeOperation.sources=e)})])}destroy(){this._operationHandlesGroup=Z(this._operationHandlesGroup)}get _sources(){let{sources:e,view:t}=this;return t&&e?.length?e.flatMap(i=>{if(ur(i))return i;if(Tn(i)||Mn(i)){let o=i.layers||[],n=o.map(s=>{let l=il(t,s)||void 0;return ur(l)?l:s});return n.length?n.toArray():o.length?o.toArray():i}let r=il(t,i)||void 0;return ur(r)?r:i}):[]}get layers(){return ir(E.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources}set layers(e){ir(E.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources=e}get state(){let{_sources:e,view:t}=this,i=!e?.length&&!t?.selectionManager.sources.length;return this.activeOperation?"active":t?.ready&&!i?"ready":"disabled"}cancel(){this.state==="active"&&(this.activeOperation?.cancel(),this._set("activeOperation",null))}activate(e){let{_sources:t,state:i,view:r}=this,o=!t?.length&&!r?.selectionManager.sources.length;if(i==="disabled"||o||!this.view)return;i==="active"&&this.cancel();let n=new ey({view:this.view,sources:t,options:e});return this._operationHandlesGroup=rr([n.selection.on("change",s=>this.emit("selection-change",s)),n.once("complete",s=>this._onOperationComplete(s))]),this._set("activeOperation",n),n}_onOperationComplete(e){this._operationHandlesGroup=Z(this._operationHandlesGroup),this._set("activeOperation",null),this.emit("complete",e)}};a([c()],Kt.prototype,"_sources",null),a([c({readOnly:!0})],Kt.prototype,"activeOperation",void 0),a([c()],Kt.prototype,"layers",null),a([c()],Kt.prototype,"sources",void 0),a([c({readOnly:!0})],Kt.prototype,"state",null),a([c()],Kt.prototype,"view",void 0),Kt=a([f("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],Kt);var ty=Kt;var iy={lassoTool:!0,rectangleTool:!0},Ob={createTool:"polygon",mode:"freehand"},Db={createTool:"rectangle"},op="esri-selection-toolbar",np={base:op,container:`${op}__container`,toolButton:`${op}__tool-button`},Fe=class extends ne{constructor(e,t){super(e,t),this._viewModelHandlesGroup=null,this.activeToolInfo=null,this.messages=null,this.toolConfigs=[],this.viewModel=new ty,this.visibleElements=g({},iy),this._viewModelHandlesGroup=rr([this.viewModel.on("complete",i=>{this._set("activeToolInfo",null),this.emit("complete",i)})])}destroy(){this._viewModelHandlesGroup=Z(this._viewModelHandlesGroup)}loadDependencies(){return Se({action:()=>import("./chunk-EANCIRMG.js"),icon:()=>import("./chunk-4HUBSTEF.js")})}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layers(){return ir(E.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources}set layers(e){ir(E.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources=e}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return g(g({},iy),e)}get visibleToolCount(){let{view:e,toolConfigs:t,visibleElements:i}=this;return(t?.length??0)+(e?.type==="2d"?(i.lassoTool?1:0)+(i.rectangleTool?1:0):0)}activate(e){if(this.cancel(),this.viewModel.state!=="disabled")switch(e){case"lasso":this._activateTool("lasso");break;case"rectangle":this._activateTool("rectangle");break;default:this._activateTool(e)}}cancel(){this.viewModel.cancel(),this._set("activeToolInfo",null)}render(){return y("div",{"aria-label":this.label,class:this.classes(np.base,K.widget)},y("div",{class:np.container},this._renderDefaultTools(),this._renderCustomTools()))}_renderDefaultTools(){if(this.view?.type==="2d")return[this._renderRectangleTool(),this._renderLassoTool()]}_renderCustomTools(){if(this.toolConfigs?.length)return this.toolConfigs.map(({toolName:e,icon:t})=>y("calcite-action",{active:this.activeToolInfo?.toolName===e,bind:this,class:np.toolButton,disabled:this.viewModel.state==="disabled",onclick:()=>this._onCustomToolClick(e),scale:"s",text:e,title:e},y("calcite-icon",{icon:t||"selection",scale:"s"})))}_renderLassoTool(){let{activeToolInfo:e,messages:t,visibleElements:i}=this;if(!i.lassoTool)return;let r=t.selectByLasso;return y("calcite-action",{active:e?.toolName==="lasso",bind:this,disabled:this.viewModel.state==="disabled",onclick:this._onLassoToolClick,scale:"s",text:r,title:r},y("calcite-icon",{icon:"lasso-select",scale:"s"}))}_renderRectangleTool(){let{activeToolInfo:e,messages:t,visibleElements:i}=this;if(!i.rectangleTool)return;let r=t.selectByRectangle;return y("calcite-action",{active:e?.toolName==="rectangle",bind:this,disabled:this.viewModel.state==="disabled",onclick:this._onRectangleToolClick,scale:"s",text:r,title:r},y("calcite-icon",{icon:"cursor-marquee",scale:"s"}))}_onCustomToolClick(e){this._toggleTool(e)}_onLassoToolClick(){this._toggleTool("lasso")}_onRectangleToolClick(){this._toggleTool("rectangle")}_activateTool(e){let t=this._getToolOptions(e);if(!t)return;let i=this.viewModel.activate(t);i&&this._set("activeToolInfo",{toolName:e,operation:i})}_toggleTool(e){if(this.activeToolInfo){let t=this.activeToolInfo.toolName;if(this.cancel(),t===e)return}this._activateTool(e)}_getToolOptions(e){return e==="lasso"?Ob:e==="rectangle"?Db:this.toolConfigs.find(t=>t.toolName===e)}};a([c({readOnly:!0})],Fe.prototype,"activeToolInfo",void 0),a([c()],Fe.prototype,"label",null),a([c()],Fe.prototype,"layers",null),a([c(),le("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],Fe.prototype,"messages",void 0),a([c()],Fe.prototype,"sources",null),a([c()],Fe.prototype,"toolConfigs",void 0),a([c()],Fe.prototype,"view",null),a([c()],Fe.prototype,"viewModel",void 0),a([c()],Fe.prototype,"visibleElements",void 0),a([ze("visibleElements")],Fe.prototype,"castVisibleElements",null),a([c()],Fe.prototype,"visibleToolCount",null),Fe=a([f("esri.widgets.support.SelectionToolbar")],Fe);var ry=Fe;var Ys=()=>Promise.all([Se({icon:()=>import("./chunk-4HUBSTEF.js"),label:()=>import("./chunk-LMCBFGZ4.js"),switch:()=>import("./chunk-JZRA6NKO.js"),tooltip:()=>import("./chunk-3DLWI6VB.js")})]),qs="esri-labeled-switch",Ks={label:`${qs}__label`,labelContent:`${qs}__label-content`,icon:`${qs}__icon`,tooltip:`${qs}__tooltip`};function Wi({checked:e,disabled:t,hint:i,key:r,label:o,onChange:n}){return y("calcite-label",{class:Ks.label,disabled:t,key:r,layout:"inline-space-between",scale:"s"},y("div",{class:Ks.labelContent,key:"label-content"},i?y(Ld,null,y("div",null,o),y("calcite-icon",{class:Ks.icon,icon:"information",id:r,scale:"s"}),y("calcite-tooltip",{class:Ks.tooltip,referenceElement:r},i)):o),y("calcite-switch",{checked:e,disabled:t,scale:"s",onCalciteSwitchChange:s=>n(s.target.checked)}))}var $i=class extends S{constructor(e){super(e),this.directionModePicker=!1,this.header=!1,this.labelsToggle=!0,this.tooltipsToggle=!0}};a([c({type:Boolean,nonNullable:!0})],$i.prototype,"directionModePicker",void 0),a([c({type:Boolean,nonNullable:!0})],$i.prototype,"header",void 0),a([c({type:Boolean,nonNullable:!0})],$i.prototype,"labelsToggle",void 0),a([c({type:Boolean,nonNullable:!0})],$i.prototype,"tooltipsToggle",void 0),$i=a([f("esri.widgets.support.SketchTooltipControls.VisibleElements")],$i);var sp=$i;var Xo="esri-sketch-tooltip-controls",Qs={base:Xo,block:`${Xo}__block`,blockContent:`${Xo}__block-content`,hintIcon:`${Xo}__hint-icon`,radioButtonLabelWrapper:`${Xo}__radio-button-label-wrapper`},gi=class extends ne{constructor(e,t){super(e,t),this.viewModel=null,this.visibleElements=new sp,this.sketchOptions=new mr,this.viewType=void 0,this._onTooltipsEnabledChange=i=>{this.sketchOptions.tooltips.enabled=i},this._onLabelsEnabledChange=i=>{this.sketchOptions.labels.enabled=i},this._onDirectionModeChange=i=>{this.sketchOptions.values.directionMode=i.target.selectedItem.value}}loadDependencies(){return Promise.all([Se({block:()=>import("./chunk-ZKHFZ44S.js"),label:()=>import("./chunk-LMCBFGZ4.js"),icon:()=>import("./chunk-4HUBSTEF.js"),"radio-button":()=>import("./chunk-KVC4CJDJ.js"),"radio-button-group":()=>import("./chunk-FRJNOSUK.js")}),Ys()])}render(){let{label:e,visibleElements:t}=this,i=this._renderContent();return y("div",{"aria-label":e,class:this.classes(Qs.base,K.widget)},i?y("calcite-block",{class:Qs.block,heading:t.header?this.label:"",key:"content-block",open:!0},y("div",{class:Qs.blockContent,key:"content"},i)):void 0)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}_renderContent(){let{visibleElements:e,viewType:t}=this,i=[e.tooltipsToggle?this._renderTooltipsToggle():null,e.labelsToggle&&t!=="2d"?this._renderLabelsToggle():null,e.directionModePicker?this._renderDirectionModePicker():null].filter(fe);return i.length===0?null:i}_renderTooltipsToggle(){let{messages:e,sketchOptions:t}=this;return y(Wi,{checked:t.tooltips.effectiveEnabled,hint:e.tooltipsToggleHint,key:`${this.id}__tooltips`,label:e.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){let{messages:e,sketchOptions:t}=this;return y(Wi,{checked:t.labels.enabled,hint:e.labelsToggleHint,key:`${this.id}__labels`,label:e.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){let{messages:e,sketchOptions:t}=this,{directionMode:i}=t.values;return y("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},e.directionModePicker,y("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:i,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",i,e.directionModeRelative),this._renderDirectionModeOption("absolute",i,e.directionModeAbsolute)))}_renderDirectionModeOption(e,t,i){return y("calcite-label",{key:e,layout:"inline",scale:"s"},y("calcite-radio-button",{checked:e===t,scale:"s",value:e}),y("div",{class:Qs.radioButtonLabelWrapper,key:"label-wrapper"},y("calcite-icon",{icon:qu[e],scale:"s"}),i))}};a([c()],gi.prototype,"label",null),a([c({type:sp,nonNullable:!0})],gi.prototype,"visibleElements",void 0),a([c(),le("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],gi.prototype,"messages",void 0),a([c({nonNullable:!0,type:mr})],gi.prototype,"sketchOptions",void 0),a([c({type:String})],gi.prototype,"viewType",void 0),gi=a([f("esri.widgets.support.SketchTooltipControls")],gi);var oy=gi;var Rb={hide:"hide",hideChildren:"hide-children"};function Zr(e){return e?.listMode??void 0}function ny(e){if(!e)return"inherited";let t=Pb(lp(e)?e.layer:e);return t!=null?t?"independent":"inherited":"visibilityMode"in e&&e.visibilityMode!=null?e.visibilityMode:"independent"}function Xs(e){if(e&&(!("type"in e)||e.type!=="wmts"))return"sublayers"in e?"sublayers":"layers"in e?"layers":void 0}function qr(e){return Zr(e)!==Rb.hide}function ap(e){let t=e?.layer;return t&&"layers"in t?t.layers:null}function lp(e){return e!=null&&"layer"in e&&e.layer!=null}function Pb(e){let t=Ab(e);return t!=null&&"supportsSublayerVisibility"in t?t.supportsSublayerVisibility:void 0}function Ab(e){return e&&"capabilities"in e&&e.capabilities!=null&&"exportMap"in e.capabilities?e.capabilities.exportMap:void 0}var cp,yi=cp=class extends Ln{constructor(e){super(e),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new cp({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};a([c()],yi.prototype,"displayValueEnabled",void 0),a([c()],yi.prototype,"max",void 0),a([c()],yi.prototype,"min",void 0),a([c()],yi.prototype,"step",void 0),a([c()],yi.prototype,"value",void 0),yi=cp=a([f("esri.support.actions.ActionSlider")],yi);var sy=yi;var ve=class extends Cn(ne){constructor(e,t){super(e,t),this._legend=null,this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([b(()=>this._canCreateLegend,()=>this._createLegend(),R),b(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),R)])}destroy(){this._legend=A(this._legend)}get _canCreateLegend(){let{content:e,listItem:t}=this;if(!t)return!1;let i="legend";return e===i||e!=null&&!!Array.isArray(e)&&e.includes(i)}get _legendOptions(){let{listItem:e,_legendLayerInfo:t}=this,i=e?.view;return t&&i?{view:i,layerInfos:[t]}:{}}get _legendLayerInfo(){let e=this.listItem?.layer;if(!e||e.type==="subtype-sublayer")return null;let t=lp(e)?e:null,i=e?.parent,r=i!=null&&"type"in i&&i.type==="map-image"?t?.source:null,o="";return r&&i?{layer:i,title:o,sublayerIds:[r.mapLayerId]}:{layer:e,title:o}}get disabled(){let{listItem:e,_legend:t,content:i}=this;return!e||!(Array.isArray(i)&&i.length>1)&&!!t&&(!t.activeLayerInfos?.length||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){let{image:e}=this,t=this._getFirstWidget();return this._get("icon")??(!e&&t?t.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(e){this._override("title",e)}render(){return y("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){let{_legend:t,disabled:i,open:r}=this;return e&&!i&&r?e==="legend"&&t?y("div",{key:"legend-widget"},t.render()):typeof e=="string"?y("div",{innerHTML:e,key:e}):Ka(e)?y("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?y("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){let{content:e,open:t}=this;return t?Array.isArray(e)?e.map(i=>this._renderContent(i)):this._renderContent(e):null}_createLegend(){return _(this,null,function*(){if(A(this._legend),this._legend=null,!this._canCreateLegend)return;let{default:e}=yield import("./chunk-G6ZOFGOF.js"),t=new e(this._legendOptions);this._legend=t})}_attachToNode(e){e.appendChild(this)}_updateLegend(){let e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return e==="legend"?this._legend:Ka(e)?e:null}_getFirstWidget(){let{content:e}=this;return Array.isArray(e)?e.map(t=>this._getWidget(t)).find(t=>t):this._getWidget(e)}};a([c()],ve.prototype,"_legend",void 0),a([c()],ve.prototype,"_canCreateLegend",null),a([c()],ve.prototype,"_legendOptions",null),a([c()],ve.prototype,"_legendLayerInfo",null),a([c()],ve.prototype,"className",void 0),a([c()],ve.prototype,"content",void 0),a([c()],ve.prototype,"disabled",null),a([c()],ve.prototype,"flowEnabled",void 0),a([c()],ve.prototype,"icon",null),a([c()],ve.prototype,"image",void 0),a([c()],ve.prototype,"listItem",void 0),a([c()],ve.prototype,"open",void 0),a([c()],ve.prototype,"title",null),a([c()],ve.prototype,"visible",void 0),ve=a([f("esri.widgets.LayerList.ListItemPanel")],ve);var pp=ve;var Jo,Fb=L.ofType({key:"type",defaultKeyValue:"button",base:Ln,typeMap:{button:Vh,toggle:Nh,slider:sy}}),ay=L.ofType(Fb),dp="layer",Js="child-list-mode",Vb="hide",B=Jo=class extends Cn(S){constructor(e){super(e),this.actionsSections=new ay,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(L.ofType(Jo)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.panel=null,this.parent=null,this.view=null}initialize(){if(this.addHandles([b(()=>[this.layer,this.layer?.listMode,this.listModeDisabled],()=>this._watchLayerProperties(this.layer),R),b(()=>this.checkPublishStatusEnabled,e=>this._updateChildrenPublishing(e),R),b(()=>this.view,e=>this._updateChildrenView(e),R),b(()=>this.panel,e=>this._setListItemOnPanel(e),R)]),typeof this.listItemCreatedFunction=="function"){let e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){this.panel?.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){let{layerView:e,publishing:t}=this;if(!t&&e&&"connectionStatus"in e)return e.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){let{layerView:e}=this;return!(!e||!("spatialReferenceSupported"in e))&&!e.spatialReferenceSupported}get layerView(){let{layer:e,view:t}=this;if(!e||!t||e.type==="sublayer")return null;let i=e.type==="subtype-sublayer"?e.parent:e;return t.allLayerViews.find(r=>r.layer===i)??null}castPanel(e){return this.panel?.open&&!e.hasOwnProperty("open")&&(e.open=!0),e?new pp(e):null}get sortable(){return this.layer?.type!=="knowledge-graph-sublayer"&&this._get("sortable")}set sortable(e){this._set("sortable",e)}get title(){let e=Pt(this,"layer.layer");return(!e||e&&Pt(this,"layer.layer.loaded"))&&Pt(this,"layer.title")||Pt(this,"layer.attributes.title")||""}set title(e){this._override("title",e)}get publishing(){let{layer:e,checkPublishStatusEnabled:t}=this;return t&&e&&"publishingInfo"in e&&e.publishingInfo?.status==="publishing"}get updating(){let{layerView:e,connectionStatus:t,layer:i,publishing:r}=this;return!r&&!t&&(e?e.updating:i?.loadStatus==="loading"||!1)}get visible(){return this.layer?.visible}set visible(e){let t=this.layer;t&&(t.visible=e)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!0}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return ny(this.layer)}clone(){return new Jo({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildrenPublishing(e){let t=this.children;t&&t.forEach(i=>i.checkPublishStatusEnabled=e)}_updateChildrenView(e){let t=this.children;t&&t.forEach(i=>i.view=e)}_createChildren(e){let{listModeDisabled:t,children:i}=this,r=e.filter(o=>!i.some(n=>n.layer===o));i.addMany(this._createChildItems(r,t))}_destroyChildren(e){let{children:t}=this,i=t.filter(r=>!e.includes(r.layer));t.destroyMany(i)}_sortChildren(e){this.children.sort((t,i)=>e.indexOf(i.layer)-e.indexOf(t.layer))}_destroyAllChildren(){this.removeHandles(Js),this.children.destroyAll()}_watchChildLayerListMode(e){this.removeHandles(Js),this.listModeDisabled||this.addHandles(e.toArray().map(t=>b(()=>t.listMode,()=>this._compileChildren(e))),Js)}_compileChildren(e){let t=this.listModeDisabled?e:e?.filter(i=>Zr(i)!==Vb);t?.length?(this._createChildren(t),this._destroyChildren(t),this._sortChildren(t),this._watchChildLayerListMode(e)):this._destroyAllChildren()}_watchSublayerChanges(e){e&&this.addHandles(e.on("change",()=>this._compileChildren(e)),dp)}_initializeChildLayers(e){this._compileChildren(e),this._watchSublayerChanges(e)}_createChildItems(e,t){return e.map(i=>t||qr(i)?new Jo({layer:i,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(fe).reverse()}_watchLayerProperties(e){if(this.removeHandles(dp),this.removeHandles(Js),!e)return;if((!this.listModeDisabled&&Zr(e))==="hide-children")return void this.children.destroyAll();let t=Xs(e);t&&this.addHandles(b(()=>e[t],i=>{e.hasOwnProperty(t)&&this._initializeChildLayers(i)},R),dp)}};a([c({type:ay})],B.prototype,"actionsSections",void 0),a([c()],B.prototype,"actionsOpen",void 0),a([c()],B.prototype,"checkPublishStatusEnabled",void 0),a([c({type:L})],B.prototype,"children",void 0),a([c()],B.prototype,"childrenSortable",void 0),a([c({readOnly:!0})],B.prototype,"connectionStatus",null),a([c({readOnly:!0})],B.prototype,"error",null),a([c()],B.prototype,"hidden",void 0),a([c({readOnly:!0})],B.prototype,"incompatible",null),a([c()],B.prototype,"layer",void 0),a([c({readOnly:!0})],B.prototype,"layerView",null),a([c()],B.prototype,"listItemCreatedFunction",void 0),a([c({nonNullable:!0})],B.prototype,"listModeDisabled",void 0),a([c()],B.prototype,"open",void 0),a([c({type:pp})],B.prototype,"panel",void 0),a([ze("panel")],B.prototype,"castPanel",null),a([c()],B.prototype,"parent",void 0),a([c({value:!0})],B.prototype,"sortable",null),a([c()],B.prototype,"title",null),a([c({readOnly:!0})],B.prototype,"publishing",null),a([c({readOnly:!0})],B.prototype,"updating",null),a([c()],B.prototype,"view",void 0),a([c()],B.prototype,"visible",null),a([c({readOnly:!0})],B.prototype,"visibleAtCurrentScale",null),a([c({readOnly:!0})],B.prototype,"visibleAtCurrentTimeExtent",null),a([c({readOnly:!0})],B.prototype,"visibilityMode",null),B=Jo=a([f("esri.widgets.LayerList.ListItem")],B);var en=B;var ht={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},Nb="hide",ly=L.ofType(en),xt=class extends oe.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new ly,this.view=null}initialize(){this.addHandles([b(()=>this.view?.ready===!0,()=>this._viewHandles(),R),b(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList())],ht.view)}destroy(){this._removeAllItems(),this.view=null}get state(){let{view:e}=this;return e?.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(e=>e.children).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,r){let o=e?.layer;if(!o||o.type==="subtype-sublayer"||o.type==="sublayer")return;let n=this.view?.map?.layers,s=t?ap(t):n,l=i?ap(i):n;if(!s||!l)return;let{operationalItems:p}=this,d=t?.children||p,h=i?.children||p,u=l.length-r;e.parent=i||null,d.remove(e),s.remove(o),h.includes(e)||h.add(e,u),l.includes(o)||l.add(o,u),this._compileList()}_createLayerViewHandles(e){this.removeHandles(ht.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),ht.layerViews)}_createMapLayerHandles(e){this.removeHandles(ht.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),ht.mapLayers)}_createListItem(e){let{view:t,listItemCreatedFunction:i,checkPublishStatusEnabled:r,listModeDisabled:o}=this;return new en({checkPublishStatusEnabled:r,listModeDisabled:o,layer:e,listItemCreatedFunction:i,view:t})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(t=>Zr(t)!==Nb):void 0}_watchLayersListMode(e){this.removeHandles(ht.layerListMode),e&&!this.listModeDisabled&&this.addHandles(b(()=>e.filter(t=>"listMode"in t).map(t=>t.listMode).toArray(),()=>this._compileList()),ht.layerListMode)}_compileList(){let e=this.view?.map?.layers;this._watchLayersListMode(e);let t=this._getViewableLayers(e);t?.length?(this._createNewItems(t),this._removeItems(t),this._sortItems(t)):this._removeAllItems()}_createNewItems(e){let{operationalItems:t}=this;e.forEach(i=>{t.some(r=>r.layer===i)||t.add(this._createListItem(i))})}_removeItems(e){let{operationalItems:t}=this,i=[];t.forEach(r=>{r&&e&&e.includes(r.layer)||i.push(r)}),t.destroyMany(i)}_sortItems(e){let{operationalItems:t}=this;t.sort((i,r)=>{let o=e.indexOf(i.layer),n=e.indexOf(r.layer);return o>n?-1:o<n?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){let{view:e}=this;this.removeHandles([ht.mapLayers,ht.layerViews,ht.viewLayers]),e?.ready?this.addHandles([b(()=>this.view?.map?.allLayers,t=>this._createMapLayerHandles(t),R),b(()=>this.view?.allLayerViews,t=>this._createLayerViewHandles(t),R)],ht.viewLayers):this._removeAllItems()}};a([c()],xt.prototype,"checkPublishStatusEnabled",void 0),a([c()],xt.prototype,"listItemCreatedFunction",void 0),a([c({nonNullable:!0})],xt.prototype,"listModeDisabled",void 0),a([c({type:ly})],xt.prototype,"operationalItems",void 0),a([c({readOnly:!0})],xt.prototype,"state",null),a([c()],xt.prototype,"totalItems",null),a([c()],xt.prototype,"view",void 0),xt=a([f("esri.widgets.LayerList.LayerListViewModel")],xt);var cy=xt;var tn=e=>Hb(e)||Ub(e),Hb=e=>{if(!("type"in e))return!1;switch(e.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},Ub=e=>{let t=Xs(e);if(t!=null&&e.hasOwnProperty(t)&&e[t]!=null){for(let i of e[t])if(tn(i))return!0}return!1},rn=(e,t)=>t!=null&&e!=null&&(t.test(e.title)?"self":!!e.children.some(i=>rn(i,t)!==!1)&&"children");var hp,It=hp=class extends en{constructor(e){super(e),this.children=new L,this.parent=null}get enabled(){let{children:e}=this;if(e.length===0)return this.featureSource!=null&&this.featureSource.enabled?"enabled":"disabled";let t=!1,i=!1;for(let r of e){if(r.enabled==="indeterminate")return r.enabled;if(r.enabled==="enabled"?t=!0:r.enabled==="disabled"&&(i=!0),i&&t)return"indeterminate"}return i?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap(e=>[e.layer.id,...e.childLayerIds])}get featureSource(){let{layer:e,getFeatureSnappingSources:t}=this;return t().find(i=>i.layer===e)}_initializeChildLayers(e){if(!e)return;let t=e.filter(tn);super._initializeChildLayers(t)}_createChildItems(e){return e.map(t=>qr(t)?new hp({layer:t,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(fe).reverse()}};a([c()],It.prototype,"enabled",null),a([c()],It.prototype,"children",void 0),a([c()],It.prototype,"childLayerIds",null),a([c()],It.prototype,"featureSource",null),a([c({constructOnly:!0})],It.prototype,"getFeatureSnappingSources",void 0),a([c()],It.prototype,"parent",void 0),It=hp=a([f("esri.widgets.support.SnappingControls.SnappingListItem")],It);var vi=class extends cy{constructor(){super(...arguments),this.featureSnappingSources=new L}get operationalItemsFlat(){return this.operationalItems.flatten(e=>e.children)}get selectableItems(){return this.operationalItemsFlat.filter(e=>!e.children?.length)}_compileList(){let e=this.view?.map?.layers;if(!e)return;let t=e.filter(tn);this._watchLayersListMode(t);let i=this._getViewableLayers(t);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(e){return new It({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};a([c()],vi.prototype,"featureSnappingSources",void 0),a([c()],vi.prototype,"operationalItems",void 0),a([c()],vi.prototype,"operationalItemsFlat",null),a([c()],vi.prototype,"selectableItems",null),vi=a([f("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],vi);var Et=class extends S{constructor(e){super(e),this.layerListViewModel=new vi,this.snappingOptions=new fr,this.view=null}initialize(){this.addHandles([b(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:e,view:t})=>{e.view=t},R),b(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:e,sources:t})=>{e.featureSnappingSources=t},R)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??[]).every(e=>e.enabled==="enabled")}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every(e=>!e.enabled)}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter(e=>e.enabled==="enabled").length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(e,t){e?.forEach(i=>t?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach(({layer:{id:t}})=>{e?this.enableSnappingForLayer(t):this.disableSnappingForLayer(t)})}enableSnappingForLayer(e){let t=this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e);t&&(t.enabled=!0)}disableSnappingForLayer(e){let t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(let t of this.snappingOptions.featureSources)qr(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find(t=>t.layer.id===e)}_makeSnappingSourceForLayer(e){let t=this.layerListViewModel.operationalItemsFlat.find(r=>r.layer.id===e)?.layer;if(!t)throw new P("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);if(t.type==="group")return;let i=new Uu({layer:t});return this.snappingOptions.featureSources.add(i),i}};a([c()],Et.prototype,"allLayersEnabled",null),a([c()],Et.prototype,"allLayersDisabled",null),a([c({constructOnly:!0})],Et.prototype,"layerListViewModel",void 0),a([c()],Et.prototype,"layersEnabledCount",null),a([c({type:fr,nonNullable:!0})],Et.prototype,"snappingOptions",void 0),a([c()],Et.prototype,"state",null),a([c()],Et.prototype,"view",void 0),Et=a([f("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],Et);var py=Et;var ut="esri-snapping-controls",Lt={base:ut,container:`${ut}__container`,item:`${ut}__item`,toggleBlock:`${ut}__toggle-block`,layerListBlock:`${ut}__layer-list-block`,layerList:`${ut}__layer-list`,layerListFilter:`${ut}__layer-list__filter`,layerListButton:`${ut}__layer-list__button`,layerListItem:`${ut}__layer-list__item`,layerListGroup:`${ut}__layer-list__group`,nestedContainer:`${ut}__nested-container`},Ve=class extends ne{constructor(e,t){super(e,t),this._defaultViewModel=null,this._layerListFilter=null,this.layerListOpen=!0,this.messages=null,this.visibleElements=new $r,this._enableSnappingSwitchChange=n=>{this.snappingOptions.enabled=n},this._featureEnabledSwitchChange=n=>{this.snappingOptions.featureEnabled=n},this._selfEnabledSwitchChange=n=>{this.snappingOptions.selfEnabled=n},this._onToggleLayersButtonClick=n=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),requestAnimationFrame(()=>n.target.setFocus())};let{snappingOptions:i,view:r,viewModel:o}=e;this.viewModel=o??(this._defaultViewModel=new py({snappingOptions:i,view:r}))}normalizeCtorArgs(e){let n=e,{snappingOptions:t,view:i,viewModel:r}=n;return yp(n,["snappingOptions","view","viewModel"])}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=A(this._defaultViewModel))}loadDependencies(){return Promise.all([Se({block:()=>import("./chunk-ZKHFZ44S.js"),button:()=>import("./chunk-J63POI2Y.js"),input:()=>import("./chunk-6R2Z5WOF.js"),list:()=>import("./chunk-DB7XGNRL.js"),"list-item":()=>import("./chunk-4FFGJW4G.js"),checkbox:()=>import("./chunk-NRW7GLO6.js")}),Ys()])}get icon(){return"snap-to-point"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&(this._defaultViewModel!=null&&this._defaultViewModel===e||(this._defaultViewModel=A(this._defaultViewModel)),this._set("viewModel",e))}render(){let{label:e}=this;return y("div",{"aria-label":e,class:this.classes(Lt.base,K.widget)},y("div",{class:Lt.container},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList()]}_renderToggles(){let{visibleElements:e}=this,t=[e.selfEnabledToggle?this._renderSelfEnabledToggle():null,e.featureEnabledToggle?this._renderFeatureEnabledToggle():null].filter(fe),i=[e.enabledToggle?this._renderEnabledToggle():null,t.length>0?y("div",{class:Lt.nestedContainer},t):null].filter(fe);return i.length===0?null:y("calcite-block",{class:Lt.toggleBlock,heading:e.header?this.label:"",key:"toggle-block",open:!0},i)}_renderEnabledToggle(){let{messages:e,viewModel:t}=this,{snappingOptions:i}=t;return y(Wi,{checked:i.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:e.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){let{messages:e,viewModel:t}=this,{snappingOptions:i}=t,r=i.enabled&&i.selfEnabled;return y(Wi,{checked:r,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:e.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){let{messages:e,viewModel:t}=this,{snappingOptions:i}=t,r=i.enabled&&i.featureEnabled;return y(Wi,{checked:r,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:e.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;let{messages:e,viewModel:t}=this,i=({target:{value:s}})=>{this._layerListFilter=s===""?null:new RegExp(s,"i")},r=t.layerListViewModel.operationalItems.length>9?y("calcite-input",{class:Lt.layerListFilter,clearable:!0,placeholder:e?.searchLayers,onCalciteInputInput:i}):null,o=this._secondaryElementsDisabled,n=this.layerListOpen&&!o;return y("calcite-block",{class:Lt.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,heading:e.snappingLayers,key:"list-block",open:n,onCalciteBlockToggle:s=>this.layerListOpen=s.target.open},r,this._renderToggleLayersButton(),y("calcite-list",{class:Lt.layerList,selectionMode:"none"},this._renderLayerListItemCollection(t.layerListViewModel.operationalItems)))}_renderLayerListItemCollection(e){let t=this._layerListFilter;return e.map(i=>{switch(t?rn(i,t):null){case"children":{let r=i.children.filter(o=>rn(o,t)!==!1);return this._renderLayerListItemGroup(i,r)}case"self":case null:return this._renderLayerListItemOrGroup(i);case!1:return rn(i.parent,t)==="self"?this._renderLayerListItemOrGroup(i):null}}).toArray().filter(fe)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;let{viewModel:{allLayersEnabled:e},messages:t}=this,i=e?t.disableAllLayers:t.enableAllLayers;return y("calcite-button",{appearance:"transparent",class:Lt.layerListButton,label:i,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},i)}_renderLayerListItemOrGroup(e){if(e.children.length)return this._renderLayerListItemGroup(e);let{messages:{untitledLayer:t}}=this,i=e.title||t,r=()=>{this.viewModel.toggleSnappingForLayers([e.layer.id],e.enabled!=="enabled")};return y("calcite-list-item",{class:Lt.layerListItem,key:`${this.id}-list-item-${e.uid}`,label:i,onCalciteListItemSelect:o=>{o.stopPropagation(),r()}},y("calcite-checkbox",{checked:e.enabled==="enabled",slot:"actions-start",onCalciteCheckboxChange:r}))}_renderLayerListItemGroup(e,t){let{children:i,title:r}=e,o=r||this.messages.untitledLayer,n=r&&r!==""?r:fd(),s=!!t?.length,l=t??i,p=()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,e.enabled!=="enabled")};return y("calcite-list-item",{class:Lt.layerListGroup,key:n,label:o,open:s,onCalciteListItemSelect:d=>{d.stopPropagation(),p()}},y("calcite-checkbox",{checked:e.enabled==="enabled",indeterminate:e.enabled==="indeterminate",slot:"actions-start",onCalciteCheckboxChange:p}),y("calcite-list",null,this._renderLayerListItemCollection(l)))}get _enabledToggleDisabled(){let e=this.snappingOptions;return e.enabledToggled||e.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};a([c()],Ve.prototype,"_defaultViewModel",void 0),a([c()],Ve.prototype,"_layerListFilter",void 0),a([c()],Ve.prototype,"label",null),a([c({type:Boolean,nonNullable:!0})],Ve.prototype,"layerListOpen",void 0),a([c(),le("esri/widgets/support/SnappingControls/t9n/SnappingControls")],Ve.prototype,"messages",void 0),a([c()],Ve.prototype,"snappingOptions",null),a([c()],Ve.prototype,"view",null),a([c()],Ve.prototype,"viewModel",null),a([c({type:$r,nonNullable:!0})],Ve.prototype,"visibleElements",void 0),a([c()],Ve.prototype,"_enabledToggleDisabled",null),a([c()],Ve.prototype,"_secondaryElementsDisabled",null),Ve=a([f("esri.widgets.support.SnappingControls")],Ve);var dy=Ve;var he="esri-sketch",ue={base:he,verticalLayout:`${he}--vertical`,horizontalLayout:`${he}--horizontal`,panel:`${he}__panel`,infoPanel:`${he}__info-panel`,section:`${he}__section`,toolSection:`${he}__tool-section`,infoSection:`${he}__info-section`,infoCountSection:`${he}__info-count-section`,menuContainer:`${he}__menu-container`,menuHeader:`${he}__menu-header`,menuTitle:`${he}__menu-title`,featureCountBadge:`${he}__feature-count-badge`,featureCountText:`${he}__feature-count-text`,featureCountNumber:`${he}__feature-count-number`,actionToggle:`${he}__action-toggle`,actionToggleOn:`${he}__action-toggle--on`,actionTitle:`${he}__item-action-title`,actionIcon:`${he}__item-action-icon`},ee=class extends ne{constructor(e,t){super(e,t),this._activeCreateOptions=null,this._menuOpen=!1,this._selectionToolbar=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.creationMode="continuous",this.layout="horizontal",this.messages=null,this.messagesCommon=null,this.visibleElements=new rp,this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=e?.viewModel||new qg}initialize(){let{layer:e,view:t}=this,i=new ry({view:t?.type==="2d"?t:null,sources:e?[e]:null});this.addHandles([b(()=>this.viewModel,r=>{this._viewModelHandlesGroup=Z(this._viewModelHandlesGroup),r&&(this._viewModelHandlesGroup=rr([r.on("create",o=>{this.scheduleRender(),this._onCreateOperation(o)}),r.on("update",()=>this.scheduleRender()),r.on("delete",o=>this.emit("delete",o)),r.on("undo",()=>this.scheduleRender()),r.on("redo",()=>this.scheduleRender()),b(()=>r.layer,o=>{this._selectionToolbar&&(this._selectionToolbar.sources=o?[o]:null)}),b(()=>r.view,o=>{this._selectionToolbar&&(this._selectionToolbar.view=o?.type==="2d"?o:null)}),b(()=>r.state,()=>this.notifyChange("state"))]))},ae),Ue(()=>i.activeToolInfo,()=>this.viewModel.cancel()),i.on("complete",r=>this._onSelectionOperationComplete(r)),b(()=>{let{selectionTools:r}=this.visibleElements;return{lassoTool:!!r?.["lasso-selection"],rectangleTool:!!r?.["rectangle-selection"]}},r=>{Object.assign(i.visibleElements,r)},ae)]),this._selectionToolbar=i}loadDependencies(){return Se({action:()=>import("./chunk-EANCIRMG.js"),icon:()=>import("./chunk-4HUBSTEF.js")})}destroy(){this._selectionToolbar?.destroy(),this._viewModelHandlesGroup=Z(this._viewModelHandlesGroup)}get activeTool(){let e=this._selectionToolbar?.activeToolInfo;if(e)switch(e.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}return this.viewModel.activeTool}get createGraphic(){return this.viewModel.createGraphic}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(e){this.viewModel.defaultUpdateOptions=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get state(){return this._selectionToolbar?.activeToolInfo?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){let t=this._get("viewModel");e!==t&&(t&&A(t),this._set("viewModel",e))}get _effectiveAvailableCreateTools(){let{availableCreateTools:e,visibleElements:t}=this;return e?.filter(i=>!!t.createTools?.[i])}create(e,t){return this._activeCreateOptions=t||null,He(this.viewModel.create(e,t))}update(e,t){return He(this.viewModel.update(e,t))}complete(){this.viewModel.complete()}cancel(){this._selectionToolbar?.cancel(),this.viewModel.cancel()}undo(){this.viewModel.undo(),this.view?.focus()}redo(){this.viewModel.redo(),this.view?.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}render(){let{label:e,layout:t,viewModel:{state:i}}=this;return y("div",{"aria-label":e,class:this.classes(ue.base,K.widget,{[K.disabled]:i==="disabled",[ue.verticalLayout]:t==="vertical",[ue.horizontalLayout]:t==="horizontal"})},y("div",{class:ue.panel,role:"toolbar"},this._renderTopPanelContents()),y("div",{class:this.classes(ue.panel,ue.infoPanel)},this._renderInfoPanelContents()))}_renderTopPanelContents(){let e=this.classes(ue.section,ue.toolSection),{_effectiveAvailableCreateTools:t,visibleElements:i,viewModel:r}=this;return[r.updateOnGraphicClick||this._selectionToolbar?.visibleToolCount?y("div",{class:e,key:"selection-button-container",role:"menu"},this._renderDefaultSelectionButton(),this._renderSelectionToolbar()):null,t?.length?y("div",{class:e,role:"menu"},this._renderDrawActions()):null,i.undoRedoMenu?y("div",{class:e,key:"undo-redo-menu-button-container",role:"menu"},this._renderUndoRedoMenuButtons()):null,i.settingsMenu?y("div",{class:ue.section,key:"settings-menu-button-container"},this._renderSettingsMenuButton()):null]}_renderInfoPanelContents(){return this._menuOpen?this._renderSettingsMenu():this.updateGraphics.length?[y("div",{class:this.classes(ue.section,ue.infoSection,ue.infoCountSection),key:"feature-count-container"},this._renderFeatureCount()),y("div",{class:this.classes(ue.section,ue.infoSection),key:"delete-button-container"},this._renderDuplicateButton(),this._renderDeleteButton())]:void 0}_renderSettingsMenu(){let{messagesCommon:e,snappingOptions:t,view:i,viewModel:r,visibleElements:o}=this,n={directionModePicker:o.directionModePicker,labelsToggle:o.labelsToggle,tooltipsToggle:o.tooltipsToggle};return y("div",{class:ue.menuContainer,"data-testid":"menu",key:"settings-menu-container",role:"menu"},y("header",{class:ue.menuHeader,key:"settings-menu-header"},y("span",{class:ue.menuTitle},e.settings)),Ed(n)?y(oy,{sketchOptions:r.sketchOptions,viewType:i?.type,visibleElements:n}):void 0,o.snappingControls&&i&&t?y(dy,{snappingOptions:t,view:i,visibleElements:o.snappingControlsElements}):void 0)}_renderFeatureCount(){let{layout:e,messages:t,updateGraphics:{length:i}}=this,r=Td(t.selectedCount,{count:i});return y("div",{"aria-label":r,class:ue.featureCountBadge},y("span",{class:ue.featureCountNumber},e==="vertical"?i:r))}_renderDuplicateButton(){if(!this.visibleElements.duplicateButton)return;let e=this.messages,t=this.updateGraphics.length>1?e.duplicateFeatures:e.duplicateFeature;return y("calcite-action",{bind:this,onclick:this._onDuplicateSelect,scale:"s",text:t,title:t},y("calcite-icon",{icon:"copy",scale:"s"}))}_renderDeleteButton(){let e=this.messages,t=this.updateGraphics.length>1?e.deleteFeatures:e.deleteFeature;return y("calcite-action",{bind:this,onclick:this.delete,scale:"s",text:t,title:t},y("calcite-icon",{icon:"trash",scale:"s"}))}_renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return;let{messages:e,state:t}=this,i=e.selectFeature;return y("calcite-action",{active:t==="ready",bind:this,disabled:t==="disabled",onclick:this._activateDefaultSelectTool,scale:"s",text:i,title:i},y("calcite-icon",{icon:"cursor",scale:"s"}))}_renderSelectionToolbar(){if(this.view?.type==="2d"&&this._selectionToolbar)return this._selectionToolbar.render()}_renderDrawActions(){let{messages:e}=this;return this._effectiveAvailableCreateTools?.map(t=>{switch(t){case"point":return this._renderAction(t,e.drawPoint,"pin");case"polyline":return this._renderAction(t,e.drawPolyline,"line");case"polygon":return this._renderAction(t,e.drawPolygon,"polygon");case"rectangle":return this._renderAction(t,e.drawRectangle,"rectangle");case"circle":return this._renderAction(t,e.drawCircle,"circle");default:return}})}_renderAction(e,t,i){return y("calcite-action",{active:this.activeTool===e,bind:this,disabled:this.state==="disabled",onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},y("calcite-icon",{icon:i,scale:"s"}))}_renderUndoRedoMenuButtons(){return[this._renderUndoButton(),this._renderRedoButton()]}_renderUndoButton(){let e=this.messages.undo;return y("calcite-action",{bind:this,disabled:!this.viewModel.canUndo()||this.state==="disabled",onclick:this.undo,scale:"s",text:e,title:e},y("calcite-icon",{icon:ao(this.container)?"redo":"undo",scale:"s"}))}_renderRedoButton(){let e=this.messages.redo;return y("calcite-action",{bind:this,disabled:!this.viewModel.canRedo()||this.state==="disabled",onclick:this.redo,scale:"s",text:e,title:e},y("calcite-icon",{icon:ao(this.container)?"undo":"redo",scale:"s"}))}_renderSettingsMenuButton(){let e=this.messagesCommon.settings;return y("calcite-action",{active:this._menuOpen,bind:this,"data-testid":"settings-menu-action",disabled:this.state==="disabled",onclick:this._toggleMenu,scale:"s",text:e,title:e},y("calcite-icon",{icon:"gear",scale:"s"}))}_activateCreateTool(e){this.activeTool!==e?(this._selectionToolbar?.cancel(),this.create(e)):this.cancel()}_onCreateOperation(e){if(e.state!=="complete")return;let{creationMode:t}=this,{type:i}=e;if(i==="create"){let{tool:r,graphic:o}=e,n=this._activeCreateOptions;this._activeCreateOptions=null,t==="continuous"?this.create(r,n):t==="update"&&this.update([o])}}_toggleMenu(){this._menuOpen=!this._menuOpen,this.scheduleRender()}_onDuplicateSelect(){let e=this.duplicate(),t=this.viewModel.activeTool;t!=="transform"&&t!=="reshape"||this.update(e,{tool:t})}_onSelectionOperationComplete(e){let{viewModel:{defaultUpdateOptions:t}}=this,{selection:i}=e;if(!e.aborted&&i.length){let r=t.tool,o=i.length>1&&r==="reshape"?"transform":r;this.update(i,T(g({},t),{tool:o}))}this.notifyChange("state")}_activateDefaultSelectTool(){this.cancel(),this.view?.focus()}};a([c()],ee.prototype,"activeTool",null),a([c({cast:e=>{if(!e?.length)return null;let t=new Set(["point","polyline","polygon","rectangle","circle"]);return e.filter(i=>t.has(i))}})],ee.prototype,"availableCreateTools",void 0),a([c({readOnly:!0})],ee.prototype,"createGraphic",null),a([c()],ee.prototype,"creationMode",void 0),a([c()],ee.prototype,"defaultCreateOptions",null),a([c()],ee.prototype,"defaultUpdateOptions",null),a([c()],ee.prototype,"icon",null),a([c()],ee.prototype,"label",null),a([c()],ee.prototype,"labelOptions",null),a([c()],ee.prototype,"layer",null),a([c({type:["horizontal","vertical"]})],ee.prototype,"layout",void 0),a([c(),le("esri/widgets/Sketch/t9n/Sketch")],ee.prototype,"messages",void 0),a([c(),le("esri/t9n/common")],ee.prototype,"messagesCommon",void 0),a([c()],ee.prototype,"snappingOptions",null),a([c()],ee.prototype,"state",null),a([c()],ee.prototype,"tooltipOptions",null),a([c({readOnly:!0})],ee.prototype,"updateGraphics",null),a([c({type:Nn,nonNullable:!0})],ee.prototype,"valueOptions",null),a([c()],ee.prototype,"view",null),a([c(),nu(["create","update","undo","redo"])],ee.prototype,"viewModel",null),a([c({type:rp,nonNullable:!0})],ee.prototype,"visibleElements",void 0),a([c()],ee.prototype,"_effectiveAvailableCreateTools",null),ee=a([f("esri.widgets.Sketch")],ee);var kt=class extends S{constructor(e){super(e),this.activeTool=null,this.activeViewModel=null,this.view=null}get areaUnit(){return this.defaultUnit}set areaUnit(e){this._overrideIfSome("areaUnit",e)}get linearUnit(){return this.defaultUnit}set linearUnit(e){this._overrideIfSome("linearUnit",e)}get state(){let{activeViewModel:e}=this;return e?e.state:"disabled"}};a([c({type:["area","distance","direct-line"]})],kt.prototype,"activeTool",void 0),a([c()],kt.prototype,"activeViewModel",void 0),a([c({type:Fd})],kt.prototype,"areaUnit",null),a([c(Vn)],kt.prototype,"defaultUnit",void 0),a([c({type:Vd})],kt.prototype,"linearUnit",null),a([c({readOnly:!0})],kt.prototype,"state",null),a([c()],kt.prototype,"view",void 0),kt=a([f("esri.widgets.Measurement.MeasurementViewModel")],kt);var up=kt;var zb={base:"esri-measurement"};function Gb(e){return e?.declaredClass==="esri.widgets.AreaMeasurement2D"||e?.declaredClass==="esri.widgets.AreaMeasurement3D"}var ot=class extends ne{constructor(e,t){super(e,t),this._widgets=new Map,this.activeWidget=null,this.messages=null,this.viewModel=new up}initialize(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel),this.view&&this.activeTool&&this._getActiveWidget().then(e=>{this._set("activeWidget",e)}),this.addHandles([b(()=>[this.view,this.activeTool],()=>_(this,null,function*(){this._set("activeWidget",yield this._getActiveWidget())})),b(()=>this.activeWidget,(e,t)=>{this.viewModel.set("activeViewModel",e?e.viewModel:null),t&&(t.visible=!1)}),b(()=>[this.areaUnit,this.linearUnit,this.uiStrings],()=>this._updateSubWidgetProperties())])}destroy(){this._destroyWidgets()}get activeTool(){return this.viewModel.activeTool}set activeTool(e){this.viewModel.activeTool=e}get areaUnit(){return this.viewModel.areaUnit}set areaUnit(e){this.viewModel.areaUnit=e}get icon(){return"measure"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get linearUnit(){return this.viewModel.linearUnit}set linearUnit(e){this.viewModel.linearUnit=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){let{activeWidget:e}=this,t=e&&!e.destroyed?e.render():null;return y("div",{class:zb.base},t)}clear(){this.activeTool=null,this._destroyWidgets()}startMeasurement(){let{activeViewModel:e}=this.viewModel;e&&He(e.start())}_createWidget(e){return _(this,null,function*(){let{areaUnit:t,linearUnit:i,view:r}=this;if(!r)return null;switch(e){case"area":{let{type:o}=r;switch(o){case"2d":return new(yield import("./chunk-ZVTFGOTK.js")).default({view:r,unit:t,uiStrings:this._createUIStringsForWidget(e)});case"3d":return new(yield import("./chunk-YRBNLTH6.js")).default({view:r,unit:t,uiStrings:this._createUIStringsForWidget(e)});default:return null}}case"distance":{let{type:o}=r;return o==="2d"?new(yield import("./chunk-KL27SKGA.js")).default({view:r,unit:i,uiStrings:this._createUIStringsForWidget(e)}):null}case"direct-line":{let{type:o}=r;return o==="3d"?new(yield import("./chunk-DXHN7UKG.js")).default({view:r,unit:i,uiStrings:this._createUIStringsForWidget(e)}):null}default:return null}})}_destroyWidgets(){this._widgets.forEach(e=>e.destroy()),this._widgets.clear()}_getActiveWidget(){return _(this,null,function*(){let{activeTool:e,view:t}=this;if(!t||!e)return null;let i=null;if(this._widgets.has(e))i=this._widgets.get(e),i.visible=!0;else{if(i=yield this._createWidget(e),!i)return null;yield i.viewModel.start(),this._widgets.set(e,i)}return i})}_createUIStringsForWidget(e){if(!this.uiStrings)return;let t=e+"-"+this.view?.type;return this.uiStrings[t]}_updateSubWidgetProperties(){this._widgets.forEach((e,t)=>{let{areaUnit:i,linearUnit:r}=this;e.unit=Gb(e)?i:r,e.uiStrings=this._createUIStringsForWidget(t)})}};a([c()],ot.prototype,"activeTool",null),a([c({readOnly:!0})],ot.prototype,"activeWidget",void 0),a([c()],ot.prototype,"areaUnit",null),a([c()],ot.prototype,"icon",null),a([c()],ot.prototype,"label",null),a([c()],ot.prototype,"linearUnit",null),a([c(),le("esri/widgets/Measurement/t9n/Measurement")],ot.prototype,"messages",void 0),a([c()],ot.prototype,"uiStrings",void 0),a([c()],ot.prototype,"view",null),a([c({type:up})],ot.prototype,"viewModel",void 0),ot=a([f("esri.widgets.Measurement")],ot);var jb=fy(hy());var uy=(()=>{let t=class t{constructor(){this.showPlatforms=!0,this.showLegend=!0}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=_i({type:t,selectors:[["app-root"]],standalone:!0,features:[Ti],decls:7,vars:0,consts:[[1,"container-fliud","h-100","container","text-center"],[1,"row","align-items-center","justify-content-center"],[1,"align-middle","fs-1"],[2,"font-size","100px"],["href","https://gisisims.azurewebsites.net/","target","_blank","title","GIS ISIMS",2,"font-size","larger","text-align","center"]],template:function(o,n){o&1&&(Oe(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),Xe(4,"Site has been moved.."),Qe(),Oe(5,"a",4),Xe(6,"Click here to use new site"),Qe()()()())},dependencies:[Ca],styles:[".sidebar[_ngcontent-%COMP%]{height:100vh;position:fixed-right;overflow-y:auto}"]});let e=t;return e})();om(uy,Km).catch(e=>console.error(e));
