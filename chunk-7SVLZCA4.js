import{a as se,d as re}from"./chunk-YKUB35EI.js";import{a as w,b as ie,d as ne}from"./chunk-QWLQUMDY.js";import{p as ee,q as te}from"./chunk-MRVR6F6G.js";import{b as $}from"./chunk-24BLFS5R.js";import{R as W,o as Y,t as Z}from"./chunk-JDDD6VJ4.js";import{t as X}from"./chunk-KUJG22IX.js";import{a as J,c as Q}from"./chunk-GISCFF3Z.js";import{t as N}from"./chunk-HQMV3KQV.js";import{p as _}from"./chunk-CRMMDK2Z.js";var ae="z",ce="r",be={redo:ce,undo:ae,center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},Se={toggle:"Control"},Ae={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},ze={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:se,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:ae,redo:ce},oe=class{constructor(){this._bindings=new Map}add(i,t){return this.addToggle(i,n=>{n.type==="key-down"&&t(n)})}addToggle(i,t){let n=B.fromDefinition(i,t),s=X(this._bindings,n.key,()=>[]);return s.push(n),J(()=>_(s,n))}register(i,t=re.WIDGET){return Q([i.on("key-down",n=>this.dispatch(i.inputManager,n),t),i.on("key-up",n=>this.dispatch(i.inputManager,n),t)])}dispatch(i,t){let n=t.key,s=this._bindings.get(n);if(s)for(let r of s)r.process(i,t)}},B=class e{constructor(i,t,n,s,r){this.key=i,this.modifiers=t,this.repeats=n,this.continuePropagation=s,this.callback=r}process(i,t){if(!(t.key!==this.key||"repeat"in t&&t.repeat&&!this.repeats)){for(let n of this.modifiers)if(!i.isModifierKeyDown(n))return;this.continuePropagation||t.stopPropagation(),this.callback(t)}}static fromDefinition(i,t){if(typeof i=="string")return new e(i,[],!1,!1,t);let{key:n,modifier:s,repeats:r,continuePropagation:o}=i;return new e(n,s?Array.isArray(s)?s:[s]:[],!!r,!!o,t)}};function pe(e){if(!e)return null;if(Y(e)&&e.wkid){let t=ne[e.wkid];if(t)return t}let i=e.wkt2||e.wkt;if(i){let t=me(i);if(t)return t}return null}function me(e){let i=ie.exec(e);if(!i||i.length!==2)return null;let t=i[1].split(",");if(!t||t.length<3)return null;let n=parseFloat(t[1]),s=parseFloat(t[2]);return isNaN(n)||isNaN(s)?null:{a:n,f:s===0?0:1/s}}function F(e){let i=pe(e);if(ge(i))return i;let t=i.a*(1-i.f);return Object.assign(i,{b:t,eSq:1-(t/i.a)**2,radius:(2*i.a+t)/3,densificationRatio:1e4/((2*i.a+t)/3)})}function ge(e){return e!=null&&"b"in e&&"eSq"in e&&"radius"in e}function U(e,i,t){let{a:n,eSq:s}=F(t),r=Math.sqrt(s),o=Math.sin(i[1]*w),a=n*i[0]*w,p;return s>0?p=n*((1-s)*(o/(1-s*(o*o))-1/(2*r)*Math.log((1-r*o)/(1+r*o))))*.5:p=n*o,e[0]=a,e[1]=p,e}function T(e){return pe(e)!==null}function Te(e,i="square-meters"){if(e.some(o=>!T(o.spatialReference)))throw new N("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");let t=[];for(let o=0;o<e.length;o++){let a=e[o],p=a.spatialReference,{radius:h,densificationRatio:f}=F(p),c=h*f;t.push(ye(a,c))}let n=[],s=[0,0],r=[0,0];for(let o=0;o<t.length;o++){let{rings:a,spatialReference:p}=t[o],h=0;for(let f=0;f<a.length;f++){let c=a[f];U(s,c[0],p),U(r,c[c.length-1],p);let d=r[0]*s[1]-s[0]*r[1];for(let m=0;m<c.length-1;m++)U(s,c[m+1],p),U(r,c[m],p),d+=r[0]*s[1]-s[0]*r[1];h+=d}h=W(h,"square-meters",i),n.push(h/-2)}return n}function je(e,i="meters"){if(!e)throw new N("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some(n=>!T(n.spatialReference)))throw new N("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");let t=[];for(let n=0;n<e.length;n++){let s=e[n],{spatialReference:r}=s,o=s.type==="polyline"?s.paths:s.rings,a=0;for(let p=0;p<o.length;p++){let h=o[p],f=0;for(let c=1;c<h.length;c++){let d=h[c-1][0],m=h[c][0],v=h[c-1][1],g=h[c][1];if(v!==g||d!==m){let u=new C;he(u,[d,v],[m,g],r),f+=u.distance}}a+=f}a=W(a,"meters",i),t.push(a)}return t}function ye(e,i){if(e.type!=="polyline"&&e.type!=="polygon")throw new N("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");let{spatialReference:t}=e;if(!T(t))throw new N("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");let n=e.type==="polyline"?e.paths:e.rings,s=[],r=[0,0],o=new C;for(let a of n){let p=[];s.push(p),p.push([a[0][0],a[0][1]]);let h,f,c=a[0][0],d=a[0][1];for(let m=0;m<a.length-1;m++){if(h=a[m+1][0],f=a[m+1][1],c===h&&d===f)continue;let v=[c,d];he(o,[c,d],[h,f],t);let{azimuth:g,distance:u}=o,k=u/i;if(k>1){for(let y=1;y<=k-1;y++)V(r,v,g,y*i,t),p.push(r.slice(0));V(r,v,g,(u+Math.floor(k-1)*i)/2,t),p.push(r.slice(0))}V(r,v,g,u,t),p.push(r.slice(0)),c=r[0],d=r[1]}}return e.type==="polyline"?new te({paths:s,spatialReference:t}):new ee({rings:s,spatialReference:t})}var C=class{constructor(i=0,t=void 0,n=void 0){this.distance=i,this.azimuth=t,this.reverseAzimuth=n}};function V(e,i,t,n,s){let r=i[0],o=i[1],a=r*w,p=o*w,h=(t??0)*w,{a:f,b:c,f:d}=F(s),m=Math.sin(h),v=Math.cos(h),g=(1-d)*Math.tan(p),u=1/Math.sqrt(1+g*g),k=g*u,y=Math.atan2(g,v),E=u*m,q=E*E,b=1-q,l=b*(f*f-c*c)/(c*c),D=1+l/16384*(4096+l*(l*(320-175*l)-768)),P=l/1024*(256+l*(l*(74-47*l)-128)),R,A,M,G,x=n/(c*D),S=2*Math.PI;for(;Math.abs(x-S)>1e-12;)M=Math.cos(2*y+x),R=Math.sin(x),A=Math.cos(x),G=P*R*(M+P/4*(A*(2*M*M-1)-P/6*M*(4*R*R-3)*(4*M*M-3))),S=x,x=n/(c*D)+G;let z=k*R-u*A*v,I=Math.atan2(k*A+u*R*v,(1-d)*Math.sqrt(q+z*z)),j=Math.atan2(R*m,u*A-k*R*v),K=d/16*b*(4+d*(4-3*b)),O=I/w,L=(a+(j-(1-K)*d*E*(x+K*R*(M+K*A*(2*M*M-1)))))/w;return e[0]=L,e[1]=O,e}function he(e,i,t,n){let s=i[0]*w,r=i[1]*w,o=t[0]*w,a=t[1]*w,{a:p,b:h,f,radius:c}=F(n),d=o-s,m=Math.atan((1-f)*Math.tan(r)),v=Math.atan((1-f)*Math.tan(a)),g=Math.sin(m),u=Math.cos(m),k=Math.sin(v),y=Math.cos(v),E,q,b,l,D,P,R,A,M,G,x=1e3,S=d;do{if(R=Math.sin(S),A=Math.cos(S),b=Math.sqrt(y*R*(y*R)+(u*k-g*y*A)*(u*k-g*y*A)),b===0)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;D=g*k+u*y*A,P=Math.atan2(b,D),M=u*y*R/b,q=1-M*M,l=D-2*g*k/q,isNaN(l)&&(l=0),G=f/16*q*(4+f*(4-3*q)),E=S,S=d+(1-G)*f*M*(P+G*b*(l+G*D*(2*l*l-1)))}while(Math.abs(S-E)>1e-12&&--x>0);if(x===0){let L=c,fe=Math.acos(Math.sin(r)*Math.sin(a)+Math.cos(r)*Math.cos(a)*Math.cos(o-s))*L,H=o-s,le=Math.sin(H)*Math.cos(a),ue=Math.cos(r)*Math.sin(a)-Math.sin(r)*Math.cos(a)*Math.cos(H),de=Math.atan2(le,ue);return e.azimuth=de/w,e.distance=fe,e.reverseAzimuth=void 0,e}let z=q*(p*p-h*h)/(h*h),I=z/1024*(256+z*(z*(74-47*z)-128)),j=h*(1+z/16384*(4096+z*(z*(320-175*z)-768)))*(P-I*b*(l+I/4*(D*(2*l*l-1)-I/6*l*(4*b*b-3)*(4*l*l-3)))),K=Math.atan2(y*Math.sin(S),u*k-g*y*Math.cos(S)),O=Math.atan2(u*Math.sin(S),u*k*Math.cos(S)-g*y);return e.azimuth=K/w,e.distance=j,e.reverseAzimuth=O/w,e}function Oe(e){return T(e)?e:Z(e)?$.WGS84:null}export{T as a,Te as b,je as c,ye as d,C as e,V as f,he as g,Oe as h,be as i,Se as j,Ae as k,ze as l,oe as m};
