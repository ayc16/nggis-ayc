import{a as Dt}from"./chunk-EB5CS3GG.js";import{a as At,b as q,c as Ft,e as It,f as Lt,g as v,h as Mt,i as Vt,j as wt,k as St,l as Z,n as Ut}from"./chunk-3HJJZGL7.js";import{a as gt}from"./chunk-TXV2XM7Y.js";import{a as ct}from"./chunk-UZSTUBKI.js";import{a as pt}from"./chunk-HPYRFOMM.js";import{b,f as j,g as G,i as N,j as kt,k as bt}from"./chunk-VORAPKV5.js";import{k as xt}from"./chunk-7SVLZCA4.js";import{a as y,b as U,c as D,d as A,e as F,f as vt,j as T,k as yt,l as R}from"./chunk-GAF32LQP.js";import{a as ht}from"./chunk-4QS7PGAF.js";import{D as dt,m as mt,q as ft}from"./chunk-SJTQM4NH.js";import{b as Y}from"./chunk-LQWMDYLF.js";import{a as $}from"./chunk-V2KSICSA.js";import{l as S}from"./chunk-76YVRX2R.js";import{C as X,c as E,l as nt,m as st,p as lt,q as ut}from"./chunk-OZF6BMOL.js";import{a as x,b as it,f as rt,i as C}from"./chunk-GJP6PTKT.js";import{e as O}from"./chunk-JOSG37QF.js";import{f as w,k as at}from"./chunk-SA4OMQAD.js";import{ia as et,ja as ot,t as tt}from"./chunk-JDDD6VJ4.js";import{L as s,O as J}from"./chunk-AUTL5LCV.js";import{S as k}from"./chunk-KUJG22IX.js";import{a as r}from"./chunk-W3WDPWBE.js";import{a as Q,c as K}from"./chunk-GISCFF3Z.js";import{a as d,h as z}from"./chunk-EAH6BNBL.js";function ve(t,o){let e=Y(o.vertexSpace),{scale:a,orientation:i}=t,{transform:u}=o,l=Gt(u);e&&l!=null?(i.actual=A(l,"degrees","arithmetic"),i.visible=!0):(i.actual=null,i.visible=!1),e?(a.actual=y(Rt(u)),a.visible=!0):(a.actual=null,a.visible=!1)}function ye(t,o,e){if(!o||!Y(o.vertexSpace))return;let a=o.transform??=new pt,{rotationAngle:i,rotationAxis:u}=a,l=kt(t.orientation.actual),h=Tt(u);if(l!=null&&h!=null&&l!==i){e?.onRotateStart?.(i);let g=l*h;a.rotationAngle=g,e?.onRotate?.(g),e?.onRotateStop?.(g)}let m=t.scale.actual?.value,c=Rt(a);if(m!=null&&m!==c){let{scale:g}=a,f;if(e?.onScaleStart?.(g[0],g[1],g[2]),c===0)f=it(rt);else{let _=m/c;f=nt(x(),g,_)}a.scale=f,e?.onScale?.(f[0],f[1],f[2]),e?.onScaleStop?.(f[0],f[1],f[2])}}function ke(t,o){let{x:e,y:a,z:i}=o,{x:u,y:l,z:h}=jt(t,o.spatialReference);return{dx:u==null||S(u,e)?0:u-e,dy:l==null||S(l,a)?0:l-a,dz:h==null||i==null||S(h,i)?0:h-i}}function jt(t,o){let e,a,i;if(t.geographic){e=N(t.longitude.actual),a=N(t.latitude.actual),tt(o)&&(e!=null&&a!=null?[e,a]=w(e,a,B):e!=null?e=w(e,0,B)[0]:a!=null&&(a=w(0,a,B)[1]));let u=t.elevation.actual,l=et(o);i=l!=null&&u!=null?vt(u,l):void 0}else e=t.x.actual?.value,a=t.y.actual?.value,i=t.elevation.actual?.value;return{x:e,y:a,z:i}}var B=[0,0];function Gt(t){if(!t)return 0;let o=Tt(t.rotationAxis);return o!=null?o*t.rotationAngle:null}function Tt(t){return X(t,C)?1:X(t,Nt)?-1:null}var Nt=ut(x(),C);function Rt(t){return t?Math.max(...t.scale):1}function xe(t,o){return!(t.type!=="key-down"||t.key!==xt.enterInputMode||!o||!qt(o.info))&&(o.enterInputMode(),t.stopPropagation(),!0)}function qt(t){let o=t?.sketchOptions;if(!o)return!1;let{inputEnabled:e,visibleElements:a}=o.tooltips;return e&&t.editableFields.some(({name:i})=>i==="x"||i==="y"?a.coordinates:a[i])===!0}function be(t){let o=null;return K([t.on("paste",e=>z(this,null,function*(){o?.abort(),o=O(()=>z(this,null,function*(){At()||(yield q()),Zt(e,t.info)}))})),O(()=>q()),Q(()=>o?.abort())])}function Zt(t,o){if(!o||!("geographic"in o))return;let e=t.clipboardData?.getData("text");if(e)if(o.geographic){let a=Vt(e);a&&(o.longitude.applyValue(a.longitude),o.latitude.applyValue(a.latitude),t.stopPropagation(),t.preventDefault())}else{let a=Mt(e);a&&(o.x.applyValue(a.x),o.y.applyValue(a.y),t.stopPropagation(),t.preventDefault())}}function Pt(t,o=I()){return zt(t,o)}function _t(t,o=I()){return zt(t,o,!1)}function zt(t,o,e=t.hasZ){let a=Ut(t.spatialReference),i=ot(a);if(i==null)return null;let u=(h,m)=>!(m.length<2)&&(E(h,m[0],m[1],e&&m[2]||0),!0),l=0;for(let h of t.rings){let m=h.length;if(m<3)continue;let{positionsWorldCoords:c}=o;for(;c.length<m;)c.push(x());let g=Bt,f=E(Wt,0,0,0),_=1/m;for(let p=0;p<m;p++){if(!u(g,h[p])||!ht(g,t.spatialReference,c[p],a))return null;st(f,f,c[p],_)}let H=ft(c[0],c[1],f,mt());if(lt(H)===0)continue;for(let p=0;p<m;p++)dt(H,f,c[p],c[p]);let V=Ht(c);for(let p=0;p<V.length;p+=3)l+=gt(c[V[p]],c[V[p+1]],c[V[p+2]])}return D(l,i)}var Bt=x(),Wt=x();function I(){return{positionsWorldCoords:[]}}function Ht(t){return ct(Qt(t),[],2)}function Qt(t){let o=new Float64Array(2*t.length);for(let e=0;e<t.length;++e){let a=t[e],i=2*e;o[i]=a[0],o[i+1]=a[1]}return o}function Kt(t,o,e=I()){if(o==="on-the-ground"){let a=Dt(t);return a??_t(t,e)}return Pt(t,e)}function Oe(t,o=I()){return Kt(t,"on-the-ground",o)}var n=class extends J{constructor(t){super(t),this.actual=null,this.lockable=!0,this.id=$(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(t){this.lockable&&this._set("committed",t)}get dirty(){return this.inputValue!=null}get locked(){return this.lockable&&this.committed!=null}onInput(t){this.inputValue=t}onCommit(t,o,e){this.lockable?this._onCommitLockable(t,e):this._onCommitNonLockable(e),this.invalid&&t==="commit-and-exit"||e.onCommit(o,t)}_onCommitLockable(t,o){let{inputValue:e,locked:a}=this;a&&P(e)?this.unlock():(t==="commit-and-exit"&&!a||e!=null)&&this._parseInputAndLock(o)}_onCommitNonLockable(t){let{inputValue:o}=this;P(o)?this.setActual(null):o!=null&&this._parseInputAndSetActual(t)}applyValue(t){this.lockable?this.lock(t):this.setActual(t)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(t){this.actual=t,this.clearInputValue()}lock(t){this.lockable&&(this.committed=t??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(t){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(t))}getSuffix(t){let{suffix:o}=this;return typeof o=="function"?o(t):o}getFormattedValue(t){let{actual:o,committed:e,format:a}=this;return e!=null?a(e,t):o!=null?a(o,t):null}getRawDisplayValue(t){let{actual:o,committed:e,inputValue:a}=this;return a??(this.lockable&&e!=null?this.formatForInputMode(e,t):o!=null?this.formatForInputMode(o,t):null)}_parseInputAndSetActual(t){let{inputValue:o}=this;if(o==null||P(o))return this.setActual(null);let e=this.parse(o,t);e!=null?this.setActual(e):this.invalid=!0}_parseInputAndLock(t){let{inputValue:o,actual:e}=this;if(P(o))return this.unlock();if(o==null)return this.lock(e);let a=this.parse(o,t);a!=null?this.lock(a):this.invalid=!0}};function P(t){return t!=null&&t.trim()===""}r([s()],n.prototype,"actual",void 0),r([s()],n.prototype,"committed",null),r([s()],n.prototype,"dirty",null),r([s()],n.prototype,"format",void 0),r([s()],n.prototype,"formatForInputMode",void 0),r([s()],n.prototype,"lockable",void 0),r([s()],n.prototype,"locked",null),r([s()],n.prototype,"id",void 0),r([s()],n.prototype,"inputValue",void 0),r([s()],n.prototype,"name",void 0),r([s()],n.prototype,"parse",void 0),r([s()],n.prototype,"readOnly",void 0),r([s()],n.prototype,"suffix",void 0),r([s()],n.prototype,"title",void 0),r([s()],n.prototype,"visible",void 0),r([s()],n.prototype,"invalid",void 0),r([s()],n.prototype,"unlockOnVertexPlacement",void 0),n=r([k("esri.views.interactive.tooltip.fields.TooltipField")],n);var L=class extends n{constructor(t){super(t),this.showAsZ=!1}normalizeCtorArgs(t){let o=e=>e.inputUnitInfos.verticalLength.unit;return d({name:"elevation",actual:T,parse:v((e,a)=>U(e,o(a))),format:(e,a)=>a.formatters.verticalLength(e),formatForInputMode:(e,a)=>a.formatters.scalar(F(e,o(a))),suffix:e=>e.inputUnitInfos.verticalLength.abbreviation,title:e=>e.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1},t)}};r([s()],L.prototype,"showAsZ",void 0),L=r([k("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],L);var M=class extends n{constructor(t){super(t),this.precision=1}normalizeCtorArgs(t){let o=e=>e.inputUnitInfos.orientation.unit;return d({name:"orientation",actual:null,parse:v((e,a)=>A(e,o(a),"geographic")),format:e=>{let a=G(e);return Ft(a,"geographic",this.precision)},formatForInputMode:(e,a)=>{let i=G(e);return a.formatters.scalar(i)},suffix:e=>e.inputUnitInfos.orientation.abbreviation,title:e=>e.messages.sketch.orientation},t)}};r([s()],M.prototype,"precision",void 0),M=r([k("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],M);function wo(t){let o=a=>a.inputUnitInfos.direction.unit,e=a=>a.sketchOptions.values.effectiveDirectionMode;return new n(d({name:"direction",actual:R,parse:v((a,i)=>A(a,o(i),"geographic")),format:(a,i)=>{let u=e(i),l=j(a,u);switch(u){case b.Absolute:return i.formatters.direction(l);case b.Relative:return i.formatters.directionRelative(l);case b.RelativeBilateral:return i.formatters.directionRelativeBilateral(l)}},formatForInputMode:(a,i)=>{let u=j(a,e(i));return i.formatters.scalar(F(u,o(i)))},suffix:a=>a.inputUnitInfos.direction.abbreviation,title:a=>{let i=e(a),{absolute:u,relative:l}=a.messages.sketch.direction;switch(i){case b.Absolute:return u;case b.Relative:case b.RelativeBilateral:return l}}},t))}function Jt(t){let o=e=>e.inputUnitInfos.length.unit;return new n(d({name:"distance",actual:T,parse:v((e,a)=>U(Math.max(e,0),o(a))),format:(e,a)=>a.formatters.length(e),formatForInputMode:(e,a)=>a.formatters.scalar(F(e,o(a))),suffix:e=>e.inputUnitInfos.length.abbreviation,title:e=>e.messages.sketch.distance},t))}function So(){return Jt({format:(t,o)=>o.formatters.totalLength(t),title:t=>t.messages.sketch.totalLength,readOnly:!0})}function Ot(t){return new L(t)}function Uo(t){return new M(t)}function Do(t){return W("scale",d({name:"scale",actual:null,parse:v(o=>y(Math.abs(o)))},t))}function To(t){let o=e=>e.inputUnitInfos.area.unit;return new n(d({name:"area",actual:yt,parse:v((e,a)=>D(e,o(a))),format:(e,a)=>a.formatters.area(e),formatForInputMode:(e,a)=>a.formatters.scalar(F(e,o(a))),suffix:e=>e.inputUnitInfos.area.abbreviation,title:e=>e.messages.sketch.area,readOnly:!0},t))}function Ct(t){return new n(d({name:"x",actual:R,parse:wt,format:(o,e)=>e.formatters.longitudeDecimalDegrees(o),formatForInputMode:o=>It(o),suffix:o=>o.inputUnitInfos.longitudeLatitude.abbreviation,title:o=>o.messages.sketch.longitude},t))}function Et(t){return new n(d({name:"y",actual:R,parse:St,format:(o,e)=>e.formatters.latitudeDecimalDegrees(o),formatForInputMode:o=>Lt(o),suffix:o=>o.inputUnitInfos.longitudeLatitude.abbreviation,title:o=>o.messages.sketch.latitude},t))}function Xt(t){return W("x",d({name:"x"},t))}function Yt(t){return W("y",d({name:"y"},t))}function W(t,o){return new n(d({actual:y(0),parse:v(e=>y(e)),format:(e,a)=>a.formatters.scalar(e),formatForInputMode:(e,a)=>a.formatters.scalar(e),title:e=>e.messages.sketch[t]},o))}var Zo=t=>{let o=class extends t{constructor(){super(...arguments),this.longitude=Ct(),this.latitude=Et(),this.x=Xt(),this.y=Yt(),this.elevation=Ot(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(e,a=e?.spatialReference){if(this.geographic=!!a&&bt(a),e==null)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){let i=at(e,$t);this._setActualLonLat(Z(i?.[0]),Z(i?.[1]))}else this._setActualXY(y(e.x),y(e.y))}_setActualLonLat(e,a){this.longitude.actual=e,this.latitude.actual=a}_setActualXY(e,a){this.x.actual=e,this.y.actual=a}};return r([s()],o.prototype,"geographic",void 0),r([s()],o.prototype,"effectiveX",null),r([s()],o.prototype,"effectiveY",null),r([s()],o.prototype,"key",null),o=r([k("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],o),o},$t=[0,0];export{ve as a,ye as b,ke as c,xe as d,be as e,Zt as f,wo as g,Jt as h,So as i,Uo as j,Do as k,To as l,Zo as m,Oe as n};
