import{a as Ot,b as Ct,c as At}from"./chunk-DZAMIX2P.js";import{a as St,c as Vt}from"./chunk-6ELPNVMG.js";import{b as vt,g as _t,k as F,l as Pt,s as bt,t as Mt,u as Dt,v as Lt}from"./chunk-MSTVL2XB.js";import{N as ft,z as wt}from"./chunk-QRTF6HWT.js";import"./chunk-BJQH3R2Y.js";import"./chunk-I6JXU463.js";import"./chunk-L4N7O64W.js";import"./chunk-JAAOLJTO.js";import"./chunk-EB5CS3GG.js";import"./chunk-QJKE5PUA.js";import"./chunk-FVCRK5IX.js";import"./chunk-6W67IVZS.js";import"./chunk-CURQPDM4.js";import"./chunk-AWMFYQHJ.js";import"./chunk-DRX336HH.js";import"./chunk-SFGIVWEM.js";import"./chunk-TB62XDET.js";import"./chunk-724MIMFK.js";import"./chunk-UJUCAWBP.js";import"./chunk-EXOOWX4Z.js";import"./chunk-UZMIDNNF.js";import"./chunk-I2LACOYT.js";import"./chunk-RCPMQJFX.js";import"./chunk-7E3X25PE.js";import"./chunk-TXV2XM7Y.js";import"./chunk-PJBIIWFF.js";import"./chunk-R5K6EMED.js";import"./chunk-FVCUBGKZ.js";import"./chunk-LCBWJNVO.js";import"./chunk-JAXR3ZUJ.js";import"./chunk-XN46SLSO.js";import"./chunk-UGL7UJES.js";import"./chunk-QKPKWNQQ.js";import"./chunk-IHA7ZQ4Q.js";import"./chunk-XSJRPCD6.js";import"./chunk-JRJHFO7J.js";import"./chunk-JR27VNVT.js";import"./chunk-WICM2VEE.js";import"./chunk-DUZ52FW3.js";import"./chunk-VLBUZRRG.js";import"./chunk-7G763D5W.js";import"./chunk-3DDJTCET.js";import"./chunk-UDMTFKLM.js";import"./chunk-BYXBJQAS.js";import"./chunk-L5A2ASNG.js";import"./chunk-3OLRRKKD.js";import"./chunk-PTXLSCMJ.js";import"./chunk-AW3LMT4V.js";import"./chunk-LTJDZ7OM.js";import"./chunk-6EZU2A2D.js";import"./chunk-OZLCBZHH.js";import"./chunk-UTDAYTD2.js";import"./chunk-JCJ5KQ5Q.js";import"./chunk-TREMRME7.js";import"./chunk-C2FNHCAJ.js";import{a as at}from"./chunk-3AGOGXUT.js";import"./chunk-ADDH3SWI.js";import"./chunk-GJBALZEB.js";import"./chunk-XAHD7XBV.js";import"./chunk-DL3OPG77.js";import{d as nt}from"./chunk-RBP2Z7C6.js";import"./chunk-BYXBJQAS.js";import"./chunk-AIKSV6LF.js";import"./chunk-ELGDZDOQ.js";import"./chunk-NQ4QDYDP.js";import"./chunk-S26YVN25.js";import"./chunk-DOFADBK3.js";import"./chunk-VYC75ESO.js";import"./chunk-ZN6YLP6I.js";import"./chunk-VVVTRG42.js";import"./chunk-CETY2ZOK.js";import"./chunk-CI3GTVLF.js";import"./chunk-Y6C54FDT.js";import"./chunk-5H3X7WYB.js";import"./chunk-GMW3QDVG.js";import"./chunk-RHABF3KL.js";import"./chunk-KUOODJRB.js";import"./chunk-OW7DVBQB.js";import"./chunk-56SRKZHP.js";import"./chunk-LAXYP2KV.js";import"./chunk-TIXZ4OWB.js";import"./chunk-NDZXQR2V.js";import"./chunk-W5OI4BJ2.js";import"./chunk-UVJ5D37D.js";import"./chunk-2NH7HOKA.js";import"./chunk-ZAQLF7TN.js";import"./chunk-ZHUHFKYD.js";import"./chunk-SKXQUOOX.js";import"./chunk-6HNTTYFF.js";import"./chunk-LWKMZQFJ.js";import"./chunk-I3DWOIS7.js";import{a as rt}from"./chunk-RM56F5OF.js";import"./chunk-OQUBYVYT.js";import{a as W}from"./chunk-ZZUOGAMH.js";import{f as ht,k as mt,t as yt}from"./chunk-RAMEUAPV.js";import{d as pt}from"./chunk-5NHMASEK.js";import{e as ut,g as dt,p as ct,q as gt}from"./chunk-3K3SLH5Z.js";import"./chunk-VORAPKV5.js";import"./chunk-WKQVOD3E.js";import{a as lt}from"./chunk-4OC4J3KU.js";import"./chunk-TOLXLK6N.js";import{t as ot}from"./chunk-CXJNPJ3A.js";import"./chunk-QU6JU243.js";import"./chunk-7SVLZCA4.js";import"./chunk-BKLTKOZS.js";import"./chunk-GAF32LQP.js";import{a as B}from"./chunk-FHBFWDFD.js";import"./chunk-S3DH7XZE.js";import"./chunk-YKUB35EI.js";import"./chunk-ZJHI7U3R.js";import"./chunk-4Y7EKSO4.js";import"./chunk-CDCW33GU.js";import"./chunk-DJEFBPF6.js";import"./chunk-DYVXH2D6.js";import"./chunk-4QS7PGAF.js";import"./chunk-NIYDRLW4.js";import"./chunk-XHOTVM3O.js";import"./chunk-H3VY6XFU.js";import"./chunk-LNYBTIG7.js";import"./chunk-S2CEVLI5.js";import"./chunk-3JBDNTAW.js";import{h as tt,n as et,o as it,p as st}from"./chunk-H63LVRK7.js";import"./chunk-SJTQM4NH.js";import"./chunk-NYOCZ43I.js";import"./chunk-IFFYADB3.js";import"./chunk-R2Q5NMSG.js";import"./chunk-QL456MD5.js";import"./chunk-IY6MAS3P.js";import"./chunk-RPWH7ONJ.js";import"./chunk-H76XKIVW.js";import"./chunk-UWZJQ7YC.js";import"./chunk-NC2NFLV7.js";import{a as k}from"./chunk-UJ6V7JUK.js";import"./chunk-Z5FRAQHK.js";import"./chunk-LQWMDYLF.js";import"./chunk-BW3UVZYU.js";import{a as Z}from"./chunk-47Q3ZDMA.js";import"./chunk-XRRPDCIR.js";import"./chunk-XF4ZC6Y7.js";import"./chunk-D6QUKPEY.js";import"./chunk-VIAVLHRB.js";import"./chunk-UMZZ3I5D.js";import"./chunk-VXJKEPDS.js";import"./chunk-J7IKN4ZN.js";import"./chunk-I3S324BU.js";import"./chunk-OM7Z3UKX.js";import"./chunk-VNTMBMJI.js";import"./chunk-OJB2TSJ7.js";import"./chunk-MCO7DSFO.js";import"./chunk-LUPAMFKK.js";import"./chunk-7JD62GP7.js";import"./chunk-YXPGI3LI.js";import"./chunk-KRMYHUR3.js";import"./chunk-R4NNYEN7.js";import"./chunk-PDBA6QOJ.js";import"./chunk-CF52RSJZ.js";import"./chunk-ALWV3RJ2.js";import"./chunk-7C6Z24SS.js";import"./chunk-7G4KK3KW.js";import"./chunk-J3ZDC5ZE.js";import"./chunk-KYNKUTEO.js";import"./chunk-QWLQUMDY.js";import"./chunk-2ETHV3H2.js";import{f as Y,g as I}from"./chunk-AUSMAEKP.js";import{g as R}from"./chunk-WVCJLLRA.js";import"./chunk-OVOWBDBP.js";import"./chunk-V2KSICSA.js";import{a as f,g as H,h as T}from"./chunk-4XUOIGFO.js";import"./chunk-R2HWUZ3L.js";import"./chunk-G24ZJINL.js";import"./chunk-T25YY3N7.js";import"./chunk-ALQ3STGG.js";import"./chunk-EETFV2SL.js";import"./chunk-AM3VOA32.js";import"./chunk-SAOUSUZE.js";import"./chunk-LECQV7I4.js";import"./chunk-7HZKOXPR.js";import"./chunk-4HISZWR4.js";import"./chunk-33BSK37G.js";import"./chunk-TQAPQODA.js";import"./chunk-M2GLXRA2.js";import"./chunk-EBWCXIFH.js";import"./chunk-MRVR6F6G.js";import"./chunk-WXQQZY3K.js";import"./chunk-VPMDQK57.js";import"./chunk-BCREO4Q5.js";import"./chunk-ZVHU7VE3.js";import"./chunk-76YVRX2R.js";import"./chunk-OZF6BMOL.js";import{a as E}from"./chunk-GJP6PTKT.js";import"./chunk-RSDQHAJX.js";import"./chunk-HMKFQDR7.js";import"./chunk-2OT2C2UU.js";import"./chunk-XIMCHX2H.js";import"./chunk-SF6Z2K5H.js";import"./chunk-GBTN5LIS.js";import"./chunk-JOSG37QF.js";import"./chunk-SLMQFZE3.js";import"./chunk-VNB5ZT3P.js";import"./chunk-NDG5FXLR.js";import"./chunk-EJG3F6VR.js";import"./chunk-5ODCEDHC.js";import"./chunk-BENVXA3L.js";import{l as O}from"./chunk-SA4OMQAD.js";import"./chunk-24BLFS5R.js";import{O as D}from"./chunk-JDDD6VJ4.js";import"./chunk-VOYK3LZF.js";import"./chunk-HOJTYTYD.js";import"./chunk-XNEAL2YW.js";import"./chunk-J7M5V2SQ.js";import"./chunk-RQD6EDD6.js";import"./chunk-XPCG2OJX.js";import{L as s,O as X}from"./chunk-AUTL5LCV.js";import{S as w}from"./chunk-KUJG22IX.js";import"./chunk-OVHPPCBL.js";import{a as e}from"./chunk-W3WDPWBE.js";import{t as Q}from"./chunk-GISCFF3Z.js";import{b as V}from"./chunk-MLSR6YE6.js";import"./chunk-SNFOAZZQ.js";import"./chunk-CPDJJRWA.js";import"./chunk-DKS57BVI.js";import"./chunk-VU5W7W6Y.js";import"./chunk-HQMV3KQV.js";import"./chunk-CRMMDK2Z.js";import"./chunk-MDAB6L5Y.js";import"./chunk-FMFGIQYB.js";import{a as x,b as U}from"./chunk-EAH6BNBL.js";var _=class extends at{constructor(t){super(t),this.type="direct-line-measurement",this.startPoint=null,this.endPoint=null,this.unit=null}get requiredPropertiesForEditing(){return[this.startPoint,this.endPoint]}clear(){this.startPoint=null,this.endPoint=null}};e([s({type:["direct-line-measurement"]})],_.prototype,"type",void 0),e([s({type:O})],_.prototype,"startPoint",void 0),e([s({type:O})],_.prototype,"endPoint",void 0),e([s({type:D,value:null})],_.prototype,"unit",void 0),e([s({readOnly:!0})],_.prototype,"requiredPropertiesForEditing",null),_=e([w("esri.analysis.DirectLineMeasurementAnalysis")],_);var j=_;var G;(function(t){t[t.Auto=0]="Auto",t[t.Euclidean=1]="Euclidean",t[t.Geodesic=2]="Geodesic"})(G||(G={}));var C,xt;(function(t){t[t.None=0]="None",t[t.Direct=1]="Direct",t[t.Triangle=2]="Triangle",t[t.ProjectedGeodesic=3]="ProjectedGeodesic"})(C||(C={})),function(t){t[t.Auto=0]="Auto",t[t.AboveSegment=1]="AboveSegment",t[t.BelowSegment=2]="BelowSegment"}(xt||(xt={}));var L;(function(t){t.Manipulators="manipulators",t.AnalysisViewDestroyed="analysis-view-destroyed",t.AnalysisView="analysis-view"})(L||(L={}));var l=class extends X{constructor(t){super(t),this.cursorPoint=null,this._visible=!1,this._laserLine=null,this.laserLineEnabled=!0,this._lastDraggedHandle=null}initialize(){this._laserLine=new vt({view:this.view,attached:!0,isDecoration:!0}),this._updateVisibility(this._visible),this._connectToAnalysisView(),this.addHandles(f(()=>this._params,({laserLineGlowColor:t,laserLineInnerColor:i,laserLineGlobalAlpha:a})=>{let n=this._laserLine,o=n.style;n.style=U(x({},o),{innerColor:i,glowColor:t,globalAlpha:a})}))}destroy(){this._laserLine=V(this._laserLine)}get _params(){let{accentColor:t}=this.view.effectiveTheme;return{laserLineGlowColor:k.toUnitRGB(t),laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:k.toUnitRGB(tt(t)),laserLineInnerWidth:.75,laserLineGlobalAlpha:.75*t.a,handleColor:st(t,.5),handleRadius:5}}get visible(){return this._visible}set visible(t){t?this.show():this.hide()}get testData(){}get _cursorPosition(){let t=E(),i=this.cursorPoint;return i&&this.view.renderCoordsHelper.toRenderCoords(i,t),t}get _startPosition(){let t=E(),i=this.analysis.startPoint;return i&&this.view.renderCoordsHelper.toRenderCoords(i,t),t}get _endPosition(){let t=E(),i=this.analysis.endPoint;return i&&this.view.renderCoordsHelper.toRenderCoords(i,t),t}get _laserLineParams(){let t=this._focusPosition,{active:i,lineState:a}=this.toolState,n=this.analysisViewData,o=this.laserLineEnabled&&!!t&&a!=="measured"&&i;if(!o||!this.visible||n==null||n.destroyed)return{heightManifoldTarget:null,pointDistanceLine:null,lineVerticalPlaneSegment:null};let r=n.actualVisualizedMeasurement,u=this.view.viewingMode!=="local"&&o&&!!this.analysis.startPoint&&r==="geodesic",h=o&&n.viewMode===C.Triangle;return{heightManifoldTarget:r==="euclidean"?t:null,pointDistanceLine:u?this._pointDistanceLine:null,lineVerticalPlaneSegment:h?nt(this._startPosition,this._endPosition):null}}get _focusPosition(){let{lineState:t}=this.toolState,i=this.analysisViewData,a=i!=null&&!i.destroyed&&i.measurementMode===G.Euclidean&&i.viewMode===C.Direct;switch(t){case"drawing":return a?this._startPosition:this.analysis.endPoint?this._endPosition:this._startPosition;case"editing":return a?this._lastDraggedHandle==="start"?this._endPosition:this._startPosition:this._lastDraggedHandle==="start"?this._startPosition:this._endPosition;default:return this.cursorPoint!=null?this._cursorPosition:null}}get _pointDistanceLine(){return{origin:this.toolState.lineState==="drawing"||this._lastDraggedHandle==="end"?this._startPosition:this._endPosition,target:this._focusPosition}}createManipulators(){let t=this._params,{view:i}=this,a=()=>{let p=Lt(t.handleColor),S=[new Pt(wt(p,1,32,32))],b=new F({view:i,renderObjects:S});return b.available=!1,b.radius=t.handleRadius,[b,p]},[n,o]=a(),[r,u]=a(),h=new F({view:this.view,available:!1,interactive:!1});this.analysis.startPoint!=null&&(n.location=this.analysis.startPoint,n.available=!0),this.analysis.endPoint!=null&&(r.location=this.analysis.endPoint,r.available=!0);let m=()=>{let p=this._lastDraggedHandle;n.grabbing&&!r.grabbing&&(p="start"),r.grabbing&&!n.grabbing&&(p="end"),n.grabbing||r.grabbing||(p=null),this._lastDraggedHandle=p},M=n.events.on("grab-changed",m),P=r.events.on("grab-changed",m);return this.addHandles([M,P,f(()=>it(this._params.handleColor),p=>{o.setParameters({color:p}),u.setParameters({color:p})},{equals:et})],L.Manipulators),{start:n,end:r,cursor:h}}show(){this.destroyed||this._visible||this._updateVisibility(!0)}hide(){!this.destroyed&&this._visible&&this._updateVisibility(!1)}_connectToAnalysisView(){this.removeHandles(L.AnalysisView),this.addHandles([f(()=>this.analysisViewData?.destroyed,t=>{t&&this.removeHandles(L.AnalysisView)},H),f(()=>[this.toolState.lineState==="measured",this.analysisViewData],([t,i])=>{i==null||i.destroyed||(i.allowVisualElementsOrientationChange=!t)},H),f(()=>this._laserLineParams,t=>{let i=this._laserLine;i.heightManifoldTarget=t.heightManifoldTarget,i.pointDistanceLine=t.pointDistanceLine,i.lineVerticalPlaneSegment=t.lineVerticalPlaneSegment},H)],L.AnalysisView)}_updateVisibility(t){this.initialized&&(this._visible=t,t?this._laserLine.style={innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,glowFalloff:this._params.laserLineGlowFalloff,globalAlpha:this._params.laserLineGlobalAlpha}:this.view.cursor=null,this._laserLine.visible=t)}};e([s({constructOnly:!0})],l.prototype,"view",void 0),e([s()],l.prototype,"_params",null),e([s({constructOnly:!0})],l.prototype,"analysis",void 0),e([s({constructOnly:!0})],l.prototype,"analysisViewData",void 0),e([s()],l.prototype,"cursorPoint",void 0),e([s()],l.prototype,"toolState",void 0),e([s()],l.prototype,"visible",null),e([s()],l.prototype,"testData",null),e([s()],l.prototype,"_visible",void 0),e([s()],l.prototype,"_laserLine",void 0),e([s({constructOnly:!0})],l.prototype,"laserLineEnabled",void 0),e([s()],l.prototype,"_cursorPosition",null),e([s()],l.prototype,"_startPosition",null),e([s()],l.prototype,"_endPosition",null),e([s()],l.prototype,"_lastDraggedHandle",void 0),e([s()],l.prototype,"_laserLineParams",null),e([s()],l.prototype,"_focusPosition",null),e([s()],l.prototype,"_pointDistanceLine",null),l=e([w("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DView")],l);var d=class extends Ct{constructor(t){super(t),this._updatingHandles=new Z,this._emulatedDrag=null,this.lineState="initial",this.startPointSurfaceLocation=null,this.endPointSurfaceLocation=null,this.cursorPointSurfaceLocation=null,this.startManipulator=null,this.endManipulator=null,this.cursorManipulator=null,this._getSnappingContext=lt(i=>new gt({elevationInfo:{mode:"absolute-height",offset:0},pointer:i,editGeometryOperations:new ct(new dt("point",ut(!0,!1,this.view.spatialReference)),this.view.state.viewingMode),visualizer:new _t}))}initialize(){let{view:t,analysis:i,analysisViewData:a,visible:n}=this;this.measurementView=new l({toolState:this,view:t,analysis:i,analysisViewData:a,visible:n});let o=St(t);this._snappingManagerResult=o,this.addHandles(o);let{start:r,end:u,cursor:h}=this.measurementView.createManipulators(),m=(P,p,S)=>ht(P,(b,Et,A,J)=>{let K=Mt(b),Gt=this._snappingManager,zt=this._getSnappingContext(J),It=this._updatingHandles,{lineState:Rt}=this;A=A.next(K).next(mt(this,[S,p])).next(g=>{if(p!=="cursorPoint"){let y=this.analysis[p];y!=null&&(b.location=y)}return g});let kt=Dt(this.view),Bt=g=>{let y=kt(g);return y||this.lineState!=="drawing"&&this.lineState!=="initial"||(this[p]=null,this[S]=null),y},z=Et.next(K).next(Bt);if(J!=="touch"||Rt==="editing"){let{snappingStep:g,cancelSnapping:y}=yt({snappingManager:Gt,snappingContext:zt,updatingHandles:It});A=A.next(y),z=z.next(...g)}z.next(g=>g.action!=="start"?g:null).next(g=>{let y=pt(g.mapEnd,new O);this[p]=y,b.location=y,this[S]=this._surfaceLocation(y,g.surfaceType)})}),M=P=>P.events.on("grab-changed",()=>{let p=r.grabbing||u.grabbing;this.lineState=p?"editing":"measured"});this.addHandles([m(r,"startPoint","startPointSurfaceLocation"),m(u,"endPoint","endPointSurfaceLocation"),m(h,"cursorPoint","cursorPointSurfaceLocation"),M(r),M(u)]),this.manipulators.add(r),this.manipulators.add(u),this.manipulators.add(h),this.startManipulator=r,this.endManipulator=u,this.cursorManipulator=h,this.addHandles(f(()=>this.state,P=>{P==="measured"&&this.finishToolCreation()},T)),ot(this)}destroy(){this._updatingHandles=V(this._updatingHandles),this.measurementView=V(this.measurementView)}get _snappingManager(){return this._snappingManagerResult.snappingManager}get state(){let{analysis:t}=this;if(t.startPoint==null&&t.endPoint==null)return"ready";let{lineState:i}=this;return this.validMeasurement&&i!=="editing"&&i!=="drawing"?"measured":"measuring"}get cursor(){return this.state==="ready"||this.lineState==="drawing"?"crosshair":null}get startPoint(){return this.analysis.startPoint}set startPoint(t){this.analysis.startPoint=t}get endPoint(){return this.analysis.endPoint}set endPoint(t){this.analysis.endPoint=t}get cursorPoint(){return this.measurementView.cursorPoint}set cursorPoint(t){this.measurementView.cursorPoint=t}get snappingOptions(){return this._snappingManager.options}get validMeasurement(){return this.analysis.startPoint!=null&&this.analysis.endPoint!=null}get updating(){return this._updatingHandles.updating||this._snappingManager.updating}onShow(){this.measurementView.show(),this._updateManipulatorAvailability()}onHide(){this.measurementView.hide()}onDeactivate(){this._emulatedDrag?.cancel(),this._emulatedDrag=null}onInputEvent(t){switch(t.type){case"immediate-click":this._handleImmediateClick(t);break;case"pointer-move":this._handlePointerMove(t)}this._updateManipulatorAvailability()}_handlePointerMove(t){if(!this.active||this.view.navigating)return;let{pointerType:i}=t;if(i!=="mouse")return;let a=W(t),{lineState:n,cursorManipulator:o,endManipulator:r}=this,u=!1;this.cursorPoint==null&&(this._emulatedDrag?.cancel(),this._emulatedDrag=q(o,i,a),u=!0),n==="initial"&&(this._emulatedDrag?.update(a),u=!0),n==="drawing"&&(r.events.emit("drag",{action:"update",start:a,screenPoint:a}),u=!0),u&&t.stopPropagation()}_handleImmediateClick(t){if(!this.active||!Ot(t))return;let i=W(t),{pointerType:a}=t,{cursorManipulator:n,startManipulator:o,endManipulator:r,lineState:u}=this,h=!1;switch(this.cursorPoint==null&&(this._emulatedDrag?.cancel(),this._emulatedDrag=q(n,a,i)),u){case"initial":if(this._emulatedDrag?.update(i),this.cursorPoint!=null){this._emulatedDrag?.end(i),this._emulatedDrag=null;let{cursorPoint:m}=this;this.startPoint=m,this.startPointSurfaceLocation=this.cursorPointSurfaceLocation,o.location=m,o.interactive=!1,r.interactive=!1,this.lineState="drawing",this._emulatedDrag=q(r,a,i),h=!0}break;case"drawing":this._emulatedDrag?.update(i),this.endPoint!=null&&(this._emulatedDrag?.end(i),this._emulatedDrag=null,o.interactive=!0,r.interactive=!0,this.lineState="measured",h=!0)}h&&t.stopPropagation()}_surfaceLocation(t,i){return i===bt.GROUND?"on-the-surface":(t.z??0)>=this._getElevation(t)?"above-the-surface":"below-the-surface"}_updateManipulatorAvailability(){this.startManipulator.available=this.analysis.startPoint!=null,this.endManipulator.available=this.analysis.endPoint!=null}_getElevation(t){return this.view.basemapTerrain.ready?ft(this.view.elevationProvider,t)??0:0}get test(){}};function q(t,i,a){return t.events.emit("drag",{action:"start",pointerType:i,start:a,screenPoint:a}),{update:n=>t.events.emit("drag",{action:"update",start:n,screenPoint:n}),end:n=>t.events.emit("drag",{action:"end",start:n,screenPoint:n}),cancel:()=>t.events.emit("drag",{action:"cancel"})}}e([s({readOnly:!0})],d.prototype,"state",null),e([s()],d.prototype,"lineState",void 0),e([s({readOnly:!0})],d.prototype,"cursor",null),e([s()],d.prototype,"startPoint",null),e([s()],d.prototype,"endPoint",null),e([s()],d.prototype,"cursorPoint",null),e([s({constructOnly:!0})],d.prototype,"analysis",void 0),e([s({constructOnly:!0})],d.prototype,"analysisViewData",void 0),e([s()],d.prototype,"measurementView",void 0),e([s({constructOnly:!0})],d.prototype,"view",void 0),e([s({readOnly:!0})],d.prototype,"validMeasurement",null),e([s({value:null})],d.prototype,"startPointSurfaceLocation",void 0),e([s({value:null})],d.prototype,"endPointSurfaceLocation",void 0),e([s({value:null})],d.prototype,"cursorPointSurfaceLocation",void 0),e([s()],d.prototype,"updating",null),d=e([w("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],d);var Ut=d;var v=class extends At{constructor(t){super(t),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="DirectLineMeasurement3DViewModel is only supported in 3D views.",this._userUnit=null,this._userUnitOptions=null}initialize(){this.addHandles(f(()=>({analysis:this.analysis,unit:this.unit}),({analysis:t,unit:i})=>{t!=null&&(t.unit=i)},T))}get state(){return this.disabled||!this.ready?"disabled":this.tool==null?"ready":this.tool.state}get measurement(){let{tool:t}=this;if(t==null)return null;let i=()=>({text:null,state:"unavailable"}),a=r=>({text:r,state:"available"}),{analysisViewData:n}=t,o=n.result!=null;return{mode:n.result?.mode??"euclidean",directDistance:o&&n.actualVisualizedMeasurement==="euclidean"?a(n.directLabelText):i(),horizontalDistance:o?a(n.horizontalLabelText):i(),verticalDistance:o?a(n.verticalLabelText):i()}}set unitOptions(t){this._userUnitOptions=t,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(t){this._userUnit=t?this._findSelectableUnit(t,this._userUnit):null}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}constructAnalysis(){return new j}constructTool(){return new Ut({view:this.view,analysis:this.analysis,analysisViewData:this.analysisView,visible:this.visible})}_findSelectableUnit(t,i){let a=this.unitOptions;return a.includes(t)?t:i?this._findSelectableUnit(i):a[0]}_filteredOrAllUnits(t){if(!t)return D.slice();let i=t.filter(a=>D.includes(a));return i.length===0?D.slice():i}};e([s({type:j})],v.prototype,"analysis",void 0),e([s({readOnly:!0})],v.prototype,"state",null),e([s({readOnly:!0})],v.prototype,"measurement",null),e([s()],v.prototype,"unitOptions",null),e([s()],v.prototype,"unit",null),e([s(rt)],v.prototype,"defaultUnit",void 0),e([s()],v.prototype,"_userUnit",void 0),e([s()],v.prototype,"_userUnitOptions",void 0),v=e([w("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],v);var N=v;var Ht="esri-direct-line-measurement-3d",Tt={base:Ht,newMeasurementButton:`${Ht}__clear-button`},c=class extends Y{constructor(t,i){super(t,i),this.messages=null,this.messagesCommon=null,this.viewModel=new N}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(t){this.viewModel.analysis=t}get icon(){return"measure-line"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(t){this.viewModel.unitOptions=t}get unit(){return this.viewModel.unit}set unit(t){this.viewModel.unit=t}render(){let{messages:t,messagesCommon:i,unit:a,unitOptions:n,viewModel:o}=this,{active:r,measurement:u,state:h,supported:m}=o;return R("div",{"aria-label":this.messages.widgetLabel,class:this.classes(Tt.base,B.widget,B.panel),key:this,role:"presentation"},this.visible?R(Vt,{active:r,measurementItems:[{key:"direct",title:t.direct,value:$(u?.directDistance)},{key:"horizontal",title:t.horizontal,value:$(u?.horizontalDistance)},{key:"vertical",title:t.vertical,value:$(u?.verticalDistance)}],messages:U(x({},t),{notApplicable:i?.notApplicable}),newMeasurementButtonClass:Tt.newMeasurementButton,state:h,supported:m,unit:a,unitOptions:n,onNewMeasurementClick:()=>{Q(this.viewModel.start())},onUnitChange:M=>{this.unit=M}}):null)}};function $(t){return t?.state==="available"?t.text:null}e([s()],c.prototype,"view",null),e([s()],c.prototype,"visible",null),e([s()],c.prototype,"active",null),e([s({constructOnly:!0,nonNullable:!0})],c.prototype,"analysis",null),e([s()],c.prototype,"icon",null),e([s()],c.prototype,"label",null),e([s(),I("esri/widgets/DirectLineMeasurement3D/t9n/DirectLineMeasurement3D")],c.prototype,"messages",void 0),e([s(),I("esri/t9n/common")],c.prototype,"messagesCommon",void 0),e([s()],c.prototype,"uiStrings",void 0),e([s({type:N})],c.prototype,"viewModel",void 0),e([s()],c.prototype,"unitOptions",null),e([s()],c.prototype,"unit",null),c=e([w("esri.widgets.DirectLineMeasurement3D")],c);var Oi=c;export{Oi as default};
