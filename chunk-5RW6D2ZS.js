import{a as Xt}from"./chunk-N7KNO35F.js";import{a as Yt}from"./chunk-MFP2OFDR.js";import{a as R}from"./chunk-WXS2B4FF.js";import{j as Zt,n as te}from"./chunk-KYP6LPQU.js";import{a as rt}from"./chunk-XKXYUJUA.js";import{g as Ht}from"./chunk-DS2JVXBM.js";import{b as et}from"./chunk-G3LLBABP.js";import{a as ot}from"./chunk-UI76XBLJ.js";import{a as w}from"./chunk-UE2YGKE7.js";import{a as Qt}from"./chunk-D2ITYHSM.js";import{a as qt,b as Gt}from"./chunk-FIITBHDP.js";import{F as o,I as tt,Q as a}from"./chunk-VWEBO6QK.js";import{H as Wt,I as _,S as i}from"./chunk-KAAR5ZJN.js";import{a as t}from"./chunk-W3WDPWBE.js";import{w as Vt}from"./chunk-WKT5W7KT.js";import{b as c,p as zt}from"./chunk-X3IDZTNG.js";import{a as $t,h as Z}from"./chunk-EAH6BNBL.js";var wt,N=wt=class extends a{constructor(e){super(e),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new wt({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};t([o({type:String,json:{write:!0}})],N.prototype,"name",void 0),t([o({type:String,json:{write:!0}})],N.prototype,"title",void 0),t([o({type:String,json:{write:!0}})],N.prototype,"expression",void 0),t([o({type:["string","number"],json:{write:!0}})],N.prototype,"returnType",void 0),N=wt=t([i("esri.popup.ExpressionInfo")],N);var ee=N;var It,f=It=class extends Xt(tt){constructor(e){super(e),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new It({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};t([o()],f.prototype,"active",void 0),t([o()],f.prototype,"className",void 0),t([o()],f.prototype,"disabled",void 0),t([o()],f.prototype,"icon",void 0),t([o()],f.prototype,"id",void 0),t([o()],f.prototype,"indicator",void 0),t([o()],f.prototype,"title",void 0),t([o()],f.prototype,"type",void 0),t([o()],f.prototype,"visible",void 0),f=It=t([i("esri.support.actions.ActionBase")],f);var A=f;var bt,it=bt=class extends A{constructor(e){super(e),this.image=null,this.type="button"}clone(){return new bt({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};t([o()],it.prototype,"image",void 0),it=bt=t([i("esri.support.Action.ActionButton")],it);var oe=it;var st=class extends a{constructor(e){super(e),this.type=null}};t([o({type:["attachments","custom","fields","media","text","expression","relationship"],readOnly:!0,json:{read:!1,write:!0}})],st.prototype,"type",void 0),st=t([i("esri.popup.content.Content")],st);var d=st;var gt,S=gt=class extends d{constructor(e){super(e),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new gt({description:this.description,displayType:this.displayType,title:this.title})}};t([o({type:String,json:{write:!0}})],S.prototype,"description",void 0),t([o({type:["auto","preview","list"],json:{write:!0}})],S.prototype,"displayType",void 0),t([o({type:String,json:{write:!0}})],S.prototype,"title",void 0),t([o({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],S.prototype,"type",void 0),S=gt=t([i("esri.popup.content.AttachmentsContent")],S);var J=S;var Ft,j=Ft=class extends d{constructor(e){super(e),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new Ft({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?c(this.outFields):null})}};t([o()],j.prototype,"creator",void 0),t([o()],j.prototype,"destroyer",void 0),t([o()],j.prototype,"outFields",void 0),t([o({type:["custom"],readOnly:!0})],j.prototype,"type",void 0),j=Ft=t([i("esri.popup.content.CustomContent")],j);var _t=j;var Nt,M=Nt=class extends a{constructor(e){super(e),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new Nt({title:this.title,expression:this.expression})}};t([o({type:String,json:{write:!0}})],M.prototype,"title",void 0),t([o({type:String,json:{write:!0}})],M.prototype,"expression",void 0),t([o({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],M.prototype,"returnType",void 0),M=Nt=t([i("esri.popup.ElementExpressionInfo")],M);var re=M;var St,K=St=class extends d{constructor(e){super(e),this.expressionInfo=null,this.type="expression"}clone(){return new St({expressionInfo:this.expressionInfo?.clone()})}};t([o({type:re,json:{write:!0}})],K.prototype,"expressionInfo",void 0),t([o({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],K.prototype,"type",void 0),K=St=t([i("esri.popup.content.ExpressionContent")],K);var $=K;var E=class extends R(a){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};t([rt(Ht)],E.prototype,"dateFormat",void 0),t([o({type:Boolean,json:{write:!0}})],E.prototype,"digitSeparator",void 0),t([o({type:_,json:{write:!0}})],E.prototype,"places",void 0),E=t([i("esri.popup.support.FieldInfoFormat")],E);var ie=E;var jt,y=jt=class extends a{constructor(e){super(e),this.fieldName=null,this.format=null,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new jt({fieldName:this.fieldName,format:this.format?c(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};t([o({type:String,json:{write:!0}})],y.prototype,"fieldName",void 0),t([o({type:ie,json:{write:!0}})],y.prototype,"format",void 0),t([o({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],y.prototype,"isEditable",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"label",void 0),t([rt(new qt({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],y.prototype,"stringFieldOption",void 0),t([o({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],y.prototype,"statisticType",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"tooltip",void 0),t([o({type:Boolean,json:{write:!0}})],y.prototype,"visible",void 0),y=jt=t([i("esri.popup.FieldInfo")],y);var pt=y;var Ot,I=Ot=class extends d{constructor(e){super(e),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(e,r){r.fieldInfos=e&&e.map(p=>p.toJSON())}clone(){return new Ot(c({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};t([o({type:Object,json:{write:!0}})],I.prototype,"attributes",void 0),t([o({type:String,json:{write:!0}})],I.prototype,"description",void 0),t([o({type:[pt]})],I.prototype,"fieldInfos",void 0),t([w("fieldInfos")],I.prototype,"writeFieldInfos",null),t([o({type:String,json:{write:!0}})],I.prototype,"title",void 0),t([o({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],I.prototype,"type",void 0),I=Ot=t([i("esri.popup.content.FieldsContent")],I);var B=I;var O=class extends a{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};t([o({type:String,json:{write:!0}})],O.prototype,"altText",void 0),t([o({type:String,json:{write:!0}})],O.prototype,"caption",void 0),t([o({type:String,json:{write:!0}})],O.prototype,"title",void 0),t([o({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],O.prototype,"type",void 0),O=t([i("esri.popup.content.mixins.MediaInfo")],O);var L=O;var Ct,C=Ct=class extends tt{constructor(e){super(e),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new Ct({fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};t([o()],C.prototype,"color",void 0),t([o()],C.prototype,"fieldName",void 0),t([o()],C.prototype,"tooltip",void 0),t([o()],C.prototype,"value",void 0),C=Ct=t([i("esri.popup.content.support.ChartMediaInfoValueSeries")],C);var se=C;var Tt,b=Tt=class extends a{constructor(e){super(e),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new Tt({colors:c(this.colors),fields:c(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};t([o({type:[Yt],json:{type:[[_]],write:!0}})],b.prototype,"colors",void 0),t([o({type:[String],json:{write:!0}})],b.prototype,"fields",void 0),t([o({type:String,json:{write:!0}})],b.prototype,"normalizeField",void 0),t([o({type:[se],json:{read:!1}})],b.prototype,"series",void 0),t([o({type:String,json:{write:!0}})],b.prototype,"tooltipField",void 0),b=Tt=t([i("esri.popup.content.support.ChartMediaInfoValue")],b);var pe=b;var z=class extends L{constructor(e){super(e),this.type=null,this.value=null}};t([o({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],z.prototype,"type",void 0),t([o({type:pe,json:{write:!0}})],z.prototype,"value",void 0),z=t([i("esri.popup.content.mixins.ChartMediaInfo")],z);var g=z;var F=Gt()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var Rt,nt=Rt=class extends g{constructor(e){super(e),this.type="bar-chart"}clone(){return new Rt({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};t([o({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:F.write}})],nt.prototype,"type",void 0),nt=Rt=t([i("esri.popup.content.BarChartMediaInfo")],nt);var at=nt;var At,lt=At=class extends g{constructor(e){super(e),this.type="column-chart"}clone(){return new At({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};t([o({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:F.write}})],lt.prototype,"type",void 0),lt=At=t([i("esri.popup.content.ColumnChartMediaInfo")],lt);var mt=lt;var Jt,V=Jt=class extends a{constructor(e){super(e),this.linkURL=null,this.sourceURL=null}clone(){return new Jt({linkURL:this.linkURL,sourceURL:this.sourceURL})}};t([o({type:String,json:{write:!0}})],V.prototype,"linkURL",void 0),t([o({type:String,json:{write:!0}})],V.prototype,"sourceURL",void 0),V=Jt=t([i("esri.popup.content.support.ImageMediaInfoValue")],V);var ne=V;var Mt,D=Mt=class extends L{constructor(e){super(e),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new Mt({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};t([o({type:Number,json:{write:!0}})],D.prototype,"refreshInterval",void 0),t([o({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],D.prototype,"type",void 0),t([o({type:ne,json:{write:!0}})],D.prototype,"value",void 0),D=Mt=t([i("esri.popup.content.ImageMediaInfo")],D);var dt=D;var Et,ct=Et=class extends g{constructor(e){super(e),this.type="line-chart"}clone(){return new Et({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};t([o({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:F.write}})],ct.prototype,"type",void 0),ct=Et=t([i("esri.popup.content.LineChartMediaInfo")],ct);var ft=ct;var Bt,ut=Bt=class extends g{constructor(e){super(e),this.type="pie-chart"}clone(){return new Bt({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};t([o({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:F.write}})],ut.prototype,"type",void 0),ut=Bt=t([i("esri.popup.content.PieChartMediaInfo")],ut);var yt=ut;var ht={base:L,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":at,"column-chart":mt,"line-chart":ft,"pie-chart":yt,image:dt}};var Lt,h=Lt=class extends d{constructor(e){super(e),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(e){return e&&e.map(r=>r.type==="image"?dt.fromJSON(r):r.type==="barchart"?at.fromJSON(r):r.type==="columnchart"?mt.fromJSON(r):r.type==="linechart"?ft.fromJSON(r):r.type==="piechart"?yt.fromJSON(r):void 0).filter(Boolean)}writeMediaInfos(e,r){r.mediaInfos=e&&e.map(p=>p.toJSON())}clone(){return new Lt(c({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};t([o()],h.prototype,"activeMediaInfoIndex",void 0),t([o({type:Object,json:{write:!0}})],h.prototype,"attributes",void 0),t([o({type:String,json:{write:!0}})],h.prototype,"description",void 0),t([o({types:[ht]})],h.prototype,"mediaInfos",void 0),t([ot("mediaInfos")],h.prototype,"readMediaInfos",null),t([w("mediaInfos")],h.prototype,"writeMediaInfos",null),t([o({type:String,json:{write:!0}})],h.prototype,"title",void 0),t([o({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],h.prototype,"type",void 0),h=Lt=t([i("esri.popup.content.MediaContent")],h);var k=h;var Dt,W=Dt=class extends a{constructor(e){super(e),this.field=null,this.order=null}clone(){return new Dt({field:this.field,order:this.order})}};t([o({type:String,json:{write:!0}})],W.prototype,"field",void 0),t([o({type:["asc","desc"],json:{write:!0}})],W.prototype,"order",void 0),W=Dt=t([i("esri.popup.support.RelatedRecordsInfoFieldOrder")],W);var vt=W;var x=class extends R(d){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};t([o({type:String,json:{write:!0}})],x.prototype,"description",void 0),t([o({type:Number,json:{type:_,write:!0}})],x.prototype,"displayCount",void 0),t([o({type:["list"],json:{write:!0}})],x.prototype,"displayType",void 0),t([o({type:[vt],json:{write:!0}})],x.prototype,"orderByFields",void 0),t([o({type:Number,json:{type:_,write:!0}})],x.prototype,"relationshipId",void 0),t([o({type:String,json:{write:!0}})],x.prototype,"title",void 0),t([o({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],x.prototype,"type",void 0),x=t([i("esri.popup.content.RelationshipContent")],x);var U=x;var kt,q=kt=class extends d{constructor(e){super(e),this.text=null,this.type="text"}clone(){return new kt({text:this.text})}};t([o({type:String,json:{write:!0}})],q.prototype,"text",void 0),t([o({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],q.prototype,"type",void 0),q=kt=t([i("esri.popup.content.TextContent")],q);var P=q;var ae={base:null,key:"type",typeMap:{attachment:J,media:k,text:P,expression:$,field:B,relationship:U}};var Ut,G=Ut=class extends a{constructor(e){super(e),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new Ut({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};t([o({type:Boolean,json:{write:!0}})],G.prototype,"returnTopmostRaster",void 0),t([o({type:Boolean,json:{write:!0}})],G.prototype,"showNoDataRecords",void 0),G=Ut=t([i("esri.popup.LayerOptions")],G);var le=G;var Pt,H=Pt=class extends a{constructor(e){super(e),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new Pt({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?c(this.orderByFields):null})}};t([o({type:Boolean,json:{write:!0}})],H.prototype,"showRelatedRecords",void 0),t([o({type:[vt],json:{write:!0}})],H.prototype,"orderByFields",void 0),H=Pt=t([i("esri.popup.RelatedRecordsInfo")],H);var me=H;var Kt,Q=Kt=class extends A{constructor(e){super(e),this.image=null,this.type="toggle",this.value=!1}clone(){return new Kt({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};t([o()],Q.prototype,"image",void 0),t([o()],Q.prototype,"value",void 0),Q=Kt=t([i("esri.support.Action.ActionToggle")],Q);var de=Q;var X="relationships/",ce="expression/",fe=et.ofType({key:"type",defaultKeyValue:"button",base:A,typeMap:{button:oe,toggle:de}}),ue={base:d,key:"type",typeMap:{media:k,custom:_t,text:P,attachments:J,fields:B,expression:$,relationship:U}},ye=new Set(["attachments","fields","media","text","expression","relationship"]),m=class extends R(a){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(r=>Wt(ue,r)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||Vt(e)?e:(zt.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,r){let{popupElements:p}=r;return Array.isArray(p)&&p.length>0?this._readPopupInfoElements(r.description,r.mediaInfos,p):this._readPopupInfo(r)}writeContent(e,r,p,n){typeof e!="string"?Array.isArray(e)&&(r.popupElements=e.filter(s=>ye.has(s.type)).map(s=>s?.toJSON(n)),r.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(r):s.type==="media"?this._writeMediaContent(s,r):s.type==="text"?this._writeTextContent(s,r):s.type==="relationship"&&this._writeRelationshipContent(s,r)})):r.description=e}writeFieldInfos(e,r,p,n){let{content:s}=this,l=Array.isArray(s)?s:null;if(e){let u=l?l.filter(v=>v.type==="fields"):[],T=u.length&&u.every(v=>v.fieldInfos?.length);r.fieldInfos=e.filter(Boolean).map(v=>{let Y=v.toJSON(n);return T&&(Y.visible=!1),Y})}if(l)for(let u of l)u.type==="fields"&&this._writeFieldsContent(u,r)}writeLayerOptions(e,r,p,n){r[p]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(n)}writeTitle(e,r){r.title=e||""}collectRequiredFields(e,r){return Z(this,null,function*(){let p=this.expressionInfos||[];yield this._collectExpressionInfoFields(e,r,[...p,...this._getContentExpressionInfos(this.content,p)]),Zt(e,r,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])})}getRequiredFields(e){return Z(this,null,function*(){let r=new Set;return yield this.collectRequiredFields(r,e),[...r].sort()})}_writeFieldsContent(e,r){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;let p=c(e.fieldInfos);Array.isArray(r.fieldInfos)?p.forEach(n=>{let s=r.fieldInfos.find(l=>l.fieldName.toLowerCase()===n.fieldName.toLowerCase());s?s.visible=!0:r.fieldInfos.push(n)}):r.fieldInfos=p}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,r){let p=e.orderByFields?.map(s=>this._toFieldOrderJSON(s,e.relationshipId))||[],n=[...r.relatedRecordsInfo?.orderByFields||[],...p];r.relatedRecordsInfo=$t({showRelatedRecords:!0},n?.length&&{orderByFields:n})}_writeTextContent(e,r){!r.description&&e.text&&(r.description=e.text)}_writeMediaContent(e,r){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;let p=c(e.mediaInfos);Array.isArray(r.mediaInfos)?r.mediaInfos=[...r.mediaInfos,...p]:r.mediaInfos=p}_readPopupInfoElements(e,r,p){let n={description:!1,mediaInfos:!1};return p.map(s=>s.type==="media"?(s.mediaInfos||!r||n.mediaInfos||(s.mediaInfos=r,n.mediaInfos=!0),k.fromJSON(s)):s.type==="text"?(s.text||!e||n.description||(s.text=e,n.description=!0),P.fromJSON(s)):s.type==="attachments"?J.fromJSON(s):s.type==="fields"?B.fromJSON(s):s.type==="expression"?$.fromJSON(s):s.type==="relationship"?U.fromJSON(s):void 0).filter(Boolean)}_toRelationshipContent(e){let{field:r,order:p}=e;if(!r?.startsWith(X))return null;let n=r.replace(X,"").split("/");if(n.length!==2)return null;let s=parseInt(n[0],10),l=n[1];return typeof s=="number"&&l?U.fromJSON({relationshipId:s,orderByFields:[{field:l,order:p}]}):null}_toFieldOrderJSON(e,r){let{order:p,field:n}=e;return{field:`${X}${r}/${n}`,order:p}}_readPopupInfo({description:e,mediaInfos:r,showAttachments:p,relatedRecordsInfo:n={showRelatedRecords:!1}}){let s=[];e?s.push(new P({text:e})):s.push(new B),Array.isArray(r)&&r.length&&s.push(k.fromJSON({mediaInfos:r})),p&&s.push(J.fromJSON({displayType:"auto"}));let{showRelatedRecords:l,orderByFields:u}=n;return l&&u?.length&&u.forEach(T=>{let v=this._toRelationshipContent(T);v&&s.push(v)}),s.length?s:e}_getContentElementFields(e){let r=e?.type;if(r==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(r==="custom")return e.outFields||[];if(r==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(r==="media"){let p=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...p.reduce((n,s)=>[...n,...this._getMediaInfoFields(s)],[])]}return r==="text"?this._extractFieldNames(e.text):[]}_getMediaInfoFields(e){let{caption:r,title:p,value:n}=e,s=n||{},{fields:l,normalizeField:u,tooltipField:T,sourceURL:v,linkURL:Y}=s,xt=[...this._extractFieldNames(p),...this._extractFieldNames(r),...this._extractFieldNames(v),...this._extractFieldNames(Y),...l??[]];return u&&xt.push(u),T&&xt.push(T),xt}_getContentExpressionInfos(e,r){return Array.isArray(e)?e.reduce((p,n)=>[...p,...n.type==="expression"&&n.expressionInfo?[n.expressionInfo]:[]],r):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((r,p)=>[...r,...this._getContentElementFields(p)],[]):[]}_collectExpressionInfoFields(e,r,p){return Z(this,null,function*(){p&&(yield Promise.all(p.map(n=>te(e,r,n.expression))))})}_getFieldInfoFields(e){return e?e.filter(r=>r.visible===void 0||!!r.visible).map(r=>r.fieldName).filter(r=>!r.startsWith(X)&&!r.startsWith(ce)):[]}_getActionsFields(e){return e?e.toArray().reduce((r,p)=>[...r,...this._getActionFields(p)],[]):[]}_getActionFields(e){let{className:r,title:p,type:n}=e,s=n==="button"||n==="toggle"?e.image:"";return[...this._extractFieldNames(p),...this._extractFieldNames(r),...this._extractFieldNames(s)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){if(!e||typeof e!="string")return[];let r=/{[^}]*}/g,p=e.match(r);if(!p)return[];let n=/\{(\w+):.+\}/,s=p.filter(l=>!(l.indexOf(`{${X}`)===0||l.indexOf(`{${ce}`)===0)).map(l=>l.replace(n,"{$1}"));return s?s.map(l=>l.slice(1,-1)):[]}};t([o({type:fe})],m.prototype,"actions",void 0),t([o()],m.prototype,"content",void 0),t([Qt("content")],m.prototype,"castContent",null),t([ot("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],m.prototype,"readContent",null),t([w("content",{popupElements:{type:et.ofType(ae)},showAttachments:{type:Boolean},mediaInfos:{type:et.ofType(ht)},description:{type:String},relatedRecordsInfo:{type:me}})],m.prototype,"writeContent",null),t([o({type:[ee],json:{write:!0}})],m.prototype,"expressionInfos",void 0),t([o({type:[pt]})],m.prototype,"fieldInfos",void 0),t([w("fieldInfos")],m.prototype,"writeFieldInfos",null),t([o({type:le})],m.prototype,"layerOptions",void 0),t([w("layerOptions")],m.prototype,"writeLayerOptions",null),t([o({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],m.prototype,"lastEditInfoEnabled",void 0),t([o()],m.prototype,"outFields",void 0),t([o()],m.prototype,"overwriteActions",void 0),t([o()],m.prototype,"returnGeometry",void 0),t([o({json:{type:String}})],m.prototype,"title",void 0),t([w("title")],m.prototype,"writeTitle",null),m=t([i("esri.PopupTemplate")],m);var Fn=m;export{J as a,re as b,ie as c,pt as d,B as e,se as f,k as g,vt as h,P as i,ee as j,A as k,oe as l,de as m,Fn as n};
