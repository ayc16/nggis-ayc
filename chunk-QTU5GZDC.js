import{a as v,b as S}from"./chunk-F3UC6FP6.js";import"./chunk-PKAPOTVL.js";import"./chunk-SAPHIB7U.js";import"./chunk-M3O7X24A.js";import"./chunk-ZK263UMU.js";import"./chunk-MKR7D3TU.js";import"./chunk-QRJOWAPI.js";import"./chunk-37HBPHMX.js";import"./chunk-KEHUQDYM.js";import"./chunk-L7EWUDGR.js";import"./chunk-DER7DWMI.js";import"./chunk-I2LACOYT.js";import"./chunk-63CLAPA5.js";import"./chunk-HIVLPSQC.js";import"./chunk-RCPMQJFX.js";import"./chunk-BYADM53I.js";import"./chunk-BYXBJQAS.js";import"./chunk-3WIR6N5K.js";import"./chunk-TTUUVT2M.js";import"./chunk-KZUZOO74.js";import"./chunk-Q5M6H32P.js";import"./chunk-BYXBJQAS.js";import"./chunk-UTDE2IJJ.js";import"./chunk-CX34C47X.js";import"./chunk-U735ZXF7.js";import"./chunk-ADDH3SWI.js";import"./chunk-UDPPAMEQ.js";import"./chunk-NOUYXRP4.js";import"./chunk-Q7K227NX.js";import"./chunk-GJBALZEB.js";import"./chunk-GHXDYQ3O.js";import"./chunk-ZOOQQO74.js";import"./chunk-XVH66ALE.js";import"./chunk-B7IX6UFG.js";import"./chunk-XAHD7XBV.js";import"./chunk-AIKSV6LF.js";import"./chunk-RHABF3KL.js";import"./chunk-UZSTUBKI.js";import"./chunk-YAIVKHQ7.js";import"./chunk-7QY3BMVN.js";import"./chunk-5L33MNIH.js";import"./chunk-TNPL7MIN.js";import"./chunk-NDZXQR2V.js";import"./chunk-W5OI4BJ2.js";import"./chunk-ZAQLF7TN.js";import"./chunk-QAJCY744.js";import"./chunk-BKLTKOZS.js";import"./chunk-S3DH7XZE.js";import"./chunk-2FU5HSUP.js";import"./chunk-4KGZTO2H.js";import"./chunk-2774JW3N.js";import"./chunk-R4ZRZJFL.js";import"./chunk-L657QK52.js";import"./chunk-4Y7EKSO4.js";import"./chunk-4ZBUTOIE.js";import"./chunk-XHIF7VIS.js";import"./chunk-X5XSKIWR.js";import"./chunk-E3472BDJ.js";import"./chunk-4D3QHJI2.js";import"./chunk-E2J2V7JN.js";import"./chunk-AGT7IE2H.js";import"./chunk-37H4LYIE.js";import"./chunk-D6Q6GMSU.js";import"./chunk-IXG346EU.js";import"./chunk-HUYHDVA2.js";import"./chunk-UC7SIIH5.js";import"./chunk-SIDAXOMN.js";import{a as g}from"./chunk-S2CEVLI5.js";import"./chunk-XURBKGOF.js";import"./chunk-BRJSO7CG.js";import"./chunk-AATZFFI5.js";import"./chunk-LNUI6KC7.js";import"./chunk-BXHQ44WX.js";import"./chunk-EWHTP5EW.js";import"./chunk-N3SZSSU6.js";import"./chunk-3JBDNTAW.js";import{a as p}from"./chunk-TMYZ2I35.js";import"./chunk-TXAFMDDV.js";import"./chunk-ZCSEBPCJ.js";import"./chunk-LOEAA5XF.js";import"./chunk-R2Q5NMSG.js";import"./chunk-QL456MD5.js";import"./chunk-IY6MAS3P.js";import"./chunk-RPWH7ONJ.js";import"./chunk-H76XKIVW.js";import"./chunk-UWZJQ7YC.js";import"./chunk-NC2NFLV7.js";import"./chunk-UJ6V7JUK.js";import"./chunk-47Q3ZDMA.js";import"./chunk-XF4ZC6Y7.js";import"./chunk-D6QUKPEY.js";import"./chunk-VIAVLHRB.js";import"./chunk-UMZZ3I5D.js";import"./chunk-LSEOQ2KR.js";import"./chunk-VXJKEPDS.js";import"./chunk-I3S324BU.js";import"./chunk-OM7Z3UKX.js";import"./chunk-6KRFVLII.js";import"./chunk-7JD62GP7.js";import"./chunk-KRMYHUR3.js";import"./chunk-R4NNYEN7.js";import"./chunk-PDBA6QOJ.js";import"./chunk-CF52RSJZ.js";import"./chunk-2ETHV3H2.js";import{a as c}from"./chunk-4XUOIGFO.js";import"./chunk-2OKSPLJT.js";import"./chunk-7LEG2VDW.js";import"./chunk-R2HWUZ3L.js";import"./chunk-G24ZJINL.js";import"./chunk-T25YY3N7.js";import"./chunk-ALQ3STGG.js";import"./chunk-EETFV2SL.js";import"./chunk-AM3VOA32.js";import"./chunk-SAOUSUZE.js";import"./chunk-LECQV7I4.js";import"./chunk-7HZKOXPR.js";import"./chunk-4HISZWR4.js";import"./chunk-33BSK37G.js";import"./chunk-TQAPQODA.js";import"./chunk-M2GLXRA2.js";import"./chunk-EBWCXIFH.js";import"./chunk-MRVR6F6G.js";import"./chunk-WXQQZY3K.js";import"./chunk-VPMDQK57.js";import"./chunk-BCREO4Q5.js";import"./chunk-ZVHU7VE3.js";import"./chunk-76YVRX2R.js";import"./chunk-OZF6BMOL.js";import"./chunk-GJP6PTKT.js";import"./chunk-RSDQHAJX.js";import"./chunk-HMKFQDR7.js";import"./chunk-2OT2C2UU.js";import"./chunk-XIMCHX2H.js";import"./chunk-SF6Z2K5H.js";import"./chunk-GBTN5LIS.js";import"./chunk-JOSG37QF.js";import"./chunk-SLMQFZE3.js";import"./chunk-VNB5ZT3P.js";import"./chunk-NDG5FXLR.js";import"./chunk-EJG3F6VR.js";import"./chunk-5ODCEDHC.js";import"./chunk-BENVXA3L.js";import"./chunk-SA4OMQAD.js";import"./chunk-24BLFS5R.js";import"./chunk-JDDD6VJ4.js";import"./chunk-VOYK3LZF.js";import"./chunk-HOJTYTYD.js";import"./chunk-XNEAL2YW.js";import"./chunk-J7M5V2SQ.js";import"./chunk-RQD6EDD6.js";import"./chunk-XPCG2OJX.js";import{L as n}from"./chunk-AUTL5LCV.js";import{S as u}from"./chunk-KUJG22IX.js";import"./chunk-OVHPPCBL.js";import{a as r}from"./chunk-W3WDPWBE.js";import{a as _,c as f}from"./chunk-GISCFF3Z.js";import"./chunk-MLSR6YE6.js";import"./chunk-SNFOAZZQ.js";import"./chunk-CPDJJRWA.js";import"./chunk-VU5W7W6Y.js";import{t as d}from"./chunk-HQMV3KQV.js";import"./chunk-CRMMDK2Z.js";import{a as m,b as y,h}from"./chunk-EAH6BNBL.js";var C=e=>{let t=class extends e{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}disconnect(){this._doDisconnect()}connect(){this._doConnect()}clear(){this._doClear()}constructor(...s){super(...s),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return(this._isUserPaused||this.suspended)&&this._streamConnectionStatus==="connected"?"paused":this._streamConnectionStatus}_onSuspendedChange(s){s?this._doPause():this._isUserPaused||this._doResume()}};return r([n()],t.prototype,"_isUserPaused",void 0),r([n({readOnly:!0})],t.prototype,"connectionStatus",null),r([n({type:g})],t.prototype,"filter",void 0),t=r([u("esri.views.layers.StreamLayerView")],t),t};var o=class extends C(S){constructor(){super(...arguments),this.pipelineConnectionStatus="disconnected",this.pipelineErrorString=null}initialize(){this.addHandles([c(()=>this.layer.customParameters,e=>h(this,null,function*(){(yield this.getWorker()).streamMessenger.updateCustomParameters(e)})),this.layer.on("send-message-to-socket",e=>h(this,null,function*(){(yield this.getWorker()).streamMessenger.sendMessageToSocket(e)})),this.layer.on("send-message-to-client",e=>h(this,null,function*(){(yield this.getWorker()).streamMessenger.sendMessageToClient(e),this._isUserPaused&&"type"in e&&e.type==="clear"&&this.incrementSourceRefreshVersion()})),c(()=>this.layer.purgeOptions,()=>this._update()),c(()=>this.suspended,this._onSuspendedChange.bind(this))],"constructor"),this._doResume()}destroy(){this._doPause()}get connectionError(){return this.pipelineErrorString?new d("stream-controller",this.pipelineErrorString):null}on(e,t){if(Array.isArray(e))return f(e.map(i=>this.on(i,t)));let s=["data-received","message-received"].includes(e);s&&this.getWorker().then(i=>i.streamMessenger.enableEvent(e,!0));let l=super.on(e,t),a=this;return _(()=>{l.remove(),s&&(a._workerProxy.closed||a.hasEventListener(e)||a.getWorker().then(i=>i.streamMessenger.enableEvent(e,!1)))})}queryLatestObservations(e,t){return h(this,null,function*(){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new d("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");let s=yield this.getWorker();return v(s.features.executeQueryForLatestObservations(this._cleanUpQuery(e),t).then(l=>{let a=p.fromJSON(l);return a.features.forEach(i=>{i.layer=this.layer,i.sourceLayer=this.layer}),a}),new p({features:[]}))})}detach(){super.detach(),this.pipelineConnectionStatus="disconnected"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){this._refreshInterval!=null&&(clearInterval(this._refreshInterval),this._refreshInterval=null)}_doResume(){this._refreshInterval=setInterval(()=>this.incrementSourceRefreshVersion(),this.layer.updateInterval)}_doDisconnect(){this.getWorker().then(e=>e.streamMessenger.disconnect()),this._doPause()}_doConnect(){this.getWorker().then(e=>e.streamMessenger.connect()),this.resume()}_doClear(){this.getWorker().then(e=>e.streamMessenger.clear()),this._refreshInterval==null&&this.incrementSourceRefreshVersion()}_createClientOptions(){let e=super._createClientOptions(),t=this;return y(m({},e),{get container(){return t.featureContainer},setProperty:s=>{this.set(s.propertyName,s.value)}})}};r([n()],o.prototype,"pipelineConnectionStatus",void 0),r([n()],o.prototype,"pipelineErrorString",void 0),r([n({readOnly:!0})],o.prototype,"connectionError",null),r([n({readOnly:!0})],o.prototype,"_streamConnectionStatus",null),o=r([u("esri.views.2d.layers.StreamLayerView2D")],o);var z=o;export{z as default};
