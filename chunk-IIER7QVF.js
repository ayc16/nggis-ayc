import{a as g}from"./chunk-V6I7PS5D.js";import"./chunk-6GEWZ7SA.js";import"./chunk-KWPZPKEZ.js";import"./chunk-PTXLSCMJ.js";import"./chunk-UZSTUBKI.js";import"./chunk-GEDCZS6Y.js";import"./chunk-DRE2I74M.js";import"./chunk-YQNUGDFH.js";import"./chunk-WB63P7CN.js";import"./chunk-SDUXSXKH.js";import{a as F,b as T}from"./chunk-F7N72PQ7.js";import"./chunk-3MLEE2XK.js";import"./chunk-GEV3XR4C.js";import"./chunk-ZREXZJBZ.js";import{e as N}from"./chunk-7EQBH2NW.js";import"./chunk-BPP5MIUB.js";import"./chunk-I46GU3Q4.js";import"./chunk-H5IJXG2U.js";import"./chunk-TCQOV56D.js";import{e as w}from"./chunk-6MTY3OXX.js";import"./chunk-CGZE4C6W.js";import"./chunk-CLDJAOGN.js";import"./chunk-YIRBKWRK.js";import"./chunk-IFFYADB3.js";import"./chunk-BVW6ULEA.js";import"./chunk-7C6Z24SS.js";import"./chunk-C4XQ3IUU.js";import"./chunk-T2INZTCD.js";import"./chunk-H34WFTDW.js";import"./chunk-AWOMJTYJ.js";import"./chunk-ER5QN5R7.js";import{a as D}from"./chunk-FXKKVZVX.js";import{a as M}from"./chunk-X6FZ7Z76.js";import"./chunk-5RW6D2ZS.js";import"./chunk-N7KNO35F.js";import"./chunk-53X2B37Z.js";import"./chunk-6UOVQ25A.js";import"./chunk-BNSYK2BT.js";import"./chunk-DHY7QZ2H.js";import"./chunk-MFP2OFDR.js";import"./chunk-YTC2EJDQ.js";import"./chunk-ERH7ZNSC.js";import"./chunk-GUOR3BIM.js";import"./chunk-2EA2KAER.js";import"./chunk-V5AJXD2Y.js";import"./chunk-WXS2B4FF.js";import"./chunk-XFK3CDZ5.js";import"./chunk-4XBATNKX.js";import"./chunk-3IJY37BG.js";import"./chunk-J57HR4DB.js";import"./chunk-GNCG2SQP.js";import"./chunk-J4PQZSQE.js";import"./chunk-KYP6LPQU.js";import"./chunk-UMB6LRQI.js";import"./chunk-AQ74ANSJ.js";import"./chunk-SAOUSUZE.js";import"./chunk-IFPBW5UQ.js";import"./chunk-RHHHYJSZ.js";import"./chunk-QBQKFGOZ.js";import"./chunk-K5NHJTKR.js";import"./chunk-XKXYUJUA.js";import"./chunk-F7PIPM6E.js";import"./chunk-FR6Q4MSQ.js";import"./chunk-C6JT6KYF.js";import"./chunk-BCREO4Q5.js";import"./chunk-Z5Q76SB7.js";import"./chunk-E5R4OI7X.js";import"./chunk-6FWNINU2.js";import"./chunk-ES7AH7WX.js";import"./chunk-RSDQHAJX.js";import"./chunk-NYONONNN.js";import"./chunk-MZFPLWMN.js";import"./chunk-DS2JVXBM.js";import"./chunk-G3LLBABP.js";import"./chunk-T4B3RN6B.js";import"./chunk-MXADXAOS.js";import"./chunk-RJHITHLB.js";import"./chunk-CGTLZX6D.js";import"./chunk-JTJ3UVF7.js";import"./chunk-R4TNLPIN.js";import"./chunk-5HLV7XP5.js";import"./chunk-BENVXA3L.js";import{j as y,t as E}from"./chunk-UI76XBLJ.js";import{b as d}from"./chunk-UE2YGKE7.js";import"./chunk-BE76S5KT.js";import"./chunk-3RDV3O6N.js";import"./chunk-D2ITYHSM.js";import"./chunk-FIITBHDP.js";import"./chunk-VSVNPPHQ.js";import"./chunk-CTGIUUCS.js";import"./chunk-VWEBO6QK.js";import{u as p}from"./chunk-KAAR5ZJN.js";import"./chunk-W3WDPWBE.js";import"./chunk-WKT5W7KT.js";import"./chunk-MLSR6YE6.js";import"./chunk-JPDAKIWT.js";import"./chunk-VU5W7W6Y.js";import{p as S}from"./chunk-X3IDZTNG.js";import"./chunk-IQJU4QT3.js";import"./chunk-EAH6BNBL.js";var h=()=>S.getLogger("esri.rest.support.meshFeatureSet");function z(e,t,r){let n=r.features;r.features=[],delete r.geometryType;let s=D.fromJSON(r);if(s.geometryType="mesh",!r.assetMaps)return s;let o=P(t,r.assetMaps),i=e.sourceSpatialReference??d.WGS84,c=r.globalIdFieldName,{outFields:a}=e,l=a!=null&&a.length>0?A(a.includes("*")?null:new Set(a)):()=>({});for(let f of n){let u=O(f,c,i,t,o);u!=null&&s.features.push(new M({geometry:u,attributes:l(f)}))}return s}function A(e){return({attributes:t})=>{if(!t)return{};if(!e)return t;for(let r in t)e.has(r)||delete t[r];return t}}function O(e,t,r,n,s){let o=e.attributes[t],i=s.get(o);if(i==null)return h().error("mesh-feature-set:asset-not-found","Service returned a feature which was not found in the asset map",e),null;if(!e.geometry)return h().error("mesh-feature-set:no-geometry","Service returned a feature without geometry",e),null;let c=v(e,r,n),a=E.fromJSON(e.geometry);a.spatialReference=r;let l=L(e.attributes,n),f=r.isGeographic?"local":"georeferenced",u=x(i);return u?g.createWithExternalSource(c,u,{extent:a,transform:l,vertexSpace:f}):g.createIncomplete(c,{extent:a,transform:l,vertexSpace:f})}function v({attributes:e},t,{transformFieldRoles:r}){let n=e[r.originX],s=e[r.originY],o=e[r.originZ];return new y({x:n,y:s,z:o,spatialReference:t})}function L(e,{transformFieldRoles:t}){return new w({translation:[e[t.translationX],-e[t.translationZ],e[t.translationY]],rotationAxis:[e[t.rotationX],-e[t.rotationZ],e[t.rotationY]],rotationAngle:e[t.rotationDeg],scale:[e[t.scaleX],e[t.scaleZ],e[t.scaleY]]})}var m;function P(e,t){let r=new Map;for(let n of t){let s=n.parentGlobalId;if(s==null)continue;let o=n.assetName,i=n.assetType,c=n.assetHash,a=n.assetURL,l=n.conversionStatus,f=n.seqNo,u=N(i,e.supportedFormats);if(!u){h().error("mesh-feature-set:unknown-format",`Service returned an asset of type ${i}, but it does not list it as a supported type`);continue}let I=p(r,s,()=>({files:new Map}));p(I.files,o,()=>({name:o,type:i,mimeType:u,status:b(l),parts:[]})).parts[f]={hash:c,url:a}}return r}function x(e){let t=Array.from(e.files.values()),r=new Array;for(let n of t){if(n.status!==m.COMPLETED)return null;let s=new Array;for(let o of n.parts){if(!o)return null;s.push(new T(o.url,o.hash))}r.push(new F(n.name,n.mimeType,s))}return r}function b(e){switch(e){case"COMPLETED":case"SUBMITTED":return m.COMPLETED;case"INPROGRESS":return m.PENDING;default:return m.FAILED}}(function(e){e[e.FAILED=0]="FAILED",e[e.PENDING=1]="PENDING",e[e.COMPLETED=2]="COMPLETED"})(m||(m={}));export{P as assetMapFromAssetMapsJSON,O as extractMesh,z as meshFeatureSetFromJSON};
