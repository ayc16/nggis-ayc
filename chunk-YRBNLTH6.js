import{a as F,b as Vt,c as bt}from"./chunk-DZAMIX2P.js";import{a as ft,c as Mt}from"./chunk-6ELPNVMG.js";import{b as gt,g as _t,k as q,l as B,t as wt,u as vt,v as G}from"./chunk-MSTVL2XB.js";import{q as ct,s as yt,z}from"./chunk-QRTF6HWT.js";import"./chunk-BJQH3R2Y.js";import"./chunk-I6JXU463.js";import"./chunk-L4N7O64W.js";import"./chunk-JAAOLJTO.js";import"./chunk-EB5CS3GG.js";import"./chunk-QJKE5PUA.js";import"./chunk-FVCRK5IX.js";import"./chunk-6W67IVZS.js";import"./chunk-CURQPDM4.js";import"./chunk-AWMFYQHJ.js";import"./chunk-DRX336HH.js";import"./chunk-SFGIVWEM.js";import"./chunk-TB62XDET.js";import"./chunk-724MIMFK.js";import"./chunk-UJUCAWBP.js";import"./chunk-EXOOWX4Z.js";import"./chunk-UZMIDNNF.js";import"./chunk-I2LACOYT.js";import"./chunk-RCPMQJFX.js";import"./chunk-7E3X25PE.js";import"./chunk-TXV2XM7Y.js";import"./chunk-PJBIIWFF.js";import"./chunk-R5K6EMED.js";import"./chunk-FVCUBGKZ.js";import"./chunk-LCBWJNVO.js";import"./chunk-JAXR3ZUJ.js";import"./chunk-XN46SLSO.js";import"./chunk-UGL7UJES.js";import"./chunk-QKPKWNQQ.js";import"./chunk-IHA7ZQ4Q.js";import"./chunk-XSJRPCD6.js";import"./chunk-JRJHFO7J.js";import"./chunk-JR27VNVT.js";import"./chunk-WICM2VEE.js";import"./chunk-DUZ52FW3.js";import"./chunk-VLBUZRRG.js";import"./chunk-7G763D5W.js";import"./chunk-3DDJTCET.js";import"./chunk-UDMTFKLM.js";import"./chunk-BYXBJQAS.js";import"./chunk-L5A2ASNG.js";import"./chunk-3OLRRKKD.js";import"./chunk-PTXLSCMJ.js";import"./chunk-AW3LMT4V.js";import"./chunk-LTJDZ7OM.js";import"./chunk-6EZU2A2D.js";import"./chunk-OZLCBZHH.js";import"./chunk-UTDAYTD2.js";import"./chunk-JCJ5KQ5Q.js";import"./chunk-TREMRME7.js";import"./chunk-C2FNHCAJ.js";import{a as st}from"./chunk-3AGOGXUT.js";import"./chunk-ADDH3SWI.js";import"./chunk-GJBALZEB.js";import"./chunk-XAHD7XBV.js";import"./chunk-DL3OPG77.js";import"./chunk-RBP2Z7C6.js";import"./chunk-BYXBJQAS.js";import"./chunk-AIKSV6LF.js";import"./chunk-ELGDZDOQ.js";import"./chunk-NQ4QDYDP.js";import"./chunk-S26YVN25.js";import"./chunk-DOFADBK3.js";import"./chunk-VYC75ESO.js";import"./chunk-ZN6YLP6I.js";import"./chunk-VVVTRG42.js";import"./chunk-CETY2ZOK.js";import"./chunk-CI3GTVLF.js";import"./chunk-Y6C54FDT.js";import"./chunk-5H3X7WYB.js";import"./chunk-GMW3QDVG.js";import"./chunk-RHABF3KL.js";import"./chunk-KUOODJRB.js";import"./chunk-OW7DVBQB.js";import"./chunk-56SRKZHP.js";import"./chunk-LAXYP2KV.js";import"./chunk-TIXZ4OWB.js";import"./chunk-NDZXQR2V.js";import"./chunk-W5OI4BJ2.js";import"./chunk-UVJ5D37D.js";import"./chunk-2NH7HOKA.js";import"./chunk-ZAQLF7TN.js";import"./chunk-ZHUHFKYD.js";import"./chunk-SKXQUOOX.js";import"./chunk-6HNTTYFF.js";import"./chunk-LWKMZQFJ.js";import"./chunk-I3DWOIS7.js";import{a as at}from"./chunk-RM56F5OF.js";import"./chunk-OQUBYVYT.js";import{a as R}from"./chunk-ZZUOGAMH.js";import{a as dt}from"./chunk-I7V2OAI2.js";import{d as O,f as ut,t as mt}from"./chunk-RAMEUAPV.js";import{d as P}from"./chunk-5NHMASEK.js";import{e as ot,g as lt,p as pt,q as ht}from"./chunk-3K3SLH5Z.js";import"./chunk-VORAPKV5.js";import"./chunk-WKQVOD3E.js";import{a as rt}from"./chunk-4OC4J3KU.js";import"./chunk-TOLXLK6N.js";import{t as nt}from"./chunk-CXJNPJ3A.js";import"./chunk-QU6JU243.js";import"./chunk-7SVLZCA4.js";import"./chunk-BKLTKOZS.js";import"./chunk-GAF32LQP.js";import{a as I}from"./chunk-FHBFWDFD.js";import"./chunk-S3DH7XZE.js";import"./chunk-YKUB35EI.js";import"./chunk-ZJHI7U3R.js";import"./chunk-4Y7EKSO4.js";import"./chunk-CDCW33GU.js";import"./chunk-DJEFBPF6.js";import"./chunk-DYVXH2D6.js";import"./chunk-4QS7PGAF.js";import"./chunk-NIYDRLW4.js";import"./chunk-XHOTVM3O.js";import"./chunk-H3VY6XFU.js";import"./chunk-LNYBTIG7.js";import"./chunk-S2CEVLI5.js";import"./chunk-3JBDNTAW.js";import{h as et,m as it,p as E}from"./chunk-H63LVRK7.js";import"./chunk-SJTQM4NH.js";import"./chunk-NYOCZ43I.js";import"./chunk-IFFYADB3.js";import"./chunk-R2Q5NMSG.js";import"./chunk-QL456MD5.js";import"./chunk-IY6MAS3P.js";import"./chunk-RPWH7ONJ.js";import"./chunk-H76XKIVW.js";import"./chunk-UWZJQ7YC.js";import"./chunk-NC2NFLV7.js";import{a as T}from"./chunk-UJ6V7JUK.js";import"./chunk-Z5FRAQHK.js";import"./chunk-LQWMDYLF.js";import"./chunk-BW3UVZYU.js";import{a as tt}from"./chunk-47Q3ZDMA.js";import"./chunk-XRRPDCIR.js";import"./chunk-XF4ZC6Y7.js";import"./chunk-D6QUKPEY.js";import"./chunk-VIAVLHRB.js";import"./chunk-UMZZ3I5D.js";import"./chunk-VXJKEPDS.js";import"./chunk-J7IKN4ZN.js";import"./chunk-I3S324BU.js";import"./chunk-OM7Z3UKX.js";import"./chunk-VNTMBMJI.js";import"./chunk-OJB2TSJ7.js";import"./chunk-MCO7DSFO.js";import"./chunk-LUPAMFKK.js";import"./chunk-7JD62GP7.js";import"./chunk-YXPGI3LI.js";import"./chunk-KRMYHUR3.js";import"./chunk-R4NNYEN7.js";import"./chunk-PDBA6QOJ.js";import"./chunk-CF52RSJZ.js";import"./chunk-ALWV3RJ2.js";import"./chunk-7C6Z24SS.js";import"./chunk-7G4KK3KW.js";import"./chunk-J3ZDC5ZE.js";import"./chunk-KYNKUTEO.js";import"./chunk-QWLQUMDY.js";import"./chunk-2ETHV3H2.js";import{f as X,g as x}from"./chunk-AUSMAEKP.js";import{g as L}from"./chunk-WVCJLLRA.js";import"./chunk-OVOWBDBP.js";import"./chunk-V2KSICSA.js";import{a as d,f as Q,h as V}from"./chunk-4XUOIGFO.js";import"./chunk-R2HWUZ3L.js";import"./chunk-G24ZJINL.js";import"./chunk-T25YY3N7.js";import"./chunk-ALQ3STGG.js";import"./chunk-EETFV2SL.js";import{h as Z}from"./chunk-AM3VOA32.js";import"./chunk-SAOUSUZE.js";import"./chunk-LECQV7I4.js";import"./chunk-7HZKOXPR.js";import"./chunk-4HISZWR4.js";import"./chunk-33BSK37G.js";import"./chunk-TQAPQODA.js";import"./chunk-M2GLXRA2.js";import"./chunk-EBWCXIFH.js";import{p as Y}from"./chunk-MRVR6F6G.js";import"./chunk-WXQQZY3K.js";import"./chunk-VPMDQK57.js";import"./chunk-BCREO4Q5.js";import"./chunk-ZVHU7VE3.js";import"./chunk-76YVRX2R.js";import"./chunk-OZF6BMOL.js";import{a as k}from"./chunk-GJP6PTKT.js";import"./chunk-RSDQHAJX.js";import"./chunk-HMKFQDR7.js";import"./chunk-2OT2C2UU.js";import"./chunk-XIMCHX2H.js";import"./chunk-SF6Z2K5H.js";import"./chunk-GBTN5LIS.js";import"./chunk-JOSG37QF.js";import"./chunk-SLMQFZE3.js";import"./chunk-VNB5ZT3P.js";import"./chunk-NDG5FXLR.js";import"./chunk-EJG3F6VR.js";import"./chunk-5ODCEDHC.js";import"./chunk-BENVXA3L.js";import{l as b}from"./chunk-SA4OMQAD.js";import"./chunk-24BLFS5R.js";import{N as v}from"./chunk-JDDD6VJ4.js";import"./chunk-VOYK3LZF.js";import"./chunk-HOJTYTYD.js";import"./chunk-XNEAL2YW.js";import"./chunk-J7M5V2SQ.js";import"./chunk-RQD6EDD6.js";import"./chunk-XPCG2OJX.js";import{L as n,h as J}from"./chunk-AUTL5LCV.js";import{S as y}from"./chunk-KUJG22IX.js";import"./chunk-OVHPPCBL.js";import{a as s}from"./chunk-W3WDPWBE.js";import{t as M}from"./chunk-GISCFF3Z.js";import{b as _}from"./chunk-MLSR6YE6.js";import"./chunk-SNFOAZZQ.js";import"./chunk-CPDJJRWA.js";import"./chunk-DKS57BVI.js";import"./chunk-VU5W7W6Y.js";import{r as $}from"./chunk-HQMV3KQV.js";import{g as K}from"./chunk-CRMMDK2Z.js";import"./chunk-MDAB6L5Y.js";import"./chunk-FMFGIQYB.js";import{a as D,b as S}from"./chunk-EAH6BNBL.js";var w=class extends st{constructor(t){super(t),this.type="area-measurement",this.unit=null}set geometry(t){t!=null?(t.rings.length>1&&$.getLogger(this).warn("Measuring polygons with multiple rings is not supported."),this._set("geometry",t.clone())):this._set("geometry",null)}get requiredPropertiesForEditing(){if(this.geometry!=null&&this.geometry.rings.length===1){let t=this.geometry.rings[0];if(t.length<=2||!K(t[0],t[t.length-1]))return[null]}return[this.geometry]}clear(){this.geometry=null}};s([n({type:["area-measurement"]})],w.prototype,"type",void 0),s([n({value:null,type:Y})],w.prototype,"geometry",null),s([n({type:v,value:null})],w.prototype,"unit",void 0),s([n({readOnly:!0})],w.prototype,"requiredPropertiesForEditing",null),w=s([y("esri.analysis.AreaMeasurementAnalysis")],w);var j=w;var A=class{constructor(e,i=null){this.screenPoint=e,this.result=i}},C=class{constructor(e,i){this.scenePoint=e,this.mapPoint=i}};function Pt(t){let e=yt(t);return e.options.store=ct.MIN,e.options.hud=!1,e}var U=class{constructor(e){this.vertexManipulators=[],this._destroyed=!1,this._isManipulatorsOwner=!0,this._visible=!0,this._listenerHandles=null,this._tempHandlePosition=k();let{analysisViewData:i,manipulators:a,toolState:o,view:r,visible:l}=e;this._analysisViewData=i,this._toolState=o,a!=null?(this._manipulators=a,this._isManipulatorsOwner=!1):this._manipulators=new O,this._view=r,this._intersector=Pt(r.state.viewingMode);let h=G(this._handleColor),m=[new B(z(h,1,32,32))],c=new q({view:r,renderObjects:m});c.available=!1,c.radius=Dt,c.interactive=!1,this._manipulators.add(c),this._cursorManipulator=c,this._cursorManipulatorMaterial=h,this._laserLine=new gt({view:r,attached:!0,style:{glowWidth:kt,glowFalloff:Tt,innerWidth:Et},isDecoration:!0}),this._updateVisibility(l??!0)}destroy(){this._listenerHandles=_(this._listenerHandles),this._isManipulatorsOwner?this._manipulators=_(this._manipulators):this._manipulators=null,this._laserLine=_(this._laserLine),this._destroyed=!0}get destroyed(){return this._destroyed}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){}show(){this._setVisibility(!0)}hide(){this._setVisibility(!1)}_setVisibility(e){this._destroyed||this._visible===e||this._updateVisibility(e)}_updateVisibility(e){this._visible=e,this._laserLine.visible=e,e?(this._initializeListeners(),this._updateAll()):(this._destroyListeners(),this.vertexManipulators.forEach(({manipulator:i})=>this._removeVertexManipulator(i)),this.vertexManipulators=[],this._view.cursor=null)}vertexHandleAt(e,i){return this._manipulators.intersect(e,i)?.metadata}pick(e){let i=this._view.spatialReference,a=Z(e.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(a,this._intersector);let o=this._intersector.results.min,r=k();if(!o.getIntersectionPoint(r))return null;let l=this._view.renderCoordsHelper.fromRenderCoords(r,new b({spatialReference:i}));return l==null?null:new C(r,l)}_updateAll(){this._visible&&(this._updateVertexManipulators(),this._updateLaserLine())}_createVertexManipulator(){let e=G(this._handleColor),i=[new B(z(e,1,32,32))],a=new q({view:this._view,renderObjects:i});return a.radius=Dt,this._manipulators.add(a),{manipulator:a,material:e}}_removeVertexManipulator(e){this._manipulators.remove(e)}_updateVertexManipulators(){let{viewData:e}=this._analysisViewData,i=this._analysisViewData.path?this._analysisViewData.path.vertices:[],a=this.vertexManipulators;Lt(a,i.length,()=>this._createVertexManipulator(),({manipulator:o})=>this._removeVertexManipulator(o)),a.forEach(({manipulator:o},r)=>{o.metadata=i[r],o.renderLocation=e.positionsRender[r],o.cursor=r===0&&this._toolState.polygonState==="drawing"?"crosshair":null}),this._toolState.polygonState==="drawing"&&this._analysisViewData.stagedPoint!=null?(this._cursorManipulator.available=!0,this._cursorManipulator.location=this._analysisViewData.stagedPoint):this._cursorManipulator.available=!1}get _handleColor(){return E(this._view.effectiveTheme.accentColor,.5)}_getFocusPoint(){let{lastDraggedVertex:e}=this._analysisViewData;switch(this._toolState.polygonState){case"drawing":return this._analysisViewData.stagedPoint!=null?this._analysisViewData.stagedPoint:e!=null?this._analysisViewData.path.getVertexPositionAsPoint(e):this._analysisViewData.path.lastPoint;case"editing":return e!=null?this._analysisViewData.path.getVertexPositionAsPoint(e):null;default:return this._analysisViewData.stagedPoint}}_updateLaserLine(){let e=this._toolState.polygonState!=="measured"&&this._toolState.active,i=this._getFocusPoint();if(e&&i!=null){let a=this._tempHandlePosition;this._view.renderCoordsHelper.toRenderCoords(i,a),this._laserLine.heightManifoldTarget=a}else this._laserLine.heightManifoldTarget=null}_initializeListeners(){this._listenerHandles=new J,this._listenerHandles.add([d(()=>this._toolState.polygonState,()=>this._updateLaserLine()),d(()=>this._analysisViewData.viewData,()=>this._updateAll(),Q),d(()=>({lastDraggedVertex:this._analysisViewData.lastDraggedVertex,cursorPoint:this._analysisViewData.stagedPoint}),()=>this._updateLaserLine()),d(()=>this._toolState.active,()=>this._updateAll()),d(()=>this._view.effectiveTheme.accentColor,e=>{let i=E(e,.5);for(let{material:m}of this.vertexManipulators)m.setParameters({color:i});this._cursorManipulatorMaterial.setParameters({color:i});let a=T.toUnitRGB(e),o=T.toUnitRGB(et(e)),r=.75*e.a,l=this._laserLine,h=l.style;l.style=S(D({},h),{glowColor:a,innerColor:o,globalAlpha:r})},{initial:!0,equals:it})])}_destroyListeners(){this._listenerHandles=_(this._listenerHandles)}};function Lt(t,e,i,a){for(;t.length<e;)t.push(i());if(a)for(;t.length>e;)a(t.pop());else t.length=e}var kt=8,Tt=8,Et=1,Dt=5;var u=class extends Vt{constructor(t){super(t),this._updatingHandles=new tt,this.polygonState="initial",this.manipulators=new O,this._getSnappingContext=rt(e=>new ht({elevationInfo:{mode:"absolute-height",offset:0},pointer:e,editGeometryOperations:new pt(new lt("point",ot(!0,!1,this.view.spatialReference)),this.view.state.viewingMode),visualizer:new _t}))}initialize(){let{view:t,analysisViewData:e,manipulators:i,visible:a}=this;this.measurementView=new U({view:t,analysisViewData:e,toolState:this,manipulators:i,visible:a});let o=ft(t);this._snappingManagerResult=o,this.addHandles(o),this._snappingOperation=new dt({view:t}),this._updatingHandles.add(()=>this.stagedPoint,r=>{this.analysisViewData.stagedPoint=r!=null?P(r,new b):null},V),nt(this,()=>{let r=this.view.inputManager.latestPointerType??"mouse",l=this._getSnappingContext(r);this._updatingHandles.addPromise(M(this._snappingOperation.snapAgainNearPreviousMapPoint(this._snappingManager,l)))}),this._setupManipulators(),this.addHandles([d(()=>this.state,r=>{r==="measured"&&this.finishToolCreation()},V),this.analysisViewData.path.on("change",()=>{let r=this.analysisViewData.path;this.polygonState!=="initial"||r.isEmptyPolygon||(r.isValidPolygon?this.polygonState="measured":this.polygonState="drawing")})])}destroy(){this.measurementView.destroy(),this._set("measurementView",null),this._updatingHandles=_(this._updatingHandles)}get _snappingManager(){return this._snappingManagerResult.snappingManager}get state(){return this.analysisViewData.path.numVertices===0?"ready":this.analysisViewData.path.isValidPolygon&&this.polygonState!=="editing"?"measured":"measuring"}get cursor(){return this.state==="ready"||this.polygonState==="drawing"?"crosshair":null}get updating(){return this._updatingHandles.updating||this._snappingManager.updating}get stagedPoint(){return this._snappingOperation.stagedPoint}set stagedPoint(t){this._snappingOperation.stagedPoint=t}get snappingOptions(){return this._snappingManager.options}finishMeasurement(){let{path:t}=this.analysisViewData;t.numVertices<3?(t.clear(),this.polygonState="initial"):(t.close(),this.polygonState="measured"),this._resetSnappingState()}onShow(){this.measurementView.show()}onHide(){this.measurementView.hide()}onDeactivate(){this._resetSnappingState()}onInputEvent(t){switch(t.type){case"immediate-double-click":this._handleImmediateDoubleClick(t);break;case"immediate-click":this._handleImmediateClick(t);break;case"pointer-move":this._handlePointerMove(t);break;case"drag":this._handleDrag(t);break;case"key-down":this._handleKeyDown(t)}}_setupManipulators(){let t=i=>i.events.on("grab-changed",()=>{if(this.analysisViewData.path.isValidPolygon){let a=this.manipulators.some(o=>o.manipulator.grabbing);this.polygonState=a?"editing":"measured"}}),e=i=>{this.addHandles([ut(i,(a,o,r,l)=>{let h=wt(a),m=a.metadata,c=this._snappingManager,H=this._getSnappingContext(l),Ct=this._updatingHandles,{snappingStep:Ut,cancelSnapping:Ht}=mt({snappingManager:c,snappingContext:H,updatingHandles:Ct});r=r.next(h).next(f=>(this.analysisViewData.lastDraggedVertex=null,this.analysisViewData.path.setVertexPosition(m,W),a.location=W,f)).next(Ht),o.next(h).next(vt(this.view)).next(...Ut).next(f=>{a.location=f.mapEnd,this.analysisViewData.lastDraggedVertex=f.action==="end"?null:m,this.analysisViewData.path.setVertexPosition(m,P(f.mapEnd))});let W=P(this.analysisViewData.path.getVertexPositionAsPoint(m))}),t(i)],i)};this.manipulators.forEach(({manipulator:i})=>{e(i)}),this.addHandles([this.manipulators.on("after-add",({item:{manipulator:i}})=>{e(i)}),this.manipulators.on("after-remove",({item:{manipulator:i}})=>this.removeHandles(i))])}_handleImmediateDoubleClick(t){F(t)&&(this.polygonState==="drawing"&&this.finishMeasurement(),t.stopPropagation())}_handleDrag(t){this.polygonState==="editing"&&t.stopPropagation()}_handleImmediateClick(t){if(!F(t))return;let e=R(t),{pointerType:i}=t;if(this.active)switch(this.polygonState){case"initial":if(this._addVertexAt(e,i))return this.stagedPoint=null,this.polygonState="drawing",void t.stopPropagation();break;case"drawing":{let a=this.measurementView.vertexHandleAt(e,i);if(a==null){if(this._addVertexAt(e,i))return this.stagedPoint=null,void t.stopPropagation()}else a.index===0&&(this.finishMeasurement(),t.stopPropagation());break}}t.pointerType==="mouse"&&this._hoverAt(e)}_handlePointerMove(t){if(t.pointerType==="mouse"){let e=R(t);this._hoverAt(e)}}_handleKeyDown(t){let{path:e}=this.analysisViewData;t.key==="Enter"&&this.polygonState==="drawing"&&e.numVertices>=3&&(this.stagedPoint=null,this.finishMeasurement(),t.stopPropagation())}_hoverAt(t){let{polygonState:e}=this;if(this.active&&(e==="initial"||e==="drawing")){let i=this._pick(t);if(i?.mapPoint!=null){let a=this._getSnappingContext("mouse");this._updatingHandles.addPromise(M(this._snappingOperation.snap({point:i.mapPoint},this._snappingManager,a)))}}else this.stagedPoint=null}_addVertexAt(t,e){let i=this._pick(t);if(i?.mapPoint!=null){let{mapPoint:a}=i,o=this._getSnappingContext(e),r=this._snappingOperation.update({point:a},this._snappingManager,o),l=P(r,new b);return this.analysisViewData.path.add(l),!0}return!1}_pick(t){let e=new A(t);return this.measurementView.pick(e)}_resetSnappingState(){this._snappingManager.doneSnapping(),this._snappingOperation.abort(),this._snappingOperation.stagedPoint=null}get test(){}};s([n({readOnly:!0})],u.prototype,"state",null),s([n()],u.prototype,"polygonState",void 0),s([n({readOnly:!0})],u.prototype,"cursor",null),s([n()],u.prototype,"measurementView",void 0),s([n({constructOnly:!0})],u.prototype,"view",void 0),s([n({constructOnly:!0})],u.prototype,"analysis",void 0),s([n({constructOnly:!0})],u.prototype,"analysisViewData",void 0),s([n({readOnly:!0})],u.prototype,"manipulators",void 0),s([n()],u.prototype,"updating",null),s([n()],u.prototype,"stagedPoint",null),s([n()],u.prototype,"snappingOptions",null),u=s([y("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],u);var St=u;var g=class extends bt{constructor(t){super(t),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="AreaMeasurement3DViewModel is only supported in 3D views.",this._userUnitOptions=null,this._userUnit=null}initialize(){this.addHandles(d(()=>({analysis:this.analysis,unit:this.unit}),({analysis:t,unit:e})=>{t!=null&&(t.unit=e)},V))}get state(){return this.disabled||!this.ready?"disabled":this.tool==null?"ready":this.tool.state}get measurement(){if(this.tool==null||this.disabled||this.tool.destroyed)return null;let{analysisView:t}=this;if(t==null)return null;let e=t.analysisVisualization,i=e.viewData,a=i.validMeasurement,o=i.mode==="euclidean",r=i.intersectingSegments.size===0,l=r?a?"available":"unavailable":"invalid";return{mode:o?"euclidean":"geodesic",area:{text:r&&a?e.areaLabel:null,state:l},perimeterLength:{text:r&&a?e.perimeterLengthLabel:null,state:l}}}set unitOptions(t){this._userUnitOptions=t,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(t){this._userUnit=t?this._findSelectableUnit(t,this._userUnit):null}get unit(){return this._userUnit!=null?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}constructAnalysis(){return new j}constructTool(){return new St({view:this.view,analysis:this.analysis,analysisViewData:this.analysisView,visible:this.visible})}_findSelectableUnit(t,e){let{unitOptions:i}=this;return i.includes(t)?t:e!=null?this._findSelectableUnit(e):i[0]}_filteredOrAllUnits(t){if(t==null)return v.slice();let e=t.filter(i=>v.includes(i));return e.length===0?v.slice():e}};s([n({type:j})],g.prototype,"analysis",void 0),s([n({readOnly:!0})],g.prototype,"state",null),s([n({readOnly:!0})],g.prototype,"measurement",null),s([n()],g.prototype,"unitOptions",null),s([n()],g.prototype,"unit",null),s([n(at)],g.prototype,"defaultUnit",void 0),s([n()],g.prototype,"_userUnit",void 0),g=s([y("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],g);var N=g;var xt="esri-area-measurement-3d",Ot={base:xt,newMeasurementButton:`${xt}__clear-button`},p=class extends X{constructor(t,e){super(t,e),this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new N}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(t){this.viewModel.analysis=t}get icon(){return"measure-area"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(t){this.viewModel.unitOptions=t}get unit(){return this.viewModel.unit}set unit(t){this.viewModel.unit=t}render(){let{messages:t,messagesCommon:e,messagesUnits:i,unit:a,unitOptions:o,viewModel:r}=this,{active:l,measurement:h,state:m,supported:c}=r;return L("div",{"aria-label":this.messages.widgetLabel,class:this.classes(Ot.base,I.widget,I.panel),key:this,role:"presentation"},this.visible?L(Mt,{active:l,measurementItems:[{key:"direct",title:i.measures.area,value:At(h?.area)},{key:"perimeter",title:t.perimeterLength,value:At(h?.perimeterLength)}],messages:S(D({},t),{notApplicable:e.notApplicable}),newMeasurementButtonClass:Ot.newMeasurementButton,state:m,supported:c,unit:a,unitOptions:o,onNewMeasurementClick:()=>{M(this.viewModel.start())},onUnitChange:H=>{this.unit=H}}):null)}};function At(t){return t?.state==="available"?t.text:null}s([n()],p.prototype,"view",null),s([n()],p.prototype,"visible",null),s([n()],p.prototype,"active",null),s([n({constructOnly:!0,nonNullable:!0})],p.prototype,"analysis",null),s([n()],p.prototype,"icon",null),s([n()],p.prototype,"label",null),s([n(),x("esri/widgets/AreaMeasurement3D/t9n/AreaMeasurement3D")],p.prototype,"messages",void 0),s([n(),x("esri/t9n/common")],p.prototype,"messagesCommon",void 0),s([n(),x("esri/core/t9n/Units")],p.prototype,"messagesUnits",void 0),s([n()],p.prototype,"uiStrings",void 0),s([n({type:N})],p.prototype,"viewModel",void 0),s([n()],p.prototype,"unitOptions",null),s([n()],p.prototype,"unit",null),p=s([y("esri.widgets.AreaMeasurement3D")],p);var bi=p;export{bi as default};
