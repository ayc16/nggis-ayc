import{a as N,j as P}from"./chunk-KOW2YKW3.js";import{d as G}from"./chunk-ZGCXXZVI.js";import{e as S,f as q}from"./chunk-RMOIVYM4.js";import{a as b}from"./chunk-F4I5LECK.js";import{E as L,c as Y}from"./chunk-Q3WN5PJ6.js";import{a as D}from"./chunk-AQ74ANSJ.js";import{b as R}from"./chunk-6ZT4EXDX.js";import{j as C}from"./chunk-UI76XBLJ.js";import{b as A}from"./chunk-UE2YGKE7.js";import{A as U,o as O}from"./chunk-BE76S5KT.js";import{a as j,b as V,h as z}from"./chunk-EAH6BNBL.js";var m=null,B=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;function Z(n,e,o){return n.x<0?n.x+=e:n.x>o&&(n.x-=e),n}function ae(n,e,o,s){let i=U(o)?O(o):null,u=i?Math.round((i.valid[1]-i.valid[0])/e.scale[0]):null;return n.map(l=>{let r=new C(l.geometry);return R(e,r,r,r.hasZ,r.hasM),l.geometry=i?Z(r,u??0,s[0]):r,l})}function ue(n,e=18,o,s,i){let u=new Float64Array(s*i);e=Math.round(D(e));let l=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,w=q(o);for(let{geometry:p,attributes:v}of n){let{x:$,y:f}=p,g=Math.max(0,$-e),E=Math.max(0,f-e),T=Math.min(i,f+e),F=Math.min(s,$+e),h=+w(v);for(let c=E;c<T;c++)for(let d=g;d<F;d++){let I=c*s+d,x=S(d-$,c-f,e)*h,a=u[I]+=x;l=Math.min(l,a),r=Math.max(r,a)}}return{min:l,max:r}}function _(n){let e=B.exec(n);if(!e)return null;let{hh:o,mm:s,ss:i,ms:u}=e.groups;return Number(o)*b.hours+Number(s)*b.minutes+Number(i)*b.seconds+Number(u||0)}function fe(n,e,o=!0){return z(this,null,function*(){if(!e)return[];let{field:s,field2:i,field3:u,fieldDelimiter:l,fieldInfos:r,timeZone:w}=n,p=s&&r?.find(a=>a.name.toLowerCase()===s.toLowerCase()),v=!!p&&L(p),$=!!p&&G(p),f=n.valueExpression,g=n.normalizationType,E=n.normalizationField,T=n.normalizationTotal,F=[],h=n.viewInfoParams,c=null,d=null;if(f){if(!m){let{arcadeUtils:a}=yield Y();m=a}m.hasGeometryOperations(f)&&(yield m.enableGeometryOperations()),c=m.createFunction(f),d=h?m.getViewInfo({viewingMode:h.viewingMode,scale:h.scale,spatialReference:new A(h.spatialReference)}):null}let I=n.fieldInfos,x=!(e[0]&&"declaredClass"in e[0]&&e[0].declaredClass==="esri.Graphic")&&I?{fields:I}:null;return e.forEach(a=>{let y=a.attributes,t;if(f){let M=x?V(j({},a),{layer:x}):a,W=m.createExecContext(M,d,w);t=m.executeFunction(c,W)}else y&&(t=y[s],i?(t=`${N(t)}${l}${N(y[i])}`,u&&(t=`${t}${l}${N(y[u])}`)):typeof t=="string"&&o&&($?t=t?new Date(t).getTime():null:v&&(t=t?_(t):null)));if(g&&typeof t=="number"&&isFinite(t)){let M=y&&parseFloat(y[E]);t=P(t,g,M,T)}F.push(t)}),F})}export{ae as a,ue as b,_ as c,fe as d};
