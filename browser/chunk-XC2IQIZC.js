import{i as I}from"./chunk-DHY7QZ2H.js";import{d as h,e as C}from"./chunk-QPDPZUDG.js";import{a as w}from"./chunk-F4I5LECK.js";import{E as b}from"./chunk-KYP6LPQU.js";import{b as g}from"./chunk-NYONONNN.js";import{h as m}from"./chunk-EAH6BNBL.js";var V=/^-?(\d+)(\.(\d+))?$/i;function M(t,e){return t-e}function y(t,e){let n,i;return n=Number(t.toFixed(e)),n<t?i=n+1/10**e:(i=n,n-=1/10**e),n=Number(n.toFixed(e)),i=Number(i.toFixed(e)),[n,i]}function B(t,e,n,i,o){let a=R(t,e,n,i),r=a.previous==null||a.previous<=o,l=a.next==null||a.next<=o;return r&&l||a.previous+a.next<=2*o}function U(t){let e=String(t),n=e.match(V);if(n&&n[1])return{integer:n[1].split("").length,fractional:n[3]?n[3].split("").length:0};if(e.toLowerCase().includes("e")){let i=e.split("e"),o=i[0],a=i[1];if(o&&a){let r=Number(o),l=Number(a),s=l>0;s||(l=Math.abs(l));let A=U(r);return s?(A.integer+=l,l>A.fractional?A.fractional=0:A.fractional-=l):(A.fractional+=l,l>A.integer?A.integer=1:A.integer-=l),A}}return{integer:0,fractional:0}}function R(t,e,n,i){let o={previous:null,next:null};if(n!=null){let a=t-n,r=e-n-a;o.previous=Math.floor(Math.abs(100*r/a))}if(i!=null){let a=i-t,r=i-e-a;o.next=Math.floor(Math.abs(100*r/a))}return o}function S(t,e={}){let n=t.slice(0),{tolerance:i=2,strictBounds:o=!1,indexes:a=n.map((r,l)=>l)}=e;a.sort(M);for(let r=0;r<a.length;r++){let l=a[r],s=n[l],A=l===0?null:n[l-1],N=l===n.length-1?null:n[l+1],p=U(s).fractional;if(p){let u,c=0,f=!1;for(;c<=p&&!f;){let d=y(s,c);u=o&&r===0?d[1]:d[0],f=B(s,u,A,N,i),c++}f&&(n[l]=u)}}return n}var T={maximumFractionDigits:20};function F(t){return g(t,T)}var v="<",x=">";function Z(t,e,n,i){let o="";return e===0?o=`${v} `:e===n&&(o=`${x} `),o+(i?C(t,i):F(t))}var z=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];function E(t){return m(this,null,function*(){if(!("visualVariables"in t)||!t.visualVariables)return null;let e=t.visualVariables.find(r=>r.type==="color");if(!e)return null;let n=null,i=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;n=e.stops[0].value,i=e.stops[e.stops.length-1].value}let o=n!=null&&i!=null?n+(i-n)/2:0,{getColor:a}=yield import("./chunk-MODFJR45.js");return a(e,o)??null})}function X(t,e){return m(this,null,function*(){let n=t.trailCap,i=t.trailWidth||1,o=e||(yield E(t))||t.color;return new I({cap:n,color:o,width:i})})}function Y(t){return t!=null&&typeof t=="object"&&"min"in t&&"max"in t}function Q(t,e){if(!e.field)return null;if("featureReduction"in t)switch(t.featureReduction?.type){case"cluster":case"binning":{let n=t.featureReduction.fields.find(({name:i})=>i.toLowerCase()===e.field.toLowerCase());return n&&"getField"in t?t.getField(n.onStatisticField):null}}return"getField"in t?t.getField?.(e.field):null}function q(t,e){let n="popupTemplate"in t?t.popupTemplate?.fieldInfos:null;if(n?.length&&e)return n.find(i=>i.fieldName?.toLowerCase()===e.toLowerCase())?.format?.dateFormat}function P(t,e,n){let i=Q(t,e);if(!i||!h(i)&&!b(i))return null;let o=q(t,i.name);if(!o&&i.type==="date"){let a=0,r=0;e.stops?(a=e.stops?.at(0)?.value??a,r=e.stops?.at(-1)?.value??r):"minDataValue"in e&&"maxDataValue"in e&&(a=e.minDataValue??a,r=e.maxDataValue??r),o=r-a>2*w.days?"short-date":"short-date-short-time"}return{fieldType:i.type,format:o,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:n,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}export{U as a,R as b,S as c,v as d,x as e,Z as f,z as g,E as h,X as i,Y as j,P as k};
