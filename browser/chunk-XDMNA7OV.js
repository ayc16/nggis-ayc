import{a as J,b as w,c as E,d as q}from"./chunk-NKZ7R6T6.js";import{a as Q,b as Y}from"./chunk-VHAPMMA5.js";import{b as K}from"./chunk-DR5D3NPO.js";import{f as H,g as D}from"./chunk-QBQKFGOZ.js";import{o as X,p as C}from"./chunk-F7PIPM6E.js";import{h as O,i as B}from"./chunk-UI76XBLJ.js";import{o as I,p as N}from"./chunk-BE76S5KT.js";import{_ as G,g as _}from"./chunk-CTGIUUCS.js";import{j as V,p as W,r as F}from"./chunk-X3IDZTNG.js";import{a as P,b as z,h as S}from"./chunk-EAH6BNBL.js";function Z(e,s,a,n){return S(this,null,function*(){let t=K(e),i=s[0].spatialReference,r=z(P({},n),{responseType:"json",query:z(P({},t.query),{f:"json",sr:N(i),target:JSON.stringify({geometryType:D(s[0]),geometries:s}),cutter:JSON.stringify(a)})}),o=yield G(t.path+"/cut",r),{cutIndexes:l,geometries:p=[]}=o.data;return{cutIndexes:l,geometries:p.map(u=>{let g=H(u);return g.spatialReference=i,g})}})}function $(e,s,a){return S(this,null,function*(){let n=typeof e=="string"?_(e):e,t=s[0].spatialReference,i=D(s[0]),r=z(P({},a),{query:z(P({},n.query),{f:"json",sr:N(t),geometries:JSON.stringify(Q(s))})}),{data:o}=yield G(n.path+"/simplify",r);return Y(o.geometries,i,t)})}var ne=()=>W.getLogger("esri.geometry.support.normalizeUtils");function oe(e){return e.type==="polygon"}function re(e){return e[0].type==="polygon"}function ie(e){return e[0].type==="polyline"}function ee(e){let s=[],a=0,n=0;for(let t=0;t<e.length;t++){let i=e[t],r=null;for(let o=0;o<i.length;o++)r=i[o],s.push(r),o===0?(a=r[0],n=a):(a=Math.min(a,r[0]),n=Math.max(n,r[0]));r&&s.push([(a+n)/2,0])}return s}function ae(e,s){if(!(e instanceof C||e instanceof X)){let t="straightLineDensify: the input geometry is neither polyline nor polygon";throw ne().error(t),new F(t)}let a=q(e),n=[];for(let t of a){let i=[];n.push(i),i.push([t[0][0],t[0][1]]);for(let r=0;r<t.length-1;r++){let o=t[r][0],l=t[r][1],p=t[r+1][0],u=t[r+1][1],g=Math.sqrt((p-o)*(p-o)+(u-l)*(u-l)),m=(u-l)/g,x=(p-o)/g,h=g/s;if(h>1){for(let b=1;b<=h-1;b++){let T=b*s,f=x*T+o,c=m*T+l;i.push([f,c])}let R=(g+Math.floor(h-1)*s)/2,L=x*R+o,U=m*R+l;i.push([L,U])}i.push([p,u])}}return oe(e)?new X({rings:n,spatialReference:e.spatialReference}):new C({paths:n,spatialReference:e.spatialReference})}function te(e,s,a){if(s){let n=ae(e,1e6);e=B(n,!0)}return a&&(e=E(e,a)),e}function se(e,s,a){if(Array.isArray(e)){let n=e[0];if(n>s){let t=w(n,s);e[0]=n+t*(-2*s)}else if(n<a){let t=w(n,a);e[0]=n+t*(-2*a)}}else{let n=e.x;if(n>s){let t=w(n,s);e=e.clone().offset(t*(-2*s),0)}else if(n<a){let t=w(n,a);e=e.clone().offset(t*(-2*a),0)}}return e}function le(e,s){let a=-1;for(let n=0;n<s.cutIndexes.length;n++){let t=s.cutIndexes[n],i=s.geometries[n],r=q(i);for(let o=0;o<r.length;o++){let l=r[o];l.some(p=>{if(p[0]<180)return!0;{let u=0;for(let m=0;m<l.length;m++){let x=l[m][0];u=x>u?x:u}u=Number(u.toFixed(9));let g=-360*w(u,180);for(let m=0;m<l.length;m++){let x=i.getPoint(o,m);i.setPoint(o,m,x.clone().offset(g,0))}return!0}})}if(t===a){if(re(e))for(let o of q(i))e[t]=e[t].addRing(o);else if(ie(e))for(let o of q(i))e[t]=e[t].addPath(o)}else a=t,e[t]=i}return e}function fe(e,s,a){return S(this,null,function*(){if(!Array.isArray(e))return fe([e],s);s&&typeof s!="string"&&ne().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");let n=typeof s=="string"?s:s?.url??V.geometryServiceUrl,t,i,r,o,l,p,u,g,m=0,x=[],h=[];for(let f of e)if(f!=null)if(t||(t=f.spatialReference,i=I(t),r=t.isWebMercator,p=r?102100:4326,o=J[p].maxX,l=J[p].minX,u=J[p].plus180Line,g=J[p].minus180Line),i)if(f.type==="mesh")h.push(f);else if(f.type==="point")h.push(se(f.clone(),o,l));else if(f.type==="multipoint"){let c=f.clone();c.points=c.points.map(y=>se(y,o,l)),h.push(c)}else if(f.type==="extent"){let c=f.clone()._normalize(!1,!1,i);h.push(c.rings?new X(c):c)}else if(f.extent){let c=f.extent,y=w(c.xmin,l)*(2*o),d=y===0?f.clone():E(f.clone(),y);c.offset(y,0),c.intersects(u)&&c.xmax!==o?(m=c.xmax>m?c.xmax:m,d=te(d,r),x.push(d),h.push("cut")):c.intersects(g)&&c.xmin!==l?(m=c.xmax*(2*o)>m?c.xmax*(2*o):m,d=te(d,r,360),x.push(d),h.push("cut")):h.push(d)}else h.push(f.clone());else h.push(f);else h.push(f);let R=w(m,o),L=-90,U=R,b=new C;for(;R>0;){let f=360*R-180;b.addPath([[f,L],[f,-1*L]]),L*=-1,R--}if(x.length>0&&U>0){let f=le(x,yield Z(n,x,b,a)),c=[],y=[];for(let M=0;M<h.length;M++){let j=h[M];if(j!=="cut")y.push(j);else{let A=f.shift(),v=e[M];v!=null&&v.type==="polygon"&&v.rings&&v.rings.length>1&&A.rings.length>=v.rings.length?(c.push(A),y.push("simplify")):y.push(r?O(A):A)}}if(!c.length)return y;let d=yield $(n,c,a),k=[];for(let M=0;M<y.length;M++){let j=y[M];j!=="simplify"?k.push(j):k.push(r?O(d.shift()):d.shift())}return k}let T=[];for(let f=0;f<h.length;f++){let c=h[f];if(c!=="cut")T.push(c);else{let y=x.shift();T.push(r===!0?O(y):y)}}return T})}function Ge(e){if(!e)return null;let s=e.extent;if(!s)return null;let a=e.spatialReference&&I(e.spatialReference);if(!a)return s;let[n,t]=a.valid,i=2*t,{width:r}=s,o,{xmin:l,xmax:p}=s;if([l,p]=[p,l],e.type==="extent"||r===0||r<=t||r>i||l<n||p>t)return s;switch(e.type){case"polygon":if(!(e.rings.length>1))return s;o=ee(e.rings);break;case"polyline":if(!(e.paths.length>1))return s;o=ee(e.paths);break;case"multipoint":o=e.points}let u=s.clone();for(let g=0;g<o.length;g++){let m=o[g][0];m<0?(m+=t,p=Math.max(m,p)):(m-=t,l=Math.min(m,l))}return u.xmin=l,u.xmax=p,u.width<r?(u.xmin-=t,u.xmax-=t,u):s}function Ne(e,s,a){let n=I(a);if(n==null)return e;let[t,i]=n.valid,r=2*i,o=0,l=0;s>i?o=Math.ceil(Math.abs(s-i)/r):s<t&&(o=-Math.ceil(Math.abs(s-t)/r)),e>i?l=Math.ceil(Math.abs(e-i)/r):e<t&&(l=-Math.ceil(Math.abs(e-t)/r));let p=e+(o-l)*r,u=p-s;return u>i?p-=r:u<t&&(p+=r),p}function Oe(e,s){let a=I(s);if(a){let[n,t]=a.valid,i=t-n;if(e<n)for(;e<n;)e+=i;if(e>t)for(;e>t;)e-=i}return e}export{ae as a,fe as b,Ge as c,Ne as d,Oe as e};
