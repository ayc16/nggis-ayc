import{a as St,b as N,c as S,d as Z,g as Dt,p as Fe,q as P}from"./chunk-GLDWQ77T.js";import{d as bt,e as At,f as zt,i as It}from"./chunk-R4SFVOZO.js";import{a as Oe}from"./chunk-BKLTKOZS.js";import{d as je}from"./chunk-YKUB35EI.js";import{a as He}from"./chunk-NIYDRLW4.js";import{h as ze,j as Ie,m as Se,o as De}from"./chunk-H3VY6XFU.js";import{A as Re,C as Rt,E as nt,F as be,k as Pt,l as _,p as X,q as qe,w as yt}from"./chunk-SJTQM4NH.js";import{d as Ve}from"./chunk-I7FAWQNR.js";import{a as I,c as et,e as xe}from"./chunk-PDBA6QOJ.js";import{a as Me}from"./chunk-QWLQUMDY.js";import{b as Lt,d as z,h as $,j as gt,k as Ne,l as tt,o as Q,q as we,v as qt,y as ve}from"./chunk-2ETHV3H2.js";import{a as de,h as pe}from"./chunk-4XUOIGFO.js";import{f as Ee}from"./chunk-R2HWUZ3L.js";import{b as _e}from"./chunk-ORM3VHG6.js";import{a as Ce}from"./chunk-M2GLXRA2.js";import{b as ke,i as Te}from"./chunk-ZVHU7VE3.js";import{j as ye,k as Ae}from"./chunk-76YVRX2R.js";import{B as M,C as Pe,E,I as mt,b as ht,c as b,e as B,m as g,n as me,o as U,p as Le,s as ge,t as y,u as K}from"./chunk-OZF6BMOL.js";import{a as l,b as R,c as Vt,i as he}from"./chunk-GJP6PTKT.js";import{a as J}from"./chunk-RSDQHAJX.js";import{A as fe}from"./chunk-AUTL5LCV.js";import{g as ue,q as le}from"./chunk-CRMMDK2Z.js";function an(e,t){let n=e.x-t.x,s=e.y-t.y;return n*n+s*s}function Wn(e,t){return Math.sqrt(an(e,t))}function Jn(e,t){t.sort((n,s)=>U(n.targetPoint,e)-U(s.targetPoint,e))}var Ge;function Kn({point:e,distance:t,returnEdge:n,vertexMode:s,coordinateHelper:{spatialReference:r},filter:i},o,a){return a=a!=null?a.clone():new Ve({where:"1=1"}),i&&(a.geometry=i.geometry,a.distance=i.distance,a.spatialRelationship=i.spatialRelationship,a.where=_e(a.where,i.where),a.timeExtent=Ee(a.timeExtent,i.timeExtent),a.objectIds=on(a.objectIds,i.objectIds)),{point:He(e[0],e[1],e[2],r.toJSON()),mode:o,distance:t,returnEdge:n,vertexMode:s,query:a.toJSON()}}function on(e,t){return e||t?t?e?Array.from(fe(new Set(e),new Set(t))):t:e:null}function Qn(e,t,n){return{left:Dt(e.leftVertex.pos,t,n),right:Dt(e.rightVertex.pos,t,n)}}function Xn(e){return e.createQuery()}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(Ge||(Ge={}));var Ye=Symbol("snapping-toggle");function Bn(e,t=()=>{}){let n=de(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:s,snappingOptions:r})=>{if(e.removeHandles(Ye),!s||!r)return;let i=je.TOOL,o=[s.on("key-down",a=>{a.key!==It.toggle||a.repeat||(r.enabledToggled=!0,t())},i),s.on("key-up",a=>{a.key===It.toggle&&(r.enabledToggled=!1,t())},i),s.on("pointer-move",a=>{let c=a.native.ctrlKey;r.enabledToggled!==c&&(r.enabledToggled=c,t())},i)];e.addHandles(o,Ye)},pe);e.addHandles(n)}function Un(e){return Oe(e)&&"utilityNetworks"in e&&!!e.utilityNetworks?.length}function _t({start:e,end:t,type:n},s,r){let i=[],o=z(st,t,e),a=z(Tt,e,s),c=tt(o),u=2*Q(o,a),p=u*u-4*c*(tt(a)-r*r);if(p===0){let f=-u/(2*c);(n===k.PLANE||f>=0)&&i.push($(I(),e,o,f))}else if(p>0){let f=Math.sqrt(p),L=(-u+f)/(2*c);(n===k.PLANE||L>=0)&&i.push($(I(),e,o,L));let h=(-u-f)/(2*c);(n===k.PLANE||h>=0)&&i.push($(I(),e,o,h))}return i}function jt(e,t){let n=e.start,s=e.end,r=z(st,s,n),i=b(Mt,-r[1],r[0],0),o=t.start,a=t.end,c=E(Kt,a,o),u=y(c,i),p=b(Ke,n[0],n[1],0),f=E(Qe,p,o),L=y(f,i),h=J();if(Math.abs(u)<h)return Math.abs(L),[];let m=g(Xe,o,c,L/u);if(t.type===P.RAY){let A=E(Ht,m,o);if(y(A,c)<-h)return[]}if(e.type===k.HALF_PLANE){let A=ve(Tt,m,n);if(Q(A,r)<-h)return[]}return[R(m)]}function Ze(e,t){return cn(Et(Qt,t[2],e),t)}function Ot(e,t){return Wt(Et(Qt,0,e),Et(fn,0,t)).map(([s,r])=>et(s,r))}function Ft(e,t,n){return Yt(e,Et(Qt,e[2],t),n)}function Gt(e,t,n,s=l()){let r=z(st,e,t),i=Ne(r);return $(s,t,r,i===0?1:n/i),s[2]=e[2],s}function Yt(e,{start:t,end:n,type:s},r=l()){let i=E(Ct,e,t),o=E(Mt,n,t),a=y(i,o)/y(o,o);return g(r,t,o,s===P.RAY?Math.max(a,0):a)}var We=(()=>{let e=l(),t=l(),n=l();return({start:s,end:r},{center:i,radius:o,normal:a,slicePlane:c})=>{let u=X(i,a,ln);if(d(nt(u,s),0)&&d(nt(u,r),0)){Pt(a,e,t);let f=(m,A)=>(B(n,A,i),Lt(m,y(n,e),y(n,t)),m),L=Fe({start:f(st,s),end:f(Tt,r),type:P.LINE},xe,o),h=[];for(let[m,A]of L){let C=ht(l(),i);g(C,C,e,m),g(C,C,t,A),c&&!D(c,C)||h.push(C)}return h}let p=l();return yt(u,s,r,p)?!d(me(p,i),o)||c&&!D(c,p)?[]:[p]:[]}})();function Zt({start:e,end:t,type:n},s,r){let i=[],o=B(Ct,t,e),a=z(Tt,e,s),c=tt(o),u=2*Q(o,a),p=u*u-4*c*(tt(a)-r*r);if(p===0){let f=-u/(2*c);(n===P.LINE||f>=0)&&i.push(g(l(),e,o,f))}else if(p>0){let f=Math.sqrt(p),L=(-u+f)/(2*c);(n===P.LINE||L>=0)&&i.push(g(l(),e,o,L));let h=(-u-f)/(2*c);(n===P.LINE||h>=0)&&i.push(g(l(),e,o,h))}return i}function Wt(e,t){let n=e.start,s=e.end,r=t.start,i=t.end,o=E(Ct,s,n),a=E(Mt,i,r),c=E(Kt,r,n),u=K(Ke,o,a);if(!d(y(c,u),0))return[];let p=mt(u);if(d(p,0))return[];let f=K(Qe,c,a),L=y(f,u)/p,h=g(Xe,n,o,L);if(e.type===P.RAY){let m=E(Ht,h,n);if(y(o,m)<-J())return[]}if(t.type===P.RAY){let m=E(Ht,h,r);if(y(a,m)<-J())return[]}return[R(h)]}function cn({start:e,end:t,type:n},s){let r=E(Ct,s,e),i=E(Mt,t,e),o=K(Kt,i,r),a=mt(o)/mt(i),c=J();if(a<c)switch(n){case P.LINE:return[R(s)];case P.RAY:return y(i,r)<-c?[]:[R(s)]}return[]}function kt(e,t,n,s){let[r,i]=e,[o,a]=n,c=o-r,u=a-i,p=c*c+u*u,f=Math.sqrt(p);if(f>t+s)return[];if(f<Math.abs(t-s))return[];if(d(f,0)&&d(t,s))return[];let L=(t*t-s*s+p)/(2*f),h=Math.sqrt(t*t-L*L),m=h*u/f,A=h*c/f,[C,Y]=we(st,e,n,L/f);return d(m,A)?[et(C,Y)]:[et(C+m,Y-A),et(C-m,Y+A)]}function Et(e,t,{start:n,end:s,type:r}){return b(e.start,n[0],n[1],t),b(e.end,s[0],s[1],t),e.type=un[r],e}function Jt(e,t){return d(e[2],t[2])}function d(e,t){return Ae(Math.abs(e-t),0,J())}function Je(e,t){return t.filter(n=>D(e,n))}function D(e,t){return Re(e,t)}var k;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})(k||(k={}));var un={[k.PLANE]:P.LINE,[k.HALF_PLANE]:P.RAY},st=I(),Tt=I(),Ct=l(),Mt=l(),Kt=l(),Ke=l(),Qe=l(),Xe=l(),Ht=l(),ln=_(),Qt={start:l(),end:l(),type:P.LINE},fn={start:l(),end:l(),type:P.LINE};var T=class{intersect(t){return H(this,t)}closestPoints(t){return[this.closestTo(t)]}},W=class extends T{constructor(t){super(),this.point=t}equals(t){return this===t||w(t)&&M(this.point,t.point)}closestTo(){return Z(this.point)}},it=class extends T{constructor(t,n,s){super(),this.start=t,this.end=n,this.lineLike={start:t,end:n,type:s}}equals(t){return this===t||x(t)&&this.lineLike.type===t.lineLike.type&&M(this.start,t.start)&&M(this.end,t.end)}closestTo(t){let n=N();return Yt(t,this.lineLike,n),n}},Nt=class extends it{constructor(t,n){super(t,n,P.LINE)}},Ut=class extends it{constructor(t,n){super(t,n,P.RAY)}},wt=class extends T{constructor(t){super(),this.constraints=t}equals(t){return this===t||ie(t)&&ue(this.constraints,t.constraints,(n,s)=>n.equals(s))}closestTo(t){let n,s=1/0;for(let r of this.constraints){let i=r.closestTo(t),o=U(t,i);o<s&&(s=o,n=i)}return Z(n??t)}closestPoints(t){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(t))}},$t=class extends T{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||q(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){let n=N();return Gt(t,this.center,this.radius,n),n}},at=class extends T{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||O(t)&&M(this.center,t.center)&&this.radius===t.radius}closestTo(t){let n=N();return Gt(t,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new ot(Z(this.center),this.radius,S(0,0,1))}},ot=class extends T{constructor(t,n,s,r=void 0){super(),this.center=t,this.radius=n,this.normal=s,this.slicePlane=r}equals(t){return this===t||G(t)&&M(this.center,t.center)&&M(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){let{center:n,radius:s}=this;Rt(this.getPlane(dn),t,Xt);let r=E(Xt,Xt,n),i=Le(r);if(d(i,0))return Z(t);let o=s/Math.sqrt(i),a=N();g(a,n,r,o);let{slicePlane:c}=this;return c&&!D(c,a)?ae(c,this)?.closestTo(t)??Z(t):a}getPlane(t=_()){return X(this.center,this.normal,t)}},Xt=l(),dn=_(),te=class extends T{constructor(t){super(),this.z=t}equals(t){return this===t||j(t)&&this.z===t.z}closestTo(t){return S(t[0],t[1],this.z)}getPlane(t=_()){return b(Be,0,0,this.z),X(Be,he,t)}},Be=l(),ct=class extends T{constructor(t,n,s){super(),this.start=t,this.end=n,this.planeLike={start:t,end:n,type:s}}equals(t){return this===t||V(t)&&this.planeLike.type===t.planeLike.type&&M(this.start,t.start)&&M(this.end,t.end)}closestTo(t){let n=N();return Ft(t,this.planeLike,n),n}closestEndTo(t){let{start:n,end:s}=this.planeLike;return Math.sign(Q(z(pn,s,n),z(hn,t,n)))>0?this.end:this.start}getPlane(t=_()){let n=ht(Ue,this.end);return n[2]+=1,qe(this.start,this.end,n,t)}getSlicePlane(t=_()){let{start:n,end:s,type:r}=this.planeLike;if(r===k.PLANE)return;let i=b(Ue,n[0],n[1],0),o=b($e,s[0],s[1],0),a=B($e,o,i);return X(i,a,t),t}},pn=I(),hn=I(),Ue=l(),$e=l(),tn=class extends ct{constructor(t,n){super(t,n,k.HALF_PLANE)}},en=class extends ct{constructor(t,n){super(t,n,k.PLANE)}},ee=class extends T{constructor(t,n){super(),this.sphere=Ie(t,n)}equals(t){return this===t||F(t)&&ze(this.sphere,t.sphere)}closestTo(t){let n=N();return De(this.sphere,t,n),n}get center(){return this.sphere}get radius(){return this.sphere[3]}},ne=class extends T{constructor(t,n,s){super(),this.start=t,this.end=n,this.getZ=s,this.planeLike={start:t,end:n,type:k.PLANE}}equals(t){return this===t||vt(t)&&M(this.start,t.start)&&M(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return Pn(this,t)}addIfOnTheGround(t,n){for(let s of n){let r=this.getZ(s[0],s[1])??0;d(s[2],r)&&(s[2]=r,t.push(s))}}},se=class extends T{constructor(t,n,s){super(),this._x=t,this._y=n,this._z=s}equals(t){return this===t||bn(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo([t,n,s]){return St(this._x??t,this._y??n,this._z??s)}},re=class extends T{constructor(t,n,s,r,i){super(),this._origin=t,this._spatialReference=n,this._distanceMeters=s,this._elevationMeters=r,this._directionDegrees=i}equals(t){return this===t||Rn(t)&&qt(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._elevationMeters===t._elevationMeters&&this._directionDegrees===t._directionDegrees}closestTo([t,n,s]){return Lt(rt,t,n),qt(rt,this._origin)||this._applyDirectionAndDistance(rt),St(rt[0],rt[1],this._elevationMeters??s)}_applyDirectionAndDistance(t){if(this._directionDegrees!=null&&this._distanceMeters!=null)At(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Ln(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(this._distanceMeters!=null){let{azimuth:n}=zt(mn,this._origin,t,this._spatialReference);At(t,this._origin,n??0,this._distanceMeters,this._spatialReference)}}},rt=[0,0],mn=new bt;function Ln(e,t,n,s,r){let{azimuth:i,distance:o}=zt(gn,t,s,r);i??=0;let a=o*Math.cos((i-n)*Me);a=Math.max(0,a),At(e,t,n,a,r)}var gn=new bt;function Pn(e,t){let n=N();return Ft(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??rn,n}function H(e,t){if(ie(e)){let n=[];for(let s of e.constraints){let r=s.intersect(t);r&&n.push(r)}return oe(n)}if(ie(t))return H(t,e);if(vt(e))return nn(e,t);if(vt(t))return nn(t,e);if(w(e)){let{point:n}=e;if(w(t))return M(n,t.point)?e:void 0;let s=t.closestTo(n);return Pe(s,n)?e:void 0}if(x(e)){if(w(t))return H(t,e);if(x(t))return v(Wt(e.lineLike,t.lineLike));if(j(t))return yn(e,t);if(V(t))return v(jt(t.planeLike,e.lineLike));if(q(t))return v(Zt(e.lineLike,t.center,t.radius));if(G(t))return v(We(e.lineLike,t));if(O(t))return An(e,t);if(F(t))return En(e,t)}else if(j(e)){if(w(t)||x(t))return H(t,e);if(j(t))return _n(e,t);if(V(t))return kn(e,t);if(q(t))return Tn(e,t);if(G(t))return Mn(e,t);if(O(t))return Cn(e,t);if(F(t))return Nn(e,t)}else if(V(e)){if(w(t)||x(t)||j(t))return H(t,e);if(V(t))return Bt(Ot(e.planeLike,t.planeLike));if(q(t))return Bt(_t(e.planeLike,t.center,t.radius));if(G(t))return vn(e,t);if(O(t))return wn(e,t);if(F(t))return xn(e,t)}else if(q(e)){if(w(t)||x(t)||j(t)||V(t))return H(t,e);if(q(t))return Bt(kt(e.center,e.radius,t.center,t.radius));if(G(t))return void 0;if(O(t))return Vn(e,t);if(F(t))return void 0}else if(G(e)){if(w(t)||x(t)||j(t)||V(t)||q(t))return H(t,e);if(G(t))return void 0;if(O(t))return t.asCircle(),void 0;if(F(t))return void 0}else if(O(e)){if(w(t)||x(t)||j(t)||V(t)||q(t)||G(t))return H(t,e);if(O(t))return qn(t,e);if(F(t))return void 0}else if(F(e)){if(w(t)||x(t)||j(t)||V(t)||q(t)||O(t))return H(t,e);if(F(t))return void 0}}var yn=(()=>{let e=_();return(t,n)=>{let{start:s,end:r}=t;if(Jt(s,r)&&d(s[2],n.z))return t;let i=N();return yt(n.getPlane(e),s,r,i)?new W(i):void 0}})();function An({lineLike:e},{center:t,radius:n}){let s=t[2];return v(Zt(e,t,n).filter(r=>d(r[2],s)))}function En({lineLike:e},{sphere:t}){return v(Se(t,e.start,e.end))}var ae=(()=>{let e=Ce(),t=l(),n=l();return(s,r,i)=>{let{normal:o,center:a,radius:c}=r;Pt(o,t,n);let u=s,p=c*y(u,t),f=c*y(u,n);ke(e,a[0],a[1],a[2],1);let L=Te(s,e),h=Math.hypot(p,f),m=d(h,0);if(d(nt(s,a),0)){if(m)return r;if(d(c,0))return!i||D(i,a)?new W(Z(a)):void 0;K(t,u,o),ge(t,t);let xt=new Array,dt=R(a);g(dt,dt,t,c),i&&!D(i,dt)||xt.push(dt);let pt=R(a);return g(pt,pt,t,-c),i&&!D(i,pt)||xt.push(pt),v(xt)}if(m)return;let A=-L/h;if(Math.abs(A)>1||d(A,1))return;let C=Math.atan(p/f),Y=ye(A)-C,ce=Math.PI-Y,ut=new Array,lt=l();g(lt,a,t,c*Math.cos(Y)),g(lt,lt,n,c*Math.sin(Y)),ut.push(lt);let ft=l();return g(ft,a,t,c*Math.cos(ce)),g(ft,ft,n,c*Math.sin(ce)),ut.push(ft),v(i?Je(i,ut):ut)}})();function _n(e,t){return d(e.z,t.z)?e:void 0}function kn({z:e},{planeLike:t}){let[n,s]=t.start,[r,i]=t.end,o=S(n,s,e),a=S(r,i,e);return t.type===k.PLANE?new Nt(o,a):new Ut(o,a)}function Tn(e,t){let[n,s]=t.center;return new at(S(n,s,e.z),t.radius)}function Cn(e,t){return d(t.center[2],e.z)?t:void 0}var Mn=(()=>{let e=_();return(t,n)=>ae(t.getPlane(e),n,n.slicePlane)})();function Nn(e,{center:t,radius:n}){let s=Math.abs(t[2]-e.z);if(s>n&&!d(s,n))return;let r=S(t[0],t[1],e.z),i=Math.sqrt(n**2-s**2);return d(i,0)?void 0:new at(r,i)}var wn=(()=>{let e=_();return(t,{center:n,radius:s})=>{let r=_t(t.planeLike,n,s),i=n[2];t.getSlicePlane(e);let o=new Array;for(let[a,c]of r){let u=[a,c,i];D(e,u)&&o.push(u)}return v(o)}})(),vn=(()=>{let e=_(),t=_();return(n,s)=>ae(n.getPlane(e),s,n.getSlicePlane(t))})(),xn=(()=>{let e=_();return(t,{center:n,radius:s})=>{let r=t.getPlane(e),i=be(r,n),o=Math.abs(i);if(o>s&&!d(o,s))return;let a=Math.sqrt(s**2-i**2);if(d(a,0)){let p=N();return Rt(r,n,p),new W(p)}let c=N(),u=R(r);return g(c,n,u,i),new ot(c,a,u,t.getSlicePlane())}})();function Vn(e,t){let n=gt(e.center,t.center);return d(n,0)&&d(e.radius,t.radius)?t:sn(kt(e.center,e.radius,t.center,t.radius),t.center[2])}function qn(e,t){if(!Jt(e.center,t.center))return;let n=gt(e.center,t.center);return d(n,0)&&d(e.radius,t.radius)?e:sn(kt(e.center,e.radius,t.center,t.radius),e.center[2])}function nn(e,t){let{planeLike:n,getZ:s}=e,r=new Array;if(w(t))e.addIfOnTheGround(r,Ze(n,t.point));else if(x(t))e.addIfOnTheGround(r,jt(n,t.lineLike));else if(q(t))for(let[i,o]of _t(n,t.center,t.radius)){let a=s(i,o);a!=null&&r.push(Vt(i,o,a))}else if(V(t)||vt(t))for(let[i,o]of Ot(n,t.planeLike)){let a=s(i,o)??rn;r.push(Vt(i,o,a))}return v(r)}function Bt(e){return oe(e.map(([t,n])=>{let s=S(t,n,0),r=S(t,n,1);return new Nt(s,r)}))}function v(e){return oe(e.map(t=>t?new W(t):void 0))}function sn(e,t){return v(e.map(([n,s])=>[n,s,t]))}function oe(e){if(e.length!==0)return e.length===1?e[0]??void 0:new wt(e.filter(le))}function ie(e){return e instanceof wt}function w(e){return e instanceof W}function x(e){return e instanceof it}function j(e){return e instanceof te}function V(e){return e instanceof ct}function q(e){return e instanceof $t}function O(e){return e instanceof at}function G(e){return e instanceof ot}function F(e){return e instanceof ee}function vt(e){return e instanceof ne}function Rn(e){return e instanceof re}function bn(e){return e instanceof se}var rn=0;export{Yt as a,W as b,Nt as c,$t as d,te as e,tn as f,en as g,ne as h,se as i,re as j,oe as k,w as l,an as m,Wn as n,Jn as o,Ge as p,Kn as q,Qn as r,Xn as s,Bn as t,Un as u};
