import{b as I,c as V}from"./chunk-CFNOUYUR.js";import{a as _}from"./chunk-B7KWHLLV.js";import"./chunk-7O3EZSIG.js";import{a as x}from"./chunk-PE4X2FO7.js";import"./chunk-TICXV5QZ.js";import"./chunk-RXMXYODQ.js";import"./chunk-EMACKK4D.js";import{a as b}from"./chunk-6V4AOGGQ.js";import{a as P}from"./chunk-D25K7LZ7.js";import"./chunk-C54ONMNR.js";import{a as H}from"./chunk-OGDKYPWU.js";import"./chunk-TJO74ND6.js";import"./chunk-A3KX3DLS.js";import{b as w,c as v}from"./chunk-VZSQNMU3.js";import"./chunk-VOLKMATP.js";import"./chunk-XJE2IOXJ.js";import"./chunk-72UMK7Q7.js";import"./chunk-BYXBJQAS.js";import"./chunk-BSIXRBVK.js";import"./chunk-3VXDWYJU.js";import"./chunk-RI4EXXSR.js";import"./chunk-BYXBJQAS.js";import"./chunk-KNDM5UGY.js";import"./chunk-EKKBMKVP.js";import"./chunk-TEXQFKMJ.js";import"./chunk-V2ACH6PW.js";import"./chunk-NOUYXRP4.js";import"./chunk-CXKNFANK.js";import"./chunk-57GB3TOJ.js";import"./chunk-RHABF3KL.js";import"./chunk-2MJIH6TV.js";import"./chunk-HX3FHHCG.js";import"./chunk-ZOOQQO74.js";import"./chunk-OGOKP66I.js";import"./chunk-BZEC7TCW.js";import"./chunk-WD4CT5CX.js";import"./chunk-XAHD7XBV.js";import"./chunk-UZSTUBKI.js";import"./chunk-R5S5CHNL.js";import"./chunk-UDAVCKBV.js";import"./chunk-7QY3BMVN.js";import"./chunk-BGI2WQLI.js";import"./chunk-Z33JZO3Q.js";import"./chunk-FYZRIMPP.js";import"./chunk-W5OI4BJ2.js";import"./chunk-XSMN6VN6.js";import"./chunk-I46GU3Q4.js";import"./chunk-LX3TXNPU.js";import"./chunk-FOPE5Y6E.js";import"./chunk-R4ZRZJFL.js";import"./chunk-L657QK52.js";import{a as y}from"./chunk-FJ6F3CXY.js";import"./chunk-4Y7EKSO4.js";import"./chunk-XVXRQZ3E.js";import"./chunk-Z6LOQ73Z.js";import{c as f}from"./chunk-ZORGARF3.js";import"./chunk-MJN6ZDZD.js";import"./chunk-26EEXAHQ.js";import"./chunk-OX7MQO37.js";import"./chunk-AC7AQWXQ.js";import"./chunk-HPYQ6UOC.js";import"./chunk-37H4LYIE.js";import"./chunk-X4LAWCTR.js";import"./chunk-TBR6RMWR.js";import"./chunk-ZB2MLS4M.js";import{l as c}from"./chunk-IFW7DQNN.js";import"./chunk-MAVOHF7Q.js";import"./chunk-JIO2NKRP.js";import"./chunk-JIFV566L.js";import"./chunk-A2WF4NJX.js";import"./chunk-VAIXCJGK.js";import"./chunk-STCMK6X3.js";import"./chunk-X6FZ7Z76.js";import"./chunk-5RW6D2ZS.js";import"./chunk-N7KNO35F.js";import"./chunk-53X2B37Z.js";import"./chunk-6UOVQ25A.js";import"./chunk-BNSYK2BT.js";import"./chunk-DHY7QZ2H.js";import"./chunk-MFP2OFDR.js";import"./chunk-ADXKVFX6.js";import"./chunk-VWOJQZ7J.js";import"./chunk-V2JYXY4D.js";import"./chunk-KMJL237I.js";import"./chunk-PDWLAUMH.js";import"./chunk-UVZRJ2I3.js";import"./chunk-65QIQYGA.js";import"./chunk-TLLESPR2.js";import"./chunk-NFADXGWT.js";import"./chunk-YTC2EJDQ.js";import"./chunk-2UDQ3IWX.js";import"./chunk-DCAB3MR3.js";import"./chunk-KVRBCQMQ.js";import"./chunk-XDMNA7OV.js";import"./chunk-NKZ7R6T6.js";import"./chunk-VHAPMMA5.js";import"./chunk-DR5D3NPO.js";import"./chunk-U6WVZEYH.js";import"./chunk-ERH7ZNSC.js";import"./chunk-GUOR3BIM.js";import"./chunk-2EA2KAER.js";import"./chunk-V5AJXD2Y.js";import"./chunk-WXS2B4FF.js";import"./chunk-XFK3CDZ5.js";import"./chunk-4XBATNKX.js";import"./chunk-3IJY37BG.js";import"./chunk-J57HR4DB.js";import{a as u}from"./chunk-GNCG2SQP.js";import"./chunk-5HCLBNUR.js";import"./chunk-5JXPUH2D.js";import"./chunk-F4I5LECK.js";import"./chunk-J4PQZSQE.js";import"./chunk-KYP6LPQU.js";import"./chunk-UMB6LRQI.js";import"./chunk-AQ74ANSJ.js";import"./chunk-SAOUSUZE.js";import"./chunk-IFPBW5UQ.js";import"./chunk-6ZT4EXDX.js";import"./chunk-RHHHYJSZ.js";import"./chunk-QBQKFGOZ.js";import"./chunk-K5NHJTKR.js";import"./chunk-XKXYUJUA.js";import"./chunk-F7PIPM6E.js";import"./chunk-FR6Q4MSQ.js";import"./chunk-C6JT6KYF.js";import"./chunk-BCREO4Q5.js";import"./chunk-Z5Q76SB7.js";import"./chunk-E5R4OI7X.js";import"./chunk-6FWNINU2.js";import"./chunk-ES7AH7WX.js";import"./chunk-RSDQHAJX.js";import"./chunk-NYONONNN.js";import"./chunk-MZFPLWMN.js";import"./chunk-DS2JVXBM.js";import"./chunk-G3LLBABP.js";import"./chunk-T4B3RN6B.js";import"./chunk-MXADXAOS.js";import"./chunk-RJHITHLB.js";import"./chunk-CGTLZX6D.js";import"./chunk-JTJ3UVF7.js";import"./chunk-R4TNLPIN.js";import"./chunk-5HLV7XP5.js";import"./chunk-BENVXA3L.js";import"./chunk-UI76XBLJ.js";import"./chunk-UE2YGKE7.js";import"./chunk-BE76S5KT.js";import"./chunk-3RDV3O6N.js";import"./chunk-D2ITYHSM.js";import"./chunk-FIITBHDP.js";import"./chunk-VSVNPPHQ.js";import"./chunk-CTGIUUCS.js";import{F as r}from"./chunk-VWEBO6QK.js";import{S as p}from"./chunk-KAAR5ZJN.js";import{a as i}from"./chunk-W3WDPWBE.js";import{p as d}from"./chunk-WKT5W7KT.js";import"./chunk-MLSR6YE6.js";import"./chunk-JPDAKIWT.js";import"./chunk-VU5W7W6Y.js";import{p as g}from"./chunk-X3IDZTNG.js";import"./chunk-IQJU4QT3.js";import{a as n,h as l}from"./chunk-EAH6BNBL.js";var E=t=>{let e=class extends t{initialize(){this.exportImageParameters=new y({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty("version"),this.commitProperty("timeExtent"),this.commitProperty("floors"),(this._get("exportImageVersion")||0)+1}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return i([r()],e.prototype,"exportImageParameters",void 0),i([r({readOnly:!0})],e.prototype,"floors",null),i([r({readOnly:!0})],e.prototype,"exportImageVersion",null),i([r()],e.prototype,"layer",void 0),i([r()],e.prototype,"suspended",void 0),i([r(c)],e.prototype,"timeExtent",void 0),e=i([p("esri.views.layers.MapImageLayerView")],e),e};var o=class extends E(H(w(v))){constructor(){super(...arguments),this._highlightGraphics=new f,this._updateHash=""}fetchPopupFeaturesAtLocation(t,e){return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(t,e)}update(t){let e=`${this.exportImageVersion}/${t.state.id}/${t.pixelRatio}/${t.stationary}`;this._updateHash!==e&&(this._updateHash=e,this.strategy.update(t).catch(a=>{d(a)||g.getLogger(this).error(a)}),t.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)),this._highlightView.processUpdate(t)}attach(){let{imageMaxWidth:t,imageMaxHeight:e,version:a}=this.layer,s=a>=10.3,C=a>=10;this._bitmapContainer=new P,this.container.addChild(this._bitmapContainer),this._highlightView=new x({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new _(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new I({createFetchPopupFeaturesQueryGeometry:(h,m)=>V(h,m,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(h,m)=>{this._highlightView.graphicUpdateHandler({graphic:h,property:m})},layerView:this,updatingHandles:this._updatingHandles}),this.strategy=new b({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:t,imageMaxHeight:e,imageRotationSupported:s,imageNormalizationSupported:C,hidpi:!0}),this.addAttachHandles(u(()=>this.exportImageVersion,()=>this.requestUpdate())),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(t){return this.layer.serviceSupportsSpatialReference(t)}doRefresh(){return l(this,null,function*(){this._updateHash="",this.requestUpdate()})}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(t,e,a,s){return this.layer.fetchImage(t,e,a,n({timeExtent:this.timeExtent,floors:this.floors},s))}fetchImageBitmap(t,e,a,s){return this.layer.fetchImageBitmap(t,e,a,n({timeExtent:this.timeExtent,floors:this.floors},s))}highlight(t){return this._popupHighlightHelper.highlight(t)}};i([r()],o.prototype,"strategy",void 0),i([r()],o.prototype,"updating",void 0),o=i([p("esri.views.2d.layers.MapImageLayerView2D")],o);var at=o;export{at as default};
