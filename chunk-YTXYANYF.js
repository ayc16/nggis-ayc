import{a as f,b as g}from"./chunk-L4MOPW3J.js";import"./chunk-OTYIVLNB.js";import"./chunk-7TPH6OXU.js";import"./chunk-72HDUQH4.js";import"./chunk-TICXV5QZ.js";import"./chunk-RXMXYODQ.js";import"./chunk-EMACKK4D.js";import"./chunk-OGDKYPWU.js";import"./chunk-TJO74ND6.js";import"./chunk-A3KX3DLS.js";import"./chunk-VZSQNMU3.js";import"./chunk-VOLKMATP.js";import"./chunk-ATQVCPB3.js";import"./chunk-BYXBJQAS.js";import"./chunk-BSIXRBVK.js";import"./chunk-TTUUVT2M.js";import"./chunk-RI4EXXSR.js";import"./chunk-BYXBJQAS.js";import"./chunk-KNDM5UGY.js";import"./chunk-EKKBMKVP.js";import"./chunk-TEXQFKMJ.js";import"./chunk-V2ACH6PW.js";import"./chunk-NOUYXRP4.js";import"./chunk-CXKNFANK.js";import"./chunk-57GB3TOJ.js";import"./chunk-RHABF3KL.js";import"./chunk-2MJIH6TV.js";import"./chunk-HX3FHHCG.js";import"./chunk-ZOOQQO74.js";import"./chunk-OGOKP66I.js";import"./chunk-BZEC7TCW.js";import"./chunk-WD4CT5CX.js";import"./chunk-UZSTUBKI.js";import"./chunk-UDAVCKBV.js";import"./chunk-7QY3BMVN.js";import"./chunk-BGI2WQLI.js";import"./chunk-Z33JZO3Q.js";import"./chunk-W5OI4BJ2.js";import"./chunk-XSMN6VN6.js";import"./chunk-I46GU3Q4.js";import"./chunk-QAJCY744.js";import"./chunk-FOPE5Y6E.js";import"./chunk-R4ZRZJFL.js";import"./chunk-L657QK52.js";import"./chunk-4Y7EKSO4.js";import"./chunk-XVXRQZ3E.js";import"./chunk-UPCYQ2JS.js";import"./chunk-26EEXAHQ.js";import"./chunk-OX7MQO37.js";import"./chunk-AC7AQWXQ.js";import"./chunk-HPYQ6UOC.js";import"./chunk-37H4LYIE.js";import"./chunk-X4LAWCTR.js";import"./chunk-A3QOQ5KT.js";import{a as y}from"./chunk-3SDF35T4.js";import"./chunk-NSRU3MRX.js";import"./chunk-NJFASAXZ.js";import"./chunk-ZNEMFYSX.js";import"./chunk-ZB2MLS4M.js";import"./chunk-6MKTTYAV.js";import"./chunk-PPALSVK5.js";import"./chunk-MAVOHF7Q.js";import"./chunk-JIO2NKRP.js";import"./chunk-JIFV566L.js";import"./chunk-YBNLKD57.js";import"./chunk-A2WF4NJX.js";import"./chunk-STCMK6X3.js";import{a as c}from"./chunk-C4OC7UNL.js";import"./chunk-KH5B55IZ.js";import"./chunk-LOEAA5XF.js";import"./chunk-LX5FIKVZ.js";import"./chunk-576BZULE.js";import"./chunk-N7KNO35F.js";import"./chunk-TALIOOAA.js";import"./chunk-6UOVQ25A.js";import"./chunk-BNSYK2BT.js";import"./chunk-DHY7QZ2H.js";import"./chunk-MFP2OFDR.js";import"./chunk-ADXKVFX6.js";import"./chunk-B7SBOPIK.js";import"./chunk-PDWLAUMH.js";import"./chunk-UVZRJ2I3.js";import"./chunk-65QIQYGA.js";import"./chunk-TLLESPR2.js";import"./chunk-NFADXGWT.js";import"./chunk-FI6XC3PH.js";import"./chunk-I3S324BU.js";import"./chunk-YTC2EJDQ.js";import"./chunk-2UDQ3IWX.js";import"./chunk-DCAB3MR3.js";import"./chunk-ERH7ZNSC.js";import"./chunk-GUOR3BIM.js";import"./chunk-2EA2KAER.js";import"./chunk-V5AJXD2Y.js";import"./chunk-WXS2B4FF.js";import"./chunk-J57HR4DB.js";import{a as l}from"./chunk-GNCG2SQP.js";import"./chunk-RMOIVYM4.js";import"./chunk-5JXPUH2D.js";import"./chunk-F4I5LECK.js";import"./chunk-J4PQZSQE.js";import"./chunk-Q3WN5PJ6.js";import"./chunk-UMB6LRQI.js";import"./chunk-AQ74ANSJ.js";import"./chunk-SAOUSUZE.js";import"./chunk-IFPBW5UQ.js";import"./chunk-ZV7ILGPO.js";import"./chunk-RHHHYJSZ.js";import"./chunk-QBQKFGOZ.js";import"./chunk-K5NHJTKR.js";import"./chunk-XKXYUJUA.js";import"./chunk-F7PIPM6E.js";import"./chunk-FR6Q4MSQ.js";import"./chunk-C6JT6KYF.js";import"./chunk-BCREO4Q5.js";import"./chunk-Z5Q76SB7.js";import"./chunk-E5R4OI7X.js";import"./chunk-6FWNINU2.js";import"./chunk-ES7AH7WX.js";import"./chunk-RSDQHAJX.js";import"./chunk-NYONONNN.js";import"./chunk-MZFPLWMN.js";import"./chunk-DS2JVXBM.js";import"./chunk-G3LLBABP.js";import"./chunk-T4B3RN6B.js";import"./chunk-MXADXAOS.js";import"./chunk-RJHITHLB.js";import"./chunk-U4U366GW.js";import"./chunk-JTJ3UVF7.js";import"./chunk-R4TNLPIN.js";import"./chunk-5HLV7XP5.js";import"./chunk-BENVXA3L.js";import"./chunk-UI76XBLJ.js";import"./chunk-UE2YGKE7.js";import"./chunk-BE76S5KT.js";import"./chunk-3RDV3O6N.js";import"./chunk-D2ITYHSM.js";import"./chunk-FIITBHDP.js";import"./chunk-VSVNPPHQ.js";import"./chunk-CTGIUUCS.js";import{F as n}from"./chunk-VWEBO6QK.js";import{S as u}from"./chunk-KAAR5ZJN.js";import{a as s}from"./chunk-W3WDPWBE.js";import{a as m,b as _}from"./chunk-WKT5W7KT.js";import"./chunk-MLSR6YE6.js";import"./chunk-JPDAKIWT.js";import"./chunk-VU5W7W6Y.js";import{r as h}from"./chunk-X3IDZTNG.js";import"./chunk-IQJU4QT3.js";import{a as d,b as p}from"./chunk-EAH6BNBL.js";var v=e=>{let t=class extends e{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}disconnect(){this._doDisconnect()}connect(){this._doConnect()}clear(){this._doClear()}constructor(...r){super(...r),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return(this._isUserPaused||this.suspended)&&this._streamConnectionStatus==="connected"?"paused":this._streamConnectionStatus}_onSuspendedChange(r){r?this._doPause():this._isUserPaused||this._doResume()}};return s([n()],t.prototype,"_isUserPaused",void 0),s([n({readOnly:!0})],t.prototype,"connectionStatus",null),s([n({type:y})],t.prototype,"filter",void 0),t=s([u("esri.layers.mixins.StreamLayerView")],t),t};var i=class extends v(g){constructor(){super(...arguments),this.pipelineConnectionStatus="disconnected",this.pipelineErrorString=null}initialize(){this.addHandles([l(()=>this.layer.customParameters,e=>this._worker.streamMessenger.updateCustomParameters(e)),this.layer.on("send-message-to-socket",e=>this._worker.streamMessenger.sendMessageToSocket(e)),this.layer.on("send-message-to-client",e=>{this._worker.streamMessenger.sendMessageToClient(e),this._isUserPaused&&"type"in e&&e.type==="clear"&&this.incrementSourceRefreshVersion()}),l(()=>this.layer.purgeOptions,()=>this._update()),l(()=>this.suspended,this._onSuspendedChange.bind(this))],"constructor"),this._doResume()}destroy(){this._doPause()}get connectionError(){return this.pipelineErrorString?new h("stream-controller",this.pipelineErrorString):null}on(e,t){if(Array.isArray(e))return _(e.map(S=>this.on(S,t)));let r=["data-received","message-received"].includes(e);r&&this._worker.streamMessenger.enableEvent(e,!0);let a=super.on(e,t),o=this;return m(()=>{a.remove(),r&&(o._worker.closed||o.hasEventListener(e)||o._worker.streamMessenger.enableEvent(e,!1))})}queryLatestObservations(e,t){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new h("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return f(this._worker.features.executeQueryForLatestObservations(this._cleanUpQuery(e),t).then(r=>{let a=c.fromJSON(r);return a.features.forEach(o=>{o.layer=this.layer,o.sourceLayer=this.layer}),a}),new c({features:[]}))}detach(){super.detach(),this.pipelineConnectionStatus="disconnected"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){this._refreshInterval!=null&&(clearInterval(this._refreshInterval),this._refreshInterval=null)}_doResume(){this._refreshInterval=setInterval(()=>this.incrementSourceRefreshVersion(),this.layer.updateInterval)}_doDisconnect(){this._worker.streamMessenger.disconnect(),this._doPause()}_doConnect(){this._worker.streamMessenger.connect(),this.resume()}_doClear(){this._worker.streamMessenger.clear(),this._refreshInterval==null&&this.incrementSourceRefreshVersion()}_createClientOptions(){let e=super._createClientOptions(),t=this;return p(d({},e),{get container(){return t.featureContainer},setProperty:r=>{this.set(r.propertyName,r.value)}})}};s([n()],i.prototype,"pipelineConnectionStatus",void 0),s([n()],i.prototype,"pipelineErrorString",void 0),s([n({readOnly:!0})],i.prototype,"connectionError",null),s([n({readOnly:!0})],i.prototype,"_streamConnectionStatus",null),i=s([u("esri.views.2d.layers.StreamLayerView2D")],i);var z=i;export{z as default};
