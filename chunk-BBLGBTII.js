import{a as T}from"./chunk-WBPLJNRU.js";import{d as Pt}from"./chunk-DJEFBPF6.js";import{c as At,e as $,f as tt,g as V,h as jt,i as zt,j as Mt}from"./chunk-E2J2V7JN.js";import{a as Nt,b as St}from"./chunk-VXJKEPDS.js";import{c as ht,d as U}from"./chunk-NSEXRUGB.js";import{a as m,c as Gt}from"./chunk-PDBA6QOJ.js";import{c as J,g as _,h as Q,r as Z}from"./chunk-IISBSAYJ.js";import{a as wt,b as p,c as bt,d as X,g as P,k as H,m as xt,n as K,o as Rt,p as vt,s as F,y as Y}from"./chunk-2ETHV3H2.js";import{a as gt}from"./chunk-FVDACA4R.js";import{f as D}from"./chunk-SJW4NR3T.js";import{b as yt,f as dt}from"./chunk-76YVRX2R.js";import{c as pt}from"./chunk-RSDQHAJX.js";import{b as st}from"./chunk-SF6Z2K5H.js";import{a as ft,b as W,l as S,v as O}from"./chunk-2KZICFRS.js";import{a as ct,b as mt}from"./chunk-D2RUV6O4.js";import{A as L,aa as ut,l as I,m as lt}from"./chunk-4JWMB5SM.js";import{a as M}from"./chunk-XNEAL2YW.js";import{L as y,W as C}from"./chunk-AUTL5LCV.js";import{S as z,w as b}from"./chunk-KUJG22IX.js";import{a as u}from"./chunk-W3WDPWBE.js";import{h as E}from"./chunk-EAH6BNBL.js";var A=class extends St{constructor(t){super(t),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(t){return t!=null&&this.row===t.row&&this.rows===t.rows&&this.column===t.column&&this.columns===t.columns}};u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],A.prototype,"row",void 0),u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],A.prototype,"column",void 0),u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],A.prototype,"rows",void 0),u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],A.prototype,"columns",void 0),A=u([z("esri.CameraLayout")],A);var et=A;var h=class extends Nt(C){constructor(...t){super(...t),this.position=new S([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new et}normalizeCtorArgs(t,e,r,o){if(t&&typeof t=="object"&&("x"in t||Array.isArray(t))){let n={position:t};return e!=null&&(n.heading=e),r!=null&&(n.tilt=r),o!=null&&(n.fov=o),n}return t}writePosition(t,e,r,o){let n=t.clone();n.x=b(t.x||0),n.y=b(t.y||0),n.z=t.hasZ?b(t.z||0):t.z,e[r]=n.write({},o)}readPosition(t,e){let r=new S;return r.read(t,e),r.x=b(r.x||0),r.y=b(r.y||0),r.z=r.hasZ?b(r.z||0):r.z,r}equals(t){return t!=null&&this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)&&this.layout.equals(t.layout)}};u([y({type:S,json:{write:{isRequired:!0}}})],h.prototype,"position",void 0),u([ct("position")],h.prototype,"writePosition",null),u([ft("position")],h.prototype,"readPosition",null),u([y({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),M(t=>Pt.normalize(b(t)))],h.prototype,"heading",void 0),u([y({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),M(t=>yt(b(t),-180,180))],h.prototype,"tilt",void 0),u([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],h.prototype,"fov",void 0),u([y({type:et,nonNullable:!0,json:{read:!1,write:!1}})],h.prototype,"layout",void 0),h=u([z("esri.Camera")],h);var Tt=h;var ot,v=ot=class extends C{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new ot({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};u([y({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:rt}}}}})],v.prototype,"rotation",void 0),u([M("rotation")],v.prototype,"castRotation",null),u([y({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:rt}}}}})],v.prototype,"scale",void 0),u([y({types:gt,json:{read:D,write:!0,origins:{"web-scene":{read:D,write:{overridePolicy:rt}}}}})],v.prototype,"targetGeometry",void 0),u([y({type:Tt,json:{write:!0}})],v.prototype,"camera",void 0),v=ot=u([z("esri.Viewpoint")],v);var B=v;function rt(){return{enabled:!this.camera}}var qt=96,Ct=39.37,Dt=180/Math.PI;function Ft(t){return t.wkid?t:t.spatialReference||mt.WGS84}function nt(t,e){return e.type?p(t,e.x,e.y):wt(t,e)}function Vt(t){return ut(t)}function Bt(t,e,r=0){let o=t.width,n=t.height;if(r!==0){let s=dt(r),l=Math.abs(Math.cos(s)),c=Math.abs(Math.sin(s));o=t.width*l+t.height*c,n=t.width*c+t.height*l}let a=Math.max(1,e[0]),i=Math.max(1,e[1]);return Math.max(o/a,n/i)*Xt(t.spatialReference)}function k(t,e,r,o){return E(this,null,function*(){let n,a;if(!t||Array.isArray(t)&&!t.length)return null;if(st.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){let s=t.every(g=>"attributes"in g),l=t.some(g=>!g.geometry),c=t;if(s&&l&&e&&e.allLayerViews){let g=new Map;for(let f of t){let d=f.layer,j=g.get(d)||[],R=f.attributes[d.objectIdField];R!=null&&j.push(R),g.set(d,j)}let x=[];g.forEach((f,d)=>{let j=e.allLayerViews.find(R=>R.layer.id===d.id);if(j&&"queryFeatures"in j){let R=d.createQuery();R.objectIds=f,R.returnGeometry=!0,x.push(j.queryFeatures(R))}});let N=yield Promise.all(x),w=[];for(let f of N)if(f&&f.features&&f.features.length)for(let d of f.features)d.geometry!=null&&w.push(d.geometry);c=w}for(let g of c)o=yield k(g,e,r,o);return o}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")n=new S(t);else if(t instanceof W)n=t;else if("geometry"in t){if(t.geometry)n=t.geometry;else if(t.layer){let s=t.layer,l=e.allLayerViews.find(c=>c.layer.id===s.id);if(l&&"queryFeatures"in l){let c=s.createQuery();c.objectIds=[t.attributes[s.objectIdField]],c.returnGeometry=!0,n=(yield l.queryFeatures(c))?.features?.[0]?.geometry}}}if(n==null)return null;switch(n.type){case"point":a=new O({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":a=ht(n);break;default:a=n.extent}if(!a)return null;J()||Z(a.spatialReference,r)||(yield _());let i=Q(a,r);if(!i)return null;if(o){let s=i.center,l=s.clone();l.x=U(s.x,o.center.x,r),l.x!==s.x&&i.centerAt(l),o=o.union(i)}else o=i;return o})}function Jt(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){let e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,r=0;for(let o of t){let n=o.layer;n?.minScale&&n.maxScale&&(e=n.minScale<e?n.minScale:e,r=n.maxScale>r?n.maxScale:r)}return e&&r?{min:e,max:r}:null}}}function kt(t,e){return I(Ft(t),e)?t:Q(t,e)}function er(t,e){return E(this,null,function*(){if(!t||!e)return new B({targetGeometry:new S,scale:0,rotation:0});let r=e.spatialReference,{constraints:o,padding:n,viewpoint:a,size:i}=e,s=[n?i[0]-n.left-n.right:i[0],n?i[1]-n.top-n.bottom:i[1]],l=null;t instanceof B?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let c=null;l?.targetGeometry?c=l.targetGeometry:t instanceof O?c=t:t instanceof W?c=yield k(t,e,r):t&&(c=(yield k(t.center,e,r))||(yield k(t.target,e,r))||(yield k(t,e,r))),!c&&a?.targetGeometry?c=a.targetGeometry:!c&&e.extent&&(c=e.extent),r||(r=Ft(e.spatialReference||e.extent||c)),J()||I(c.spatialReference,r)||Z(c.spatialReference,r)||(yield _());let g=kt(c,r),x="center"in g?g.center:g;e.pickClosestTarget!==!1&&x.type==="point"&&a.targetGeometry?.type==="point"&&(x.x=U(x.x,a.targetGeometry.x,x.spatialReference));let N=0;l?N=l.rotation:t.hasOwnProperty("rotation")?N=t.rotation:a&&(N=a.rotation);let w=0;w=l?.targetGeometry!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&o&&o.effectiveLODs?o.zoomToScale(t.zoom):Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0?a.scale:Bt(kt(c.extent,r),s,N);let f=Jt(t.target??t);f&&(f.min&&f.min<w?w=f.min:f.max&&f.max>w&&(w=f.max));let d=new B({targetGeometry:x,scale:w,rotation:N});return o&&(d=o.fit(d),o.constrainByGeometry(d),o.rotationEnabled||(d.rotation=a.rotation)),d})}function G(t,e){let r=t.targetGeometry,o=e.targetGeometry;return r.x=o.x,r.y=o.y,r.spatialReference=o.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function _t(t,e,r){return r?p(t,.5*(e[0]-r.right+r.left),.5*(e[1]-r.bottom+r.top)):P(t,e,.5)}var rr=function(){let t=m();return function(e,r,o){let n=r.targetGeometry;nt(t,n);let a=.5*q(r);return e.xmin=t[0]-a*o[0],e.ymin=t[1]-a*o[1],e.xmax=t[0]+a*o[0],e.ymax=t[1]+a*o[1],e.spatialReference=n.spatialReference,e}}();function or(t,e,r,o,n){return Yt(t,e,r.center),t.scale=Bt(r,o),n?.constraints?.constrain(t),t}function Qt(t,e,r,o){return Lt(t,e,r,o),At(t,t)}var Et=function(){let t=m();return function(e,r,o){return Y(e,Ht(e,r),_t(t,r,o))}}(),Zt=function(){let t=T(),e=m();return function(r,o,n,a){let i=q(o),s=at(o);return p(e,i,i),zt(t,e),$(t,t,s),V(t,t,Et(e,n,a)),V(t,t,[0,a.top-a.bottom]),p(r,t[4],t[5])}}();function q(t){return t.scale*Ut(t.targetGeometry?.spatialReference)}function Ut(t){return t!=null&&L(t)?1/(Vt(t)*Ct*qt):1}function at(t){return pt(t.rotation)||0}function Xt(t){return L(t)?Vt(t)*Ct*qt:1}function Ht(t,e){return P(t,e,.5)}var It=function(){let t=m(),e=m(),r=m();return function(o,n,a,i,s,l){return xt(t,n),P(e,a,.5*l),p(r,1/i*l,-1/i*l),Mt(o,e),s&&$(o,o,s),tt(o,o,r),V(o,o,t),o}}(),Lt=function(){let t=m();return function(e,r,o,n){let a=q(r),i=at(r);return nt(t,r.targetGeometry),It(e,t,o,a,i,n)}}(),nr=function(){let t=m();return function(e,r,o,n){let a=q(r);return nt(t,r.targetGeometry),It(e,t,o,a,0,n)}}();function Kt(t){let e=lt(t);return e?e.valid[1]-e.valid[0]:0}function ar(t,e){return Math.round(Kt(t)/e)}var ir=function(){let t=m(),e=m(),r=[0,0,0];return function(o,n,a){X(t,o,n),K(t,t),X(e,o,a),K(e,e),vt(r,t,e);let i=Math.acos(Rt(t,e)/(H(t)*H(e)))*Dt;return r[2]<0&&(i=-i),isNaN(i)&&(i=0),i}}(),sr=function(){let t=m();return function(e,r,o,n){let a=e.targetGeometry;return G(e,r),Zt(t,r,o,n),a.x+=t[0],a.y+=t[1],e}}(),Yt=function(t,e,r){G(t,e);let o=t.targetGeometry;return o.x=r.x,o.y=r.y,o.spatialReference=r.spatialReference,t},cr=function(){let t=m();return function(e,r,o,n,a){a||(a="center"),Y(t,o,n),P(t,t,.5);let i=t[0],s=t[1];switch(a){case"center":p(t,0,0);break;case"left":p(t,-i,0);break;case"top":p(t,0,s);break;case"right":p(t,i,0);break;case"bottom":p(t,0,-s);break;case"top-left":p(t,-i,s);break;case"bottom-left":p(t,-i,-s);break;case"top-right":p(t,i,s);break;case"bottom-right":p(t,i,-s)}return it(e,r,t),e}}();function lr(t,e,r){return G(t,e),t.rotation+=r,t}function ur(t,e,r){return G(t,e),t.rotation=r,t}var $t=function(){let t=m();return function(e,r,o,n,a){return G(e,r),isNaN(o)||o===0||(Wt(t,n,r,a),e.scale=r.scale*o,Ot(t,t,e,a),it(e,e,p(t,t[0]-n[0],n[1]-t[1]))),e}}();function mr(t,e,r){return G(t,e),t.scale=r,t}var te=function(){let t=m();return function(e,r,o,n,a,i){return G(e,r),isNaN(o)||o===0||(Wt(t,a,r,i),e.scale=r.scale*o,e.rotation+=n,Ot(t,t,e,i),it(e,e,p(t,t[0]-a[0],a[1]-t[1]))),e}}(),fr=function(){let t=m(),e=m();return function(r,o,n,a,i,s,l){return Et(e,s,l),bt(t,i,e),a?te(r,o,n,a,t,s):$t(r,o,n,t,s)}}(),Wt=function(){let t=T();return function(e,r,o,n){return F(e,r,Qt(t,o,n,1))}}(),Ot=function(){let t=T();return function(e,r,o,n){return F(e,r,Lt(t,o,n,1))}}(),it=function(){let t=m(),e=T();return function(r,o,n){G(r,o);let a=q(o),i=r.targetGeometry;return jt(e,at(o)),tt(e,e,Gt(a,a)),F(t,n,e),i.x+=t[0],i.y+=t[1],r}}();export{B as a,Bt as b,er as c,G as d,_t as e,rr as f,or as g,Et as h,q as i,Ut as j,It as k,Lt as l,nr as m,Kt as n,ar as o,ir as p,sr as q,Yt as r,cr as s,lr as t,ur as u,mr as v,te as w,fr as x,it as y};
